<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>5.1. RESTful Web Service &#8212; TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.4.1.RELEASE documentation</title>
    <link rel="stylesheet" href="../../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '5.4.1.RELEASE',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.2. REST Client (HTTP Client)" href="RestClient.html" />
    <link rel="prev" title="5. Web Services" href="index.html" /><script async src="https://www.googletagmanager.com/gtag/js?id=G-847V2Q99G8"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date()); gtag('config', 'G-847V2Q99G8');
</script>
<script src="../../_static/jquery.treeview.js" type="text/javascript"></script>
<!-- <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'> -->
<link href="../../_static/solarized-dark.css" rel="stylesheet">
<link href="../../_static/jquery.treeview.css" rel="stylesheet">
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="RestClient.html" title="5.2. REST Client (HTTP Client)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="5. Web Services"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.4.1.RELEASE documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">5. Web Services</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><br/><img src="../../_static/logo_color.png" alt="TERASOLUNA"/><br/><label><input id="scroll" type="checkbox" checked> scroll sidebar</label>

  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5.1. RESTful Web Service</a><ul>
<li><a class="reference internal" href="#overview">5.1.1. Overview</a><ul>
<li><a class="reference internal" href="#what-is-restful-web-service">5.1.1.1. What is RESTful Web Service</a></li>
<li><a class="reference internal" href="#restful-web-service-development">5.1.1.2. RESTful Web Service development</a><ul>
<li><a class="reference internal" href="#configuration-for-restful-web-service-module">5.1.1.2.1. Configuration for RESTful Web Service module</a></li>
<li><a class="reference internal" href="#rest-api-implementation-sample">5.1.1.2.2. REST API implementation sample</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#architecture">5.1.2. Architecture</a><ul>
<li><a class="reference internal" href="#publishing-as-a-resource-on-web">5.1.2.1. Publishing as a resource on Web</a></li>
<li><a class="reference internal" href="#restoverviewassignuri">5.1.2.2. Identifying the resource using URI</a></li>
<li><a class="reference internal" href="#resource-operations-using-http-methods">5.1.2.3. Resource operations using HTTP methods</a></li>
<li><a class="reference internal" href="#using-an-appropriate-format">5.1.2.4. Using an appropriate format</a></li>
<li><a class="reference internal" href="#using-the-appropriate-http-status-code">5.1.2.5. Using the appropriate HTTP status code</a></li>
<li><a class="reference internal" href="#stateless-communication-between-client-and-server">5.1.2.6. Stateless communication between client and server</a></li>
<li><a class="reference internal" href="#link-to-related-resource">5.1.2.7. Link to related resource</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-design">5.1.3. How to design</a><ul>
<li><a class="reference internal" href="#resource-extraction">5.1.3.1. Resource extraction</a></li>
<li><a class="reference internal" href="#assigning-uri">5.1.3.2. Assigning URI</a><ul>
<li><a class="reference internal" href="#assigning-a-uri-that-indicates-the-api-as-rest-api">5.1.3.2.1. Assigning a URI that indicates the API as REST API</a></li>
<li><a class="reference internal" href="#assigning-a-uri-for-identifying-the-api-version">5.1.3.2.2. Assigning a URI for identifying the API version</a></li>
<li><a class="reference internal" href="#assigning-a-path-for-identifying-resource">5.1.3.2.3. Assigning a path for identifying resource</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assigning-http-methods">5.1.3.3. Assigning HTTP methods</a><ul>
<li><a class="reference internal" href="#assigning-http-methods-for-resource-collection-uri">5.1.3.3.1. Assigning HTTP methods for resource collection URI</a></li>
<li><a class="reference internal" href="#assigning-http-methods-for-uri-of-specific-resources">5.1.3.3.2. Assigning HTTP methods for URI of specific resources</a></li>
</ul>
</li>
<li><a class="reference internal" href="#resource-format">5.1.3.4. Resource format</a><ul>
<li><a class="reference internal" href="#json-field-name">5.1.3.4.1. JSON Field name</a></li>
<li><a class="reference internal" href="#null-and-blank-characters">5.1.3.4.2. NULL and blank characters</a></li>
<li><a class="reference internal" href="#date-format">5.1.3.4.3. Date format</a></li>
<li><a class="reference internal" href="#hypermedia-link-format">5.1.3.4.4. Hypermedia link format</a></li>
<li><a class="reference internal" href="#format-at-the-time-of-error-response">5.1.3.4.5. Format at the time of error response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#http-status-code">5.1.3.5. HTTP Status Code</a><ul>
<li><a class="reference internal" href="#http-status-codes-when-the-request-is-successful">5.1.3.5.1. HTTP status codes when the request is successful</a></li>
<li><a class="reference internal" href="#http-status-code-when-the-cause-of-request-failure-lies-at-client-side">5.1.3.5.2. HTTP status code when the cause of request failure lies at client side</a></li>
<li><a class="reference internal" href="#http-status-code-when-the-cause-of-request-failure-lies-at-server-side">5.1.3.5.3. HTTP status code when the cause of request failure lies at server side</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authentication-and-authorization">5.1.3.6. Authentication and Authorization</a></li>
<li><a class="reference internal" href="#conditional-update-control-of-resource">5.1.3.7. Conditional update control of resource</a></li>
<li><a class="reference internal" href="#conditional-acquisition-control-of-resource">5.1.3.8. Conditional acquisition control of resource</a></li>
<li><a class="reference internal" href="#cache-control-of-resource">5.1.3.9. Cache control of resource</a></li>
<li><a class="reference internal" href="#versioning">5.1.3.10. Versioning</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use">5.1.4. How to use</a><ul>
<li><a class="reference internal" href="#web-application-configuration">5.1.4.1. Web application configuration</a></li>
<li><a class="reference internal" href="#pom-xml-configuration">5.1.4.2. pom.xml configuration</a></li>
<li><a class="reference internal" href="#application-settings">5.1.4.3. Application settings</a><ul>
<li><a class="reference internal" href="#settings-for-activating-the-spring-mvc-components-necessary-for-restful-web-service">5.1.4.3.1. Settings for activating the Spring MVC components necessary for RESTful Web Service</a></li>
<li><a class="reference internal" href="#servlet-settings-for-restful-web-service">5.1.4.3.2. Servlet settings for RESTful Web Service</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rest-api-implementation">5.1.4.4. REST API implementation</a><ul>
<li><a class="reference internal" href="#creating-rest-api-packages">5.1.4.4.1. Creating REST API packages</a></li>
<li><a class="reference internal" href="#creating-resource-class">5.1.4.4.2. Creating Resource class</a></li>
<li><a class="reference internal" href="#creating-controller-class">5.1.4.4.3. Creating Controller class</a></li>
<li><a class="reference internal" href="#implementing-rest-api-that-fetches-collection-of-resources">5.1.4.4.4. Implementing REST API that fetches collection of resources</a></li>
<li><a class="reference internal" href="#implementing-rest-api-that-adds-a-resource-to-collection">5.1.4.4.5. Implementing REST API that adds a resource to collection</a></li>
<li><a class="reference internal" href="#implementing-rest-api-that-fetches-specified-resource">5.1.4.4.6. Implementing REST API that fetches specified resource</a></li>
<li><a class="reference internal" href="#implementing-rest-api-that-updates-specified-resource">5.1.4.4.7. Implementing REST API that updates specified resource</a></li>
<li><a class="reference internal" href="#implementing-rest-api-that-deletes-specified-resource">5.1.4.4.8. Implementing REST API that deletes specified resource</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-exception-handling">5.1.4.5. Implementing exception handling</a><ul>
<li><a class="reference internal" href="#implementation-to-output-error-information-in-response-body">5.1.4.5.1. Implementation to output error information in response Body</a></li>
<li><a class="reference internal" href="#implementing-input-error-exception-handling">5.1.4.5.2. Implementing input error exception handling</a></li>
<li><a class="reference internal" href="#implementing-exception-handling-for-resource-not-found-error">5.1.4.5.3. Implementing exception handling for “Resource not found” error</a></li>
<li><a class="reference internal" href="#implementing-exception-handling-for-business-errors">5.1.4.5.4. Implementing exception handling for business errors</a></li>
<li><a class="reference internal" href="#implementing-exception-handling-for-exclusive-errors">5.1.4.5.5. Implementing exception handling for exclusive errors</a></li>
<li><a class="reference internal" href="#implementing-exception-handling-for-system-errors">5.1.4.5.6. Implementing exception handling for system errors</a></li>
<li><a class="reference internal" href="#resolving-error-codes-and-messages-using-exceptioncoderesolver">5.1.4.5.7. Resolving error codes and messages using ExceptionCodeResolver</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-the-error-handling-notified-to-servlet-container">5.1.4.6. Implementing the error handling notified to Servlet Container</a><ul>
<li><a class="reference internal" href="#implementing-the-controller-that-sends-error-response">5.1.4.6.1. Implementing the Controller that sends error response</a></li>
<li><a class="reference internal" href="#creating-a-static-json-file-to-be-sent-as-response-when-a-fatal-error-occurs">5.1.4.6.2. Creating a static JSON file to be sent as response when a fatal error occurs</a></li>
<li><a class="reference internal" href="#settings-for-handling-an-error-that-is-notified-to-servlet-container">5.1.4.6.3. Settings for handling an error that is notified to Servlet Container</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-measures">5.1.4.7. Security measures</a><ul>
<li><a class="reference internal" href="#resthowtousesecurityauth">5.1.4.7.1. Authentication and Authorization</a></li>
<li><a class="reference internal" href="#csrf-measures">5.1.4.7.2. CSRF measures</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conditional-operations-for-resource">5.1.4.8. Conditional operations for resource</a></li>
<li><a class="reference internal" href="#cache-control-for-resource">5.1.4.9. Cache control for resource</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-extend">5.1.5. How to extend</a><ul>
<li><a class="reference internal" href="#output-control-for-response-using-jsonview">5.1.5.1. Output control for response using &#64;JsonView</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix">5.1.6. Appendix</a><ul>
<li><a class="reference internal" href="#configuration-while-using-jsr-310-date-and-time-api-joda-time">5.1.6.1. Configuration while using JSR-310 Date and Time API / Joda Time</a></li>
<li><a class="reference internal" href="#settings-when-restful-web-service-and-client-application-are-operated-as-the-same-web-application">5.1.6.2. Settings when RESTful Web Service and client application are operated as the same Web application</a><ul>
<li><a class="reference internal" href="#how-to-set-dispatcherservlet-for-restful-web-service">5.1.6.2.1. How to set <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> for RESTful Web Service</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-hypermedia-link">5.1.6.3. Implementing hypermedia link</a><ul>
<li><a class="reference internal" href="#implementing-common-parts">5.1.6.3.1. Implementing common parts</a></li>
<li><a class="reference internal" href="#implementation-for-each-resource">5.1.6.3.2. Implementation for each resource</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-restful-web-service-conforming-to-http-specifications">5.1.6.4. Creating RESTful Web Service conforming to HTTP specifications</a><ul>
<li><a class="reference internal" href="#settings-for-location-header-at-the-time-of-post">5.1.6.4.1. Settings for location header at the time of POST</a></li>
<li><a class="reference internal" href="#id3">5.1.6.4.2. Implementation for each resource</a></li>
</ul>
</li>
<li><a class="reference internal" href="#disabling-csrf-measures">5.1.6.5. Disabling CSRF measures</a></li>
<li><a class="reference internal" href="#enabling-xxe-injection-measures">5.1.6.6. Enabling XXE Injection measures</a></li>
<li><a class="reference internal" href="#how-to-copy-joda-time-classes-using-dozer">5.1.6.7. How to copy Joda-Time classes using Dozer</a></li>
<li><a class="reference internal" href="#source-code-for-application-layer">5.1.6.8. Source code for application layer</a><ul>
<li><a class="reference internal" href="#memberrestcontroller-java">5.1.6.8.1. MemberRestController.java</a></li>
<li><a class="reference internal" href="#apierrorcreator-java">5.1.6.8.2. ApiErrorCreator.java</a></li>
<li><a class="reference internal" href="#apiglobalexceptionhandler-java">5.1.6.8.3. ApiGlobalExceptionHandler.java</a></li>
</ul>
</li>
<li><a class="reference internal" href="#source-code-of-the-domain-layer-class-created-at-the-time-of-rest-api-implementation">5.1.6.9. Source code of the domain layer class created at the time of REST API implementation</a><ul>
<li><a class="reference internal" href="#member-java">5.1.6.9.1. Member.java</a></li>
<li><a class="reference internal" href="#membercredentia-java">5.1.6.9.2. MemberCredentia.java</a></li>
<li><a class="reference internal" href="#gender-java">5.1.6.9.3. Gender.java</a></li>
<li><a class="reference internal" href="#memberrepository-java">5.1.6.9.4. MemberRepository.java</a></li>
<li><a class="reference internal" href="#memberservice-java">5.1.6.9.5. MemberService.java</a></li>
<li><a class="reference internal" href="#memberserviceimpl-java">5.1.6.9.6. MemberServiceImpl.java</a></li>
<li><a class="reference internal" href="#domainmessagecodes-java">5.1.6.9.7. DomainMessageCodes.java</a></li>
<li><a class="reference internal" href="#gendertypehandler-java">5.1.6.9.8. GenderTypeHandler.java</a></li>
<li><a class="reference internal" href="#member-mapping-xml">5.1.6.9.9. member-mapping.xml</a></li>
<li><a class="reference internal" href="#mybatis-config-xml">5.1.6.9.10. mybatis-config.xml</a></li>
<li><a class="reference internal" href="#memberrepository-xml">5.1.6.9.11. MemberRepository.xml</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">5. Web Services</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="RestClient.html"
                        title="next chapter">5.2. REST Client (HTTP Client)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/ArchitectureInDetail/WebServiceDetail/REST.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="restful-web-service">
<h1>5.1. RESTful Web Service<a class="headerlink" href="#restful-web-service" title="Permalink to this headline">¶</a></h1>
<div class="admonition caution">
  <p class="first admonition-title">Caution</p>
  <p><strong>This version is already obsolete</strong>. Please check <a href="http://terasolunaorg.github.io/guideline/">the latest guideline</a>.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id5">Overview</a><ul>
<li><a class="reference internal" href="#what-is-restful-web-service" id="id6">What is RESTful Web Service</a></li>
<li><a class="reference internal" href="#restful-web-service-development" id="id7">RESTful Web Service development</a><ul>
<li><a class="reference internal" href="#configuration-for-restful-web-service-module" id="id8">Configuration for RESTful Web Service module</a></li>
<li><a class="reference internal" href="#rest-api-implementation-sample" id="id9">REST API implementation sample</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#architecture" id="id10">Architecture</a><ul>
<li><a class="reference internal" href="#publishing-as-a-resource-on-web" id="id11">Publishing as a resource on Web</a></li>
<li><a class="reference internal" href="#restoverviewassignuri" id="id12">Identifying the resource using URI</a></li>
<li><a class="reference internal" href="#resource-operations-using-http-methods" id="id13">Resource operations using HTTP methods</a></li>
<li><a class="reference internal" href="#using-an-appropriate-format" id="id14">Using an appropriate format</a></li>
<li><a class="reference internal" href="#using-the-appropriate-http-status-code" id="id15">Using the appropriate HTTP status code</a></li>
<li><a class="reference internal" href="#stateless-communication-between-client-and-server" id="id16">Stateless communication between client and server</a></li>
<li><a class="reference internal" href="#link-to-related-resource" id="id17">Link to related resource</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-design" id="id18">How to design</a><ul>
<li><a class="reference internal" href="#resource-extraction" id="id19">Resource extraction</a></li>
<li><a class="reference internal" href="#assigning-uri" id="id20">Assigning URI</a><ul>
<li><a class="reference internal" href="#assigning-a-uri-that-indicates-the-api-as-rest-api" id="id21">Assigning a URI that indicates the API as REST API</a></li>
<li><a class="reference internal" href="#assigning-a-uri-for-identifying-the-api-version" id="id22">Assigning a URI for identifying the API version</a></li>
<li><a class="reference internal" href="#assigning-a-path-for-identifying-resource" id="id23">Assigning a path for identifying resource</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assigning-http-methods" id="id24">Assigning HTTP methods</a><ul>
<li><a class="reference internal" href="#assigning-http-methods-for-resource-collection-uri" id="id25">Assigning HTTP methods for resource collection URI</a></li>
<li><a class="reference internal" href="#assigning-http-methods-for-uri-of-specific-resources" id="id26">Assigning HTTP methods for URI of specific resources</a></li>
</ul>
</li>
<li><a class="reference internal" href="#resource-format" id="id27">Resource format</a><ul>
<li><a class="reference internal" href="#json-field-name" id="id28">JSON Field name</a></li>
<li><a class="reference internal" href="#null-and-blank-characters" id="id29">NULL and blank characters</a></li>
<li><a class="reference internal" href="#date-format" id="id30">Date format</a></li>
<li><a class="reference internal" href="#hypermedia-link-format" id="id31">Hypermedia link format</a></li>
<li><a class="reference internal" href="#format-at-the-time-of-error-response" id="id32">Format at the time of error response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#http-status-code" id="id33">HTTP Status Code</a><ul>
<li><a class="reference internal" href="#http-status-codes-when-the-request-is-successful" id="id34">HTTP status codes when the request is successful</a></li>
<li><a class="reference internal" href="#http-status-code-when-the-cause-of-request-failure-lies-at-client-side" id="id35">HTTP status code when the cause of request failure lies at client side</a></li>
<li><a class="reference internal" href="#http-status-code-when-the-cause-of-request-failure-lies-at-server-side" id="id36">HTTP status code when the cause of request failure lies at server side</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authentication-and-authorization" id="id37">Authentication and Authorization</a></li>
<li><a class="reference internal" href="#conditional-update-control-of-resource" id="id38">Conditional update control of resource</a></li>
<li><a class="reference internal" href="#conditional-acquisition-control-of-resource" id="id39">Conditional acquisition control of resource</a></li>
<li><a class="reference internal" href="#cache-control-of-resource" id="id40">Cache control of resource</a></li>
<li><a class="reference internal" href="#versioning" id="id41">Versioning</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use" id="id42">How to use</a><ul>
<li><a class="reference internal" href="#web-application-configuration" id="id43">Web application configuration</a></li>
<li><a class="reference internal" href="#pom-xml-configuration" id="id44">pom.xml configuration</a></li>
<li><a class="reference internal" href="#application-settings" id="id45">Application settings</a><ul>
<li><a class="reference internal" href="#settings-for-activating-the-spring-mvc-components-necessary-for-restful-web-service" id="id46">Settings for activating the Spring MVC components necessary for RESTful Web Service</a></li>
<li><a class="reference internal" href="#servlet-settings-for-restful-web-service" id="id47">Servlet settings for RESTful Web Service</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rest-api-implementation" id="id48">REST API implementation</a><ul>
<li><a class="reference internal" href="#creating-rest-api-packages" id="id49">Creating REST API packages</a></li>
<li><a class="reference internal" href="#creating-resource-class" id="id50">Creating Resource class</a></li>
<li><a class="reference internal" href="#creating-controller-class" id="id51">Creating Controller class</a></li>
<li><a class="reference internal" href="#implementing-rest-api-that-fetches-collection-of-resources" id="id52">Implementing REST API that fetches collection of resources</a></li>
<li><a class="reference internal" href="#implementing-rest-api-that-adds-a-resource-to-collection" id="id53">Implementing REST API that adds a resource to collection</a></li>
<li><a class="reference internal" href="#implementing-rest-api-that-fetches-specified-resource" id="id54">Implementing REST API that fetches specified resource</a></li>
<li><a class="reference internal" href="#implementing-rest-api-that-updates-specified-resource" id="id55">Implementing REST API that updates specified resource</a></li>
<li><a class="reference internal" href="#implementing-rest-api-that-deletes-specified-resource" id="id56">Implementing REST API that deletes specified resource</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-exception-handling" id="id57">Implementing exception handling</a><ul>
<li><a class="reference internal" href="#implementation-to-output-error-information-in-response-body" id="id58">Implementation to output error information in response Body</a></li>
<li><a class="reference internal" href="#implementing-input-error-exception-handling" id="id59">Implementing input error exception handling</a></li>
<li><a class="reference internal" href="#implementing-exception-handling-for-resource-not-found-error" id="id60">Implementing exception handling for “Resource not found” error</a></li>
<li><a class="reference internal" href="#implementing-exception-handling-for-business-errors" id="id61">Implementing exception handling for business errors</a></li>
<li><a class="reference internal" href="#implementing-exception-handling-for-exclusive-errors" id="id62">Implementing exception handling for exclusive errors</a></li>
<li><a class="reference internal" href="#implementing-exception-handling-for-system-errors" id="id63">Implementing exception handling for system errors</a></li>
<li><a class="reference internal" href="#resolving-error-codes-and-messages-using-exceptioncoderesolver" id="id64">Resolving error codes and messages using ExceptionCodeResolver</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-the-error-handling-notified-to-servlet-container" id="id65">Implementing the error handling notified to Servlet Container</a><ul>
<li><a class="reference internal" href="#implementing-the-controller-that-sends-error-response" id="id66">Implementing the Controller that sends error response</a></li>
<li><a class="reference internal" href="#creating-a-static-json-file-to-be-sent-as-response-when-a-fatal-error-occurs" id="id67">Creating a static JSON file to be sent as response when a fatal error occurs</a></li>
<li><a class="reference internal" href="#settings-for-handling-an-error-that-is-notified-to-servlet-container" id="id68">Settings for handling an error that is notified to Servlet Container</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-measures" id="id69">Security measures</a><ul>
<li><a class="reference internal" href="#resthowtousesecurityauth" id="id70">Authentication and Authorization</a></li>
<li><a class="reference internal" href="#csrf-measures" id="id71">CSRF measures</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conditional-operations-for-resource" id="id72">Conditional operations for resource</a></li>
<li><a class="reference internal" href="#cache-control-for-resource" id="id73">Cache control for resource</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-extend" id="id74">How to extend</a><ul>
<li><a class="reference internal" href="#output-control-for-response-using-jsonview" id="id75">Output control for response using &#64;JsonView</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix" id="id76">Appendix</a><ul>
<li><a class="reference internal" href="#configuration-while-using-jsr-310-date-and-time-api-joda-time" id="id77">Configuration while using JSR-310 Date and Time API / Joda Time</a></li>
<li><a class="reference internal" href="#settings-when-restful-web-service-and-client-application-are-operated-as-the-same-web-application" id="id78">Settings when RESTful Web Service and client application are operated as the same Web application</a><ul>
<li><a class="reference internal" href="#how-to-set-dispatcherservlet-for-restful-web-service" id="id79">How to set <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> for RESTful Web Service</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-hypermedia-link" id="id80">Implementing hypermedia link</a><ul>
<li><a class="reference internal" href="#implementing-common-parts" id="id81">Implementing common parts</a></li>
<li><a class="reference internal" href="#implementation-for-each-resource" id="id82">Implementation for each resource</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-restful-web-service-conforming-to-http-specifications" id="id83">Creating RESTful Web Service conforming to HTTP specifications</a><ul>
<li><a class="reference internal" href="#settings-for-location-header-at-the-time-of-post" id="id84">Settings for location header at the time of POST</a></li>
<li><a class="reference internal" href="#id3" id="id85">Implementation for each resource</a></li>
</ul>
</li>
<li><a class="reference internal" href="#disabling-csrf-measures" id="id86">Disabling CSRF measures</a></li>
<li><a class="reference internal" href="#enabling-xxe-injection-measures" id="id87">Enabling XXE Injection measures</a></li>
<li><a class="reference internal" href="#how-to-copy-joda-time-classes-using-dozer" id="id88">How to copy Joda-Time classes using Dozer</a></li>
<li><a class="reference internal" href="#source-code-for-application-layer" id="id89">Source code for application layer</a><ul>
<li><a class="reference internal" href="#memberrestcontroller-java" id="id90">MemberRestController.java</a></li>
<li><a class="reference internal" href="#apierrorcreator-java" id="id91">ApiErrorCreator.java</a></li>
<li><a class="reference internal" href="#apiglobalexceptionhandler-java" id="id92">ApiGlobalExceptionHandler.java</a></li>
</ul>
</li>
<li><a class="reference internal" href="#source-code-of-the-domain-layer-class-created-at-the-time-of-rest-api-implementation" id="id93">Source code of the domain layer class created at the time of REST API implementation</a><ul>
<li><a class="reference internal" href="#member-java" id="id94">Member.java</a></li>
<li><a class="reference internal" href="#membercredentia-java" id="id95">MemberCredentia.java</a></li>
<li><a class="reference internal" href="#gender-java" id="id96">Gender.java</a></li>
<li><a class="reference internal" href="#memberrepository-java" id="id97">MemberRepository.java</a></li>
<li><a class="reference internal" href="#memberservice-java" id="id98">MemberService.java</a></li>
<li><a class="reference internal" href="#memberserviceimpl-java" id="id99">MemberServiceImpl.java</a></li>
<li><a class="reference internal" href="#domainmessagecodes-java" id="id100">DomainMessageCodes.java</a></li>
<li><a class="reference internal" href="#gendertypehandler-java" id="id101">GenderTypeHandler.java</a></li>
<li><a class="reference internal" href="#member-mapping-xml" id="id102">member-mapping.xml</a></li>
<li><a class="reference internal" href="#mybatis-config-xml" id="id103">mybatis-config.xml</a></li>
<li><a class="reference internal" href="#memberrepository-xml" id="id104">MemberRepository.xml</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<span id="restoverview"></span><h2><a class="toc-backref" href="#id5">5.1.1. Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This section explains the basic concept of RESTful Web Service and its development by using Spring MVC.</p>
<p>Refer to the following for basic description of architecture, design and implementation of RESTful Web Service</p>
<ul>
<li><div class="first line-block">
<div class="line">“<a class="reference internal" href="#restaboutresourceorientedarchitecture"><span class="std std-ref">Architecture</span></a>”</div>
<div class="line">Basic architecture of RESTful Web Service is explained.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">“<a class="reference internal" href="#resthowtodesign"><span class="std std-ref">How to design</span></a>”</div>
<div class="line">Points to be considered while designing a RESTful Web Service are explained.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">“<a class="reference internal" href="#resthowtouse"><span class="std std-ref">How to use</span></a>”</div>
<div class="line">Application structure of RESTful Web Service and API implementation methods are explained.</div>
</div>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="what-is-restful-web-service">
<span id="restoverviewaboutrestfulwebservice"></span><h3><a class="toc-backref" href="#id6">5.1.1.1. What is RESTful Web Service</a><a class="headerlink" href="#what-is-restful-web-service" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">REST is an abbreviation of “<strong>RE</strong>presentational <strong>S</strong>tate <strong>T</strong>ransfer”, and is one of the <strong>architecture styles</strong></div>
<div class="line">for building an application, wherein data is exchanged between client and server.</div>
<div class="line">REST architecture style consists of various important fundamental rules and the services which are in accordance with these rules (system etc.) are expressed as <strong>RESTful</strong>.</div>
<div class="line">In other words, “RESTful Web Service” is a Web service that is built in accordance with the fundamental rules of REST.</div>
</div>
<div class="line-block">
<div class="line"><strong>The concept of “resource” is of prime importance in RESTful Web Service.</strong></div>
<div class="line">In RESTful Web Service, the information that should be provided to the client is extracted as “resource”, from the information stored in database etc. and the CRUD operation for this extracted “resource” is provided to the client using HTTP methods (POST/GET/PUT/DELETE).</div>
<div class="line">The CRUD operation for “resource” is called “REST API” or “RESTful API” and is mentioned as “REST API” in this guideline.</div>
<div class="line">Further, JSON or XML that have higher message visibility and data structure expressivity, are used as the message formats while exchanging resources between client and server.</div>
</div>
<div class="line-block">
<div class="line">System configuration of the application that uses RESTful Web Service mainly consists of following 2 patterns.</div>
<div class="line">The basic architecture for exchanging resources between client and server is explained by using “<a class="reference internal" href="#restaboutresourceorientedarchitecture"><span class="std std-ref">Architecture</span></a>”.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../../_images/RESTExampleSystemConstitution.png"><img alt="Constitution of RESTful Web Service" src="../../_images/RESTExampleSystemConstitution.png" style="width: 100%;" /></a>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A resource is directly exchanged between client application with user interface and RESTful Web Service.</div>
<div class="line">This pattern is used to separate user interface dependent logic with higher number of requirement &amp; specification changes and the logic for a data model which is more universal with less number of changes.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Rather than directly exchanging the resource with client applications having user interface, the resource is exchanged between systems.</div>
<div class="line">This pattern is used while building a system wherein, the business data stored by each system is managed centrally.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="restful-web-service-development">
<span id="restoverviewaboutrestfulwebservicedevelopment"></span><h3><a class="toc-backref" href="#id7">5.1.1.2. RESTful Web Service development</a><a class="headerlink" href="#restful-web-service-development" title="Permalink to this headline">¶</a></h3>
<p>RESTful Web Service is developed in TERASOLUNA Server Framework for Java (5.x) using Spring MVC functionalities.</p>
<div class="line-block">
<div class="line">The common functionalities necessary for RESTful Web Service development are built in Spring MVC by default.</div>
<div class="line">As a result, RESTful Web Service development can be initiated without adding any specific settings or implementations.</div>
</div>
<div class="line-block">
<div class="line">Main common functionalities built in Spring MVC by default, are given below.</div>
<div class="line">These functionalities can only be enabled by specifying annotations in the methods of the Controller that provides REST API.</div>
</div>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Function overview</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is a function which converts the JSON or XML format message set in request BODY, to Resource object (JavaBean) and delivers it to the Controller class method (REST API).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is a function which implements input validation for the value stored in Resource object (JavaBean) that has been converted from message.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is a function which converts Resource object (JavaBean) returned from the Controller class method (REST API) to JSON or XML format and sets it in response BODY.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Exception handling</strong></p>
<p class="last">It is necessary to implement exception handling for each project since a generic functionality for the same is not provided by Spring MVC.
For details on exception handling, refer to “<a class="reference internal" href="#resthowtouseexceptionhandling"><span class="std std-ref">Implementing exception handling</span></a>”.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">When RESTful Web Service is developed using Spring MVC, the application is configured as given below. Among these, implementation is necessary for the portion marked with red frame.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../../_images/RESTOverviewApplicationConstitutionOnSpringMVC.png"><img alt="Application constitution of RESTful Web Service on Spring MVC" src="../../_images/RESTOverviewApplicationConstitutionOnSpringMVC.png" style="width: 100%;" /></a>
</div>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Process layer</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC</div>
<div class="line">(Framework)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC receives a request from client and determines the REST API (handler method of Controller) to be called.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC converts the JSON format message specified in request BODY to Resource object by using <code class="docutils literal"><span class="pre">HttpMessageConverter</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC performs input validation for the value stored in Resource object using <code class="docutils literal"><span class="pre">Validator</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC calls REST API.</div>
<div class="line">Here, the Resource that has been converted from JSON and for which input validation is carried out, is delivered to REST API.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">REST API</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">REST API calls Service method and performs the process for DomainObject such as Entity etc.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Service method calls the Repository method and performs CRUD process for the DomainObject such as Entity etc.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC</div>
<div class="line">(Framework)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC converts the Resource object returned from REST API to JSON format message, by using <code class="docutils literal"><span class="pre">HttpMessageConverter</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(8)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC sets JSON format message in response BODY and responds to client.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="configuration-for-restful-web-service-module">
<h4><a class="toc-backref" href="#id8">5.1.1.2.1. Configuration for RESTful Web Service module</a><a class="headerlink" href="#configuration-for-restful-web-service-module" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">A lot of RESTful Web Service specific processing can be entrusted to Spring MVC by using the functionalities provided by the framework.</div>
<div class="line">Therefore, configuration of the module to be developed is almost same as the development of conventional Web application that responds with HTML.</div>
<div class="line">Configuration elements of the module are explained below.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../../_images/RESTModuleConstitution.png"><img alt="Constitution of Modules" src="../../_images/RESTModuleConstitution.png" style="width: 100%;" /></a>
</div>
</div></blockquote>
<ul>
<li><p class="first"><strong>Module for application layer</strong></p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Module name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Controller class</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A class that provides REST API.</div>
<div class="line">Controller class is created by resource unit and specifies end points (URI) of REST API for each resource.</div>
<div class="line">CRUD process for the resource is implemented by delegating it to the Service of domain layer.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Resource class</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Java Bean representing JSON (or XML) that acts as I/O for REST API.</div>
<div class="line">Annotation for Bean Validation and annotation for controlling JSON or XML format are specified in this class.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Validator Class</div>
<div class="line">(Optional)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Class that implements correlation validation for input value.</div>
<div class="line">If the correlation validation for input value is unnecessary, this class need not be created. Hence, it is considered as optional.</div>
<div class="line">For input value correlation validation, refer to “<a class="reference internal" href="../WebApplicationDetail/Validation.html"><span class="doc">Input Validation</span></a>”.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Helper Class</div>
<div class="line">(Optional)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Class which implements the process that assists the process to be performed by the Controller.</div>
<div class="line">This class is created with the aim of simplifying the Controller processing.</div>
<div class="line">Basically, it implements a method that performs conversion of Resource object and DomainObject models.</div>
<div class="line">If the model can be converted simply by using copy of the value, “<a class="reference internal" href="../GeneralFuncDetail/Dozer.html"><span class="doc">Bean Mapping (Dozer)</span></a>” may be used without creating the Helper class. Hence, it is considered as optional.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first"><strong>Domain layer module</strong></p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The description is beyond the scope of this section since the module implemented in the domain layer is independent of application type.</div>
<div class="line">For role of each module, refer to “<a class="reference internal" href="../../Overview/ApplicationLayering.html"><span class="doc">Application Layering</span></a>” and for domain layer development, refer to “<a class="reference internal" href="../../ImplementationAtEachLayer/DomainLayer.html"><span class="doc">Domain Layer Implementation</span></a>”.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first"><strong>Infrastructure layer module</strong></p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The description is beyond the scope of this section since the module implemented in the infrastructure layer is independent of application type.</div>
<div class="line">Refer to “<a class="reference internal" href="../../Overview/ApplicationLayering.html"><span class="doc">Application Layering</span></a>” for role of each module and “<a class="reference internal" href="../../ImplementationAtEachLayer/InfrastructureLayer.html"><span class="doc">Implementation of Infrastructure Layer</span></a>” for development of infrastructure layer.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="rest-api-implementation-sample">
<h4><a class="toc-backref" href="#id9">5.1.1.2.2. REST API implementation sample</a><a class="headerlink" href="#rest-api-implementation-sample" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Before giving a detailed explanation, an implementation sample of Resource class and Controller class is given below to let one understand the kind of class created in the application layer.</div>
<div class="line">The implementation sample given below is the REST API of Todo resource which is the topic of <a class="reference internal" href="../../Tutorial/TutorialREST.html"><span class="doc">Tutorial (Todo Application REST)</span></a>.</div>
</div>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>It is strongly recommended to practice **:doc:`../../Tutorial/TutorialREST`** first, before reading the detailed explanation.</strong></p>
<p>Aim of the tutorial is to emphasize the saying “Practice makes one perfect”. Prior to detailed explanation, the user can gain the experience of actually practicing RESTful Web Service development using TERASOLUNA Server Framework for Java (5.x), with the help of this tutorial.
When this firsthand experience of RESTful Web Service development is followed by reading the detailed explanation, the user gains a deeper understanding of the development.</p>
<p class="last">Especially when the user does not have any experience of RESTful Web Service development, it is recommended to follow a process in the order namely,  “Tutorial practice” –&gt; “Detailed explanation of architecture, design and development (described in subsequent sections)” –&gt; “Tutorial revision (Re-practice)”.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Resources handled in implementation sample</li>
</ul>
<blockquote>
<div><p>Resources handled in the implementation sample (Todo resources) are set in following JSON format.</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;todoId&quot;</span> <span class="p">:</span> <span class="s2">&quot;9aef3ee3-30d4-4a7c-be4a-bc184ca1d558&quot;</span><span class="p">,</span>
    <span class="nt">&quot;todoTitle&quot;</span> <span class="p">:</span> <span class="s2">&quot;Hello World!&quot;</span><span class="p">,</span>
    <span class="nt">&quot;finished&quot;</span> <span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">&quot;createdAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-02-25T02:21:48.493+0000&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Resource class implementation sample</li>
</ul>
<blockquote>
<div><p>Resource class is created as the JavaBean representing the Todo resources shown above.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">todo.api.todo</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TodoResource</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">todoId</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">todoTitle</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">finished</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">Date</span> <span class="n">createdAt</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTodoId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">todoId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTodoId</span><span class="p">(</span><span class="n">String</span> <span class="n">todoId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">todoId</span> <span class="o">=</span> <span class="n">todoId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTodoTitle</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">todoTitle</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTodoTitle</span><span class="p">(</span><span class="n">String</span> <span class="n">todoTitle</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">todoTitle</span> <span class="o">=</span> <span class="n">todoTitle</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isFinished</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">finished</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setFinished</span><span class="p">(</span><span class="kt">boolean</span> <span class="n">finished</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">finished</span> <span class="o">=</span> <span class="n">finished</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Date</span> <span class="nf">getCreatedAt</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">createdAt</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setCreatedAt</span><span class="p">(</span><span class="n">Date</span> <span class="n">createdAt</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">createdAt</span> <span class="o">=</span> <span class="n">createdAt</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Implementation sample for Controller class (REST API)</li>
</ul>
<blockquote>
<div><p>Following five REST APIs (Controller handler methods) are created for Todo resource.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="15%" />
<col width="10%" />
<col width="30%" />
<col width="15%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">API Name</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">HTTP</div>
<div class="line">Method</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Path</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Status</div>
<div class="line">Code</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">GET Todos</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">GET</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">/api/v1/todos</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">200</div>
<div class="line">(OK)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">All Todo resources are fetched.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">POST Todos</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">POST</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">/api/v1/todos</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">201</div>
<div class="line">(Created)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A new Todo resource is created.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">GET Todo</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">GET</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">/api/v1/todos/{todoId}</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">200</div>
<div class="line">(OK)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">One Todo resource is fetched.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">PUT Todo</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">PUT</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">/api/v1/todos/{todoId}</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">200</div>
<div class="line">(OK)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Todo resource is updated to “completed”.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">DELETE Todo</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">DELETE</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">/api/v1/todos/{todoId}</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">204</div>
<div class="line">(No Content)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Todo resource is deleted.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">todo.api.todo</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collection</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.dozer.Mapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.HttpStatus</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.PathVariable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestBody</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ResponseStatus</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">todo.domain.model.Todo</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">todo.domain.service.todo.TodoService</span><span class="p">;</span>

<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;todos&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TodoRestController</span> <span class="p">{</span>
    <span class="nd">@Inject</span>
    <span class="n">TodoService</span> <span class="n">todoService</span><span class="p">;</span>
    <span class="nd">@Inject</span>
<span class="hll">    <span class="n">Mapper</span> <span class="n">beanMapper</span><span class="p">;</span>
</span><span class="hll">
</span><span class="hll">    <span class="c1">// (1)</span>
</span><span class="hll">    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>
</span><span class="hll">
</span>    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">TodoResource</span><span class="o">&gt;</span> <span class="nf">getTodos</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Todo</span><span class="o">&gt;</span> <span class="n">todos</span> <span class="o">=</span> <span class="n">todoService</span><span class="p">.</span><span class="na">findAll</span><span class="p">();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">TodoResource</span><span class="o">&gt;</span> <span class="n">todoResources</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Todo</span> <span class="n">todo</span> <span class="p">:</span> <span class="n">todos</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">todoResources</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">todo</span><span class="p">,</span> <span class="n">TodoResource</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
        <span class="p">}</span>
<span class="hll">        <span class="k">return</span> <span class="n">todoResources</span><span class="p">;</span>
</span><span class="hll">    <span class="p">}</span>
</span><span class="hll">
</span><span class="hll">    <span class="c1">// (2)</span>
</span>    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">)</span>

    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">CREATED</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">TodoResource</span> <span class="nf">postTodos</span><span class="p">(</span><span class="nd">@RequestBody</span> <span class="nd">@Validated</span> <span class="n">TodoResource</span> <span class="n">todoResource</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Todo</span> <span class="n">createdTodo</span> <span class="o">=</span> <span class="n">todoService</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">todoResource</span><span class="p">,</span> <span class="n">Todo</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
<span class="hll">        <span class="n">TodoResource</span> <span class="n">createdTodoResponse</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">createdTodo</span><span class="p">,</span> <span class="n">TodoResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">createdTodoResponse</span><span class="p">;</span>
</span><span class="hll">    <span class="p">}</span>
</span><span class="hll">
</span><span class="hll">    <span class="c1">// (3)</span>
</span>    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s">&quot;{todoId}&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>

    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
<span class="hll">    <span class="kd">public</span> <span class="n">TodoResource</span> <span class="nf">getTodo</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&quot;todoId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">todoId</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">        <span class="n">Todo</span> <span class="n">todo</span> <span class="o">=</span> <span class="n">todoService</span><span class="p">.</span><span class="na">findOne</span><span class="p">(</span><span class="n">todoId</span><span class="p">);</span>
</span><span class="hll">        <span class="n">TodoResource</span> <span class="n">todoResource</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">todo</span><span class="p">,</span> <span class="n">TodoResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">todoResource</span><span class="p">;</span>
</span><span class="hll">    <span class="p">}</span>
</span>
    <span class="c1">// (4)</span>
    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s">&quot;{todoId}&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">PUT</span><span class="p">)</span>

<span class="hll">    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
</span><span class="hll">    <span class="kd">public</span> <span class="n">TodoResource</span> <span class="nf">putTodo</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&quot;todoId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">todoId</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">        <span class="n">Todo</span> <span class="n">finishedTodo</span> <span class="o">=</span> <span class="n">todoService</span><span class="p">.</span><span class="na">finish</span><span class="p">(</span><span class="n">todoId</span><span class="p">);</span>
</span><span class="hll">        <span class="n">TodoResource</span> <span class="n">finishedTodoResource</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">finishedTodo</span><span class="p">,</span> <span class="n">TodoResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">finishedTodoResource</span><span class="p">;</span>
</span>    <span class="p">}</span>

    <span class="c1">// (5)</span>
    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s">&quot;{todoId}&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">DELETE</span><span class="p">)</span>

    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">NO_CONTENT</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteTodo</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&quot;todoId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">todoId</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">todoService</span><span class="p">.</span><span class="na">delete</span><span class="p">(</span><span class="n">todoId</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="architecture">
<span id="restaboutresourceorientedarchitecture"></span><h2><a class="toc-backref" href="#id10">5.1.2. Architecture</a><a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">This section explains the architecture for building a RESTful Web Service.</div>
</div>
<div class="line-block">
<div class="line">Resource Oriented Architecture (ROA) is used as the architecture for building RESTful Web Service.</div>
<div class="line">ROA is an abbreviation of “<strong>R</strong>esource <strong>O</strong>riented <strong>A</strong>rchitecture” and defines <strong>the basic architecture for building a Web Service in accordance with REST architecture style (rules)</strong>.</div>
<div class="line">It is important to thoroughly understand ROA architecture when creating RESTful Web Service.</div>
</div>
<div class="line-block">
<div class="line">This section explains following 7 elements of ROA architecture.</div>
<div class="line">These form important architectural elements for building RESTful Web Service. However, it is not always necessary to apply all of these elements.</div>
<div class="line">Necessary elements should be applied after considering the characteristics of the application to be developed.</div>
</div>
<p>Following five architectural elements must be applied regardless of the application characteristics.</p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="35%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Architecture</th>
<th class="head">Architecture overview</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restoverviewprovideresourceonweb"><span class="std std-ref">Publishing as a resource on Web</span></a></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is published as a Web resource through which information stored in the system is provided to the client.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restoverviewassignuri"><span class="std std-ref">Identifying the resource using URI</span></a></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">URI (Universal Resource Identifier) that can uniquely identify a Web resource is assigned to the resource published to the client.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restoverviewoperatedbyhttpmethod"><span class="std std-ref">Resource operations using HTTP methods</span></a></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Resource related operations are implemented by using different HTTP methods (GET, POST, PUT and DELETE).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restoverviewresourcerepresentationformat"><span class="std std-ref">Using an appropriate format</span></a></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JSON or XML that represents the data structure, is used as resource format.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restoverviewhttpstatuscode"><span class="std std-ref">Using the appropriate HTTP status code</span></a></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Appropriate HTTP status code is set in the response returned to the client.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Following two architectural elements are applied depending on the characteristics of an application.</p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="35%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Architecture</th>
<th class="head">Architectural elements</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restoverviewclientservercommunicateonstateless"><span class="std std-ref">Stateless communication between client and server</span></a></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">This element enables to perform the process only by the information requested from client, without retaining the application status on the server.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restoverviewhypermedialinkstorelatedresources"><span class="std std-ref">Link to related resource</span></a></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It includes links to other resources (URI) inside a resource that are related to the specified resource.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="publishing-as-a-resource-on-web">
<span id="restoverviewprovideresourceonweb"></span><h3><a class="toc-backref" href="#id11">5.1.2.1. Publishing as a resource on Web</a><a class="headerlink" href="#publishing-as-a-resource-on-web" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><strong>It is published as a resource on Web as the means to provide information stored in the system to client.</strong></div>
<div class="line">It signifies that resources can be accessed using HTTP protocol and URI is used as a method to identify resources.</div>
</div>
<p>For example, following information is published on the Web as resource, for a Web system providing shopping site.</p>
<ul class="simple">
<li>Product information</li>
<li>Stock information</li>
<li>Order information</li>
<li>Member information</li>
<li>Authentication information for each member (Login ID and password etc.)</li>
<li>Order history information for each member</li>
<li>Authentication history information for each member</li>
<li>and more …</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="restoverviewassignuri">
<span id="identifying-the-resource-using-uri"></span><h3><a class="toc-backref" href="#id12">5.1.2.2. Identifying the resource using URI</a><a class="headerlink" href="#restoverviewassignuri" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><strong>URI (Universal Resource Identifier) that can uniquely identify a resource on the Web, is assigned to the resource to be published to the client.</strong></div>
<div class="line">URL (Uniform Resource Locator), which is a subset of the URI, is actually used.</div>
</div>
<div class="line-block">
<div class="line">In ROA, the ability to access a resource on the Web using URI, is called as “Addressability”.</div>
<div class="line">It signifies that on using the same URI, the same resource can be accessed from anywhere.</div>
</div>
<div class="line-block">
<div class="line">URI assigned to RESTful Web Service is a combination of “<strong>a noun that indicates the type of resource</strong>” and “<strong>a value (ID etc.) that uniquely identifies a resource</strong>”.</div>
<div class="line">For example, URI of product information handled by a Web system that provides a shopping site, is given below.</div>
</div>
<ul>
<li><div class="first line-block">
<div class="line"><cite>http://example.com/api/v1/items</cite></div>
<div class="line">“<strong>items</strong>” portion is the “noun that represents the type of resource”. If there are multiple resources, a plural noun is used.</div>
<div class="line">In the above example, a plural noun is specified to indicate the product information. It forms the URI for batch operation of product information. If replaced to a file system, it corresponds to a directory.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><cite>http://example.com/api/v1/items/I312-535-01216</cite></div>
<div class="line">The part “<strong>I312-535-01216</strong>” in the above URI, represents “the value that identifies the resource” and varies for each resource.</div>
<div class="line">In the above example, product ID is specified as the value for uniquely identifying product information. It acts as the URI used to handle specific product information. If replaced by a file system, it corresponds to the files stored in a directory.</div>
</div>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>Verbs that indicate operations cannot be included</strong> in the URI assigned to RESTful Web Service are as shown below.</p>
<blockquote class="last">
<div><ul class="simple">
<li><cite>http://example.com/api/v1/items?get&amp;itemId=I312-535-01216</cite></li>
<li><cite>http://example.com/api/v1/items?delete&amp;itemId=I312-535-01216</cite></li>
</ul>
<p>URI mentioned in the above example is not suitable to be assigned to RESTful Web Service since it includes verbs like <strong>get</strong> or <strong>delete</strong>.</p>
<p>In RESTful Web Service, <strong>Resource related operations are represented by using HTTP methods (GET, POST, PUT and DELETE).</strong></p>
</div></blockquote>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="resource-operations-using-http-methods">
<span id="restoverviewoperatedbyhttpmethod"></span><h3><a class="toc-backref" href="#id13">5.1.2.3. Resource operations using HTTP methods</a><a class="headerlink" href="#resource-operations-using-http-methods" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><strong>Resource operations can be performed by using HTTP methods (GET, POST, PUT, DELETE).</strong></div>
</div>
<div class="line-block">
<div class="line">In ROA, HTTP methods are called as “Unified interface”.</div>
<div class="line">It implies that HTTP methods can be executed for all the resources published on the Web and that the meaning of HTTP method does not change with each resource.</div>
</div>
<p>The association of resource operations, assigned to HTTP methods and the post-conditions ensured by each operation, are explained below.</p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="35%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">HTTP method</th>
<th class="head">Resource operations</th>
<th class="head">Post-conditions that the operation should ensure</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">GET</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Resource is fetched.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Safety, idempotency.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">POST</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Resource is created.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Server assigns the URI for created resource, this assigned URI is set to Location header of response and is returned to client.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">PUT</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Resource is created or updated.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Idempotency.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">PATCH</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Resource difference is updated.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Idempotency.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">DELETE</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Resource is deleted.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Idempotency.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HEAD</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Meta information of resource is fetched.</div>
<div class="line">Same process as GET is performed and responds with header only.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Safety, Idempotency.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(8)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OPTIONS</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Responds with a list of HTTP methods that can be used for resources.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Safety, idempotency.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Ensuring safety and idempotency</strong></p>
<p>When resource operation is performed using HTTP method, it is necessary to ensure “safety” and “idempotency” as post conditions.</p>
<p><strong>[Safety]</strong></p>
<blockquote>
<div>It ensures that even if a particular value is multiplied several times by 1, the value does not change. (for example, if 10 is multiplied several times by 1, result remains 10).
This guarantees that even if an operation is carried out for several times, resource status does not change.</div></blockquote>
<p><strong>[Idempotency]</strong></p>
<blockquote class="last">
<div>It ensures that even if a value is multiplied a number of times by 0, the value remains 0 (for example, if 10 is multiplied a number of times or just once by 0, the result remains 0).
This signifies that once an operation is performed, resource status does not change even if the same operation is performed later for a number of times.
However, when another client is modifying the status of the same resource, idempotency need not be ensured and can be handled as a precondition error.</div></blockquote>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>When client specifies the URI assigned to a resource for creating a resource</strong></p>
<p>To create a resource, when the URI to be assigned to the resource is specified by client, <strong>PUT method is called for the URI assigned to the resource to be created.</strong></p>
<p>When creating a resource using PUT method, the general operation is to,</p>
<blockquote>
<div><ul class="simple">
<li>Create a resource when no resource exists in the specified URI</li>
<li>Modify resource status when a resource already exists</li>
</ul>
</div></blockquote>
<p>Following is the difference in process images while creating a resource using PUT and POST methods.</p>
<p><strong>[Process image while creating a resource using PUT method]</strong></p>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../../_images/RESTCreatedNewResourceUsingByPutMethod.png"><img alt="Image of processing for creating new resource using by PUT method" src="../../_images/RESTCreatedNewResourceUsingByPutMethod.png" style="width: 70%;" /></a>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">PUT method is called by specifying URI (ID) of the resource to be created in URI.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Entity is created for the ID specified in URI.</div>
<div class="line">If the entity has already been created with same ID, the contents are updated.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Created or updated resource is sent as a response.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p><strong>[Process image while creating a resource using POST method]</strong></p>
<blockquote class="last">
<div><div class="figure">
<a class="reference internal image-reference" href="../../_images/RESTCreatedNewResourceUsingByPostMethod.png"><img alt="Image of processing for create new resource using by POST method" src="../../_images/RESTCreatedNewResourceUsingByPostMethod.png" style="width: 70%;" /></a>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">POST method is called.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">ID that identifies the requested resource is generated.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Entity for the ID generated in (2) is created.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Created resource is sent as a response.</div>
<div class="line">URI for accessing the generated resource is set in the Location header of response.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="using-an-appropriate-format">
<span id="restoverviewresourcerepresentationformat"></span><h3><a class="toc-backref" href="#id14">5.1.2.4. Using an appropriate format</a><a class="headerlink" href="#using-an-appropriate-format" title="Permalink to this headline">¶</a></h3>
<p><strong>JSON or XML that indicate data structure, are used for resource format.</strong></p>
<div class="line-block">
<div class="line">However, formats other than JSON or XML can also be used depending on the type of resource.</div>
<div class="line">For example, a resource classified as statistical information can be published with line graph represented in image format (Binary data).</div>
</div>
<div class="line-block">
<div class="line">When multiple formats are supported as resource formats, any of the following methods is used to change the format.</div>
</div>
<ul>
<li><p class="first"><strong>Changing the format using an extension.</strong></p>
<div class="line-block">
<div class="line">Response format can be changed by specifying the extension.</div>
<div class="line"><strong>This guideline recommends changing the format using extension.</strong></div>
<div class="line">The reasons for recommending this format are, responding format can be easily specified and as the responding format is included in URI, it results in an intuitive URI.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Examples of URI where format is changed using extension</strong></p>
<ul class="last simple">
<li><cite>http://example.com/api/v1/items.json</cite></li>
<li><cite>http://example.com/api/v1/items.xml</cite></li>
<li><cite>http://example.com/api/v1/items/I312-535-01216.json</cite></li>
<li><cite>http://example.com/api/v1/items/I312-535-01216.xml</cite></li>
</ul>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first"><strong>Changing format by using the MIME type in Accept header of request.</strong></p>
<p>A typical MIME type used in RESTful Web Service is shown below.</p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="30%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Format</th>
<th class="head">MIME type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JSON</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">application/json</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">XML</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">application/xml</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="using-the-appropriate-http-status-code">
<span id="restoverviewhttpstatuscode"></span><h3><a class="toc-backref" href="#id15">5.1.2.5. Using the appropriate HTTP status code</a><a class="headerlink" href="#using-the-appropriate-http-status-code" title="Permalink to this headline">¶</a></h3>
<p><strong>Appropriate HTTP status code is set in the response to be returned to the client.</strong></p>
<div class="line-block">
<div class="line">Value indicating the method by which server has processed the request received from the client, is set in HTTP status code.</div>
<div class="line"><strong>This is an HTTP specification and it is recommended to conform to the HTTP specifications wherever possible.</strong></div>
</div>
<blockquote>
<div><div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>HTTP Specifications</strong></p>
<p class="last">Refer to <a class="reference external" href="https://tools.ietf.org/html/rfc7230#section-3.1.2">RFC 7230 (Hypertext Transfer Protocol – HTTP/1.1) - 3.1.2 Status Line</a>.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">In a traditional Web system wherein HTML is returned in the browser, regardless of the process results, it was common that <code class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></code> was returned as the response and process results were displayed in entity body (HTML),</div>
<div class="line">In a traditional Web application that returns HTML, there were no issues since an operator (human) determined the process results.</div>
<div class="line">However, if this structure is used to build a RESTful Web Service, following issues may exist potentially. Hence, it is recommended to set appropriate status codes.</div>
</div>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Potential issues</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Even in cases where only the process result (success and failure) is to be determined, unnecessary process has to be performed, as analysis process is mandatory for entity body.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Since it is mandatory to be aware of the unique error codes defined in the system while handling errors, it may adversely affect the architecture (design and implementation) at the client side.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Intuitive error analysis may be obstructed when analyzing error causes at client side, since understanding the meaning of unique error codes defined in the system is required for the same.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In RFC 7230 which specifies HTTP message syntax, output of description clauses of HTTP status code (<code class="docutils literal"><span class="pre">reason-phrase</span></code>) is not mandatory and it is prescribed that the client should be ignored.</p>
<p>For example, description clauses are not output in Tomcat 8.5 of implementation which is in conformance with RFC 7230.</p>
<p class="last">Refer to <a class="reference external" href="https://tools.ietf.org/html/rfc7230#section-3.1.2">RFC 7230(Hypertext Transfer Protocol – HTTP/1.1) - 3.1.2 Status Line</a>.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="stateless-communication-between-client-and-server">
<span id="restoverviewclientservercommunicateonstateless"></span><h3><a class="toc-backref" href="#id16">5.1.2.6. Stateless communication between client and server</a><a class="headerlink" href="#stateless-communication-between-client-and-server" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><strong>In this communication, only the information requested by the client is processed, without retaining the application status on the server.</strong></div>
</div>
<div class="line-block">
<div class="line">In ROA, a state wherein application status is not retained on the server, is called “stateless”.</div>
<div class="line">It signifies that application status is not retained in application server memory (HTTP session etc.) and resource related operations can be completed only by using the requested information.</div>
<div class="line">In this guideline, <strong>it is recommended to retain “stateless” state wherever possible.</strong></div>
</div>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Application status</strong></p>
<p class="last">Web page transition status, selection status for input value, pull down/checkbox/radio buttons and authentication status etc. are included in application status.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Relation with CSRF measures</strong></p>
<p>Please note that the “Stateless” state between client and server cannot be retained when the CSRF measures described in this guideline are implemented for RESTful Web Service as, the token values for CRSF measures are stored in HTTP sessions.</p>
<p>As a result, system availability must be considered while implementing CSRF measures.</p>
<p>Following measures need to be implemented for a system that requires high availability.</p>
<ul class="simple">
<li>Perform AP server clustering and session replication.</li>
<li>Use a destination other than AP server memory for storing a session.</li>
</ul>
<p>However, above measures may affect the performance. Hence, it is necessary to consider performance requirements as well.</p>
<p class="last">For CSRF measures, refer to <a class="reference internal" href="../../Security/CSRF.html"><span class="doc">CSRF Countermeasures</span></a>.</p>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p><strong>TBD</strong></p>
<p>When high availability is required, it is advisable to review an architecture wherein, “token values for CSRF measures are stored in a destination other than the AP server memory (HTTP session)”.</p>
<p class="last">Basic architecture is currently under review and will be documented in subsequent versions.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="link-to-related-resource">
<span id="restoverviewhypermedialinkstorelatedresources"></span><h3><a class="toc-backref" href="#id17">5.1.2.7. Link to related resource</a><a class="headerlink" href="#link-to-related-resource" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><strong>Hypermedia link (URI) to another resource related to the specified resource, is included in the resource.</strong></div>
</div>
<div class="line-block">
<div class="line">In ROA, the process of incorporating a hypermedia link for another resource in the resource status display, is called  “Connectivity”.</div>
<div class="line">It signifies that both the linked resources retain this mutual link and all the related resources can be accessed by following this link.</div>
</div>
<p>Connectivity of resources is described below, with the example of member information resource of a shopping site.</p>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../../_images/RESTConnectivity.png"><img alt="Image of resource connectivity" src="../../_images/RESTConnectivity.png" style="width: 100%;" /></a>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<blockquote>
<div><table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">Following JSON is returned when the member information resource is fetched (<code class="docutils literal"><span class="pre">GET</span> <span class="pre">http://example.com/api/v1/members/M000000001</span></code>).</div>
</div>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;memberId&quot;</span> <span class="p">:</span> <span class="s2">&quot;M000000001&quot;</span><span class="p">,</span>
    <span class="nt">&quot;memberName&quot;</span> <span class="p">:</span> <span class="s2">&quot;John Smith&quot;</span><span class="p">,</span>
    <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;address1&quot;</span> <span class="p">:</span> <span class="s2">&quot;45 West 36th Street&quot;</span><span class="p">,</span>
        <span class="nt">&quot;address2&quot;</span> <span class="p">:</span> <span class="s2">&quot;7th Floor&quot;</span><span class="p">,</span>
        <span class="nt">&quot;city&quot;</span> <span class="p">:</span> <span class="s2">&quot;New York&quot;</span><span class="p">,</span>
        <span class="nt">&quot;state&quot;</span> <span class="p">:</span> <span class="s2">&quot;NY&quot;</span><span class="p">,</span>
        <span class="nt">&quot;zipCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;10018&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;links&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
<span class="hll">            <span class="nt">&quot;rel&quot;</span> <span class="p">:</span> <span class="s2">&quot;orders&quot;</span><span class="p">,</span>
</span><span class="hll">            <span class="nt">&quot;href&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://example.com/api/v1/memebers/M000000001/orders&quot;</span>
</span>        <span class="p">},</span>
        <span class="p">{</span>
<span class="hll">            <span class="nt">&quot;rel&quot;</span> <span class="p">:</span> <span class="s2">&quot;authentications&quot;</span><span class="p">,</span>
</span><span class="hll">            <span class="nt">&quot;href&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://example.com/api/v1/memebers/M000000001/authentications&quot;</span>
</span>        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="last line-block">
<div class="line">Highlighted portion is the hypermedia link (URI) to other related resource.</div>
<div class="line">In the above example, connectivity is retained between the order history resource and authentication history resource of each member.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">Following JSON is returned when order history resource is fetched (<code class="docutils literal"><span class="pre">GET</span> <span class="pre">http://example.com/api/v1/memebers/M000000001/orders</span></code>) using the hypermedia link (URI) set in the returned JSON.</div>
</div>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;orders&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;orderId&quot;</span> <span class="p">:</span> <span class="s2">&quot;029b49d7-0efa-411b-bc5a-6570ce40ead8&quot;</span><span class="p">,</span>
            <span class="nt">&quot;orderDatetime&quot;</span> <span class="p">:</span> <span class="s2">&quot;2013-12-27T20:34:50.897Z&quot;</span><span class="p">,</span>
            <span class="nt">&quot;orderName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Note PC&quot;</span><span class="p">,</span>
            <span class="nt">&quot;shopName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Global PC Shop&quot;</span><span class="p">,</span>
            <span class="nt">&quot;links&quot;</span> <span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
<span class="hll">                    <span class="nt">&quot;rel&quot;</span> <span class="p">:</span> <span class="s2">&quot;order&quot;</span><span class="p">,</span>
</span><span class="hll">                    <span class="nt">&quot;href&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://example.com/api/v1/memebers/M000000001/orders/029b49d7-0efa-411b-bc5a-6570ce40ead8&quot;</span>
</span>                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;orderId&quot;</span> <span class="p">:</span> <span class="s2">&quot;79bf991d-d42d-4546-9265-c5d4d59a80eb&quot;</span><span class="p">,</span>
            <span class="nt">&quot;orderDatetime&quot;</span> <span class="p">:</span> <span class="s2">&quot;2013-12-03T19:01:44.109Z&quot;</span><span class="p">,</span>
            <span class="nt">&quot;orderName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Orange Juice 100%&quot;</span><span class="p">,</span>
            <span class="nt">&quot;shopName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Global Food Shop&quot;</span><span class="p">,</span>
            <span class="nt">&quot;links&quot;</span> <span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
<span class="hll">                    <span class="nt">&quot;rel&quot;</span> <span class="p">:</span> <span class="s2">&quot;order&quot;</span><span class="p">,</span>
</span><span class="hll">                    <span class="nt">&quot;href&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://example.com/api/v1/memebers/M000000001/orders/79bf991d-d42d-4546-9265-c5d4d59a80eb&quot;</span>
</span>                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;links&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
<span class="hll">            <span class="nt">&quot;rel&quot;</span> <span class="p">:</span> <span class="s2">&quot;ownerMember&quot;</span><span class="p">,</span>
</span><span class="hll">            <span class="nt">&quot;href&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://example.com/api/v1/memebers/M000000001&quot;</span>
</span>        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="last line-block">
<div class="line">Highlighted portion is the hypermedia link (URI) for another related resource.</div>
<div class="line">In the above example, connectivity is retained between the resource of the member information for owner of order history and the resource for order history.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">Following JSON is returned when the resource for owner member of order history is fetched again (<code class="docutils literal"><span class="pre">GET</span> <span class="pre">http://example.com/api/v1/memebers/M000000001</span></code>) and the resource for authentication history is fetched (<code class="docutils literal"><span class="pre">GET</span> <span class="pre">http://example.com/api/v1/memebers/M000000001/authentications/</span></code>) using hypermedia link (URI) set in the returned JSON.</div>
</div>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;authentications&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;authenticationId&quot;</span> <span class="p">:</span> <span class="s2">&quot;6ae9613b-85b6-4dd1-83da-b53c43994433&quot;</span><span class="p">,</span>
            <span class="nt">&quot;authenticationDatetime&quot;</span> <span class="p">:</span> <span class="s2">&quot;2013-12-27T20:34:50.897Z&quot;</span><span class="p">,</span>
            <span class="nt">&quot;clientIpaddress&quot;</span> <span class="p">:</span> <span class="s2">&quot;230.210.3.124&quot;</span><span class="p">,</span>
            <span class="nt">&quot;authenticationResult&quot;</span> <span class="p">:</span> <span class="kc">true</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;authenticationId&quot;</span> <span class="p">:</span> <span class="s2">&quot;103bf3c5-7707-46eb-b2d8-c00ce6243d5f&quot;</span><span class="p">,</span>
            <span class="nt">&quot;authenticationDatetime&quot;</span> <span class="p">:</span> <span class="s2">&quot;2013-12-26T10:03:45.001Z&quot;</span><span class="p">,</span>
            <span class="nt">&quot;clientIpaddress&quot;</span> <span class="p">:</span> <span class="s2">&quot;230.210.3.124&quot;</span><span class="p">,</span>
            <span class="nt">&quot;authenticationResult&quot;</span> <span class="p">:</span> <span class="kc">false</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;links&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
<span class="hll">            <span class="nt">&quot;rel&quot;</span> <span class="p">:</span> <span class="s2">&quot;ownerMember&quot;</span><span class="p">,</span>
</span><span class="hll">            <span class="nt">&quot;href&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://example.com/api/v1/memebers/M000000001&quot;</span>
</span>        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="last line-block">
<div class="line">Highlighted portion is the hypermedia link (URI) to other linked resource.</div>
<div class="line">In the above example, connectivity is retained with respect to the resource for owner member of authentication history.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">It is not mandatory for a resource to include hypermedia link (URI) to another resource.</div>
<div class="line">When all the endpoints (URI) of REST API are already published, even if the link for related resource is set in the resource, it is highly unlikely that it will be used.</div>
<div class="line">Particularly, it makes no sense to provide links for the REST API that exchanges resources between systems, since REST API end points that are already published can be accessed directly.</div>
<div class="line">There is no need to provide a link where it is not required.</div>
</div>
<div class="line-block">
<div class="line">In contrast, when a resource is to be directly exchanged between a client application with user interface and RESTful Web service, the loose coupling between client and server can be enhanced by providing a link.</div>
<div class="line">Following are the reasons for enhancing the coupling between client and server.</div>
</div>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Reasons to enhance the loose coupling</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Client application needs to know only the logical name of the link in advance. Hence, it is not necessary to know the specific URI for calling REST API.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Since it is not necessary for the client application to know the specific URI, impact on server, owing to change in URI, can be minimized.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Whether to provide a hypermedia link (URI) to other resources should be determined on considering all the points described above.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>Relation with HATEOAS</strong></p>
<p>HATEOAS is an abbreviation for “<strong>H</strong>ypermedia <strong>A</strong>s <strong>T</strong>he <strong>E</strong>ngine <strong>O</strong>f <strong>A</strong>pplication <strong>S</strong>tate” and is one of the architectures for creating a RESTful Web application.</p>
<p>HATEOAS architecture includes the following processes.</p>
<ul class="simple">
<li>In the resources (JSON or XML) that are exchanged between client and server, the server includes a hypermedia link (URI) to an accessible resource.</li>
<li>Client fetches required resources from the server through the hypermedia link in the resource display (JSON or XML), and changes application status (screen status etc.).</li>
</ul>
<p>Therefore, providing a link for related resources is consistent with the HATEOAS architecture.</p>
<p class="last">When loose coupling between server and client is to be enhanced, please review if using the HATEOAS architecture would be beneficial.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="how-to-design">
<span id="resthowtodesign"></span><h2><a class="toc-backref" href="#id18">5.1.3. How to design</a><a class="headerlink" href="#how-to-design" title="Permalink to this headline">¶</a></h2>
<p>This section explains the design of RESTful Web Service.</p>
<div class="section" id="resource-extraction">
<span id="resthowtodesignextractresource"></span><h3><a class="toc-backref" href="#id19">5.1.3.1. Resource extraction</a><a class="headerlink" href="#resource-extraction" title="Permalink to this headline">¶</a></h3>
<p>First, the resource published on the Web is extracted.</p>
<p>Precautions while extracting a resource are as given below.</p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Precautions while extracting a resource</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Resource published on the web is used as the information managed by database. However, <strong>data model of the database must not be published as resource as it is, without careful consideration.</strong></div>
<div class="line">It should be closely investigated, as the fields stored in the database may include some fields that should not be disclosed to the client.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><strong>When information type is different in spite of being managed by the same table of the database, publishing it as a separate resource may be considered.</strong></div>
<div class="line">There are cases wherein, even if essentially seen as different information, it is managed by the same table, due to same data structure. Hence, such cases need to be reviewed closely.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In RESTful Web Service, the information operated by an event is extracted as a resource.</div>
<div class="line"><strong>The event itself should not be extracted as a resource.</strong></div>
<div class="line"><br /></div>
<div class="line">For example, when creating RESTful Web Service to be called from the events (approve, deny, return etc.) generated by work flow functionality, information for managing the workflow status or the workflow itself, is extracted as a resource.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="assigning-uri">
<span id="resthowtodesignassignuri"></span><h3><a class="toc-backref" href="#id20">5.1.3.2. Assigning URI</a><a class="headerlink" href="#assigning-uri" title="Permalink to this headline">¶</a></h3>
<p>URI is assigned to the extracted resource for identifying it.</p>
<p>It is recommended to use following formats for the URI.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">http(s)://{Domain</span> <span class="pre">name</span> <span class="pre">(:Port</span> <span class="pre">number)}/{A</span> <span class="pre">value</span> <span class="pre">indicating</span> <span class="pre">REST</span> <span class="pre">API}/{API</span> <span class="pre">version}/{path</span> <span class="pre">for</span> <span class="pre">identifying</span> <span class="pre">a</span> <span class="pre">resource}</span></code></li>
<li><code class="docutils literal"><span class="pre">http(s)://{Domain</span> <span class="pre">name</span> <span class="pre">indicating</span> <span class="pre">REST</span> <span class="pre">API(:Port</span> <span class="pre">number)}/{API</span> <span class="pre">version}/{path</span> <span class="pre">for</span> <span class="pre">identifying</span> <span class="pre">a</span> <span class="pre">resource}</span></code></li>
</ul>
<p>A typical example is given below.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">http://example.com/api/v1/members/M000000001</span></code></li>
<li><code class="docutils literal"><span class="pre">http://api.example.com/v1/members/M000000001</span></code></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="assigning-a-uri-that-indicates-the-api-as-rest-api">
<span id="resthowtodesignassignuriforpublishapi"></span><h4><a class="toc-backref" href="#id21">5.1.3.2.1. Assigning a URI that indicates the API as REST API</a><a class="headerlink" href="#assigning-a-uri-that-indicates-the-api-as-rest-api" title="Permalink to this headline">¶</a></h4>
<p>It is recommended to include  <code class="docutils literal"><span class="pre">api</span></code> within the URI domain or path, to clearly indicate that the URI is intended for RESTful Web Service (REST API).</p>
<p>Typically, the URI is as given below.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">http://example.com/api/...</span></code></li>
<li><code class="docutils literal"><span class="pre">http://api.example.com/...</span></code></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="assigning-a-uri-for-identifying-the-api-version">
<span id="resthowtodesignassignuriforapiversion"></span><h4><a class="toc-backref" href="#id22">5.1.3.2.2. Assigning a URI for identifying the API version</a><a class="headerlink" href="#assigning-a-uri-for-identifying-the-api-version" title="Permalink to this headline">¶</a></h4>
<p>It is recommended to include a value that identifies the API version, in the URI to be published to the client, since it may be necessary to run RESTful Web Service in multiple versions.</p>
<p>Typically, the URI format is as follows.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">http://example.com/api/{API</span> <span class="pre">version}/{path</span> <span class="pre">for</span> <span class="pre">identifying</span> <span class="pre">a</span> <span class="pre">resource}</span></code></li>
<li><code class="docutils literal"><span class="pre">http://api.example.com/{API</span> <span class="pre">version}/{path</span> <span class="pre">for</span> <span class="pre">identifying</span> <span class="pre">a</span> <span class="pre">resource}</span></code></li>
</ul>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p><strong>TBD</strong></p>
<p class="last">Whether API version should be included in URI, is currently being investigated.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="assigning-a-path-for-identifying-resource">
<span id="resthowtodesignassignuriforresource"></span><h4><a class="toc-backref" href="#id23">5.1.3.2.3. Assigning a path for identifying resource</a><a class="headerlink" href="#assigning-a-path-for-identifying-resource" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">The 2 URLs given below are assigned for resources that are published on Web.</div>
<div class="line">Following is an example of a URI when publishing member information on Web.</div>
</div>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="35%" />
<col width="25%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">URI format</th>
<th class="head">Typical example of URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">/{Noun that represents collection of resources}</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">/api/v1/members</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is the URI used for batch operations of resources.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">/{Noun that represents collection of resources/resource identifier (ID etc)}</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">/api/v1/members/M0001</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is the URI used while operating a specific resource.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">The URI for related resources published on Web are nested and then displayed.</div>
<div class="line">Following example describes the URI for publishing order information for each member on the Web.</div>
</div>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="35%" />
<col width="25%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">URI format</th>
<th class="head">Typical example of URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">{Resource URI}/{Noun representing collection of related resources}</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">/api/v1/members/M0001/orders</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is the URI used at the time of batch operation of related resources.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">{Resource URI}/{Noun representing collection of related resources}/{Identifier for related resource (ID etc.)}</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">/api/v1/members/M0001/orders/O0001</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is the URI used when operating a specific related resource.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">When the related resource published on Web has a single element, the noun that indicates the related resource should be singular and not plural.</div>
<div class="line">Following is the example of URI to publish credentials of each member on Web.</div>
</div>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="35%" />
<col width="25%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">URI format</th>
<th class="head">Typical example of URI</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">{URI for resource}/{Noun representing related resource}</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">/api/v1/members/M0001/credential</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is the URI used when operating a related resource with single element.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="assigning-http-methods">
<span id="resthowtodesignassignhttpmethod"></span><h3><a class="toc-backref" href="#id24">5.1.3.3. Assigning HTTP methods</a><a class="headerlink" href="#assigning-http-methods" title="Permalink to this headline">¶</a></h3>
<p>CRUD operation for resources is published as REST API by assigning the following HTTP methods for the URI assigned to each resource.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="assigning-http-methods-for-resource-collection-uri">
<span id="resthowtodesignassignhttpmethodforcollectionresource"></span><h4><a class="toc-backref" href="#id25">5.1.3.3.1. Assigning HTTP methods for resource collection URI</a><a class="headerlink" href="#assigning-http-methods-for-resource-collection-uri" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">HTTP methods</th>
<th class="head">Overview of the REST API to be implemented</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">GET</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">REST API that fetches collection of resources specified in URI, is implemented.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">POST</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">REST API that creates and adds the specified resource to the collection is implemented.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">PUT</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">REST API that performs batch update for resource specified in URI is implemented.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">DELETE</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">REST API that performs batch deletion for resource specified in URI is implemented.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HEAD</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">REST API that fetches meta information of the resource collection specified in URI, is implemented.</div>
<div class="line">A process same as GET is performed and only header is sent as response.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OPTIONS</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">REST API that responds with the list of HTTP methods (API) supported by resource collection specified in URI, is implemented.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="assigning-http-methods-for-uri-of-specific-resources">
<span id="resthowtodesignassignhttpmethodforspecifiedresource"></span><h4><a class="toc-backref" href="#id26">5.1.3.3.2. Assigning HTTP methods for URI of specific resources</a><a class="headerlink" href="#assigning-http-methods-for-uri-of-specific-resources" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">HTTP methods</th>
<th class="head">Overview of REST API to be implemented</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">GET</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">REST API that fetches the resource specified in URI is implemented.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">PUT</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">REST API that creates or updates the resource specified in URI is implemented.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">DELETE</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">REST API that deletes the resource specified in URI is implemented.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HEAD</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A REST API that fetches meta information of the resource specified in URI is implemented.</div>
<div class="line">A process same as GET is performed and only header is sent as a response.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OPTIONS</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">REST API that responds with list of HTTP methods (API) supported by the resource specified in URI is implemented.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="resource-format">
<span id="resthowtodesignresourcerepresentationformat"></span><h3><a class="toc-backref" href="#id27">5.1.3.4. Resource format</a><a class="headerlink" href="#resource-format" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><strong>It is recommended to use JSON</strong> as the format for displaying a resource.</div>
<div class="line">The explanation hereafter is based on the assumption that JSON is used as the format for displaying a resource.</div>
</div>
<div class="section" id="json-field-name">
<h4><a class="toc-backref" href="#id28">5.1.3.4.1. JSON Field name</a><a class="headerlink" href="#json-field-name" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line"><strong>It is recommended to use “lower camel case”</strong> as the JSON field name.</div>
<div class="line">It is recommended on considering its compatibility with JavaScript, which is assumed as one of the client applications.</div>
</div>
<div class="line-block">
<div class="line">The JSON sample with field name set in “lower camel case”, is as given below.</div>
<div class="line">In “lower camel case”, first letter of the word is in lowercase and subsequent first letters of words are in uppercase.</div>
</div>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;memberId&quot;</span> <span class="p">:</span> <span class="s2">&quot;M000000001&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="null-and-blank-characters">
<h4><a class="toc-backref" href="#id29">5.1.3.4.2. NULL and blank characters</a><a class="headerlink" href="#null-and-blank-characters" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line"><strong>It is recommended to differentiate NULL and blank characters</strong> as JSON values.</div>
<div class="line">Although, as application process, NULL and blank characters are often equated, it is advisable to differentiate NULL and blank characters as the value to be set in JSON.</div>
</div>
<div class="line-block">
<div class="line">JSON sample wherein NULL and blank characters are differentiated, is given below.</div>
</div>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;dateOfBirth&quot;</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;address1&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="date-format">
<h4><a class="toc-backref" href="#id30">5.1.3.4.3. Date format</a><a class="headerlink" href="#date-format" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line"><strong>It is recommended to use extended ISO-8601 format</strong> as the JSON date field format.</div>
<div class="line">Format other than extended ISO-8601 format can be used. However, it is advisable to use the extended ISO-8601 format, if there is no particular reason otherwise.</div>
<div class="line">There are two formats in ISO-8601 namely, basic format and extended format, however, readability is higher in extended format.</div>
</div>
<p>Basically, there are following three formats.</p>
<ol class="arabic simple">
<li>yyyy-MM-dd</li>
</ol>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;dateOfBirth&quot;</span> <span class="p">:</span> <span class="s2">&quot;1977-03-12&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>yyyy-MM-dd’T’HH:mm:ss.SSSZ</li>
</ol>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-12T22:22:36.637+09:00&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>yyyy-MM-dd’T’HH:mm:ss.SSS’Z’ (format for UTC)</li>
</ol>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-12T13:11:27.356Z&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="hypermedia-link-format">
<h4><a class="toc-backref" href="#id31">5.1.3.4.4. Hypermedia link format</a><a class="headerlink" href="#hypermedia-link-format" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">It is recommended to use the following format to create a hypermedia link.</div>
<div class="line">Sample of recommended format is as given below.</div>
</div>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;links&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;rel&quot;</span> <span class="p">:</span> <span class="s2">&quot;ownerMember&quot;</span><span class="p">,</span>
            <span class="nt">&quot;href&quot;</span> <span class="p">:</span> <span class="s2">&quot;http://example.com/api/v1/memebers/M000000001&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>Link object consisting of 2 fields - <code class="docutils literal"><span class="pre">rel</span></code> and <code class="docutils literal"><span class="pre">href</span></code> is retained in collection format.</li>
<li>Link name for identifying the link is specified in <code class="docutils literal"><span class="pre">rel</span></code>.</li>
<li>URI to access the resource is specified in <code class="docutils literal"><span class="pre">href</span></code>.</li>
<li><code class="docutils literal"><span class="pre">links</span></code> is the field which retains the Link object in collection format.</li>
</ul>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="format-at-the-time-of-error-response">
<h4><a class="toc-backref" href="#id32">5.1.3.4.5. Format at the time of error response</a><a class="headerlink" href="#format-at-the-time-of-error-response" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">When an error is detected, it is recommended to use a format that can retain the details of the error occurred.</div>
<div class="line">Detailed error information should be included, especially when there is a possibility of the error being eliminated owing to re-operation by client.</div>
<div class="line">In contrast, detailed error information should not be included when an event that exposes system vulnerability occurs. In such cases, the detailed error information should be output to a log.</div>
</div>
<p>Following is an example of the response format when error is detected.</p>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;code&quot;</span> <span class="p">:</span> <span class="s2">&quot;e.ex.fw.7001&quot;</span><span class="p">,</span>
  <span class="nt">&quot;message&quot;</span> <span class="p">:</span> <span class="s2">&quot;Validation error occurred on item in the request body.&quot;</span><span class="p">,</span>
  <span class="nt">&quot;details&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
    <span class="nt">&quot;code&quot;</span> <span class="p">:</span> <span class="s2">&quot;ExistInCodeList&quot;</span><span class="p">,</span>
    <span class="nt">&quot;message&quot;</span> <span class="p">:</span> <span class="s2">&quot;\&quot;genderCode\&quot; must exist in code list of CL_GENDER.&quot;</span><span class="p">,</span>
    <span class="nt">&quot;target&quot;</span> <span class="p">:</span> <span class="s2">&quot;genderCode&quot;</span>
  <span class="p">}</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>In the above example,</p>
<ul class="simple">
<li>Error code (code)</li>
<li>Error message (message)</li>
<li>Error details list (details)</li>
</ul>
<div class="line-block">
<div class="line">are provided as error response formats.</div>
<div class="line">It is assumed that the error details list is used when input validation error occurs. It is a format that can retain details like the field in which the error occurred and the information of the error.</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="http-status-code">
<span id="resthowtodesignhttpstatuscode"></span><h3><a class="toc-backref" href="#id33">5.1.3.5. HTTP Status Code</a><a class="headerlink" href="#http-status-code" title="Permalink to this headline">¶</a></h3>
<p>HTTP status code is sent as the response, in accordance with the following guidelines.</p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Objectives</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When the request is successful, an HTTP status code indicating success or transfer (2xx or 3xx system) is sent as response.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When the cause of request failure lies at client side, an HTTP status code indicating client error (4xx system) is sent as the response.</div>
<div class="line">When client is not responsible for request failure however, when the request may be successful through a re-operation by client, it is still considered as client error.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When the cause of request failure lies at server side, an HTTP status code indicating server error (5xx system) is sent as the response.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="http-status-codes-when-the-request-is-successful">
<span id="resthowtodesignhttpstatuscodeforsuccess"></span><h4><a class="toc-backref" href="#id34">5.1.3.5.1. HTTP status codes when the request is successful</a><a class="headerlink" href="#http-status-codes-when-the-request-is-successful" title="Permalink to this headline">¶</a></h4>
<p>When the request is successful, following HTTP status codes are sent as responses, depending on status.</p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="30%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">HTTP</div>
<div class="line">Status codes</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Applicable conditions</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">200</div>
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HTTP status code notifying that the request was successful.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is sent as a response when the resource information corresponding to the request is output in the entity body of response, as a result of successful request,</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">201</div>
<div class="line">Created</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HTTP status code notifying the creation of a new resource.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is used when a new resource is created using POST method.</div>
<div class="line">URI for created resource is set in the Location header of the response.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">204</div>
<div class="line">No Content</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HTTP status code notifying a successful request.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is sent as a response when the resource information corresponding to request is not output in the entity body of response, as a result of successful request.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The difference between <code class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></code> and <code class="docutils literal"><span class="pre">204</span> <span class="pre">No</span> <span class="pre">Content</span></code> is whether the resource information is output/not output in the response body.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="http-status-code-when-the-cause-of-request-failure-lies-at-client-side">
<span id="resthowtodesignhttpstatuscodeforclienterror"></span><h4><a class="toc-backref" href="#id35">5.1.3.5.2. HTTP status code when the cause of request failure lies at client side</a><a class="headerlink" href="#http-status-code-when-the-cause-of-request-failure-lies-at-client-side" title="Permalink to this headline">¶</a></h4>
<p>When the cause of request failure lies at client side, following HTTP status codes are sent as responses depending on the status.</p>
<p>Status codes that must be identified by individual REST APIs handling the resources, are as given below.</p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="30%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">HTTP</div>
<div class="line">Status code</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Applicable conditions</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">400</div>
<div class="line">Bad Request</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HTTP status code notifying that the request syntax or requested value is incorrect.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is sent as a response when an incomplete JSON or XML format specified in entity body is detected or an incomplete input value is specified in JSON or XML format or in the request parameters.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">404</div>
<div class="line">Not Found</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HTTP status code notifying that the specified resource does not exist.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is sent as a response when resource corresponding to specified URI does not exist in the system.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">409</div>
<div class="line">Conflict</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HTTP status code notifying that the process is terminated due to conflict in resource status when the request status is changed by requested contents.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is sent as a response when an exclusive error or a business error is detected.</div>
<div class="line">Conflict details and error details required to resolve the conflict need to be output to the entity body.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Following status codes need not be identified by individual REST APIs which handle the resources.</div>
<div class="line">These status codes need to be identified as the framework or common process.</div>
</div>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="30%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">HTTP</div>
<div class="line">Status codes</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Applicable conditions</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">405</div>
<div class="line">Method Not Allowed</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HTTP status code notifying that the used HTTP method is not supported by the specified resource.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is sent as a response when an unsupported HTTP method is used.</div>
<div class="line">The list of allowed methods is set in the Allow header of response.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">406</div>
<div class="line">Not Acceptable</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HTTP status code notifying the inability to receive a request, as the resource status cannot be sent as a response in the specified format.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is sent as a response when, the format specified in extension or Accept header is not supported as a response format.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">415</div>
<div class="line">Unsupported Media Type</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HTTP status code notifying that the request cannot be received, as the format specified in entity body is not supported.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is sent as a response when an unsupported format is specified in Content-Type header, as request format.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="http-status-code-when-the-cause-of-request-failure-lies-at-server-side">
<span id="resthowtodesignhttpstatuscodeforservererror"></span><h4><a class="toc-backref" href="#id36">5.1.3.5.3. HTTP status code when the cause of request failure lies at server side</a><a class="headerlink" href="#http-status-code-when-the-cause-of-request-failure-lies-at-server-side" title="Permalink to this headline">¶</a></h4>
<p>When the cause of request failure lies at server side, HTTP status codes given below are sent as responses, depending on the status.</p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="30%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">HTTP</div>
<div class="line">Status code</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Applicable conditions</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">500</div>
<div class="line">Internal Server Error</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HTTP status code notifying that an internal error has occurred in the server.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is sent as a response when an unexpected error has occurred in the server or a status that should not occur during a normal operation is detected.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="authentication-and-authorization">
<h3><a class="toc-backref" href="#id37">5.1.3.6. Authentication and Authorization</a><a class="headerlink" href="#authentication-and-authorization" title="Permalink to this headline">¶</a></h3>
<p>Please refer to : ref: <cite>OAuth &lt;OAuth&gt;</cite> for the mechanism of authentication and authorization using the OAuth 2 mechanism.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="conditional-update-control-of-resource">
<h3><a class="toc-backref" href="#id38">5.1.3.7. Conditional update control of resource</a><a class="headerlink" href="#conditional-update-control-of-resource" title="Permalink to this headline">¶</a></h3>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p><strong>TBD</strong></p>
<p>The process for conditional update (exclusive control) of a resource using HTTP header is explained here.</p>
<p class="last">Conditional update using headers like Etag/Last-Modified-Since etc. will be described in subsequent versions.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="conditional-acquisition-control-of-resource">
<h3><a class="toc-backref" href="#id39">5.1.3.8. Conditional acquisition control of resource</a><a class="headerlink" href="#conditional-acquisition-control-of-resource" title="Permalink to this headline">¶</a></h3>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<p><strong>TBD</strong></p>
<p>The process for conditional acquisition (304 not modified control) of resource using HTTP header is explained here.</p>
<p class="last">Conditional acquisition using headers like Etag/Last-Modified etc. will be described in subsequent versions.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="cache-control-of-resource">
<h3><a class="toc-backref" href="#id40">5.1.3.9. Cache control of resource</a><a class="headerlink" href="#cache-control-of-resource" title="Permalink to this headline">¶</a></h3>
<div class="admonition-todo admonition" id="index-4">
<p class="first admonition-title">Todo</p>
<p><strong>TBD</strong></p>
<p>Cache control of resources which use HTTP header, is explained here.</p>
<p class="last">Cache control of resources that use headers such as Cache-Control/Pragma/Expires etc. shall be described in subsequent versions.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="versioning">
<h3><a class="toc-backref" href="#id41">5.1.3.10. Versioning</a><a class="headerlink" href="#versioning" title="Permalink to this headline">¶</a></h3>
<div class="admonition-todo admonition" id="index-5">
<p class="first admonition-title">Todo</p>
<p><strong>TBD</strong></p>
<p class="last">Version control of RESTful Web Service and details on performing parallel operations in multiple versions, will be described in subsequent versions.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="how-to-use">
<span id="resthowtouse"></span><h2><a class="toc-backref" href="#id42">5.1.4. How to use</a><a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h2>
<p>This section explains the basic method to create RESTful Web Service.</p>
<div class="section" id="web-application-configuration">
<span id="resthowtousewebapplicationconstruction"></span><h3><a class="toc-backref" href="#id43">5.1.4.1. Web application configuration</a><a class="headerlink" href="#web-application-configuration" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">While building RESTful Web Service, Web application (war) is built by any one of the following configurations.</div>
<div class="line"><strong>It is recommended to build a Web application that is exclusive to RESTful Web Service unless there is a specific reason otherwise.</strong></div>
</div>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="30%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Configuration</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Build an exclusive Web application for RESTful Web Service.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is recommended to build an exclusive Web application (war) for RESTful Web Service when an independence with client application (UI layer application) that uses RESTful Web Service, is to be ensured (is necessary).</div>
<div class="line"><br /></div>
<div class="line">This method can be used to create RESTful Web Service when there are multiple client applications using RESTful Web Service.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Build by providing <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> for RESTful Web Service.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When it is not necessary to ensure independence of client application (UI layer application) that uses RESTful Web Service, both the client application and RESTful Web Service can be built as a single Web application (war).</div>
<div class="line"><br /></div>
<div class="line">However, it is strongly recommended to build it by dividing <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> that receives the requests for RESTful Web Service and <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> that receives client application requests.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Client application (UI layer application)</strong></p>
<p class="last">Client application (UI layer application) described here refers to the application that responds with client layer (UI layer) component called CSS (Cascading Style Sheets) and scripts like HTML, JavaScript etc.
HTML generated by template engine such as JSP, is also considered.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Why division of DispatcherServlet is recommended</strong></p>
<p>In Spring MVC, operation settings of the application are defined for each <code class="docutils literal"><span class="pre">DispatcherServlet</span></code>.
Therefore, when the requests of RESTful Web Service and client application (UI layer application) are configured to be received from the same <code class="docutils literal"><span class="pre">DispatcherServlet</span></code>, specific operation settings for RESTful Web Service or client application cannot be defined, thus resulting in complex or cumbersome settings.</p>
<p class="last">In this guideline, when client application is to be configured as same Web application, for RESTful Web Service, it is recommended to divide <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> to avoid occurrence of the issues described above.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Configuration image when building a Web application exclusive to RESTful Web Service, is as follows:</p>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../../_images/RESTWebAppsConstitutionDivideWar.png"><img alt="Constitution of RESTful Web Service" src="../../_images/RESTWebAppsConstitutionDivideWar.png" style="width: 100%;" /></a>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Configuration image when building RESTful Web Service and client application as a single application, is as follows:</p>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../../_images/RESTWebAppsConstitutionDivideServlet.png"><img alt="Constitution of RESTful Web Service" src="../../_images/RESTWebAppsConstitutionDivideServlet.png" style="width: 100%;" /></a>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="pom-xml-configuration">
<h3><a class="toc-backref" href="#id44">5.1.4.2. pom.xml configuration</a><a class="headerlink" href="#pom-xml-configuration" title="Permalink to this headline">¶</a></h3>
<p>Configuration of dependency relation is not required if terasoluna-gfw-common-dependencies is used.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>Configuration while using in Java SE 7 environment</strong></p>
<p>terasoluna-gfw-common-dependencies configure a dependency relation considering Java SE 8 as a prerequisite. Java SE 8 dependency library is excluded as shown below  while using in Java SE 7 environment.
For java SE 8 dependency library, refer “<a class="reference internal" href="../../Overview/FrameworkStack.html#frameworkstack-using-oss-version"><span class="std std-ref">OSS Versions</span></a> ” of Architectural Overview.</p>
<blockquote class="last">
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.terasoluna.gfw<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>terasoluna-gfw-common-dependencies<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;exclusions&gt;</span>
        <span class="nt">&lt;exclusion&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.datatype<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>jackson-datatype-jsr310<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;/exclusion&gt;</span>
    <span class="nt">&lt;/exclusions&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="application-settings">
<span id="resthowtouseapplicationsettings"></span><h3><a class="toc-backref" href="#id45">5.1.4.3. Application settings</a><a class="headerlink" href="#application-settings" title="Permalink to this headline">¶</a></h3>
<p>Application settings for RESTful Web Service are explained below.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>DoS attack measures at the time of StAX(Streaming API for XML) use</strong></p>
<p class="last">If the StAX is used to parse the XML format data, protect DoS attack.
For details, refer to <a class="reference external" href="http://pivotal.io/security/cve-2015-3192">CVE-2015-3192 - DoS Attack with XML Input</a>.</p>
</div>
<div class="section" id="settings-for-activating-the-spring-mvc-components-necessary-for-restful-web-service">
<span id="resthowtouseapplicationsettingsofspringmvc"></span><h4><a class="toc-backref" href="#id46">5.1.4.3.1. Settings for activating the Spring MVC components necessary for RESTful Web Service</a><a class="headerlink" href="#settings-for-activating-the-spring-mvc-components-necessary-for-restful-web-service" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Create a bean definition file for RESTful Web Service.</div>
<div class="line">Definitions that are required to operate the sample indicated in the explanation hereafter, are as follows:</div>
</div>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">spring-mvc-rest.xml</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.springframework.org/schema/beans&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xmlns:context=</span><span class="s">&quot;http://www.springframework.org/schema/context&quot;</span>
    <span class="na">xmlns:mvc=</span><span class="s">&quot;http://www.springframework.org/schema/mvc&quot;</span>
    <span class="na">xmlns:util=</span><span class="s">&quot;http://www.springframework.org/schema/util&quot;</span>
    <span class="na">xmlns:aop=</span><span class="s">&quot;http://www.springframework.org/schema/aop&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;</span>
<span class="s">        http://www.springframework.org/schema/mvc</span>
<span class="s">        http://www.springframework.org/schema/mvc/spring-mvc.xsd</span>
<span class="s">        http://www.springframework.org/schema/beans</span>
<span class="s">        http://www.springframework.org/schema/beans/spring-beans.xsd</span>
<span class="s">        http://www.springframework.org/schema/util</span>
<span class="s">        http://www.springframework.org/schema/util/spring-util.xsd</span>
<span class="s">        http://www.springframework.org/schema/context</span>
<span class="s">        http://www.springframework.org/schema/context/spring-context.xsd</span>
<span class="s">        http://www.springframework.org/schema/aop</span>
<span class="s">        http://www.springframework.org/schema/aop/spring-aop.xsd</span>
<span class="s">&quot;</span><span class="nt">&gt;</span>

    <span class="c">&lt;!-- Load properties files for placeholder. --&gt;</span>
<span class="hll">    <span class="c">&lt;!-- (1) --&gt;</span>
</span>    <span class="nt">&lt;context:property-placeholder</span>
        <span class="na">location=</span><span class="s">&quot;classpath*:/META-INF/spring/*.properties&quot;</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;jsonMessageConverter&quot;</span>
        <span class="na">class=</span><span class="s">&quot;org.springframework.http.converter.json.MappingJackson2HttpMessageConverter&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;objectMapper&quot;</span> <span class="na">ref=</span><span class="s">&quot;objectMapper&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>

    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;objectMapper&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean&quot;</span><span class="nt">&gt;</span>
<span class="hll">        <span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;dateFormat&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;com.fasterxml.jackson.databind.util.StdDateFormat&quot;</span> <span class="nt">/&gt;</span>
</span>        <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>

    <span class="c">&lt;!-- Register components of Spring MVC. --&gt;</span>
<span class="hll">    <span class="c">&lt;!-- (3) --&gt;</span>
</span><span class="hll">     <span class="nt">&lt;mvc:annotation-driven&gt;</span>
</span><span class="hll">        <span class="nt">&lt;mvc:message-converters</span> <span class="na">register-defaults=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
</span>            <span class="nt">&lt;ref</span> <span class="na">bean=</span><span class="s">&quot;jsonMessageConverter&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/mvc:message-converters&gt;</span>
<span class="hll">        <span class="c">&lt;!-- (4) --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;mvc:argument-resolvers&gt;</span>
</span><span class="hll">            <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.data.web.PageableHandlerMethodArgumentResolver&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/mvc:argument-resolvers&gt;</span>
</span>    <span class="nt">&lt;/mvc:annotation-driven&gt;</span>

    <span class="c">&lt;!-- Register components of interceptor. --&gt;</span>
<span class="hll">    <span class="c">&lt;!-- (5) --&gt;</span>
</span>    <span class="nt">&lt;mvc:interceptors&gt;</span>
        <span class="nt">&lt;mvc:interceptor&gt;</span>
            <span class="nt">&lt;mvc:mapping</span> <span class="na">path=</span><span class="s">&quot;/**&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.terasoluna.gfw.web.logging.TraceLoggingInterceptor&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/mvc:interceptor&gt;</span>
        <span class="c">&lt;!-- omitted --&gt;</span>
    <span class="nt">&lt;/mvc:interceptors&gt;</span>

    <span class="c">&lt;!-- Scan &amp; register components of RESTful Web Service. --&gt;</span>
<span class="hll">    <span class="c">&lt;!-- (6) --&gt;</span>
</span>    <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">&quot;com.example.project.api&quot;</span> <span class="nt">/&gt;</span>

    <span class="c">&lt;!-- Register components of AOP. --&gt;</span>
<span class="hll">    <span class="c">&lt;!-- (7) --&gt;</span>
</span>    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;handlerExceptionResolverLoggingInterceptor&quot;</span>
        <span class="na">class=</span><span class="s">&quot;org.terasoluna.gfw.web.exception.HandlerExceptionResolverLoggingInterceptor&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;exceptionLogger&quot;</span> <span class="na">ref=</span><span class="s">&quot;exceptionLogger&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;aop:config&gt;</span>
        <span class="nt">&lt;aop:advisor</span> <span class="na">advice-ref=</span><span class="s">&quot;handlerExceptionResolverLoggingInterceptor&quot;</span>
            <span class="na">pointcut=</span><span class="s">&quot;execution(* org.springframework.web.servlet.HandlerExceptionResolver.resolveException(..))&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/aop:config&gt;</span>

<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When the value defined in the property file needs to be referred by an application layer component, the property file should be read by using <code class="docutils literal"><span class="pre">&lt;context:property-placeholder&gt;</span></code> element.</div>
<div class="line">For the details of fetching a value from property file, refer to “<a class="reference internal" href="../GeneralFuncDetail/PropertyManagement.html"><span class="doc">Properties Management</span></a>”.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add the settings for handling the JSON date field format as extended ISO-8601 format.</div>
<div class="line">Also, when Joda Time class is to be used as a property of JavaBean which represents a resource (Resource class), “<a class="reference internal" href="#restappendixusingjsr310-jodatime"><span class="std std-ref">Configuration while using JSR-310 Date and Time API / Joda Time</span></a>” must be carried out.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Perform bean registration for the Spring MVC framework component necessary for providing RESTful Web Service.</div>
<div class="line">JSON can be used as a resource format by performing these settings.</div>
<div class="line">In the above example, resource format is restricted to JSON since the register-defaults attribute of <code class="docutils literal"><span class="pre">&lt;mvc:message-converters</span></code>&gt; element is set as <code class="docutils literal"><span class="pre">false</span></code>.</div>
<div class="line"><br /></div>
<div class="line">To use XML as resource format, <code class="docutils literal"><span class="pre">MessageConverter</span></code> for XML, that performs the XXE Injection countermeasure, should be specified. For details on designated methods, refer to “<a class="reference internal" href="#restappendixenabledxxeinjectprotection"><span class="std std-ref">Enabling XXE Injection measures</span></a>” .</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add the settings to enable page search functionality.</div>
<div class="line">For page search details, refer to “<a class="reference internal" href="../WebApplicationDetail/Pagination.html"><span class="doc">Pagination</span></a>”.</div>
<div class="line">This setting is not required if page search is unnecessary, however, it is alright if defined.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Perform bean registration for Spring MVC interceptor.</div>
<div class="line">In the above example, only the <code class="docutils literal"><span class="pre">TraceLoggingInterceptor</span></code> provided by common library is defined. However, when using JPA as data access, <code class="docutils literal"><span class="pre">OpenEntityManagerInViewInterceptor</span></code> setting needs to be added separately.</div>
<div class="line">Refer to <a class="reference internal" href="../DataAccessDetail/DataAccessJpa.html"><span class="doc">Database Access (JPA)</span></a> for <code class="docutils literal"><span class="pre">OpenEntityManagerInViewInterceptor</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Scan the application layer components for RESTful Web Service (Controller or Helper class etc.) and perform bean registration.</div>
<div class="line">The <code class="docutils literal"><span class="pre">com.example.project.api</span></code> part is the <strong>package name for each project.</strong></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify AOP definition to output the exception handled by Spring MVC framework to a log.</div>
<div class="line">Refer to <a class="reference internal" href="../WebApplicationDetail/ExceptionHandling.html"><span class="doc">Exception Handling</span></a> for <code class="docutils literal"><span class="pre">HandlerExceptionResolverLoggingInterceptor</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>How to define a Bean for ObjectMapper</strong></p>
<p>When a Bean is to be defined for <code class="docutils literal"><span class="pre">com.fasterxml.jackson.databind.ObjectMapper</span></code> of Jackson,
<code class="docutils literal"><span class="pre">Jackson2ObjectMapperFactoryBean</span></code> provided by Spring should be used.
If <code class="docutils literal"><span class="pre">Jackson2ObjectMapperFactoryBean</span></code> is used, extension module for JSR-310 Date and Time API or Joda Time can be auto-registered.
Further, <code class="docutils literal"><span class="pre">ObjectMapper</span></code> configuration which is difficult to represent in Bean definition file of XML can be easily configured as well.</p>
<p>Also, when style is to be changed from directly defining a Bean for <code class="docutils literal"><span class="pre">ObjectMapper</span></code> to using <code class="docutils literal"><span class="pre">Jackson2ObjectMapperFactoryBean</span></code>,
it should be noted that default value for the following configuration differs from the default value of Jackson (disabled).</p>
<ul class="simple">
<li><a class="reference external" href="http://fasterxml.github.io/jackson-databind/javadoc/2.8/com/fasterxml/jackson/databind/MapperFeature.html?is-external=true#DEFAULT_VIEW_INCLUSION">MapperFeature#DEFAULT_VIEW_INCLUSION</a></li>
<li><a class="reference external" href="http://fasterxml.github.io/jackson-databind/javadoc/2.8/com/fasterxml/jackson/databind/DeserializationFeature.html?is-external=true#FAIL_ON_UNKNOWN_PROPERTIES">DeserializationFeature#FAIL_ON_UNKNOWN_PROPERTIES</a></li>
</ul>
<p>When <code class="docutils literal"><span class="pre">ObjectMapper</span></code> operation and default Jackson operation are to be matched, the configuration above is enabled using <code class="docutils literal"><span class="pre">featuresToEnable</span></code> property.</p>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;objectMapper&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;featuresToEnable&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;array&gt;</span>
            <span class="nt">&lt;util:constant</span> <span class="na">static-field=</span><span class="s">&quot;com.fasterxml.jackson.databind.MapperFeature.DEFAULT_VIEW_INCLUSION&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;util:constant</span> <span class="na">static-field=</span><span class="s">&quot;com.fasterxml.jackson.databind.DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/array&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p class="last">For <code class="docutils literal"><span class="pre">Jackson2ObjectMapperFactoryBean</span></code> details, refer <a class="reference external" href="http://docs.spring.io/spring/docs/4.3.14.RELEASE/javadoc-api/org/springframework/http/converter/json/Jackson2ObjectMapperFactoryBean.html">JavaDoc of Jackson2ObjectMapperFactoryBean</a>.</p>
</div>
<div class="admonition note" id="rest-note-changed-jackson-version">
<p class="first admonition-title">Note</p>
<p><strong>Points to be noted when changing the jackson version from 1.x.x to 2.x.x</strong></p>
<ul class="simple">
<li>Changed package</li>
</ul>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">version</th>
<th class="head">package</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">1.x.x</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><cite>org.codehaus.jackson</cite></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">2.x.x</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><cite>com.fasterxml.jackson</cite></div>
</div>
</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Please note that configuration of subordinate package also is also changed.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li>Deprecated List</li>
</ul>
<blockquote class="last">
<div><ul class="simple">
<li><a class="reference external" href="http://fasterxml.github.io/jackson-core/javadoc/2.8/deprecated-list.html">http://fasterxml.github.io/jackson-core/javadoc/2.8/deprecated-list.html</a></li>
<li><a class="reference external" href="http://fasterxml.github.io/jackson-databind/javadoc/2.8/deprecated-list.html">http://fasterxml.github.io/jackson-databind/javadoc/2.8/deprecated-list.html</a></li>
<li><a class="reference external" href="http://fasterxml.github.io/jackson-annotations/javadoc/2.8/deprecated-list.html">http://fasterxml.github.io/jackson-annotations/javadoc/2.8/deprecated-list.html</a></li>
</ul>
</div></blockquote>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="servlet-settings-for-restful-web-service">
<span id="resthowtouseapplicationsettingsofdispatcherservlet"></span><h4><a class="toc-backref" href="#id47">5.1.4.3.2. Servlet settings for RESTful Web Service</a><a class="headerlink" href="#servlet-settings-for-restful-web-service" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">When RESTful Web Service and client application are built as separate Web applications, the settings are as follows:</div>
<div class="line">When RESTful Web Service and client application are to be built as same Web application, it is necessary to perform “<a class="reference internal" href="#restappendixsettingsofdeployinsamewarfilerestandclientapplication"><span class="std std-ref">Settings when RESTful Web Service and client application are operated as the same Web application</span></a>” .</div>
</div>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">web.xml</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- omitted --&gt;</span>

<span class="nt">&lt;servlet&gt;</span>
<span class="hll">    <span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="hll">    <span class="nt">&lt;servlet-name&gt;</span>restAppServlet<span class="nt">&lt;/servlet-name&gt;</span>
</span>    <span class="nt">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="nt">&lt;/servlet-class&gt;</span>
    <span class="nt">&lt;init-param&gt;</span>
        <span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
<span class="hll">        <span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;param-value&gt;</span>classpath*:META-INF/spring/spring-mvc-rest.xml<span class="nt">&lt;/param-value&gt;</span>
</span>    <span class="nt">&lt;/init-param&gt;</span>
    <span class="nt">&lt;load-on-startup&gt;</span>1<span class="nt">&lt;/load-on-startup&gt;</span>
<span class="nt">&lt;/servlet&gt;</span>
<span class="hll"><span class="c">&lt;!-- (3) --&gt;</span>
</span><span class="hll"><span class="nt">&lt;servlet-mapping&gt;</span>
</span><span class="hll">    <span class="nt">&lt;servlet-name&gt;</span>restAppServlet<span class="nt">&lt;/servlet-name&gt;</span>
</span><span class="hll">    <span class="nt">&lt;url-pattern&gt;</span>/api/v1/*<span class="nt">&lt;/url-pattern&gt;</span>
</span><span class="hll"><span class="nt">&lt;/servlet-mapping&gt;</span>
</span>
<span class="c">&lt;!-- omitted --&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a name which shows that it is a  RESTful Web Service servlet, in <code class="docutils literal"><span class="pre">&lt;servlet-name&gt;</span></code> element.</div>
<div class="line">In the above example, <code class="docutils literal"><span class="pre">restAppServlet</span></code> is specified as the servlet name.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a Spring MVC bean definition file used to build <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> for RESTful Web Service.</div>
<div class="line">In the above example, <code class="file docutils literal"><span class="pre">META-INF/spring/spring-mvc-rest.xml</span></code> in class path, is specified as the Spring MVC bean definition file.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a servlet path pattern to be mapped with the <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> of RESTful Web Service.</div>
<div class="line">In the above example, the servlet path under <code class="docutils literal"><span class="pre">/api/v1/</span></code> is mapped with the  <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> for RESTful Web Service.</div>
<div class="line">Typically, servlet paths like</div>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">/api/v1/</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">/api/v1/members</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">/api/v1/members/xxxxx</span></code></div>
</div>
<div class="line">are mapped in the <code class="docutils literal"><span class="pre">DispatcherServlet</span></code>(<code class="docutils literal"><span class="pre">restAppServlet</span></code>) for RESTful Web Service.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>Value specified in the value attribute of &#64;RequestMapping annotation</strong></p>
<p>For the value to be specified in value attribute of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation, specify the value assigned to the part of wild card (“<code class="docutils literal"><span class="pre">*</span></code>”) in <code class="docutils literal"><span class="pre">&lt;url-pattern&gt;</span></code> element.</p>
<p>For example, when <code class="docutils literal"><span class="pre">&#64;RequestMapping(value</span> <span class="pre">=</span> <span class="pre">&quot;members&quot;)</span></code> is specified, it is deployed as the method to perform a process for path <code class="docutils literal"><span class="pre">/api/v1/members</span></code>.
Therefore, it is not necessary to specify the path  (<code class="docutils literal"><span class="pre">api/v1</span></code>) in value attribute of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation for mapping to divided servlets.</p>
<p class="last">When <code class="docutils literal"><span class="pre">&#64;RequestMapping(value</span> <span class="pre">=</span> <span class="pre">api/v1/members)</span></code> is specified, it gets deployed as the method that performs a process for the <code class="docutils literal"><span class="pre">&quot;/api/v1/api/v1/members&quot;</span></code> path. Hence, please take note of same.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="rest-api-implementation">
<span id="resthowtouseapiimplementation"></span><h3><a class="toc-backref" href="#id48">5.1.4.4. REST API implementation</a><a class="headerlink" href="#rest-api-implementation" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">How to implement REST API is explained here.</div>
<div class="line">Hereafter, REST API implementation example is explained using member information (Member resource) of a shopping site.</div>
</div>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Domain layer implementation is not explained in this section, however, it is sent as attachment  “<a class="reference internal" href="#restappendixsorucecodesofdomainlayer"><span class="std std-ref">Source code of the domain layer class created at the time of REST API implementation</span></a>”.</p>
<p class="last">Please refer if required.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>REST API specifications used in this explanation are as shown below.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Resource format</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">The resource format of member information should be the following JSON format.</div>
<div class="line">In the following example, although all the fields are displayed, they are not used in the requests and responses of all API.</div>
<div class="line">For example, <code class="docutils literal"><span class="pre">&quot;password&quot;</span></code> is used only in requests whereas <code class="docutils literal"><span class="pre">createdAt</span></code> or <code class="docutils literal"><span class="pre">lastModifiedAt</span></code> are used only in responses.</div>
</div>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;memberId&quot;</span> <span class="p">:</span> <span class="s2">&quot;M000000001&quot;</span><span class="p">,</span>
    <span class="nt">&quot;firstName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Firstname&quot;</span><span class="p">,</span>
    <span class="nt">&quot;lastName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Lastname&quot;</span><span class="p">,</span>
    <span class="nt">&quot;genderCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;dateOfBirth&quot;</span> <span class="p">:</span> <span class="s2">&quot;1977-03-13&quot;</span><span class="p">,</span>
    <span class="nt">&quot;emailAddress&quot;</span> <span class="p">:</span> <span class="s2">&quot;user1@test.com&quot;</span><span class="p">,</span>
    <span class="nt">&quot;telephoneNumber&quot;</span> <span class="p">:</span> <span class="s2">&quot;09012345678&quot;</span><span class="p">,</span>
    <span class="nt">&quot;zipCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;1710051&quot;</span><span class="p">,</span>
    <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span>
    <span class="nt">&quot;credential&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;signId&quot;</span> <span class="p">:</span> <span class="s2">&quot;user1@test.com&quot;</span><span class="p">,</span>
        <span class="nt">&quot;password&quot;</span> <span class="p">:</span> <span class="s2">&quot;zaq12wsx&quot;</span><span class="p">,</span>
        <span class="nt">&quot;passwordLastChangedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T04:39:14.831Z&quot;</span><span class="p">,</span>
        <span class="nt">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T04:39:14.831Z&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;createdAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T04:39:14.831Z&quot;</span><span class="p">,</span>
    <span class="nt">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T04:39:14.831Z&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section illustrates an example wherein a hypermedia link for related resource is not provided.
For details on implementation with hypermedia link, refer to “<a class="reference internal" href="#restappendixhypermedialink"><span class="std std-ref">Implementing hypermedia link</span></a>”.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Specifications of resource fields</strong></p>
<blockquote>
<div><p>The specifications for each field of a resource (JSON) are as shown below.</p>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="11%" />
<col width="22%" />
<col width="11%" />
<col width="11%" />
<col width="17%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Item name</th>
<th class="head">Type</th>
<th class="head">I/O specifications</th>
<th class="head">Number of digits
(min-max)</th>
<th class="head">Other specifications</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>memberId</td>
<td>String</td>
<td>I/O</td>
<td>10-10</td>
<td>It should be “Unspecified” (NULL) at the time of request for POST Members.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>firstName</td>
<td>String</td>
<td>I/O</td>
<td>1-128</td>
<td>-</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>lastName</td>
<td>String</td>
<td>I/O</td>
<td>1-128</td>
<td>-</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td>genderCode</td>
<td><div class="first last line-block">
<div class="line">String</div>
<div class="line">(Code)</div>
</div>
</td>
<td>I/O</td>
<td>1-1</td>
<td><div class="first last line-block">
<div class="line">“<code class="docutils literal"><span class="pre">0</span></code>” : UNKNOWN</div>
<div class="line">“<code class="docutils literal"><span class="pre">1</span></code>” : MEN</div>
<div class="line">“<code class="docutils literal"><span class="pre">2</span></code>” : WOMEN</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td>dateOfBirth</td>
<td>Date</td>
<td>I/O</td>
<td>-</td>
<td><div class="first last line-block">
<div class="line">yyyy-MM-dd format</div>
<div class="line">(extended ISO-8601 format)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td>emailAddress</td>
<td><div class="first last line-block">
<div class="line">String</div>
<div class="line">(E-mail)</div>
</div>
</td>
<td>I/O</td>
<td>1-256</td>
<td>-</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td>telephoneNumber</td>
<td>String</td>
<td>I/O</td>
<td>0-20</td>
<td>-</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(8)</div>
</div>
</td>
<td>zipCode</td>
<td>String</td>
<td>I/O</td>
<td>0-20</td>
<td>-</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(9)</div>
</div>
</td>
<td>address</td>
<td>String</td>
<td>I/O</td>
<td>0-256</td>
<td>-</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(10)</div>
</div>
</td>
<td>credential</td>
<td><div class="first last line-block">
<div class="line">Object</div>
<div class="line">(MemberCredential)</div>
</div>
</td>
<td>I/O</td>
<td>-</td>
<td>It is specified at the time of request for POST Members.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(11)</div>
</div>
</td>
<td>credential/signId</td>
<td><div class="first last line-block">
<div class="line">String</div>
<div class="line">(E-mail)</div>
</div>
</td>
<td>I/O</td>
<td>0-256</td>
<td>emailAddress value is applied when not specified.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(12)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">credential/</div>
<div class="line">password</div>
</div>
</td>
<td>String</td>
<td>I</td>
<td>8-32</td>
<td>-</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(13)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">credential/</div>
<div class="line">passwordLastChangedAt</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Timestamp</div>
<div class="line">with time-zone</div>
</div>
</td>
<td>O</td>
<td>-</td>
<td><div class="first last line-block">
<div class="line">yyyy-MM-dd’T’HH:mm:ss.SSS’Z’ format</div>
<div class="line">(extended ISO-8601 format)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(14)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">credential/</div>
<div class="line">lastModifiedAt</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Timestamp</div>
<div class="line">with time-zone</div>
</div>
</td>
<td>O</td>
<td>-</td>
<td><div class="first last line-block">
<div class="line">yyyy-MM-dd’T’HH:mm:ss.SSS’Z’format</div>
<div class="line">(extended ISO-8601 format)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(15)</div>
</div>
</td>
<td>createdAt</td>
<td><div class="first last line-block">
<div class="line">Timestamp</div>
<div class="line">with time-zone</div>
</div>
</td>
<td>O</td>
<td>-</td>
<td><div class="first last line-block">
<div class="line">yyyy-MM-dd’T’HH:mm:ss.SSS’Z’ format</div>
<div class="line">(extended ISO-8601 format)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(16)</div>
</div>
</td>
<td>lastModifiedAt</td>
<td><div class="first last line-block">
<div class="line">Timestamp</div>
<div class="line">with time-zone</div>
</div>
</td>
<td>O</td>
<td>-</td>
<td><div class="first last line-block">
<div class="line">yyyy-MM-dd’T’HH:mm:ss.SSS’Z’ format</div>
<div class="line">(extended ISO-8601 format)</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>REST APIs List</strong></p>
<blockquote>
<div><p>APIs given below are used as the REST API to be implemented.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="15%" />
<col width="10%" />
<col width="25%" />
<col width="15%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">API name</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">HTTP</div>
<div class="line">Method</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Resource path</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Status</div>
<div class="line">Code</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">API Overview</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><a class="reference internal" href="#resthowtouseapiimplementationofgetcollection"><span class="std std-ref">GET Members</span></a></td>
<td>GET</td>
<td><code class="docutils literal"><span class="pre">/api/v1/members</span></code></td>
<td><div class="first last line-block">
<div class="line">200</div>
<div class="line">(OK)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Page is searched for Member resource that matches the condition.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><a class="reference internal" href="#resthowtouseapiimplementationofpostcollection"><span class="std std-ref">POST Members</span></a></td>
<td>POST</td>
<td><code class="docutils literal"><span class="pre">/api/v1/members</span></code></td>
<td><div class="first last line-block">
<div class="line">201</div>
<div class="line">(Created)</div>
</div>
</td>
<td>One Member resource is created.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><a class="reference internal" href="#resthowtouseapiimplementationofgetspecifiedresource"><span class="std std-ref">GET Member</span></a></td>
<td>GET</td>
<td><code class="docutils literal"><span class="pre">/api/v1/members/{memberId}</span></code></td>
<td><div class="first last line-block">
<div class="line">200</div>
<div class="line">(OK)</div>
</div>
</td>
<td>One Member resource is fetched.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><a class="reference internal" href="#resthowtouseapiimplementationofputspecifiedresource"><span class="std std-ref">PUT Member</span></a></td>
<td>PUT</td>
<td><code class="docutils literal"><span class="pre">/api/v1/members/{memberId}</span></code></td>
<td><div class="first last line-block">
<div class="line">200</div>
<div class="line">(OK)</div>
</div>
</td>
<td>One Member resource is updated.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><a class="reference internal" href="#resthowtouseapiimplementationofdeletespecifiedresource"><span class="std std-ref">DELETE Member</span></a></td>
<td>DELETE</td>
<td><code class="docutils literal"><span class="pre">/api/v1/members/{memberId}</span></code></td>
<td><div class="first last line-block">
<div class="line">204</div>
<div class="line">(No Content)</div>
</div>
</td>
<td>One Member resource is deleted.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>From Spring Framework 4.3, REST API for HEAD and OPTIONS methods is now implicitly provided,
so developers do not need to explicitly implement these REST APIs.</p>
<p class="last">Since the OPTIONS itself is not included in the Allow header that the implicitly prepared REST API for OPTIONS responds to,
please note that it differs from the implementation example introduced in the development guidelines up to TERASOLUNA Server Framework for Java 5.2.x.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="creating-rest-api-packages">
<span id="resthowtousepackage"></span><h4><a class="toc-backref" href="#id49">5.1.4.4.1. Creating REST API packages</a><a class="headerlink" href="#creating-rest-api-packages" title="Permalink to this headline">¶</a></h4>
<p>Create a package to store REST API class.</p>
<div class="line-block">
<div class="line">It is recommended to assign <code class="docutils literal"><span class="pre">api</span></code> as the package name for the root package that stores REST API class and to create a package for each resource (lower case of resource name) under the same.</div>
<div class="line">Resource name in the explanation is <code class="docutils literal"><span class="pre">Member</span></code>. Hence, the package name is <code class="docutils literal"><span class="pre">org.terasoluna.examples.rest.api.member</span></code>.</div>
</div>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Usually, following 4 types of classes are stored in the created package.
It is recommended to use the following naming rules for name of the class to be created.</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">[Resource</span> <span class="pre">name]Resource</span></code></li>
<li><code class="docutils literal"><span class="pre">[Resource</span> <span class="pre">name]RestController</span></code></li>
<li><code class="docutils literal"><span class="pre">[Resource</span> <span class="pre">name]Validator</span></code> (created when required)</li>
<li><code class="docutils literal"><span class="pre">[Resource</span> <span class="pre">name]Helper</span></code> (created when required)</li>
</ul>
<p>In the explanation, name of the resource is <code class="docutils literal"><span class="pre">Member</span></code>. As a result, the respective names will be as below.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">MemberResource</span></code></li>
<li><code class="docutils literal"><span class="pre">MemberRestController</span></code></li>
<li><code class="docutils literal"><span class="pre">MemberValidator</span></code></li>
<li><code class="docutils literal"><span class="pre">MemberHelper</span></code></li>
</ul>
</div></blockquote>
<p class="last">When handling a related resource, it is advisable to place the class for related resource also in the same package.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">It is recommended to create a package named <code class="docutils literal"><span class="pre">common</span></code> that stores common parts for REST API just under the root package that stores the REST API class and to create sub packages at functionality level.</div>
<div class="line">For example, a sub package that stores common parts which perform error handling is created with the name <code class="docutils literal"><span class="pre">error</span></code>.</div>
<div class="line">The class for exception handling created in the subsequent explanation, is stored in a package called <code class="docutils literal"><span class="pre">org.terasoluna.examples.rest.api.common.error</span></code>.</div>
</div>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As long as it is clear that the package is storing common parts, it can have a name other than <code class="docutils literal"><span class="pre">common</span></code>.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="creating-resource-class">
<span id="resthowtouseresourceclass"></span><h4><a class="toc-backref" href="#id50">5.1.4.4.2. Creating Resource class</a><a class="headerlink" href="#creating-resource-class" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">In this guideline, it is recommended to provide a Resource class as the class representing the resource published on Web (represent JSON or XML).</div>
</div>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Reasons for creating a Resource class</strong></p>
<p>The reason for creating a Resource class regardless of DomainObject class (for example, Entity class) being available is,
user interface information (UI) which is used in the I/O with client and information handled by business process do not necessarily match.</p>
<p class="last">If these are mixed and then used, the application layer may affect the domain layer, resulting in deteriorated maintainability.
It is recommended to create the DomainObject and Resource class separately and convert data by using BeanMapper like Dozer etc.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Role of Resource class is as follows:</p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="30%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Roles</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">To define the data structure of a resource.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define a data structure of the resource published on Web.</div>
<div class="line">Generally, it is very rare to publish the data structure managed by persistence layer of database etc. as it is, as a resource on Web.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">To define format.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a definition related to resource format using annotation.</div>
<div class="line">Annotation to be used differs according to the resource format (JSON/XML etc.). Jackson annotation is used for JSON format whereas JAXB annotation is used for XML format.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">To define input validation rules.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify input validation rules for single item of each field by using Bean Validation annotation.</div>
<div class="line">For input validation details, refer to “<a class="reference internal" href="../WebApplicationDetail/Validation.html"><span class="doc">Input Validation</span></a>” .</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>Measures to circular reference</strong></p>
<p>When you serialize a Resource class (JavaBean) in JSON or XML format and if property holds an object of cross reference relationship,
the <code class="docutils literal"><span class="pre">StackOverflowError</span></code> and <code class="docutils literal"><span class="pre">OutOfMemoryError</span></code> occur due to circular reference, hence it is necessary to exercise caution.</p>
<p>In order to avoid a circular reference,</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">&#64;com.fasterxml.jackson.annotation.JsonIgnore</span></code>  annotation to exclude the property from serialization in case of serialized in JSON format using the Jackson</li>
<li><code class="docutils literal"><span class="pre">&#64;javax.xml.bind.annotation.XmlTransient</span></code>  annotation to exclude the property from serialization in case of serialized in XML format using the JAXB</li>
</ul>
<p>can be added.</p>
<p>An example to exclude specific field from serialization while serializing in JSON format using Jackson is given below.</p>
<blockquote class="last">
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">orderId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">OrderLine</span><span class="o">&gt;</span> <span class="n">orderLines</span><span class="p">;</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderLine</span> <span class="p">{</span>
    <span class="nd">@JsonIgnore</span>
    <span class="kd">private</span> <span class="n">Order</span> <span class="n">order</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">itemCode</span><span class="p">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">quantity</span><span class="p">;</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Add <code class="docutils literal"><span class="pre">&#64;JsonIgnore</span></code> annotation to exclude the property from serialization.</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Example of Resource class creation is shown below.</p>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">MemberResource.java</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.member</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.Valid</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Null</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Past</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.hibernate.validator.constraints.Email</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.hibernate.validator.constraints.NotEmpty</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.joda.time.DateTime</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.joda.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.format.annotation.DateTimeFormat</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.codelist.ExistInCodeList</span><span class="p">;</span>

<span class="hll"><span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberResource</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

<span class="hll">    <span class="c1">// (2)</span>
</span><span class="hll">    <span class="kd">interface</span> <span class="nc">PostMembers</span> <span class="p">{</span>
</span><span class="hll">    <span class="p">}</span>
</span><span class="hll">
</span><span class="hll">    <span class="kd">interface</span> <span class="nc">PutMember</span> <span class="p">{</span>
</span><span class="hll">    <span class="p">}</span>
</span>
    <span class="nd">@Null</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="n">PostMembers</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="nd">@NotEmpty</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="n">PutMember</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">PutMember</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">memberId</span><span class="p">;</span>

    <span class="nd">@NotEmpty</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">max</span> <span class="o">=</span> <span class="mi">128</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">firstName</span><span class="p">;</span>

    <span class="nd">@NotEmpty</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">max</span> <span class="o">=</span> <span class="mi">128</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">lastName</span><span class="p">;</span>

    <span class="nd">@NotEmpty</span>
    <span class="nd">@ExistInCodeList</span><span class="p">(</span><span class="n">codeListId</span> <span class="o">=</span> <span class="s">&quot;CL_GENDER&quot;</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">genderCode</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Past</span>
    <span class="kd">private</span> <span class="n">LocalDate</span> <span class="n">dateOfBirth</span><span class="p">;</span>

    <span class="nd">@NotEmpty</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">max</span> <span class="o">=</span> <span class="mi">256</span><span class="p">)</span>
    <span class="nd">@Email</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">emailAddress</span><span class="p">;</span>

    <span class="nd">@Size</span><span class="p">(</span><span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">telephoneNumber</span><span class="p">;</span>

    <span class="nd">@Size</span><span class="p">(</span><span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">zipCode</span><span class="p">;</span>

    <span class="nd">@Size</span><span class="p">(</span><span class="n">max</span> <span class="o">=</span> <span class="mi">256</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">address</span><span class="p">;</span>

    <span class="nd">@NotNull</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="n">PostMembers</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="nd">@Null</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="n">PutMember</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="nd">@Valid</span>
<span class="hll">    <span class="c1">// (3)</span>
</span>    <span class="kd">private</span> <span class="n">MemberCredentialResource</span> <span class="n">credential</span><span class="p">;</span>

    <span class="nd">@Null</span>
    <span class="kd">private</span> <span class="n">DateTime</span> <span class="n">createdAt</span><span class="p">;</span>

    <span class="nd">@Null</span>
    <span class="kd">private</span> <span class="n">DateTime</span> <span class="n">lastModifiedAt</span><span class="p">;</span>

    <span class="c1">// omitted setter and getter</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JavaBean representing the Member resource.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The interface for specifying validation group of Bean Validation is defined.</div>
<div class="line">In this implementation, input validation is grouped, as different input validations are performed for POST and PUT methods.</div>
<div class="line">Refer to “<a class="reference internal" href="../WebApplicationDetail/Validation.html"><span class="doc">Input Validation</span></a>” for grouped validation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JavaBean with nested related resource is defined in the field.</div>
<div class="line">In this implementation, the member credentials (sign ID and password) are handled as related resources.</div>
<div class="line">These are extracted as related resources by considering operations that carry out only the sign ID change and password change.</div>
<div class="line">However, REST API implementation for related resources is omitted here.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">MemberCredentialResource.java</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.member</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Null</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.annotation.JsonInclude</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.hibernate.validator.constraints.Email</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.joda.time.DateTime</span><span class="p">;</span>

<span class="hll"><span class="c1">// (4)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberCredentialResource</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="nd">@Size</span><span class="p">(</span><span class="n">max</span> <span class="o">=</span> <span class="mi">256</span><span class="p">)</span>
    <span class="nd">@Email</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">signId</span><span class="p">;</span>

<span class="hll">    <span class="c1">// (5)</span>
</span>    <span class="nd">@JsonInclude</span><span class="p">(</span><span class="n">JsonInclude</span><span class="p">.</span><span class="na">Include</span><span class="p">.</span><span class="na">NON_NULL</span><span class="p">)</span>
    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="p">;</span>

    <span class="nd">@Null</span>
    <span class="kd">private</span> <span class="n">DateTime</span> <span class="n">passwordLastChangedAt</span><span class="p">;</span>

    <span class="nd">@Null</span>
    <span class="kd">private</span> <span class="n">DateTime</span> <span class="n">lastModifiedAt</span><span class="p">;</span>

    <span class="c1">// omitted setter and getter</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JavaBean that represents Credential resource which is the related resource of Member resource.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An annotation is specified so that the field itself is not output in JSON when the value is <code class="docutils literal"><span class="pre">null</span></code>.</div>
<div class="line">It is specified so that the field ‘password’ is not output in responding JSON.</div>
<div class="line">In the above example, it is restricted to (<code class="docutils literal"><span class="pre">Inclusion.NON_NULL</span></code>) for NULL value, however it can also be specified as (<code class="docutils literal"><span class="pre">Inclusion.NON_EMPTY</span></code>) in case of an empty value.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><div class="first line-block">
<div class="line">Adding the mapping definition of Bean</div>
<div class="line">In the subsequent implementations, Entity class and Resource class are copied by using “<a class="reference internal" href="../GeneralFuncDetail/Dozer.html"><span class="doc">Bean Mapping (Dozer)</span></a>” .</div>
<div class="line">Joda-Time classes namely, <code class="docutils literal"><span class="pre">org.joda.time.DateTime</span></code> and <code class="docutils literal"><span class="pre">org.joda.time.LocalDate</span></code> are included in the JavaBean shown above. However, Joda-Time objects are not correctly copied if “<a class="reference internal" href="../GeneralFuncDetail/Dozer.html"><span class="doc">Bean Mapping (Dozer)</span></a>” is used for copying.</div>
<div class="line">Therefore, it is necessary to apply “<a class="reference internal" href="#restappendixcopyjodaobjectbybeanconvert"><span class="std std-ref">How to copy Joda-Time classes using Dozer</span></a>” to copy the objects correctly.</div>
</div>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="creating-controller-class">
<span id="resthowtousecontrollerclass"></span><h4><a class="toc-backref" href="#id51">5.1.4.4.3. Creating Controller class</a><a class="headerlink" href="#creating-controller-class" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Create controller class for each resource.</div>
<div class="line">Refer to <a class="reference internal" href="#restappendixsorucecodesofmemberrestcontroller"><span class="std std-ref">Appendix</span></a> for the source code when implementation of all APIs is completed.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.member</span><span class="p">;</span>

<span class="c1">// omitted</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="p">;</span>
<span class="c1">// omitted</span>

<span class="hll"><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;members&quot;</span><span class="p">)</span> <span class="c1">// (1)</span>
</span><span class="hll"><span class="nd">@RestController</span> <span class="c1">// (2)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRestController</span> <span class="p">{</span>

    <span class="c1">// omitted ...</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Map resource collection URI (Servlet path) for Controller.</div>
<div class="line">Typically, specify a servlet path indicating a collection of resources in the value attribute of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.</div>
<div class="line">In the above example, a servlet path called <code class="docutils literal"><span class="pre">/api/v1/members</span></code> is mapped.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><p class="first">Assign <code class="docutils literal"><span class="pre">&#64;RestController</span></code> annotation for Controller.</p>
<p>Assigning <code class="docutils literal"><span class="pre">&#64;RestController</span></code> annotation has same meaning of:</p>
<ul class="simple">
<li>Assigning <code class="docutils literal"><span class="pre">org.springframework.stereotype.Controller</span></code> annotation in a class</li>
<li>Assigning <code class="docutils literal"><span class="pre">&#64;org.springframework.web.bind.annotation.ResponseBody</span></code> annotation in Controller method which is described later.</li>
</ul>
<p class="last">By assigning <code class="docutils literal"><span class="pre">&#64;ResponseBody</span></code> to Controller method, the returned Resource object is marshalled in JSON or XML and set in response body.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><code class="docutils literal"><span class="pre">&#64;RestController</span></code> is an annotation added from Spring Framework 4.0.</p>
<p>Due to <code class="docutils literal"><span class="pre">&#64;RestController</span></code> annotation, it is not necessary to assign <code class="docutils literal"><span class="pre">&#64;ResponseBody</span></code> annotation to each method of Controller.
Hence, it is possible to create Controller for REST API in a simple way.
For details about <code class="docutils literal"><span class="pre">&#64;RestController</span></code> annotation refer to: <a class="reference external" href="http://docs.spring.io/spring/docs/4.3.14.RELEASE/javadoc-api/org/springframework/web/bind/annotation/RestController.html">Here</a>.</p>
<p>An example to create a Controller for REST API by combining <code class="docutils literal"><span class="pre">&#64;Controller</span></code> annotation and <code class="docutils literal"><span class="pre">&#64;ResponseBody</span></code> annotation in a conventional way is given below.</p>
<blockquote class="last">
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;members&quot;</span><span class="p">)</span>
<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRestController</span> <span class="p">{</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>
    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
    <span class="nd">@ResponseBody</span>
    <span class="kd">public</span> <span class="n">Page</span><span class="o">&lt;</span><span class="n">MemberResource</span><span class="o">&gt;</span> <span class="nf">getMembers</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>

    <span class="c1">// ...</span>

<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-rest-api-that-fetches-collection-of-resources">
<span id="resthowtouseapiimplementationofgetcollection"></span><h4><a class="toc-backref" href="#id52">5.1.4.4.4. Implementing REST API that fetches collection of resources</a><a class="headerlink" href="#implementing-rest-api-that-fetches-collection-of-resources" title="Permalink to this headline">¶</a></h4>
<p>Example to implement the REST API wherein a page search is performed for member resource collection specified by URI.</p>
<ul>
<li><div class="first line-block">
<div class="line">Creating the JavaBean for receiving search conditions</div>
<div class="line">When search conditions are necessary to fetch resource collection, create a JavaBean for receiving the search conditions.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="hll"><span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MembersSearchQuery</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

<span class="hll">    <span class="c1">// (2)</span>
</span>    <span class="nd">@NotEmpty</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create a JavaBean for receiving search conditions.</div>
<div class="line">When search conditions are not necessary, JavaBean need not be created.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Match the property name with the parameter name of request parameter.</div>
<div class="line">In the above example, value <code class="docutils literal"><span class="pre">John</span></code> is set in the name property of JavaBean for request <code class="docutils literal"><span class="pre">/api/v1/members?name=John</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><div class="first line-block">
<div class="line">REST API implementation</div>
<div class="line">Implement a process wherein page search is performed for a collection of Member resources.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;members&quot;</span><span class="p">)</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRestController</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

    <span class="nd">@Inject</span>
    <span class="n">MemberService</span> <span class="n">memberService</span><span class="p">;</span>

    <span class="nd">@Inject</span>
    <span class="n">Mapper</span> <span class="n">beanMapper</span><span class="p">;</span>

<span class="hll">    <span class="c1">// (3)</span>
</span>    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>
<span class="hll">    <span class="c1">// (4)</span>
</span>    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Page</span><span class="o">&lt;</span><span class="n">MemberResource</span><span class="o">&gt;</span> <span class="nf">getMembers</span><span class="p">(</span>
<span class="hll">            <span class="c1">// (5)</span>
</span>            <span class="nd">@Validated</span> <span class="n">MembersSearchQuery</span> <span class="n">query</span><span class="p">,</span>
<span class="hll">            <span class="c1">// (6)</span>
</span>            <span class="n">Pageable</span> <span class="n">pageable</span><span class="p">)</span> <span class="p">{</span>

<span class="hll">        <span class="c1">// (7)</span>
</span>        <span class="n">Page</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">searchMembers</span><span class="p">(</span><span class="n">query</span><span class="p">.</span><span class="na">getName</span><span class="p">(),</span> <span class="n">pageable</span><span class="p">);</span>

<span class="hll">        <span class="c1">// (8)</span>
</span>        <span class="n">List</span><span class="o">&lt;</span><span class="n">MemberResource</span><span class="o">&gt;</span> <span class="n">memberResources</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Member</span> <span class="n">member</span> <span class="p">:</span> <span class="n">page</span><span class="p">.</span><span class="na">getContent</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">memberResources</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="n">Page</span><span class="o">&lt;</span><span class="n">MemberResource</span><span class="o">&gt;</span> <span class="n">responseResource</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PageImpl</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">memberResources</span><span class="p">,</span>
                <span class="n">pageable</span><span class="p">,</span> <span class="n">page</span><span class="p">.</span><span class="na">getTotalElements</span><span class="p">());</span>

<span class="hll">        <span class="c1">// (9)</span>
</span>        <span class="k">return</span> <span class="n">responseResource</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">RequestMethod.GET</span></code> in method attribute of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;org.springframework.web.bind.annotation.ResponseStatus</span></code> as method annotation and specify the status code returned as response.</div>
<div class="line">Set 200 (OK) in the value attribute of <code class="docutils literal"><span class="pre">&#64;ResponseStatus</span></code> annotation.</div>
</div>
<div class="last admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>How to specify the status code</strong></p>
<p>A fixed status code sent as response is specified in this example using <code class="docutils literal"><span class="pre">&#64;ResponseStatus</span></code> annotation. However, it can also be specified in Controller logic.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Page</span><span class="o">&lt;</span><span class="n">MemberResource</span><span class="o">&gt;&gt;</span> <span class="nf">getMembers</span><span class="p">(</span>
        <span class="nd">@Validated</span> <span class="n">MembersSearchQuery</span> <span class="n">query</span><span class="p">,</span>
        <span class="n">Pageable</span> <span class="n">pageable</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

    <span class="k">return</span> <span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">().</span><span class="na">body</span><span class="p">(</span><span class="n">responseResource</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p class="last">When it is necessary to change the responding status codes based on process details or process results, <code class="docutils literal"><span class="pre">org.springframework.http.ResponseEntity</span></code> is used, as shown in the above implementation.</p>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a JavaBean for receiving search conditions as an argument.</div>
<div class="line">When input validation is necessary, assign <code class="docutils literal"><span class="pre">&#64;Validated</span></code> as argument annotation. For input validation details, refer to “<a class="reference internal" href="../WebApplicationDetail/Validation.html"><span class="doc">Input Validation</span></a>”.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When page search is necessary, specify <code class="docutils literal"><span class="pre">org.springframework.data.domain.Pageable</span></code> as an argument.</div>
<div class="line">For page search details, refer to “<a class="reference internal" href="../WebApplicationDetail/Pagination.html"><span class="doc">Pagination</span></a>”.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call Service method of domain layer and fetch resource information (Entity etc.) matching with the condition.</div>
<div class="line">For domain layer implementation, refer to “<a class="reference internal" href="../../ImplementationAtEachLayer/DomainLayer.html"><span class="doc">Domain Layer Implementation</span></a>”.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(8)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Generate resource object that retains information published on the Web based on the resource information matching with the conditions (Entity etc.).</div>
<div class="line">By using <code class="docutils literal"><span class="pre">org.springframework.data.domain.PageImpl</span></code> class while sending page search result as response, the fields that are necessary as response at the time of page search, can be sent to the client.</div>
<div class="line"><br /></div>
<div class="line">In the above example, a Resource object is being generated from Entity by using Bean mapping library. For details on Bean mapping library, refer to “<a class="reference internal" href="../GeneralFuncDetail/Dozer.html"><span class="doc">Bean Mapping (Dozer)</span></a>” .</div>
<div class="line"><strong>When the quantity of code for generating Resource objects is more, it is recommended to create a method for generating Resource object in Helper class.</strong></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(9)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return a Resource object generated in (8).</div>
<div class="line">The object returned here is marshalled in JSON or XML and set in response body.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">Response at the time of using <code class="docutils literal"><span class="pre">PageImpl</span></code> class is as below.</div>
<div class="line">Highlighted portion shows the fields specific for page search.</div>
</div>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;content&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
    <span class="nt">&quot;memberId&quot;</span> <span class="p">:</span> <span class="s2">&quot;M000000001&quot;</span><span class="p">,</span>
    <span class="nt">&quot;firstName&quot;</span> <span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
    <span class="nt">&quot;lastName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Smith&quot;</span><span class="p">,</span>
    <span class="nt">&quot;genderCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;dateOfBirth&quot;</span> <span class="p">:</span> <span class="s2">&quot;1977-03-07&quot;</span><span class="p">,</span>
    <span class="nt">&quot;emailAddress&quot;</span> <span class="p">:</span> <span class="s2">&quot;john.smith@test.com&quot;</span><span class="p">,</span>
    <span class="nt">&quot;telephoneNumber&quot;</span> <span class="p">:</span> <span class="s2">&quot;09012345678&quot;</span><span class="p">,</span>
    <span class="nt">&quot;zipCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;1710051&quot;</span><span class="p">,</span>
    <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span>
    <span class="nt">&quot;credential&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;signId&quot;</span> <span class="p">:</span> <span class="s2">&quot;john.smit@test.com&quot;</span><span class="p">,</span>
      <span class="nt">&quot;passwordLastChangedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span><span class="p">,</span>
      <span class="nt">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;createdAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span><span class="p">,</span>
    <span class="nt">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span>
  <span class="p">},</span> <span class="p">{</span>
    <span class="nt">&quot;memberId&quot;</span> <span class="p">:</span> <span class="s2">&quot;M000000002&quot;</span><span class="p">,</span>
    <span class="nt">&quot;firstName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Sophia&quot;</span><span class="p">,</span>
    <span class="nt">&quot;lastName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Smith&quot;</span><span class="p">,</span>
    <span class="nt">&quot;genderCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
    <span class="nt">&quot;dateOfBirth&quot;</span> <span class="p">:</span> <span class="s2">&quot;1977-03-07&quot;</span><span class="p">,</span>
    <span class="nt">&quot;emailAddress&quot;</span> <span class="p">:</span> <span class="s2">&quot;sophia.smith@test.com&quot;</span><span class="p">,</span>
    <span class="nt">&quot;telephoneNumber&quot;</span> <span class="p">:</span> <span class="s2">&quot;09012345678&quot;</span><span class="p">,</span>
    <span class="nt">&quot;zipCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;1710051&quot;</span><span class="p">,</span>
    <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span>
    <span class="nt">&quot;credential&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;signId&quot;</span> <span class="p">:</span> <span class="s2">&quot;sophia.smith@test.com&quot;</span><span class="p">,</span>
      <span class="nt">&quot;passwordLastChangedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span><span class="p">,</span>
      <span class="nt">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;createdAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span><span class="p">,</span>
    <span class="nt">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span>
  <span class="p">}</span> <span class="p">],</span>
<span class="hll">  <span class="nt">&quot;last&quot;</span> <span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class="hll">  <span class="nt">&quot;totalPages&quot;</span> <span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
</span><span class="hll">  <span class="nt">&quot;totalElements&quot;</span> <span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
</span><span class="hll">  <span class="nt">&quot;size&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span class="hll">  <span class="nt">&quot;number&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class="hll">  <span class="nt">&quot;sort&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
</span><span class="hll">    <span class="nt">&quot;direction&quot;</span> <span class="p">:</span> <span class="s2">&quot;DESC&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="nt">&quot;property&quot;</span> <span class="p">:</span> <span class="s2">&quot;lastModifiedAt&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="nt">&quot;ignoreCase&quot;</span> <span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class="hll">    <span class="nt">&quot;nullHandling&quot;</span><span class="p">:</span> <span class="s2">&quot;NATIVE&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="nt">&quot;ascending&quot;</span> <span class="p">:</span> <span class="kc">false</span>
</span><span class="hll">  <span class="p">}</span> <span class="p">],</span>
</span><span class="hll">  <span class="nt">&quot;numberOfElements&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span class="hll">  <span class="nt">&quot;first&quot;</span> <span class="p">:</span> <span class="kc">false</span>
</span><span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Points to be noted due to changes in API specifications of Spring Data Commons</strong></p>
<p>In case of “terasoluna-gfw-common 5.0.0.RELEASE or later version” dependent spring-data-commons (1.9.1 RELEASE or later),
there is a change in API specifications of interface for page search functionality (<code class="docutils literal"><span class="pre">org.springframework.data.domain.Page</span></code>) and class (<code class="docutils literal"><span class="pre">org.springframework.data.domain.PageImpl</span></code> and <code class="docutils literal"><span class="pre">org.springframework.data.domain.Sort.Order</span></code>).</p>
<p>Specifically,</p>
<ul class="simple">
<li>In <code class="docutils literal"><span class="pre">Page</span></code> interface and <code class="docutils literal"><span class="pre">PageImpl</span></code> class, <code class="docutils literal"><span class="pre">isFirst()</span></code> and <code class="docutils literal"><span class="pre">isLast()</span></code> methods are added in spring-data-commons 1.8.0.RELEASE, and <code class="docutils literal"><span class="pre">isFirstPage()</span></code> and <code class="docutils literal"><span class="pre">isLastPage()</span></code> methods are deleted from spring-data-commons 1.9.0.RELEASE.</li>
<li>In <code class="docutils literal"><span class="pre">Sort.Order</span></code> class, <code class="docutils literal"><span class="pre">nullHandling</span></code> property is added in spring-data-commons 1.8.0.RELEASE.</li>
</ul>
<p class="last">When using <code class="docutils literal"><span class="pre">Page</span></code> interface (<code class="docutils literal"><span class="pre">PageImpl</span></code> class) as resource object of REST API,
that application may also need to be modified, as JSON and XML format get changed.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><div class="first line-block">
<div class="line">Adding Bean mapping definition</div>
<div class="line">In the above implementation, <code class="docutils literal"><span class="pre">Member</span></code> object and <code class="docutils literal"><span class="pre">MemberResource</span></code> object are copied by using “<a class="reference internal" href="../GeneralFuncDetail/Dozer.html"><span class="doc">Bean Mapping (Dozer)</span></a>” .</div>
<div class="line">It is not necessary to add Bean mapping definition when simply a copy of field value can be used. However, in the above implementation, the setting needs to be such that <code class="docutils literal"><span class="pre">credential.password</span></code> is not copied while copying <code class="docutils literal"><span class="pre">Member</span></code> object details to <code class="docutils literal"><span class="pre">MemberResource</span></code> object.</div>
<div class="line">It is necessary to add Bean mapping definition so that specific fields are not copied.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="hll"><span class="c">&lt;!-- (11) --&gt;</span>
</span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;mappings</span> <span class="na">xmlns=</span><span class="s">&quot;http://dozer.sourceforge.net&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://dozer.sourceforge.net</span>
<span class="s">          http://dozer.sourceforge.net/schema/beanmapping.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;mapping</span> <span class="na">type=</span><span class="s">&quot;one-way&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;class-a&gt;</span>org.terasoluna.examples.rest.domain.model.MemberCredential<span class="nt">&lt;/class-a&gt;</span>
        <span class="nt">&lt;class-b&gt;</span>org.terasoluna.examples.rest.api.member.MemberCredentialResource<span class="nt">&lt;/class-b&gt;</span>
<span class="hll">        <span class="c">&lt;!-- (12) --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;field-exclude&gt;</span>
</span><span class="hll">            <span class="nt">&lt;a&gt;</span>password<span class="nt">&lt;/a&gt;</span>
</span><span class="hll">            <span class="nt">&lt;b&gt;</span>password<span class="nt">&lt;/b&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/field-exclude&gt;</span>
</span>    <span class="nt">&lt;/mapping&gt;</span>

<span class="nt">&lt;/mappings&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(11)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create a file that defines mapping rules for <code class="docutils literal"><span class="pre">Member</span></code> object and <code class="docutils literal"><span class="pre">MemberResource</span></code> object.</div>
<div class="line">It is recommended to create a mapping definition file of Dozer for each resource.</div>
<div class="line"><br /></div>
<div class="line">In this implementation, it is stored in <code class="file docutils literal"><span class="pre">/xxx-web/src/main/resources/META-INF/dozer/memberResource-mapping.xml</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(12)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In the above example, <code class="docutils literal"><span class="pre">password</span></code> field is not copied while copying the details of <code class="docutils literal"><span class="pre">MemberCredential</span></code> which is a related entity of <code class="docutils literal"><span class="pre">Member</span></code>, to <code class="docutils literal"><span class="pre">MemberCredentialResource</span></code>, a related resource of <code class="docutils literal"><span class="pre">MemberResource</span></code>.</div>
<div class="line">For Bean mapping definition methods, refer to “<a class="reference internal" href="../GeneralFuncDetail/Dozer.html"><span class="doc">Bean Mapping (Dozer)</span></a>” .</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Request example</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="nf">GET</span> <span class="nn">/rest-api-web/api/v1/members?name=Smith&amp;page=0&amp;size=2</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span><span class="na">Accept</span><span class="o">:</span> <span class="l">text/plain, application/json, application/*+json, */*</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Java/1.7.0_51</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">localhost:8080</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Response Example</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">fb63a6d446f849feb8ccaa4c9a794333</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Thu, 13 Mar 2014 11:10:43 GMT</span>

<span class="p">{</span><span class="nt">&quot;content&quot;</span><span class="p">:[{</span><span class="nt">&quot;memberId&quot;</span><span class="p">:</span><span class="s2">&quot;M000000001&quot;</span><span class="p">,</span><span class="nt">&quot;firstName&quot;</span><span class="p">:</span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="nt">&quot;lastName&quot;</span><span class="p">:</span><span class="s2">&quot;Smith&quot;</span><span class="p">,</span><span class="nt">&quot;genderCode&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="nt">&quot;dateOfBirth&quot;</span><span class="p">:</span><span class="s2">&quot;2013-03-13&quot;</span><span class="p">,</span><span class="nt">&quot;emailAddress&quot;</span><span class="p">:</span><span class="s2">&quot;user1394709042120@test.com&quot;</span><span class="p">,</span><span class="nt">&quot;telephoneNumber&quot;</span><span class="p">:</span><span class="s2">&quot;09012345678&quot;</span><span class="p">,</span><span class="nt">&quot;zipCode&quot;</span><span class="p">:</span><span class="s2">&quot;1710051&quot;</span><span class="p">,</span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span><span class="nt">&quot;credential&quot;</span><span class="p">:{</span><span class="nt">&quot;signId&quot;</span><span class="p">:</span><span class="s2">&quot;user1394709042120@test.com&quot;</span><span class="p">,</span><span class="nt">&quot;passwordLastChangedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:10:43.066Z&quot;</span><span class="p">,</span><span class="nt">&quot;lastModifiedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:10:43.066Z&quot;</span><span class="p">},</span><span class="nt">&quot;createdAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:10:43.066Z&quot;</span><span class="p">,</span><span class="nt">&quot;lastModifiedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:10:43.066Z&quot;</span><span class="p">},{</span><span class="nt">&quot;memberId&quot;</span><span class="p">:</span><span class="s2">&quot;M000000002&quot;</span><span class="p">,</span><span class="nt">&quot;firstName&quot;</span><span class="p">:</span><span class="s2">&quot;Sophia&quot;</span><span class="p">,</span><span class="nt">&quot;lastName&quot;</span><span class="p">:</span><span class="s2">&quot;Smith&quot;</span><span class="p">,</span><span class="nt">&quot;genderCode&quot;</span><span class="p">:</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="nt">&quot;dateOfBirth&quot;</span><span class="p">:</span><span class="s2">&quot;2013-03-13&quot;</span><span class="p">,</span><span class="nt">&quot;emailAddress&quot;</span><span class="p">:</span><span class="s2">&quot;user1394709043663@test.com&quot;</span><span class="p">,</span><span class="nt">&quot;telephoneNumber&quot;</span><span class="p">:</span><span class="s2">&quot;09012345678&quot;</span><span class="p">,</span><span class="nt">&quot;zipCode&quot;</span><span class="p">:</span><span class="s2">&quot;1710051&quot;</span><span class="p">,</span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span><span class="nt">&quot;credential&quot;</span><span class="p">:{</span><span class="nt">&quot;signId&quot;</span><span class="p">:</span><span class="s2">&quot;user1394709043663@test.com&quot;</span><span class="p">,</span><span class="nt">&quot;passwordLastChangedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:10:43.678Z&quot;</span><span class="p">,</span><span class="nt">&quot;lastModifiedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:10:43.678Z&quot;</span><span class="p">},</span><span class="nt">&quot;createdAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:10:43.678Z&quot;</span><span class="p">,</span><span class="nt">&quot;lastModifiedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:10:43.678Z&quot;</span><span class="p">}],</span><span class="nt">&quot;last&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nt">&quot;totalPages&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="nt">&quot;totalElements&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="nt">&quot;number&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nt">&quot;sort&quot;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&quot;numberOfElements&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="nt">&quot;first&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<blockquote>
<div><div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>When page search is not necessary, Resource class list may be handled directly.</p>
<p>Following is the definition of the Controller method used when handling the list of Resource class directly.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>
<span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">MemberResource</span><span class="o">&gt;</span> <span class="nf">getMembers</span><span class="p">(</span>
</span>        <span class="nd">@Validated</span> <span class="n">MembersSearchQuery</span> <span class="n">query</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// omitted</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>JSON is as follows when list of Resource class is directly handled.</p>
<blockquote class="last">
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="p">{</span>
    <span class="nt">&quot;memberId&quot;</span> <span class="p">:</span> <span class="s2">&quot;M000000001&quot;</span><span class="p">,</span>
    <span class="nt">&quot;firstName&quot;</span> <span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
    <span class="nt">&quot;lastName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Smith&quot;</span><span class="p">,</span>
    <span class="nt">&quot;genderCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;dateOfBirth&quot;</span> <span class="p">:</span> <span class="s2">&quot;1977-03-07&quot;</span><span class="p">,</span>
    <span class="nt">&quot;emailAddress&quot;</span> <span class="p">:</span> <span class="s2">&quot;john.smith@test.com&quot;</span><span class="p">,</span>
    <span class="nt">&quot;telephoneNumber&quot;</span> <span class="p">:</span> <span class="s2">&quot;09012345678&quot;</span><span class="p">,</span>
    <span class="nt">&quot;zipCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;1710051&quot;</span><span class="p">,</span>
    <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span>
    <span class="nt">&quot;credential&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;signId&quot;</span> <span class="p">:</span> <span class="s2">&quot;john.smit@test.com&quot;</span><span class="p">,</span>
      <span class="nt">&quot;passwordLastChangedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span><span class="p">,</span>
      <span class="nt">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;createdAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span><span class="p">,</span>
    <span class="nt">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="nt">&quot;memberId&quot;</span> <span class="p">:</span> <span class="s2">&quot;M000000002&quot;</span><span class="p">,</span>
    <span class="nt">&quot;firstName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Sophia&quot;</span><span class="p">,</span>
    <span class="nt">&quot;lastName&quot;</span> <span class="p">:</span> <span class="s2">&quot;Smith&quot;</span><span class="p">,</span>
    <span class="nt">&quot;genderCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
    <span class="nt">&quot;dateOfBirth&quot;</span> <span class="p">:</span> <span class="s2">&quot;1977-03-07&quot;</span><span class="p">,</span>
    <span class="nt">&quot;emailAddress&quot;</span> <span class="p">:</span> <span class="s2">&quot;sophia.smith@test.com&quot;</span><span class="p">,</span>
    <span class="nt">&quot;telephoneNumber&quot;</span> <span class="p">:</span> <span class="s2">&quot;09012345678&quot;</span><span class="p">,</span>
    <span class="nt">&quot;zipCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;1710051&quot;</span><span class="p">,</span>
    <span class="nt">&quot;address&quot;</span> <span class="p">:</span> <span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span>
    <span class="nt">&quot;credential&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;signId&quot;</span> <span class="p">:</span> <span class="s2">&quot;sophia.smith@test.com&quot;</span><span class="p">,</span>
      <span class="nt">&quot;passwordLastChangedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span><span class="p">,</span>
      <span class="nt">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;createdAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span><span class="p">,</span>
    <span class="nt">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s2">&quot;2014-03-13T10:18:08.003Z&quot;</span>
<span class="p">}</span> <span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-rest-api-that-adds-a-resource-to-collection">
<span id="resthowtouseapiimplementationofpostcollection"></span><h4><a class="toc-backref" href="#id53">5.1.4.4.5. Implementing REST API that adds a resource to collection</a><a class="headerlink" href="#implementing-rest-api-that-adds-a-resource-to-collection" title="Permalink to this headline">¶</a></h4>
<p>Example of implementation of REST API wherein a specified Member resource is created and added to the collection is given below.</p>
<ul>
<li><div class="first line-block">
<div class="line">REST API implementation</div>
<div class="line">Implement a process that creates specified Member resource and adds it to the collection.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;members&quot;</span><span class="p">)</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRestController</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (1)</span>
</span>    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">)</span>
<span class="hll">    <span class="c1">// (2)</span>
</span>    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">CREATED</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">MemberResource</span> <span class="nf">postMember</span><span class="p">(</span>
<span class="hll">            <span class="c1">// (3)</span>
</span>            <span class="nd">@RequestBody</span> <span class="nd">@Validated</span><span class="p">({</span> <span class="n">PostMembers</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
            <span class="n">MemberResource</span> <span class="n">requestedResource</span><span class="p">)</span> <span class="p">{</span>

<span class="hll">        <span class="c1">// (4)</span>
</span>        <span class="n">Member</span> <span class="n">inputMember</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">requestedResource</span><span class="p">,</span> <span class="n">Member</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
        <span class="n">Member</span> <span class="n">createdMember</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">createMember</span><span class="p">(</span><span class="n">inputMember</span><span class="p">);</span>

        <span class="n">MemberResource</span> <span class="n">responseResource</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">createdMember</span><span class="p">,</span>
                <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">responseResource</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">RequestMethod.POST</span></code> in the method attribute of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;ResponseStatus</span></code> annotation as method annotation and specify responding status code.</div>
<div class="line">Set <strong>201(Created)</strong> in the value attribute of <code class="docutils literal"><span class="pre">&#64;ResponseStatus</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify JavaBean (Resource class) that receives information of newly created resource as an argument.</div>
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;org.springframework.web.bind.annotation.RequestBody</span></code> as argument annotation.</div>
<div class="line">By assigning <code class="docutils literal"><span class="pre">&#64;RequestBody</span></code> annotation, JSON or XML data set in request Body is unmarshalled in Resource object.</div>
<div class="line"><br /></div>
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation as argument annotation to enable input validation. For details on input validation, refer to “<a class="reference internal" href="../WebApplicationDetail/Validation.html"><span class="doc">Input Validation</span></a>” .</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call Service method of domain layer and create a new resource.</div>
<div class="line">For domain layer implementation, refer to “<a class="reference internal" href="../../ImplementationAtEachLayer/DomainLayer.html"><span class="doc">Domain Layer Implementation</span></a>”.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Request example</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="nf">POST</span> <span class="nn">/rest-api-web/api/v1/members</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span><span class="na">Accept</span><span class="o">:</span> <span class="l">text/plain, application/json, application/*+json, */*</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Java/1.7.0_51</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">localhost:8080</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">248</span>

<span class="p">{</span><span class="nt">&quot;firstName&quot;</span><span class="p">:</span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="nt">&quot;lastName&quot;</span><span class="p">:</span><span class="s2">&quot;Smith&quot;</span><span class="p">,</span><span class="nt">&quot;genderCode&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="nt">&quot;dateOfBirth&quot;</span><span class="p">:</span><span class="s2">&quot;2013-03-13&quot;</span><span class="p">,</span><span class="nt">&quot;emailAddress&quot;</span><span class="p">:</span><span class="s2">&quot;user1394708306056@test.com&quot;</span><span class="p">,</span><span class="nt">&quot;telephoneNumber&quot;</span><span class="p">:</span><span class="s2">&quot;09012345678&quot;</span><span class="p">,</span><span class="nt">&quot;zipCode&quot;</span><span class="p">:</span><span class="s2">&quot;1710051&quot;</span><span class="p">,</span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span><span class="nt">&quot;credential&quot;</span><span class="p">:{</span><span class="nt">&quot;signId&quot;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&quot;password&quot;</span><span class="p">:</span><span class="s2">&quot;zaq12wsx&quot;</span><span class="p">}}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Response example</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">c7e9c8a9aa4f40ff87f3acdb77baccdf</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Thu, 13 Mar 2014 10:58:26 GMT</span>

<span class="p">{</span><span class="nt">&quot;memberId&quot;</span><span class="p">:</span><span class="s2">&quot;M000000023&quot;</span><span class="p">,</span><span class="nt">&quot;firstName&quot;</span><span class="p">:</span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="nt">&quot;lastName&quot;</span><span class="p">:</span><span class="s2">&quot;Smith&quot;</span><span class="p">,</span><span class="nt">&quot;genderCode&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="nt">&quot;dateOfBirth&quot;</span><span class="p">:</span><span class="s2">&quot;2013-03-13&quot;</span><span class="p">,</span><span class="nt">&quot;emailAddress&quot;</span><span class="p">:</span><span class="s2">&quot;user1394708306056@test.com&quot;</span><span class="p">,</span><span class="nt">&quot;telephoneNumber&quot;</span><span class="p">:</span><span class="s2">&quot;09012345678&quot;</span><span class="p">,</span><span class="nt">&quot;zipCode&quot;</span><span class="p">:</span><span class="s2">&quot;1710051&quot;</span><span class="p">,</span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span><span class="nt">&quot;credential&quot;</span><span class="p">:{</span><span class="nt">&quot;signId&quot;</span><span class="p">:</span><span class="s2">&quot;user1394708306056@test.com&quot;</span><span class="p">,</span><span class="nt">&quot;passwordLastChangedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T10:58:26.324Z&quot;</span><span class="p">,</span><span class="nt">&quot;lastModifiedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T10:58:26.324Z&quot;</span><span class="p">},</span><span class="nt">&quot;createdAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T10:58:26.324Z&quot;</span><span class="p">,</span><span class="nt">&quot;lastModifiedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T10:58:26.324Z&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-rest-api-that-fetches-specified-resource">
<span id="resthowtouseapiimplementationofgetspecifiedresource"></span><h4><a class="toc-backref" href="#id54">5.1.4.4.6. Implementing REST API that fetches specified resource</a><a class="headerlink" href="#implementing-rest-api-that-fetches-specified-resource" title="Permalink to this headline">¶</a></h4>
<p>Implementation of REST API that fetches the Member resource specified by URI, is shown below.</p>
<ul>
<li><div class="first line-block">
<div class="line">REST API implementation</div>
<div class="line">Implement a process that fetches the Member resource specified by URI.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;members&quot;</span><span class="p">)</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRestController</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (1)</span>
</span>    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;{memberId}&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>
<span class="hll">    <span class="c1">// (2)</span>
</span>    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">MemberResource</span> <span class="nf">getMember</span><span class="p">(</span>
<span class="hll">            <span class="c1">// (3)</span>
</span>            <span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&quot;memberId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">memberId</span><span class="p">)</span> <span class="p">{</span>

<span class="hll">        <span class="c1">// (4)</span>
</span>        <span class="n">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">getMember</span><span class="p">(</span><span class="n">memberId</span><span class="p">);</span>

        <span class="n">MemberResource</span> <span class="n">responseResource</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">member</span><span class="p">,</span>
                <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">responseResource</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify path variable (<code class="docutils literal"><span class="pre">{memberId}</span></code> in the example above) in value attribute whereas <code class="docutils literal"><span class="pre">RequestMethod.GET</span></code> in method attribute of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.</div>
<div class="line">A value that uniquely identifies the resource is specified in <code class="docutils literal"><span class="pre">{memberId}</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;ResponseStatus</span></code> annotation as method annotation and specify the responding status code.</div>
<div class="line">Set 200 (OK) in value attribute of <code class="docutils literal"><span class="pre">&#64;ResponseStatus</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Fetch the value that uniquely identifies the resource from path variable.</div>
<div class="line">Value specified in path variable (<code class="docutils literal"><span class="pre">{memberId}</span></code>) can be received as method argument by specifying <code class="docutils literal"><span class="pre">&#64;PathVariable(&quot;memberId&quot;)</span></code> as argument annotation.</div>
<div class="line">For details on path variable, refer to “<a class="reference internal" href="../../ImplementationAtEachLayer/ApplicationLayer.html#controller-method-argument-pathvariable-label"><span class="std std-ref">Retrieving values from URL path</span></a>”.</div>
<div class="line">In the above example, when URI is <code class="docutils literal"><span class="pre">/api/v1/members/M12345</span></code>, <code class="docutils literal"><span class="pre">M12345</span></code> is stored in <code class="docutils literal"><span class="pre">memberId</span></code> of argument.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call Service method of domain layer and acquire the resource information (Entity etc.) that matches with the ID fetched from path variable.</div>
<div class="line">For domain layer implementation, refer to “<a class="reference internal" href="../../ImplementationAtEachLayer/DomainLayer.html"><span class="doc">Domain Layer Implementation</span></a>”.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Request example</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="nf">GET</span> <span class="nn">/rest-api-web/api/v1/members/M000000003</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span><span class="na">Accept</span><span class="o">:</span> <span class="l">text/plain, application/json, application/*+json, */*</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Java/1.7.0_51</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">localhost:8080</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Response Example</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">275b4e7a61f946eea47672f272315ac2</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Thu, 13 Mar 2014 11:25:13 GMT</span>

<span class="p">{</span><span class="nt">&quot;memberId&quot;</span><span class="p">:</span><span class="s2">&quot;M000000003&quot;</span><span class="p">,</span><span class="nt">&quot;firstName&quot;</span><span class="p">:</span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="nt">&quot;lastName&quot;</span><span class="p">:</span><span class="s2">&quot;Smith&quot;</span><span class="p">,</span><span class="nt">&quot;genderCode&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="nt">&quot;dateOfBirth&quot;</span><span class="p">:</span><span class="s2">&quot;2013-03-13&quot;</span><span class="p">,</span><span class="nt">&quot;emailAddress&quot;</span><span class="p">:</span><span class="s2">&quot;user1394709913496@test.com&quot;</span><span class="p">,</span><span class="nt">&quot;telephoneNumber&quot;</span><span class="p">:</span><span class="s2">&quot;09012345678&quot;</span><span class="p">,</span><span class="nt">&quot;zipCode&quot;</span><span class="p">:</span><span class="s2">&quot;1710051&quot;</span><span class="p">,</span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span><span class="nt">&quot;credential&quot;</span><span class="p">:{</span><span class="nt">&quot;signId&quot;</span><span class="p">:</span><span class="s2">&quot;user1394709913496@test.com&quot;</span><span class="p">,</span><span class="nt">&quot;passwordLastChangedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:25:13.762Z&quot;</span><span class="p">,</span><span class="nt">&quot;lastModifiedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:25:13.762Z&quot;</span><span class="p">},</span><span class="nt">&quot;createdAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:25:13.762Z&quot;</span><span class="p">,</span><span class="nt">&quot;lastModifiedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:25:13.762Z&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-rest-api-that-updates-specified-resource">
<span id="resthowtouseapiimplementationofputspecifiedresource"></span><h4><a class="toc-backref" href="#id55">5.1.4.4.7. Implementing REST API that updates specified resource</a><a class="headerlink" href="#implementing-rest-api-that-updates-specified-resource" title="Permalink to this headline">¶</a></h4>
<p>Implementation of REST API that updates the Member resource specified in URI, is shown below.</p>
<ul>
<li><div class="first line-block">
<div class="line">REST API implementation</div>
<div class="line">Implement a process that updates the Member resource specified in URI.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;members&quot;</span><span class="p">)</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRestController</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (1)</span>
</span>    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;{memberId}&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">PUT</span><span class="p">)</span>
<span class="hll">    <span class="c1">// (2)</span>
</span>    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">MemberResource</span> <span class="nf">putMember</span><span class="p">(</span>
            <span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&quot;memberId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">memberId</span><span class="p">,</span>
<span class="hll">            <span class="c1">// (3)</span>
</span>            <span class="nd">@RequestBody</span> <span class="nd">@Validated</span><span class="p">({</span> <span class="n">PutMember</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
            <span class="n">MemberResource</span> <span class="n">requestedResource</span><span class="p">)</span> <span class="p">{</span>

<span class="hll">        <span class="c1">// (4)</span>
</span>        <span class="n">Member</span> <span class="n">inputMember</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span>
            <span class="n">requestedResource</span><span class="p">,</span> <span class="n">Member</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
        <span class="n">Member</span> <span class="n">updatedMember</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">updateMember</span><span class="p">(</span>
            <span class="n">memberId</span><span class="p">,</span> <span class="n">inputMember</span><span class="p">);</span>

        <span class="n">MemberResource</span> <span class="n">responseResource</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">updatedMember</span><span class="p">,</span>
                <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">responseResource</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify path variable (<code class="docutils literal"><span class="pre">{memberId}</span></code>in the example above) in value attribute whereas <code class="docutils literal"><span class="pre">RequestMethod.PUT</span></code> in “method” attribute of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.</div>
<div class="line">Value that uniquely identifies the resource is specified in <code class="docutils literal"><span class="pre">{memberId}</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;ResponseStatus</span></code>annotation as method annotation and specify the responding status code.</div>
<div class="line">Set 200 (OK) in value attribute of <code class="docutils literal"><span class="pre">&#64;ResponseStatus</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify JavaBean (Resource class) for receiving the details of resource update as an argument.</div>
<div class="line">By assigning <code class="docutils literal"><span class="pre">&#64;RequestBody</span></code> annotation as argument annotation, JSON or XML data set in request Body is unmarshalled in Resource object.</div>
<div class="line"><br /></div>
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation as argument annotation to enable input validation.</div>
<div class="line">For details on input validation, refer to “<a class="reference internal" href="../WebApplicationDetail/Validation.html"><span class="doc">Input Validation</span></a>” .</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call Service method of domain layer and update the resource information (Entity etc.) matching with the ID fetched from path variable.</div>
<div class="line">For domain layer implementation, refer to “<a class="reference internal" href="../../ImplementationAtEachLayer/DomainLayer.html"><span class="doc">Domain Layer Implementation</span></a>”.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Request example</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="nf">PUT</span> <span class="nn">/rest-api-web/api/v1/members/M000000004</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span><span class="na">Accept</span><span class="o">:</span> <span class="l">text/plain, application/json, application/*+json, */*</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Java/1.7.0_51</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">localhost:8080</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">221</span>

<span class="p">{</span><span class="nt">&quot;memberId&quot;</span><span class="p">:</span><span class="s2">&quot;M000000004&quot;</span><span class="p">,</span><span class="nt">&quot;firstName&quot;</span><span class="p">:</span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="nt">&quot;lastName&quot;</span><span class="p">:</span><span class="s2">&quot;Smith&quot;</span><span class="p">,</span><span class="nt">&quot;genderCode&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="nt">&quot;dateOfBirth&quot;</span><span class="p">:</span><span class="s2">&quot;2013-03-08&quot;</span><span class="p">,</span><span class="nt">&quot;emailAddress&quot;</span><span class="p">:</span><span class="s2">&quot;user1394710559584@test.com&quot;</span><span class="p">,</span><span class="nt">&quot;telephoneNumber&quot;</span><span class="p">:</span><span class="s2">&quot;09012345678&quot;</span><span class="p">,</span><span class="nt">&quot;zipCode&quot;</span><span class="p">:</span><span class="s2">&quot;1710051&quot;</span><span class="p">,</span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;Tokyo&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Response example</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">5e8fea3aae044e94bf20a293e155af57</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Thu, 13 Mar 2014 11:35:59 GMT</span>

<span class="p">{</span><span class="nt">&quot;memberId&quot;</span><span class="p">:</span><span class="s2">&quot;M000000004&quot;</span><span class="p">,</span><span class="nt">&quot;firstName&quot;</span><span class="p">:</span><span class="s2">&quot;John&quot;</span><span class="p">,</span><span class="nt">&quot;lastName&quot;</span><span class="p">:</span><span class="s2">&quot;Smith&quot;</span><span class="p">,</span><span class="nt">&quot;genderCode&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="nt">&quot;dateOfBirth&quot;</span><span class="p">:</span><span class="s2">&quot;2013-03-08&quot;</span><span class="p">,</span><span class="nt">&quot;emailAddress&quot;</span><span class="p">:</span><span class="s2">&quot;user1394710559584@test.com&quot;</span><span class="p">,</span><span class="nt">&quot;telephoneNumber&quot;</span><span class="p">:</span><span class="s2">&quot;09012345678&quot;</span><span class="p">,</span><span class="nt">&quot;zipCode&quot;</span><span class="p">:</span><span class="s2">&quot;1710051&quot;</span><span class="p">,</span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;Tokyo&quot;</span><span class="p">,</span><span class="nt">&quot;credential&quot;</span><span class="p">:{</span><span class="nt">&quot;signId&quot;</span><span class="p">:</span><span class="s2">&quot;user1394710559584@test.com&quot;</span><span class="p">,</span><span class="nt">&quot;passwordLastChangedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:35:59.847Z&quot;</span><span class="p">,</span><span class="nt">&quot;lastModifiedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:35:59.847Z&quot;</span><span class="p">},</span><span class="nt">&quot;createdAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:35:59.847Z&quot;</span><span class="p">,</span><span class="nt">&quot;lastModifiedAt&quot;</span><span class="p">:</span><span class="s2">&quot;2014-03-13T11:36:00.122Z&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-rest-api-that-deletes-specified-resource">
<span id="resthowtouseapiimplementationofdeletespecifiedresource"></span><h4><a class="toc-backref" href="#id56">5.1.4.4.8. Implementing REST API that deletes specified resource</a><a class="headerlink" href="#implementing-rest-api-that-deletes-specified-resource" title="Permalink to this headline">¶</a></h4>
<p>Implementation of REST API that deletes the Member resource specified by URI is as follows:</p>
<ul>
<li><div class="first line-block">
<div class="line">REST API implementation</div>
<div class="line">Implement a process that deletes the Member resource specified by URI.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;members&quot;</span><span class="p">)</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRestController</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (1)</span>
</span>    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;{memberId}&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">DELETE</span><span class="p">)</span>
<span class="hll">    <span class="c1">// (2)</span>
</span>    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">NO_CONTENT</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteMember</span><span class="p">(</span>
            <span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&quot;memberId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">memberId</span><span class="p">)</span> <span class="p">{</span>

<span class="hll">        <span class="c1">// (3)</span>
</span>        <span class="n">memberService</span><span class="p">.</span><span class="na">deleteMember</span><span class="p">(</span><span class="n">memberId</span><span class="p">);</span>

    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify path variable (<code class="docutils literal"><span class="pre">{memberId}</span></code>in the example above) in value attribute and <code class="docutils literal"><span class="pre">RequestMethod.DELETE</span></code> in method attribute of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;ResponseStatus</span></code> annotation as method annotation and specify the responding status code.</div>
<div class="line">Set <strong>204 (NO_CONTENT)</strong> in value attribute of <code class="docutils literal"><span class="pre">&#64;ResponseStatus</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call Service method of domain layer and delete resource information (Entity etc.) matching with the ID fetched from path variable.</div>
<div class="line">For domain layer implementation, refer to “<a class="reference internal" href="../../ImplementationAtEachLayer/DomainLayer.html"><span class="doc">Domain Layer Implementation</span></a>”.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To set deleted resource information in response BODY, set (200) OK in the status code.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Request example</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="nf">DELETE</span> <span class="nn">/rest-api-web/api/v1/members/M000000005</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span><span class="na">Accept</span><span class="o">:</span> <span class="l">text/plain, application/json, application/*+json, */*</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Java/1.7.0_51</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">localhost:8080</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Response example</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">204</span> <span class="ne">No Content</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">e06c5bd40c864a299c48d9be3f12b2c0</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Thu, 13 Mar 2014 11:40:05 GMT</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="implementing-exception-handling">
<span id="resthowtouseexceptionhandling"></span><h3><a class="toc-backref" href="#id57">5.1.4.5. Implementing exception handling</a><a class="headerlink" href="#implementing-exception-handling" title="Permalink to this headline">¶</a></h3>
<p>How to handle the exceptions occurring in RESTful Web Service is explained below.</p>
<div class="line-block">
<div class="line">RESTful Web Service oriented generic exception handling feature is not provided in Spring MVC.</div>
<div class="line">Alternately, (<code class="docutils literal"><span class="pre">org.springframework.web.servlet.mvc.method.annotation.ResponseEntityExceptionHandler</span></code>) is provided as the class that assists in implementing exception handling for RESTful Web Service.</div>
<div class="line">This guideline recommends a common exception handling method, by creating an exception handling class that inherits the Spring MVC class and assigning <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation to this exception handling class.</div>
</div>
<div class="line-block">
<div class="line">Method that handles exceptions in Spring MVC framework is implemented in advance in <code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code> by using <code class="docutils literal"><span class="pre">&#64;ExceptionHandler</span></code> annotation.</div>
<div class="line">Therefore, individual handling of the exceptions in Spring MVC framework need not be implemented.</div>
<div class="line">Further, HTTP status codes corresponding to the exceptions handled by <code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code> are set by the same specifications as <code class="docutils literal"><span class="pre">DefaultHandlerExceptionResolver</span></code>.</div>
<div class="line">For handled exceptions and HTTP status codes thus set, refer to “<a class="reference internal" href="../WebApplicationDetail/ExceptionHandling.html#exception-handling-appendix-defaulthandlerexceptionresolver-label"><span class="std std-ref">HTTP response code set by DefaultHandlerExceptionResolver</span></a>”.</div>
</div>
<div class="line-block">
<div class="line">Although an empty response BODY is returned by default implementation of <code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code>, it can be extended so as to output error information in the response Body.</div>
<div class="line">This guideline recommends to output appropriate error information in the response Body.</div>
</div>
<div class="line-block">
<div class="line">Process flow wherein, exception handling class that inherits <code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code> is created  and common exception handling is performed, is described before explaining the typical implementation.</div>
<div class="line">Please note that, separate implementation is required for the part marked in red frame.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../../_images/RESTHowToUseExceptionHandling.png"><img alt="Image of exception handling by Spring MVC" src="../../_images/RESTHowToUseExceptionHandling.png" style="width: 100%;" /></a>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Processing layer</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC</div>
<div class="line">(Framework)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC receives a request from client and calls REST API.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An exception occurs during REST API process.</div>
<div class="line">The exception occurred is caught by Spring MVC.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC delegates the process to exception handling class.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Custom Exception Handler</div>
<div class="line">(Common Component)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An error object that retains error information is generated in the exception handling class and returned to Spring MVC.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC</div>
<div class="line">(Framework)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC converts the error object to JSON format message using <code class="docutils literal"><span class="pre">HttpMessageConverter</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC sets the JSON format error message in response BODY and sends response to the client.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="implementation-to-output-error-information-in-response-body">
<span id="resthowtouseexceptionhandlingforerrorcontentinresponsebody"></span><h4><a class="toc-backref" href="#id58">5.1.4.5.1. Implementation to output error information in response Body</a><a class="headerlink" href="#implementation-to-output-error-information-in-response-body" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Error information should be in the following JSON format.</li>
</ul>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;code&quot;</span> <span class="p">:</span> <span class="s2">&quot;e.ex.fw.7001&quot;</span><span class="p">,</span>
  <span class="nt">&quot;message&quot;</span> <span class="p">:</span> <span class="s2">&quot;Validation error occurred on item in the request body.&quot;</span><span class="p">,</span>
  <span class="nt">&quot;details&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
    <span class="nt">&quot;code&quot;</span> <span class="p">:</span> <span class="s2">&quot;ExistInCodeList&quot;</span><span class="p">,</span>
    <span class="nt">&quot;message&quot;</span> <span class="p">:</span> <span class="s2">&quot;\&quot;genderCode\&quot; must exist in code list of CL_GENDER.&quot;</span><span class="p">,</span>
    <span class="nt">&quot;target&quot;</span> <span class="p">:</span> <span class="s2">&quot;genderCode&quot;</span>
  <span class="p">}</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Create JavaBean that retains error information.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.common.error</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.annotation.JsonInclude</span><span class="p">;</span>

<span class="hll"><span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiError</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">code</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">message</span><span class="p">;</span>

    <span class="nd">@JsonInclude</span><span class="p">(</span><span class="n">JsonInclude</span><span class="p">.</span><span class="na">Include</span><span class="p">.</span><span class="na">NON_EMPTY</span><span class="p">)</span>
<span class="hll">    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">target</span><span class="p">;</span> <span class="c1">// (2)</span>
</span>
    <span class="nd">@JsonInclude</span><span class="p">(</span><span class="n">JsonInclude</span><span class="p">.</span><span class="na">Include</span><span class="p">.</span><span class="na">NON_EMPTY</span><span class="p">)</span>
<span class="hll">    <span class="kd">private</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ApiError</span><span class="o">&gt;</span> <span class="n">details</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span> <span class="c1">// (3)</span>
</span>
    <span class="kd">public</span> <span class="nf">ApiError</span><span class="p">(</span><span class="n">String</span> <span class="n">code</span><span class="p">,</span> <span class="n">String</span> <span class="n">message</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">ApiError</span><span class="p">(</span><span class="n">String</span> <span class="n">code</span><span class="p">,</span> <span class="n">String</span> <span class="n">message</span><span class="p">,</span> <span class="n">String</span> <span class="n">target</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">code</span> <span class="o">=</span> <span class="n">code</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">target</span> <span class="o">=</span> <span class="n">target</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getCode</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">code</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMessage</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">message</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTarget</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">target</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ApiError</span><span class="o">&gt;</span> <span class="nf">getDetails</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">details</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addDetail</span><span class="p">(</span><span class="n">ApiError</span> <span class="n">detail</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">details</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">detail</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create a class for retaining error information.</div>
<div class="line">In the above example, it is the class that retains lists of error codes, error messages, error targets and detailed error information.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Field that retains the value for identifying the target where error has occurred.</div>
<div class="line">When an error occurs in input validation, there are cases where the value that identifies the field where error has occurred needs to be returned to the client.</div>
<div class="line">In such cases, it is necessary to set a field that retains the field name where error has occurred.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Field that retains the list of detailed error information.</div>
<div class="line">When an error occurs in input validation, it is necessary to return all the error information to the client as there are cases with multiple error causes.</div>
<div class="line">In such cases, a field that lists and retains detailed error information is necessary.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">When the value is <code class="docutils literal"><span class="pre">null</span></code> or empty, it is possible to avoid fields being output to JSON  by specifying <code class="docutils literal"><span class="pre">&#64;JsonInclude(JsonInclude.Include.NON_EMPTY)</span></code> in the field.
When the condition to disable field output is to be restricted to <code class="docutils literal"><span class="pre">null</span></code>, it is advisable to specify <code class="docutils literal"><span class="pre">&#64;JsonInclude(JsonInclude.Include.NON_NULL)</span></code>.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Create a class for generating JavaBean that retains error information.</li>
</ul>
<blockquote>
<div><p>Refer to <a class="reference internal" href="#restappendixsorucecodesofapierrorcreator"><span class="std std-ref">Appendix</span></a> for the source code when implementation of all exception handling is completed.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="hll"><span class="c1">// (4)</span>
</span><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiErrorCreator</span> <span class="p">{</span>

    <span class="nd">@Inject</span>
    <span class="n">MessageSource</span> <span class="n">messageSource</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">ApiError</span> <span class="nf">createApiError</span><span class="p">(</span><span class="n">WebRequest</span> <span class="n">request</span><span class="p">,</span> <span class="n">String</span> <span class="n">errorCode</span><span class="p">,</span>
            <span class="n">String</span> <span class="n">defaultErrorMessage</span><span class="p">,</span> <span class="n">Object</span><span class="p">...</span> <span class="n">arguments</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">        <span class="c1">// (5)</span>
</span>        <span class="n">String</span> <span class="n">localizedMessage</span> <span class="o">=</span> <span class="n">messageSource</span><span class="p">.</span><span class="na">getMessage</span><span class="p">(</span><span class="n">errorCode</span><span class="p">,</span>
                <span class="n">arguments</span><span class="p">,</span> <span class="n">defaultErrorMessage</span><span class="p">,</span> <span class="n">request</span><span class="p">.</span><span class="na">getLocale</span><span class="p">());</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ApiError</span><span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">localizedMessage</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">If needed, create a class that provides the method for generating error information.</div>
<div class="line">Creating this class is not mandatory. However, it is recommended to create it so as to clearly define the role division.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Fetch the error message from <code class="docutils literal"><span class="pre">MessageSource</span></code>.</div>
<div class="line">For message management methods, refer to “<a class="reference internal" href="../WebApplicationDetail/MessageManagement.html"><span class="doc">Message Management</span></a>”.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>In the above example, <code class="docutils literal"><span class="pre">org.springframework.web.context.request.WebRequest</span></code> is received as an argument to support localization of messages.
<code class="docutils literal"><span class="pre">WebRequest</span></code> is not necessary when message localization is not required.</p>
<p class="last">The reason for using <code class="docutils literal"><span class="pre">WebRequest</span></code> as an argument instead of <code class="docutils literal"><span class="pre">java.util.Locale</span></code> is due to an additional requirement wherein, HTTP request details are to be embedded in the error message.
When there is no such requirement to embed HTTP request details in error, <code class="docutils literal"><span class="pre">Locale</span></code> can also be used.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code> method is extended and the implementation to output error information in response Body is carried out.</li>
</ul>
<blockquote>
<div><p>Refer to <a class="reference internal" href="#restappendixsorucecodesofapiglobalexceptionhandler"><span class="std std-ref">Appendix</span></a> for the source code when implementation for all exception handling is completed.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="hll"><span class="nd">@ControllerAdvice</span> <span class="c1">// (6)</span>
</span><span class="hll"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiGlobalExceptionHandler</span> <span class="kd">extends</span> <span class="n">ResponseEntityExceptionHandler</span> <span class="p">{</span>
</span>
    <span class="nd">@Inject</span>
    <span class="n">ApiErrorCreator</span> <span class="n">apiErrorCreator</span><span class="p">;</span>

    <span class="nd">@Inject</span>
    <span class="n">ExceptionCodeResolver</span> <span class="n">exceptionCodeResolver</span><span class="p">;</span>

<span class="hll">    <span class="c1">// (7)</span>
</span><span class="hll">    <span class="nd">@Override</span>
</span><span class="hll">    <span class="kd">protected</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleExceptionInternal</span><span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">,</span>
</span>            <span class="n">Object</span> <span class="n">body</span><span class="p">,</span> <span class="n">HttpHeaders</span> <span class="n">headers</span><span class="p">,</span> <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">,</span>
            <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">final</span> <span class="n">Object</span> <span class="n">apiError</span><span class="p">;</span>
<span class="hll">        <span class="c1">// (8)</span>
</span>        <span class="k">if</span> <span class="p">(</span><span class="n">body</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">String</span> <span class="n">errorCode</span> <span class="o">=</span> <span class="n">exceptionCodeResolver</span><span class="p">.</span><span class="na">resolveExceptionCode</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
            <span class="n">apiError</span> <span class="o">=</span> <span class="n">apiErrorCreator</span><span class="p">.</span><span class="na">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errorCode</span><span class="p">,</span> <span class="n">ex</span>
                    <span class="p">.</span><span class="na">getLocalizedMessage</span><span class="p">());</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">apiError</span> <span class="o">=</span> <span class="n">body</span><span class="p">;</span>
        <span class="p">}</span>
<span class="hll">        <span class="c1">// (9)</span>
</span>        <span class="k">return</span> <span class="n">ResponseEntity</span><span class="p">.</span><span class="na">status</span><span class="p">(</span><span class="n">status</span><span class="p">).</span><span class="na">headers</span><span class="p">(</span><span class="n">headers</span><span class="p">).</span><span class="na">body</span><span class="p">(</span><span class="n">apiError</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create a class that inherits <code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code> provided by Spring MVC and assign <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Override handleExceptionInternal method of <code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(8)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When the JavaBean output to response Body is not specified, generate a JavaBean object that retains error information.</div>
<div class="line">In the above example, the exception class changes to the error code by using <code class="docutils literal"><span class="pre">ExceptionCodeResolver</span></code> provided by common library.</div>
<div class="line">For setting example of <code class="docutils literal"><span class="pre">ExceptionCodeResolver</span></code>,  refer to “<a class="reference internal" href="#resthowtouseexceptionhandlingsettingsofexceptioncoderesolver"><span class="std std-ref">Resolving error codes and messages using ExceptionCodeResolver</span></a>” .</div>
<div class="line"><br /></div>
<div class="line">When the JavaBean output to response Body is specified, use the specified JavaBean as it is.</div>
<div class="line">This process is implemented considering that error information is generated individually in the error handling process for each exception.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(9)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set the error information generated in (8) in the ‘Body’ of HTTP Entity for response and then return the same.</div>
<div class="line">Error information thus returned is converted to JSON using framework and sent as a response.</div>
<div class="line"><br /></div>
<div class="line">Appropriate values are set in the status code by <code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code> provided by Spring MVC.</div>
<div class="line">Refer to “<a class="reference internal" href="../WebApplicationDetail/ExceptionHandling.html#exception-handling-appendix-defaulthandlerexceptionresolver-label"><span class="std std-ref">HTTP response code set by DefaultHandlerExceptionResolver</span></a>”  for status codes that are set.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>Attribute of &#64;ControllerAdvice annotation added in Spring Framework 4.0</strong></p>
<p class="last">By specifying an attribute of <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation,
it has been improved to allow flexibility in specifying Controller to apply a method implemented in the class wherein <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> is assigned.
For details about attribute refer to: <a class="reference internal" href="../../ImplementationAtEachLayer/ApplicationLayer.html#application-layer-controller-advice-attribute"><span class="std std-ref">Attribute of &#64;ControllerAdvice</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Points to be noted while using an attribute of &#64;ControllerAdvice annotation</strong></p>
<blockquote>
<div>By using an attribute of <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation, it is possible to share exception handling in respective granularity,
however, it is advisable not to specify attribute of <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation for exception handling of common application (class corresponding to <code class="docutils literal"><span class="pre">ApiGlobalExceptionHandler</span></code> class in the above example).</div></blockquote>
<p>When an attribute is specified in <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation assigned in <code class="docutils literal"><span class="pre">ApiGlobalExceptionHandler</span></code> , a part of exception handling may not be possible that occurs in framework process provided by Spring MVC.</p>
<blockquote class="last">
<div>Specifically, in <code class="docutils literal"><span class="pre">ApiGlobalExceptionHandler</span></code> class, exception handling is not possible for the exceptions that occur when REST API (process method of Controller) corresponding to the request could not be found,
hence, it is not possible to correctly respond to errors such as “405 Method Not Allowed”, etc.</div></blockquote>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Response example</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">400</span> <span class="ne">Bad Request</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">e60b3b6468194e22852c8bfc7618e625</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Thu, 13 Mar 2014 12:16:55 GMT</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>

<span class="hll"><span class="p">{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;e.ex.fw.7001&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Validation error occurred on item in the request body.&quot;</span><span class="p">,</span><span class="nt">&quot;details&quot;</span><span class="p">:[{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;ExistInCodeList&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;\&quot;genderCode\&quot; must exist in code list of CL_GENDER.&quot;</span><span class="p">,</span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="s2">&quot;genderCode&quot;</span><span class="p">}]}</span>
</span></pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-input-error-exception-handling">
<span id="resthowtouseexceptionhandlingforvalidationerror"></span><h4><a class="toc-backref" href="#id59">5.1.4.5.2. Implementing input error exception handling</a><a class="headerlink" href="#implementing-input-error-exception-handling" title="Permalink to this headline">¶</a></h4>
<p>Implementation for responding to input errors (syntax error, unit item check error, correlated field check error) is explained here.</p>
<p>Following three exceptions need to be handled in order to respond to input errors.</p>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="35%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Exception</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">org.springframework.web.bind.</div>
<div class="line">MethodArgumentNotValidException</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">This exception occurs when there is an  error during the input validation for JSON or XML specified in request BODY.</div>
<div class="line">Basically, it occurs when an invalid value is entered in the resource that is specified when POST or PUT method is performed for the resource.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">org.springframework.validation.</div>
<div class="line">BindException</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">This exception occurs when there is an error during the input validation for request parameter (key=query string of value format).</div>
<div class="line">Basically, it occurs when an invalid value is entered in the search conditions specified at the time of GET method of resource collection.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">org.springframework.http.converter.</div>
<div class="line">HttpMessageNotReadableException</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">This exception occurs when there is an error while generating Resource object from JSON or XML.</div>
<div class="line">Basically, it occurs in cases such as invalid JSON or XML syntax or violation of schema definition.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="docutils literal"><span class="pre">org.springframework.beans.TypeMismatchException</span></code> occurs when there is a type conversion error for value while fetching values from request parameter, request header and path variable, by using annotation provided by Spring Framework.</p>
<p>When following annotations are specified as arguments of Controller handler method (argument other than <code class="docutils literal"><span class="pre">String</span></code>), <code class="docutils literal"><span class="pre">TypeMismatchException</span></code> may occur.</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">&#64;org.springframework.web.bind.annotation.RequestParam</span></code></li>
<li><code class="docutils literal"><span class="pre">&#64;org.springframework.web.bind.annotation.RequestHeader</span></code></li>
<li><code class="docutils literal"><span class="pre">&#64;org.springframework.web.bind.annotation.Pathvariable</span></code></li>
<li><code class="docutils literal"><span class="pre">&#64;org.springframework.web.bind.annotation.MatrixVariable</span></code></li>
</ul>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">TypeMismatchException</span></code> is handled by <code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code> resulting in 400 (Bad Request). As a result, individual handling is not required.</p>
<p class="last">Refer to “<a class="reference internal" href="#resthowtouseexceptionhandlingsettingsofexceptioncoderesolver"><span class="std std-ref">Resolving error codes and messages using ExceptionCodeResolver</span></a>” in order to resolve the error codes and error messages to be set in error information.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Method is created to generate error information for input validation errors.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiErrorCreator</span> <span class="p">{</span>

    <span class="nd">@Inject</span>
    <span class="n">MessageSource</span> <span class="n">messageSource</span><span class="p">;</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (1)</span>
</span><span class="hll">    <span class="kd">public</span> <span class="n">ApiError</span> <span class="nf">createBindingResultApiError</span><span class="p">(</span><span class="n">WebRequest</span> <span class="n">request</span><span class="p">,</span>
</span>            <span class="n">String</span> <span class="n">errorCode</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">bindingResult</span><span class="p">,</span>
            <span class="n">String</span> <span class="n">defaultErrorMessage</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ApiError</span> <span class="n">apiError</span> <span class="o">=</span> <span class="n">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errorCode</span><span class="p">,</span>
                <span class="n">defaultErrorMessage</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">FieldError</span> <span class="n">fieldError</span> <span class="p">:</span> <span class="n">bindingResult</span><span class="p">.</span><span class="na">getFieldErrors</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">apiError</span><span class="p">.</span><span class="na">addDetail</span><span class="p">(</span><span class="n">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">fieldError</span><span class="p">,</span> <span class="n">fieldError</span>
                    <span class="p">.</span><span class="na">getField</span><span class="p">()));</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">ObjectError</span> <span class="n">objectError</span> <span class="p">:</span> <span class="n">bindingResult</span><span class="p">.</span><span class="na">getGlobalErrors</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">apiError</span><span class="p">.</span><span class="na">addDetail</span><span class="p">(</span><span class="n">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">objectError</span><span class="p">,</span> <span class="n">objectError</span>
                    <span class="p">.</span><span class="na">getObjectName</span><span class="p">()));</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">apiError</span><span class="p">;</span>
    <span class="p">}</span>

<span class="hll">    <span class="c1">// (2)</span>
</span><span class="hll">    <span class="kd">private</span> <span class="n">ApiError</span> <span class="nf">createApiError</span><span class="p">(</span><span class="n">WebRequest</span> <span class="n">request</span><span class="p">,</span>
</span>            <span class="n">DefaultMessageSourceResolvable</span> <span class="n">messageResolvable</span><span class="p">,</span> <span class="n">String</span> <span class="n">target</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">localizedMessage</span> <span class="o">=</span> <span class="n">messageSource</span><span class="p">.</span><span class="na">getMessage</span><span class="p">(</span><span class="n">messageResolvable</span><span class="p">,</span>
                <span class="n">request</span><span class="p">.</span><span class="na">getLocale</span><span class="p">());</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ApiError</span><span class="p">(</span><span class="n">messageResolvable</span><span class="p">.</span><span class="na">getCode</span><span class="p">(),</span> <span class="n">localizedMessage</span><span class="p">,</span> <span class="n">target</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A method is created to generate error information for input validation.</div>
<div class="line">In the above example, single field check error (<code class="docutils literal"><span class="pre">FieldError</span></code>) and correlated field check error (<code class="docutils literal"><span class="pre">ObjectError</span></code>) are added to detailed error information.</div>
<div class="line">This method need not be provided when it is not necessary to output error information for each item.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A common method is created since same process is implemented for single field check error (<code class="docutils literal"><span class="pre">FieldError</span></code>) and correlation check error (<code class="docutils literal"><span class="pre">ObjectError</span></code>).</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code> method is extended and the implementation to output input validation error information in response Body, is performed.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@ControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiGlobalExceptionHandler</span> <span class="kd">extends</span> <span class="n">ResponseEntityExceptionHandler</span> <span class="p">{</span>

    <span class="nd">@Inject</span>
    <span class="n">ApiErrorCreator</span> <span class="n">apiErrorCreator</span><span class="p">;</span>

    <span class="nd">@Inject</span>
    <span class="n">ExceptionCodeResolver</span> <span class="n">exceptionCodeResolver</span><span class="p">;</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (3)</span>
</span><span class="hll">    <span class="nd">@Override</span>
</span><span class="hll">    <span class="kd">protected</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleMethodArgumentNotValid</span><span class="p">(</span>
</span>            <span class="n">MethodArgumentNotValidException</span> <span class="n">ex</span><span class="p">,</span> <span class="n">HttpHeaders</span> <span class="n">headers</span><span class="p">,</span>
            <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">,</span> <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">handleBindingResult</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ex</span><span class="p">.</span><span class="na">getBindingResult</span><span class="p">(),</span> <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span>
                <span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="hll">    <span class="c1">// (4)</span>
</span><span class="hll">    <span class="nd">@Override</span>
</span><span class="hll">    <span class="kd">protected</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleBindException</span><span class="p">(</span><span class="n">BindException</span> <span class="n">ex</span><span class="p">,</span>
</span>            <span class="n">HttpHeaders</span> <span class="n">headers</span><span class="p">,</span> <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">,</span> <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">handleBindingResult</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ex</span><span class="p">.</span><span class="na">getBindingResult</span><span class="p">(),</span> <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span>
                <span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="hll">    <span class="c1">// (5)</span>
</span><span class="hll">    <span class="nd">@Override</span>
</span><span class="hll">    <span class="kd">protected</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleHttpMessageNotReadable</span><span class="p">(</span>
</span>            <span class="n">HttpMessageNotReadableException</span> <span class="n">ex</span><span class="p">,</span> <span class="n">HttpHeaders</span> <span class="n">headers</span><span class="p">,</span>
            <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">,</span> <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">        <span class="k">if</span> <span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="na">getCause</span><span class="p">()</span> <span class="k">instanceof</span> <span class="n">Exception</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">            <span class="k">return</span> <span class="n">handleExceptionInternal</span><span class="p">((</span><span class="n">Exception</span><span class="p">)</span> <span class="n">ex</span><span class="p">.</span><span class="na">getCause</span><span class="p">(),</span> <span class="kc">null</span><span class="p">,</span>
</span><span class="hll">                    <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</span>        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">handleExceptionInternal</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (6)</span>
</span><span class="hll">    <span class="kd">protected</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleBindingResult</span><span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">,</span>
</span>            <span class="n">BindingResult</span> <span class="n">bindingResult</span><span class="p">,</span> <span class="n">HttpHeaders</span> <span class="n">headers</span><span class="p">,</span>
            <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">,</span> <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">code</span> <span class="o">=</span> <span class="n">exceptionCodeResolver</span><span class="p">.</span><span class="na">resolveExceptionCode</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
        <span class="n">String</span> <span class="n">errorCode</span> <span class="o">=</span> <span class="n">exceptionCodeResolver</span><span class="p">.</span><span class="na">resolveExceptionCode</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
        <span class="n">ApiError</span> <span class="n">apiError</span> <span class="o">=</span> <span class="n">apiErrorCreator</span><span class="p">.</span><span class="na">createBindingResultApiError</span><span class="p">(</span>
                <span class="n">request</span><span class="p">,</span> <span class="n">errorCode</span><span class="p">,</span> <span class="n">bindingResult</span><span class="p">,</span> <span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
        <span class="k">return</span> <span class="n">handleExceptionInternal</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">apiError</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Override handleMethodArgumentNotValid method of <code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code> and extend error handling for <code class="docutils literal"><span class="pre">MethodArgumentNotValidException</span></code>.</div>
<div class="line">In the above example, the process is delegated to a common method (6) that handles input validation errors.</div>
<div class="line">When it is not necessary to output error information for each item, overriding is not required.</div>
<div class="line"><br /></div>
<div class="line"><strong>400 (Bad Request)</strong> is set in the status code and presence of some flaw in the field value of the specified resource is notified.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Override handleBindException method of <code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code> and extend error handling for <code class="docutils literal"><span class="pre">BindException</span></code>.</div>
<div class="line">In the above example, the process is delegated to a common method (6) that handles input validation error.</div>
<div class="line">When it is not necessary to output error information for each item, overriding is not required.</div>
<div class="line"><br /></div>
<div class="line"><strong>400 (Bad Request)</strong> is set in the status code and presence of flaw in the specified request parameter is notified.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Override handleHttpMessageNotReadable method of <code class="docutils literal"><span class="pre">ResponseEntityExceptionHandler</span></code> and extend error handling for <code class="docutils literal"><span class="pre">HttpMessageNotReadableException</span></code>.</div>
<div class="line">In the above example, detailed error handling is performed by using cause exception.</div>
<div class="line">If a detailed error handling is not necessary, overriding is not required.</div>
<div class="line"><br /></div>
<div class="line"><strong>400 (Bad Request)</strong> is set in the status code and presence of flaw in the specified resource format etc. is notified</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Generate a JavaBean object that retains error information for input validation error.</div>
<div class="line">In the above example, this method is created as a common method since same process is implemented in handleMethodArgumentNotValid and handleBindException.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>Error handling when using JSON</strong></p>
<p>When JSON is used as the resource format, following exception is stored as cause exception of <code class="docutils literal"><span class="pre">HttpMessageNotReadableException</span></code>.</p>
<blockquote class="last">
<div><table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="35%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Exception class</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">com.fasterxml.jackson.core.</div>
<div class="line">JsonParseException</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It occurs when an invalid syntax is included for JSON.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">com.fasterxml.jackson.databind.exc.</div>
<div class="line">UnrecognizedPropertyException</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It occurs when a field which does not exist in Resource object is specified in JSON.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">com.fasterxml.jackson.databind.</div>
<div class="line">JsonMappingException</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It occurs when a value type conversion error occurs while converting from JSON to Resource object.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Following error response is sent when an input validation error (single field check error, correlated field check error) occurs.</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">400</span> <span class="ne">Bad Request</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">13522b3badf2432ba4cad0dc7aeaee80</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Wed, 19 Feb 2014 05:08:28 GMT</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>

<span class="hll"><span class="p">{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;e.ex.fw.7002&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Validation error occurred on item in the request parameters.&quot;</span><span class="p">,</span><span class="nt">&quot;details&quot;</span><span class="p">:[{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;NotEmpty&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;\&quot;{0}\&quot; may not be empty.&quot;</span><span class="p">,</span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="s2">&quot;name&quot;</span><span class="p">}]}</span>
</span></pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Following error response is sent when JSON errors (format error etc.) occur.</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">400</span> <span class="ne">Bad Request</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">ca4c742a6bfd49e5bc01cd0b124738a1</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Wed, 19 Feb 2014 13:32:24 GMT</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>

<span class="hll"><span class="p">{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;e.ex.fw.7003&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Request body format error occurred.&quot;</span><span class="p">}</span>
</span></pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-exception-handling-for-resource-not-found-error">
<span id="resthowtouseexceptionhandlingfornotfound"></span><h4><a class="toc-backref" href="#id60">5.1.4.5.3. Implementing exception handling for “Resource not found” error</a><a class="headerlink" href="#implementing-exception-handling-for-resource-not-found-error" title="Permalink to this headline">¶</a></h4>
<p>When a resource does not exist, implementation for responding to the “resource not found” error, is explained below.</p>
<div class="line-block">
<div class="line">When a resource matching with the ID fetched from path variable is not found, generate an exception notifying “resource not found” .</div>
<div class="line"><code class="docutils literal"><span class="pre">org.terasoluna.gfw.common.exception.ResourceNotFoundException</span></code> is provided by common library as an exception notifying “resource not found”.</div>
<div class="line">Implementation is as given below.</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>When a resource matching with the ID fetched from path variable is not found, generate <code class="docutils literal"><span class="pre">ResourceNotFoundException</span></code>.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">Member</span> <span class="nf">getMember</span><span class="p">(</span><span class="n">String</span> <span class="n">memberId</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="p">.</span><span class="na">findOne</span><span class="p">(</span><span class="n">memberId</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">member</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">        <span class="k">throw</span> <span class="k">new</span> <span class="n">ResourceNotFoundException</span><span class="p">(</span><span class="n">ResultMessages</span><span class="p">.</span><span class="na">error</span><span class="p">().</span><span class="na">add</span><span class="p">(</span>
</span><span class="hll">                <span class="s">&quot;e.ex.mm.5001&quot;</span><span class="p">,</span> <span class="n">memberId</span><span class="p">));</span>
</span>    <span class="p">}</span>
    <span class="k">return</span> <span class="n">member</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Create a method to generate error information for <code class="docutils literal"><span class="pre">ResultMessages</span></code>.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiErrorCreator</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (1)</span>
</span><span class="hll">    <span class="kd">public</span> <span class="n">ApiError</span> <span class="nf">createResultMessagesApiError</span><span class="p">(</span><span class="n">WebRequest</span> <span class="n">request</span><span class="p">,</span>
</span>            <span class="n">String</span> <span class="n">rootErrorCode</span><span class="p">,</span> <span class="n">ResultMessages</span> <span class="n">resultMessages</span><span class="p">,</span>
            <span class="n">String</span> <span class="n">defaultErrorMessage</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ApiError</span> <span class="n">apiError</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">resultMessages</span><span class="p">.</span><span class="na">getList</span><span class="p">().</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ResultMessage</span> <span class="n">resultMessage</span> <span class="o">=</span> <span class="n">resultMessages</span><span class="p">.</span><span class="na">iterator</span><span class="p">().</span><span class="na">next</span><span class="p">();</span>
            <span class="n">String</span> <span class="n">errorCode</span> <span class="o">=</span> <span class="n">resultMessage</span><span class="p">.</span><span class="na">getCode</span><span class="p">();</span>
            <span class="n">String</span> <span class="n">errorText</span> <span class="o">=</span> <span class="n">resultMessage</span><span class="p">.</span><span class="na">getText</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">errorCode</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">errorText</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">errorCode</span> <span class="o">=</span> <span class="n">rootErrorCode</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">apiError</span> <span class="o">=</span> <span class="n">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errorCode</span><span class="p">,</span> <span class="n">errorText</span><span class="p">,</span>
                    <span class="n">resultMessage</span><span class="p">.</span><span class="na">getArgs</span><span class="p">());</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">apiError</span> <span class="o">=</span> <span class="n">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">rootErrorCode</span><span class="p">,</span>
                    <span class="n">defaultErrorMessage</span><span class="p">);</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ResultMessage</span> <span class="n">resultMessage</span> <span class="p">:</span> <span class="n">resultMessages</span><span class="p">.</span><span class="na">getList</span><span class="p">())</span> <span class="p">{</span>
                <span class="n">apiError</span><span class="p">.</span><span class="na">addDetail</span><span class="p">(</span><span class="n">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">resultMessage</span>
                        <span class="p">.</span><span class="na">getCode</span><span class="p">(),</span> <span class="n">resultMessage</span><span class="p">.</span><span class="na">getText</span><span class="p">(),</span> <span class="n">resultMessage</span>
                        <span class="p">.</span><span class="na">getArgs</span><span class="p">()));</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">apiError</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create a method for generating error information from process results.</div>
<div class="line">In the above example, the message information retained by <code class="docutils literal"><span class="pre">ResultMessages</span></code> is set in error information.</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In the above example, as <code class="docutils literal"><span class="pre">ResultMessages</span></code> can retain multiple messages, the process is divided as per when a single message is stored and when multiple messages are stored.</p>
<p class="last">When it is not necessary to support multiple messages, the process wherein the message at the start is generated as error information, may be implemented.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Create a method for handling the exception that notifies “resource not found” error, in the class that performs error handling.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@ControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiGlobalExceptionHandler</span> <span class="kd">extends</span> <span class="n">ResponseEntityExceptionHandler</span> <span class="p">{</span>

    <span class="nd">@Inject</span>
    <span class="n">ApiErrorCreator</span> <span class="n">apiErrorCreator</span><span class="p">;</span>

    <span class="nd">@Inject</span>
    <span class="n">ExceptionCodeResolver</span> <span class="n">exceptionCodeResolver</span><span class="p">;</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (2)</span>
</span><span class="hll">    <span class="nd">@ExceptionHandler</span><span class="p">(</span><span class="n">ResourceNotFoundException</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
</span>    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleResourceNotFoundException</span><span class="p">(</span>
            <span class="n">ResourceNotFoundException</span> <span class="n">ex</span><span class="p">,</span> <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">handleResultMessagesNotificationException</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="k">new</span> <span class="n">HttpHeaders</span><span class="p">(),</span>
<span class="hll">                <span class="n">HttpStatus</span><span class="p">.</span><span class="na">NOT_FOUND</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</span>    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (3)</span>
</span><span class="hll">    <span class="kd">private</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleResultMessagesNotificationException</span><span class="p">(</span>
</span>            <span class="n">ResultMessagesNotificationException</span> <span class="n">ex</span><span class="p">,</span> <span class="n">HttpHeaders</span> <span class="n">headers</span><span class="p">,</span>
            <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">,</span> <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">errorCode</span> <span class="o">=</span> <span class="n">exceptionCodeResolver</span><span class="p">.</span><span class="na">resolveExceptionCode</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
        <span class="n">ApiError</span> <span class="n">apiError</span> <span class="o">=</span> <span class="n">apiErrorCreator</span><span class="p">.</span><span class="na">createResultMessagesApiError</span><span class="p">(</span>
                <span class="n">request</span><span class="p">,</span> <span class="n">errorCode</span><span class="p">,</span> <span class="n">ex</span><span class="p">.</span><span class="na">getResultMessages</span><span class="p">(),</span> <span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
        <span class="k">return</span> <span class="n">handleExceptionInternal</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">apiError</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add a method for handling <code class="docutils literal"><span class="pre">ResourceNotFoundException</span></code>.</div>
<div class="line"><code class="docutils literal"><span class="pre">ResourceNotFoundException</span></code> exception can be handled if <code class="docutils literal"><span class="pre">&#64;ExceptionHandler(ResourceNotFoundException.class)</span></code> is specified as method annotation.</div>
<div class="line">In the above example, the process is delegated to method that handles exception of the parent class (<code class="docutils literal"><span class="pre">ResultMessagesNotificationException</span></code>) of <code class="docutils literal"><span class="pre">ResourceNotFoundException</span></code>.</div>
<div class="line"><br /></div>
<div class="line">Set <strong>404 (Not Found)</strong> in the status code and notify a message stating, ‘specified resource does not exist in the server’.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Generate a JavaBean object that retains error information for “resource not found” error and business error.</div>
<div class="line">In the above example, this method is created as a common method since the process is same as that for error handling of business error discussed hereafter.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>When resource is not found, following error response is generated.</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">404</span> <span class="ne">Not Found</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">5ee563877f3140fd904d0acf52eba398</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Wed, 19 Feb 2014 08:46:18 GMT</span>

<span class="hll"><span class="p">{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;e.ex.mm.5001&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Specified member not found. member id : M000000001&quot;</span><span class="p">}</span>
</span></pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-exception-handling-for-business-errors">
<span id="resthowtouseexceptionhandlingforbusinesserror"></span><h4><a class="toc-backref" href="#id61">5.1.4.5.4. Implementing exception handling for business errors</a><a class="headerlink" href="#implementing-exception-handling-for-business-errors" title="Permalink to this headline">¶</a></h4>
<p>An implementation wherein business error is sent as a response on detecting violation of business rule, is explained here.</p>
<p>Perform business rule check as Service process and generate business exception when a business rule violation is detected.
For details on how to detect business error, refer to “<a class="reference internal" href="../../ImplementationAtEachLayer/DomainLayer.html#service-return-businesserrormessage-label"><span class="std std-ref">Notifying business error</span></a>”.</p>
<ul class="simple">
<li>Create a method to handle business exception in the class that performs error handling.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@ControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiGlobalExceptionHandler</span> <span class="kd">extends</span> <span class="n">ResponseEntityExceptionHandler</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (1)</span>
</span><span class="hll">    <span class="nd">@ExceptionHandler</span><span class="p">(</span><span class="n">BusinessException</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
</span>    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleBusinessException</span><span class="p">(</span><span class="n">BusinessException</span> <span class="n">ex</span><span class="p">,</span>
            <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">handleResultMessagesNotificationException</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="k">new</span> <span class="n">HttpHeaders</span><span class="p">(),</span>
<span class="hll">                <span class="n">HttpStatus</span><span class="p">.</span><span class="na">CONFLICT</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</span>    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add a method for handling <code class="docutils literal"><span class="pre">BusinessException</span></code>.</div>
<div class="line"><code class="docutils literal"><span class="pre">BusinessException</span></code> can be handled if <code class="docutils literal"><span class="pre">&#64;ExceptionHandler(BusinessException.class)</span></code> is specified as method annotation.</div>
<div class="line">In the above example, the process is delegated to the method that handles the exception of parent class (<code class="docutils literal"><span class="pre">ResultMessagesNotificationException</span></code>) of <code class="docutils literal"><span class="pre">BusinessException</span></code>.</div>
<div class="line"><br /></div>
<div class="line">Set <strong>409 (Conflict)</strong>in the status code and send a message notifying although there are no errors in the resource itself specified by client, all the conditions necessary for operating the resource stored by the server are not in place.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Following error response is generated when a business error occurs.</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">409</span> <span class="ne">Conflict</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">37c1a899d5f74e7a9c24662292837ef7</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Wed, 19 Feb 2014 09:03:26 GMT</span>

<span class="hll"><span class="p">{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;e.ex.mm.8001&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Cannot use specified sign id. sign id : user1@test.com&quot;</span><span class="p">}</span>
</span></pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-exception-handling-for-exclusive-errors">
<span id="resthowtouseexceptionhandlingforexcusionerror"></span><h4><a class="toc-backref" href="#id62">5.1.4.5.5. Implementing exception handling for exclusive errors</a><a class="headerlink" href="#implementing-exception-handling-for-exclusive-errors" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">An implementation is explained here wherein, an exclusive error is generated and sent as a response.</div>
<div class="line">Exclusive error handling is necessary when performing exclusive control.</div>
<div class="line">For details of exclusive control, refer to “<a class="reference internal" href="../DataAccessDetail/ExclusionControl.html"><span class="doc">Exclusive Control</span></a>” .</div>
</div>
<ul class="simple">
<li>Create a method for exclusive error handling in the class that performs error handling.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@ControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiGlobalExceptionHandler</span> <span class="kd">extends</span> <span class="n">ResponseEntityExceptionHandler</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (1)</span>
</span><span class="hll">    <span class="nd">@ExceptionHandler</span><span class="p">({</span> <span class="n">OptimisticLockingFailureException</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
</span><span class="hll">            <span class="n">PessimisticLockingFailureException</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
</span>    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleLockingFailureException</span><span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">,</span>
            <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">handleExceptionInternal</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="k">new</span> <span class="n">HttpHeaders</span><span class="p">(),</span>
<span class="hll">                <span class="n">HttpStatus</span><span class="p">.</span><span class="na">CONFLICT</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</span>    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add a method for handling exclusive errors (<code class="docutils literal"><span class="pre">OptimisticLockingFailureException</span></code> and <code class="docutils literal"><span class="pre">PessimisticLockingFailureException</span></code>).</div>
<div class="line">If <code class="docutils literal"><span class="pre">&#64;ExceptionHandler({</span> <span class="pre">OptimisticLockingFailureException.class,</span> <span class="pre">PessimisticLockingFailureException.class</span> <span class="pre">})</span></code> is specified as method annotation, exception handling of exclusive errors (<code class="docutils literal"><span class="pre">OptimisticLockingFailureException</span></code> and <code class="docutils literal"><span class="pre">PessimisticLockingFailureException</span></code>) can be performed.</div>
<div class="line"><br /></div>
<div class="line">Set <strong>409(Conflict)</strong> in status code and send a message notifying that, ‘although there are no flaws in the resource itself specified by client, the conditions for operating the resource could not be fulfilled due to conflict in the process’.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>When an exclusive error occurs, following error response is generated.</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">409</span> <span class="ne">Conflict</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">85200b5a51be42b29840e482ee35087f</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Wed, 19 Feb 2014 16:32:45 GMT</span>

<span class="hll"><span class="p">{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;e.ex.fw.8002&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Conflict with other processing occurred.&quot;</span><span class="p">}</span>
</span></pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-exception-handling-for-system-errors">
<span id="resthowtouseexceptionhandlingforsystemerror"></span><h4><a class="toc-backref" href="#id63">5.1.4.5.6. Implementing exception handling for system errors</a><a class="headerlink" href="#implementing-exception-handling-for-system-errors" title="Permalink to this headline">¶</a></h4>
<p>An implementation wherein system error is sent as a response on detecting system abnormality, is explained here.</p>
<p>Generate system exception when any system abnormality is detected.
Refer to “<a class="reference internal" href="../../ImplementationAtEachLayer/DomainLayer.html#service-return-systemerrormessage-label"><span class="std std-ref">Notifying system error</span></a>” for the details on how to detect system errors.</p>
<ul class="simple">
<li>Create a method to handle system exceptions in the class that performs error handling.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@ControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiGlobalExceptionHandler</span> <span class="kd">extends</span> <span class="n">ResponseEntityExceptionHandler</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

<span class="hll">    <span class="c1">// (1)</span>
</span><span class="hll">    <span class="nd">@ExceptionHandler</span><span class="p">(</span><span class="n">Exception</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
</span>    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleSystemError</span><span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">,</span>
            <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">handleExceptionInternal</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="k">new</span> <span class="n">HttpHeaders</span><span class="p">(),</span>
<span class="hll">                <span class="n">HttpStatus</span><span class="p">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
</span>    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add a method for handling <code class="docutils literal"><span class="pre">Exception</span></code>.</div>
<div class="line"><code class="docutils literal"><span class="pre">Exception</span></code> can be handled if <code class="docutils literal"><span class="pre">&#64;ExceptionHandler(Exception.class)</span></code> is specified as method annotation.</div>
<div class="line">In the above example, the system exceptions generated from dependent libraries being used, are also handled.</div>
<div class="line"><br /></div>
<div class="line">Set <strong>500 (Internal Server Error)</strong> in status code.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Following error response is generated when a system error occurs.</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">500</span> <span class="ne">Internal Server Error</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">3625d5a040a744e49b0a9b3763a24e9c</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Wed, 19 Feb 2014 12:22:33 GMT</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>

<span class="hll"><span class="p">{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;e.ex.fw.9003&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;System error occurred.&quot;</span><span class="p">}</span>
</span></pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>Error message at the time of system error</strong></p>
<p>When system error occurs, it is recommended that a simple error message that does not specify the error cause, is set as the message to be returned to the client.
If an error message specifying the cause of error is set, it may expose system vulnerabilities to the client resulting in security issues.</p>
<p class="last">Cause of error is output to a log, for error analysis.
This log is output by <code class="docutils literal"><span class="pre">ExceptionLogger</span></code> provided by common library as the default setting of Blank project. As a result, the settings and implementation for log output are not required.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="resolving-error-codes-and-messages-using-exceptioncoderesolver">
<span id="resthowtouseexceptionhandlingsettingsofexceptioncoderesolver"></span><h4><a class="toc-backref" href="#id64">5.1.4.5.7. Resolving error codes and messages using ExceptionCodeResolver</a><a class="headerlink" href="#resolving-error-codes-and-messages-using-exceptioncoderesolver" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">If <code class="docutils literal"><span class="pre">ExceptionCodeResolver</span></code> provided by common library is used, error codes can be resolved from the exception class.</div>
<div class="line">Especially, this functionality proves to be convenient, when the cause of error lies at client side and when it is necessary to set the error message corresponding to error cause.</div>
</div>
<ul>
<li><div class="first line-block">
<div class="line"><code class="file docutils literal"><span class="pre">applicationContext.xml</span></code></div>
<div class="line">Mapping exception class and error code (exception code).</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- omitted --&gt;</span>

<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;exceptionCodeResolver&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.terasoluna.gfw.common.exception.SimpleMappingExceptionCodeResolver&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;exceptionMappings&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;map&gt;</span>
            <span class="c">&lt;!-- omitted --&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;ResourceNotFoundException&quot;</span>              <span class="na">value=</span><span class="s">&quot;e.ex.fw.5001&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;HttpRequestMethodNotSupportedException&quot;</span> <span class="na">value=</span><span class="s">&quot;e.ex.fw.6001&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;MediaTypeNotAcceptableException&quot;</span>        <span class="na">value=</span><span class="s">&quot;e.ex.fw.6002&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;HttpMediaTypeNotSupportedException&quot;</span>     <span class="na">value=</span><span class="s">&quot;e.ex.fw.6003&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;MethodArgumentNotValidException&quot;</span>        <span class="na">value=</span><span class="s">&quot;e.ex.fw.7001&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;BindException&quot;</span>                          <span class="na">value=</span><span class="s">&quot;e.ex.fw.7002&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;JsonParseException&quot;</span>                     <span class="na">value=</span><span class="s">&quot;e.ex.fw.7003&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;UnrecognizedPropertyException&quot;</span>          <span class="na">value=</span><span class="s">&quot;e.ex.fw.7004&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;JsonMappingException&quot;</span>                   <span class="na">value=</span><span class="s">&quot;e.ex.fw.7005&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;TypeMismatchException&quot;</span>                  <span class="na">value=</span><span class="s">&quot;e.ex.fw.7006&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;BusinessException&quot;</span>                      <span class="na">value=</span><span class="s">&quot;e.ex.fw.8001&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;OptimisticLockingFailureException&quot;</span>      <span class="na">value=</span><span class="s">&quot;e.ex.fw.8002&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;PessimisticLockingFailureException&quot;</span>     <span class="na">value=</span><span class="s">&quot;e.ex.fw.8002&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;DataAccessException&quot;</span>                    <span class="na">value=</span><span class="s">&quot;e.ex.fw.9002&quot;</span> <span class="nt">/&gt;</span>
            <span class="c">&lt;!-- omitted --&gt;</span>
        <span class="nt">&lt;/map&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;defaultExceptionCode&quot;</span> <span class="na">value=</span><span class="s">&quot;e.ex.fw.9001&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!-- omitted --&gt;</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Configuration example of message corresponding to error code is shown below.</div>
<div class="line">For message management, refer to “<a class="reference internal" href="../WebApplicationDetail/MessageManagement.html"><span class="doc">Message Management</span></a>” .</div>
</div>
<ul>
<li><div class="first line-block">
<div class="line"><code class="file docutils literal"><span class="pre">xxx-web/src/main/resources/i18n/application-messages.properties</span></code></div>
<div class="line">Message corresponding to error code (exception code) is set for the error that occurs in application layer.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># ---</span>
<span class="c"># Application common messages</span>
<span class="c"># ---</span>
<span class="na">e.ex.fw.5001</span> <span class="o">=</span> <span class="s">Resource not found.</span>

<span class="na">e.ex.fw.6001</span> <span class="o">=</span> <span class="s">Request method not supported.</span>
<span class="na">e.ex.fw.6002</span> <span class="o">=</span> <span class="s">Specified representation format not supported.</span>
<span class="na">e.ex.fw.6003</span> <span class="o">=</span> <span class="s">Specified media type in the request body not supported.</span>

<span class="na">e.ex.fw.7001</span> <span class="o">=</span> <span class="s">Validation error occurred on item in the request body.</span>
<span class="na">e.ex.fw.7002</span> <span class="o">=</span> <span class="s">Validation error occurred on item in the request parameters.</span>
<span class="na">e.ex.fw.7003</span> <span class="o">=</span> <span class="s">Request body format error occurred.</span>
<span class="na">e.ex.fw.7004</span> <span class="o">=</span> <span class="s">Unknown field exists in JSON.</span>
<span class="na">e.ex.fw.7005</span> <span class="o">=</span> <span class="s">Type mismatch error occurred in JSON field.</span>
<span class="na">e.ex.fw.7006</span> <span class="o">=</span> <span class="s">Type mismatch error occurred in request parameter or header or path variable.</span>

<span class="na">e.ex.fw.8001</span> <span class="o">=</span> <span class="s">Business error occurred.</span>
<span class="na">e.ex.fw.8002</span> <span class="o">=</span> <span class="s">Conflict with other processing occurred.</span>

<span class="na">e.ex.fw.9001</span> <span class="o">=</span> <span class="s">System error occurred.</span>
<span class="na">e.ex.fw.9002</span> <span class="o">=</span> <span class="s">System error occurred.</span>
<span class="na">e.ex.fw.9003</span> <span class="o">=</span> <span class="s">System error occurred.</span>

<span class="c"># omitted</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><div class="first line-block">
<div class="line"><code class="file docutils literal"><span class="pre">xxx-web/src/main/resources/ValidationMessages.properties</span></code></div>
<div class="line">Set a message corresponding to error code for the error that occurs in the input validation performed using Bean Validation.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># ---</span>
<span class="c"># Bean Validation common messages</span>
<span class="c"># ---</span>

<span class="c"># for bean validation of standard</span>
<span class="na">javax.validation.constraints.AssertFalse.message</span> <span class="o">=</span> <span class="s">&quot;{0}&quot; must be false.</span>
<span class="na">javax.validation.constraints.AssertTrue.message</span>  <span class="o">=</span> <span class="s">&quot;{0}&quot; must be true.</span>
<span class="na">javax.validation.constraints.DecimalMax.message</span>  <span class="o">=</span> <span class="s">&quot;{0}&quot; must be less than ${inclusive == true ? &#39;or equal to &#39; : &#39;&#39;}{value}.</span>
<span class="na">javax.validation.constraints.DecimalMin.message</span>  <span class="o">=</span> <span class="s">&quot;{0}&quot; must be greater than ${inclusive == true ? &#39;or equal to &#39; : &#39;&#39;}{value}.</span>
<span class="na">javax.validation.constraints.Digits.message</span>      <span class="o">=</span> <span class="s">&quot;{0}&quot; numeric value out of bounds (&lt;{integer} digits&gt;.&lt;{fraction} digits&gt; expected).</span>
<span class="na">javax.validation.constraints.Future.message</span>      <span class="o">=</span> <span class="s">&quot;{0}&quot; must be in the future.</span>
<span class="na">javax.validation.constraints.Max.message</span>         <span class="o">=</span> <span class="s">&quot;{0}&quot; must be less than or equal to {value}.</span>
<span class="na">javax.validation.constraints.Min.message</span>         <span class="o">=</span> <span class="s">&quot;{0}&quot; must be greater than or equal to {value}.</span>
<span class="na">javax.validation.constraints.NotNull.message</span>     <span class="o">=</span> <span class="s">&quot;{0}&quot; may not be null.</span>
<span class="na">javax.validation.constraints.Null.message</span>        <span class="o">=</span> <span class="s">&quot;{0}&quot; must be null.</span>
<span class="na">javax.validation.constraints.Past.message</span>        <span class="o">=</span> <span class="s">&quot;{0}&quot; must be in the past.</span>
<span class="na">javax.validation.constraints.Pattern.message</span>     <span class="o">=</span> <span class="s">&quot;{0}&quot; must match &quot;{regexp}&quot;.</span>
<span class="na">javax.validation.constraints.Size.message</span>        <span class="o">=</span> <span class="s">&quot;{0}&quot; size must be between {min} and {max}.</span>

<span class="c"># for bean validation of hibernate</span>
<span class="na">org.hibernate.validator.constraints.CreditCardNumber.message</span>        <span class="o">=</span> <span class="s">&quot;{0}&quot; invalid credit card number.</span>
<span class="na">org.hibernate.validator.constraints.EAN.message</span>                     <span class="o">=</span> <span class="s">&quot;{0}&quot; invalid {type} barcode.</span>
<span class="na">org.hibernate.validator.constraints.Email.message</span>                   <span class="o">=</span> <span class="s">&quot;{0}&quot; not a well-formed email address.</span>
<span class="na">org.hibernate.validator.constraints.Length.message</span>                  <span class="o">=</span> <span class="s">&quot;{0}&quot; length must be between {min} and {max}.</span>
<span class="na">org.hibernate.validator.constraints.LuhnCheck.message</span>               <span class="o">=</span> <span class="s">&quot;{0}&quot; The check digit for ${validatedValue} is invalid, Luhn Modulo 10 checksum failed.</span>
<span class="na">org.hibernate.validator.constraints.Mod10Check.message</span>              <span class="o">=</span> <span class="s">&quot;{0}&quot; The check digit for ${validatedValue} is invalid, Modulo 10 checksum failed.</span>
<span class="na">org.hibernate.validator.constraints.Mod11Check.message</span>              <span class="o">=</span> <span class="s">&quot;{0}&quot; The check digit for ${validatedValue} is invalid, Modulo 11 checksum failed.</span>
<span class="na">org.hibernate.validator.constraints.ModCheck.message</span>                <span class="o">=</span> <span class="s">&quot;{0}&quot; The check digit for ${validatedValue} is invalid, ${modType} checksum failed.</span>
<span class="na">org.hibernate.validator.constraints.NotBlank.message</span>                <span class="o">=</span> <span class="s">&quot;{0}&quot; may not be empty.</span>
<span class="na">org.hibernate.validator.constraints.NotEmpty.message</span>                <span class="o">=</span> <span class="s">&quot;{0}&quot; may not be empty.</span>
<span class="na">org.hibernate.validator.constraints.ParametersScriptAssert.message</span>  <span class="o">=</span> <span class="s">&quot;{0}&quot; script expression &quot;{script}&quot; didn&#39;t evaluate to true.</span>
<span class="na">org.hibernate.validator.constraints.Range.message</span>                   <span class="o">=</span> <span class="s">&quot;{0}&quot; must be between {min} and {max}.</span>
<span class="na">org.hibernate.validator.constraints.SafeHtml.message</span>                <span class="o">=</span> <span class="s">&quot;{0}&quot; may have unsafe html content.</span>
<span class="na">org.hibernate.validator.constraints.ScriptAssert.message</span>            <span class="o">=</span> <span class="s">&quot;{0}&quot; script expression &quot;{script}&quot; didn&#39;t evaluate to true.</span>
<span class="na">org.hibernate.validator.constraints.URL.message</span>                     <span class="o">=</span> <span class="s">&quot;{0}&quot; must be a valid URL.</span>

<span class="na">org.hibernate.validator.constraints.br.CNPJ.message</span>                 <span class="o">=</span> <span class="s">&quot;{0}&quot; invalid Brazilian corporate taxpayer registry number (CNPJ).</span>
<span class="na">org.hibernate.validator.constraints.br.CPF.message</span>                  <span class="o">=</span> <span class="s">&quot;{0}&quot; invalid Brazilian individual taxpayer registry number (CPF).</span>
<span class="na">org.hibernate.validator.constraints.br.TituloEleitoral.message</span>      <span class="o">=</span> <span class="s">&quot;{0}&quot; invalid Brazilian Voter ID card number.</span>

<span class="c"># for common library</span>
<span class="na">org.terasoluna.gfw.common.codelist.ExistInCodeList.message</span>   <span class="o">=</span> <span class="s">&quot;{0}&quot; must exist in code list of {codeListId}.</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><div class="first line-block">
<div class="line"><code class="file docutils literal"><span class="pre">xxx-domain/src/main/resources/i18n/domain-messages.properties</span></code></div>
<div class="line">Set a message corresponding to error code (exception code) for the error in domain layer.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># omitted</span>

<span class="na">e.ex.mm.5001</span> <span class="o">=</span> <span class="s">Specified member not found. member id : {0}</span>
<span class="na">e.ex.mm.8001</span> <span class="o">=</span> <span class="s">Cannot use specified sign id. sign id : {0}</span>
<span class="c"># omitted</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="implementing-the-error-handling-notified-to-servlet-container">
<span id="resthowtouseexceptionhandlingforservletcontainer"></span><h3><a class="toc-backref" href="#id65">5.1.4.6. Implementing the error handling notified to Servlet Container</a><a class="headerlink" href="#implementing-the-error-handling-notified-to-servlet-container" title="Permalink to this headline">¶</a></h3>
<p>When an error occurs in Filter or when error responses are sent by using <code class="docutils literal"><span class="pre">HttpServletResponse#sendError</span></code>, the errors cannot be handled using exception handling feature of Spring MVC.
Hence, these errors are notified to Servlet Container.</p>
<p>This section explains how to handle the errors notified to Servlet Container.</p>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../../_images/RESTHowToUseErrorHandlingByServletContainer.png"><img alt="Image of error handling processing by servlet container" src="../../_images/RESTHowToUseErrorHandlingByServletContainer.png" style="width: 100%;" /></a>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Processing layer</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Servlet Container</div>
<div class="line">(AP Server)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Servlet Container receives a request from the client and performs process.</div>
<div class="line">Servlet Container detects an error during the process.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Servlet Container performs error handling according to the error page definition in <code class="docutils literal"><span class="pre">web.xml</span></code>.</div>
<div class="line">If the error is not fatal, Controller for error handling is called and the error is handled.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(2’)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In case of a fatal error, a static JSON file provided in advance is fetched and a response is sent to the client.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC</div>
<div class="line">(Framework)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC calls the Controller that performs error handling.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Controller</div>
<div class="line">(Common Component)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An error object that retains error information is generated in the Controller and is returned to Spring MVC.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC</div>
<div class="line">(Framework)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC converts the error object to JSON format message by using <code class="docutils literal"><span class="pre">HttpMessageConverter</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring MVC sets the JSON format error message in response BODY and sends a response to client.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="implementing-the-controller-that-sends-error-response">
<h4><a class="toc-backref" href="#id66">5.1.4.6.1. Implementing the Controller that sends error response</a><a class="headerlink" href="#implementing-the-controller-that-sends-error-response" title="Permalink to this headline">¶</a></h4>
<p>Create a controller that sends the error response for the error notified to Servlet Container.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.common.error</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.RequestDispatcher</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.http.HttpStatus</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.MediaType</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.ResponseEntity</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.context.request.RequestAttributes</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.context.request.WebRequest</span><span class="p">;</span>

<span class="hll"><span class="c1">// (1)</span>
</span><span class="hll"><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;error&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="nd">@RestController</span>
</span><span class="hll"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiErrorPageController</span> <span class="p">{</span>
</span>
<span class="hll">    <span class="nd">@Inject</span>
</span><span class="hll">    <span class="n">ApiErrorCreator</span> <span class="n">apiErrorCreator</span><span class="p">;</span> <span class="c1">// (2)</span>
</span>
<span class="hll">    <span class="c1">// (3)</span>
</span>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">HttpStatus</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">errorCodeMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">HttpStatus</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span><span class="p">();</span>

<span class="hll">    <span class="c1">// (4)</span>
</span>    <span class="kd">public</span> <span class="nf">ApiErrorPageController</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">errorCodeMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">NOT_FOUND</span><span class="p">,</span> <span class="s">&quot;e.ex.fw.5001&quot;</span><span class="p">);</span>
    <span class="p">}</span>

<span class="hll">    <span class="c1">// (5)</span>
</span><span class="hll">    <span class="nd">@RequestMapping</span>
</span><span class="hll">    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">ApiError</span><span class="o">&gt;</span> <span class="nf">handleErrorPage</span><span class="p">(</span><span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">        <span class="c1">// (6)</span>
</span>        <span class="n">HttpStatus</span> <span class="n">httpStatus</span> <span class="o">=</span> <span class="n">HttpStatus</span><span class="p">.</span><span class="na">valueOf</span><span class="p">((</span><span class="n">Integer</span><span class="p">)</span> <span class="n">request</span>
                <span class="p">.</span><span class="na">getAttribute</span><span class="p">(</span><span class="n">RequestDispatcher</span><span class="p">.</span><span class="na">ERROR_STATUS_CODE</span><span class="p">,</span>
                        <span class="n">RequestAttributes</span><span class="p">.</span><span class="na">SCOPE_REQUEST</span><span class="p">));</span>
<span class="hll">        <span class="c1">// (7)</span>
</span>        <span class="n">String</span> <span class="n">errorCode</span> <span class="o">=</span> <span class="n">errorCodeMap</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">httpStatus</span><span class="p">);</span>
<span class="hll">        <span class="c1">// (8)</span>
</span>        <span class="n">ApiError</span> <span class="n">apiError</span> <span class="o">=</span> <span class="n">apiErrorCreator</span><span class="p">.</span><span class="na">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errorCode</span><span class="p">,</span>
                <span class="n">httpStatus</span><span class="p">.</span><span class="na">getReasonPhrase</span><span class="p">());</span>
<span class="hll">        <span class="c1">// (9)</span>
</span>        <span class="k">return</span> <span class="n">ResponseEntity</span><span class="p">.</span><span class="na">status</span><span class="p">(</span><span class="n">httpStatus</span><span class="p">).</span><span class="na">body</span><span class="p">(</span><span class="n">apiError</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create a Controller class for sending error response.</div>
<div class="line">In the above example, it is mapped to Servlet path “<code class="docutils literal"><span class="pre">/api/v1/error</span></code>”.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inject a class that creates error information.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create <code class="docutils literal"><span class="pre">Map</span></code> for mapping HTTP status code and error code.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Register mapping of HTTP status code and error code.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create a handler method that sends error response.</div>
<div class="line">Above example is implemented on considering only the case wherein, error page is handled by using a response code (<code class="docutils literal"><span class="pre">&lt;error-code&gt;</span></code>).</div>
<div class="line">Separate consideration is required for the case where an error page that is handled by using exception type (<code class="docutils literal"><span class="pre">&lt;exception-type&gt;</span></code>) is to be processed using this method.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Fetch status code stored in request scope.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Fetch error code corresponding to status code thus fetched.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(8)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Generate error information corresponding to error codes thus fetched.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(9)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return the error information generated in (8).</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="creating-a-static-json-file-to-be-sent-as-response-when-a-fatal-error-occurs">
<h4><a class="toc-backref" href="#id67">5.1.4.6.2. Creating a static JSON file to be sent as response when a fatal error occurs</a><a class="headerlink" href="#creating-a-static-json-file-to-be-sent-as-response-when-a-fatal-error-occurs" title="Permalink to this headline">¶</a></h4>
<p>Create a static JSON file to be sent as a response when a fatal error occurs.</p>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">unhandledSystemError.json</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;e.ex.fw.9999&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Unhandled system error occurred.&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="settings-for-handling-an-error-that-is-notified-to-servlet-container">
<h4><a class="toc-backref" href="#id68">5.1.4.6.3. Settings for handling an error that is notified to Servlet Container</a><a class="headerlink" href="#settings-for-handling-an-error-that-is-notified-to-servlet-container" title="Permalink to this headline">¶</a></h4>
<p>Settings for handling an error that is notified to Servlet Container are explained here.</p>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">web.xml</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- omitted --&gt;</span>

<span class="hll"><span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="nt">&lt;error-page&gt;</span>
    <span class="nt">&lt;error-code&gt;</span>404<span class="nt">&lt;/error-code&gt;</span>
    <span class="nt">&lt;location&gt;</span>/api/v1/error<span class="nt">&lt;/location&gt;</span>
<span class="nt">&lt;/error-page&gt;</span>

<span class="hll"><span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="nt">&lt;error-page&gt;</span>
    <span class="nt">&lt;exception-type&gt;</span>java.lang.Exception<span class="nt">&lt;/exception-type&gt;</span>
    <span class="nt">&lt;location&gt;</span>/WEB-INF/views/common/error/unhandledSystemError.json<span class="nt">&lt;/location&gt;</span>
<span class="nt">&lt;/error-page&gt;</span>

<span class="hll"><span class="c">&lt;!-- (3) --&gt;</span>
</span><span class="nt">&lt;mime-mapping&gt;</span>
    <span class="nt">&lt;extension&gt;</span>json<span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;mime-type&gt;</span>application/json;charset=UTF-8<span class="nt">&lt;/mime-type&gt;</span>
<span class="nt">&lt;/mime-mapping&gt;</span>

<span class="c">&lt;!-- omitted --&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add error page definition for response code if required.</div>
<div class="line">In the above example, when  error <code class="docutils literal"><span class="pre">404</span> <span class="pre">Not</span> <span class="pre">Found</span></code> occurs, Controller (`` ApiErrorPageController``) that is mapped in request “<code class="docutils literal"><span class="pre">/api/v1/error</span></code>” is called and error response is sent.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add definition for handling a fatal error.</div>
<div class="line">When a fatal error occurs, it is recommended to respond with the static JSON provided in advance, as double failure may occur during the process that creates response information.</div>
<div class="line">In the above example, fixed JSON defined in “<code class="docutils literal"><span class="pre">/WEB-INF/views/common/error/unhandledSystemError.json</span></code>” is sent as response.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify MIME type of json.</div>
<div class="line">When multi byte characters are included in the JSON file created in (2), junk characters may be displayed at client side if <code class="docutils literal"><span class="pre">charset=UTF-8</span></code> is not specified.</div>
<div class="line">When there are no multi byte characters in the JSON file, this setting is not mandatory. However, it is always safe to incorporate this setting.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In <a class="reference external" href="http://download.oracle.com/otn-pub/jcp/servlet-3_1-fr-spec/servlet-3_1-final.pdf#page=128">Servlet specification,</a>, the behaviour wherein a path is specified which assigns query parameters in <code class="docutils literal"><span class="pre">&lt;location&gt;</span></code> of <code class="docutils literal"><span class="pre">&lt;error-page&gt;</span></code> is not defined. Hence, behaviour is likely to change according to AP server.
Accordingly, it is not recommended to transfer information to transition destination at the time of error using a query parameter.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>When the request is sent to a non-existing path, following error response is sent.</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">404</span> <span class="ne">Not Found</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">2ad50fb5ba2441699c91a5b01edef83f</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Wed, 19 Feb 2014 23:24:20 GMT</span>

<span class="hll"><span class="p">{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;e.ex.fw.5001&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Resource not found.&quot;</span><span class="p">}</span>
</span></pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>When a fatal error occurs, following error response is sent.</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="hll"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">500</span> <span class="ne">Internal Server Error</span>
</span><span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">69db3854a19f439781584321d9ce8336</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">68</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Thu, 20 Feb 2014 00:13:43 GMT</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>

<span class="hll"><span class="p">{</span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;e.ex.fw.9999&quot;</span><span class="p">,</span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="s2">&quot;Unhandled system error occurred.&quot;</span><span class="p">}</span>
</span></pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="security-measures">
<span id="resthowtousesecurity"></span><h3><a class="toc-backref" href="#id69">5.1.4.7. Security measures</a><a class="headerlink" href="#security-measures" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Implementing security measures for RESTful Web Service is explained here.</div>
<div class="line">This guideline recommends using Spring Security for implementation of security measures.</div>
</div>
<div class="section" id="resthowtousesecurityauth">
<span id="id2"></span><h4><a class="toc-backref" href="#id70">5.1.4.7.1. Authentication and Authorization</a><a class="headerlink" href="#resthowtousesecurityauth" title="Permalink to this headline">¶</a></h4>
<p>Please refer to : ref: <cite>OAuth &lt;OAuth&gt;</cite> for how to achieve authentication and authorization using OAuth 2 (Spring Security OAuth 2).</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="csrf-measures">
<span id="resthowtousesecuritycsrf"></span><h4><a class="toc-backref" href="#id71">5.1.4.7.2. CSRF measures</a><a class="headerlink" href="#csrf-measures" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Refer to <a class="reference internal" href="../../Security/CSRF.html#csrf-spring-security-setting"><span class="std std-ref">CSRF Measures</span></a> for the setting methods when CSRF measures are carried out for RESTful Web Service.</li>
<li>Refer to <a class="reference internal" href="#restappendixdisabledcsrfprotection"><span class="std std-ref">Disabling CSRF measures</span></a> for the setting methods when CSRF measures are not carried out for RESTful Web Service.</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="conditional-operations-for-resource">
<span id="resthowtouseconditionaloperations"></span><h3><a class="toc-backref" href="#id72">5.1.4.8. Conditional operations for resource</a><a class="headerlink" href="#conditional-operations-for-resource" title="Permalink to this headline">¶</a></h3>
<div class="admonition-todo admonition" id="index-6">
<p class="first admonition-title">Todo</p>
<p><strong>TBD</strong></p>
<p class="last">How to implement conditional process control using headers like Etag etc. will be explained in subsequent versions.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="cache-control-for-resource">
<span id="resthowtousecachecontrol"></span><h3><a class="toc-backref" href="#id73">5.1.4.9. Cache control for resource</a><a class="headerlink" href="#cache-control-for-resource" title="Permalink to this headline">¶</a></h3>
<div class="admonition-todo admonition" id="index-7">
<p class="first admonition-title">Todo</p>
<p><strong>TBD</strong></p>
<p class="last">How to implement cache control using headers like Cache-Control/Expires/Pragma etc. will be explained in subsequent versions.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="how-to-extend">
<span id="resthowtoextend"></span><h2><a class="toc-backref" href="#id74">5.1.5. How to extend</a><a class="headerlink" href="#how-to-extend" title="Permalink to this headline">¶</a></h2>
<div class="section" id="output-control-for-response-using-jsonview">
<span id="restappendixjsonview"></span><h3><a class="toc-backref" href="#id75">5.1.5.1. Output control for response using &#64;JsonView</a><a class="headerlink" href="#output-control-for-response-using-jsonview" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Properties within the resource object can be grouped by using <code class="docutils literal"><span class="pre">&#64;JsonView</span></code>.</div>
<div class="line">Spring Framework implements this function by supporting Jackson function.</div>
<div class="line">For details, refer <a class="reference external" href="http://www.baeldung.com/jackson-json-view-annotation">JacksonJsonViews</a>.</div>
</div>
<div class="line-block">
<div class="line">The properties those belong to the specified group alone can be output by specifying the group in Controller.</div>
<div class="line">1 property may also belong to multiple groups.</div>
<div class="line"><br /></div>
<div class="line">Example of implementation when Member resource is handled in 2 formats of ‘Overview’ and ‘Details’ is as follows.</div>
<div class="line">‘Overview format’ outputs the main item of Member resource and ‘Details format’ outputs all items of Member resource.</div>
</div>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">MemberResource.java</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.member</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.joda.time.DateTime</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.joda.time.LocalDate</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.annotation.JsonView</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberResource</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="c1">// (1)</span>
    <span class="kd">interface</span> <span class="nc">Summary</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="c1">// (2)</span>
    <span class="kd">interface</span> <span class="nc">Detail</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="c1">// (3)</span>
    <span class="nd">@JsonView</span><span class="p">({</span><span class="n">Summary</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Detail</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">memberId</span><span class="p">;</span>

    <span class="nd">@JsonView</span><span class="p">({</span><span class="n">Summary</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Detail</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">firstName</span><span class="p">;</span>

    <span class="nd">@JsonView</span><span class="p">({</span><span class="n">Summary</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Detail</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">lastName</span><span class="p">;</span>

    <span class="c1">// (4)</span>
    <span class="nd">@JsonView</span><span class="p">(</span><span class="n">Detail</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">genderCode</span><span class="p">;</span>

    <span class="nd">@JsonView</span><span class="p">(</span><span class="n">Detail</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">LocalDate</span> <span class="n">dateOfBirth</span><span class="p">;</span>

    <span class="nd">@JsonView</span><span class="p">(</span><span class="n">Detail</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">emailAddress</span><span class="p">;</span>

    <span class="nd">@JsonView</span><span class="p">(</span><span class="n">Detail</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">telephoneNumber</span><span class="p">;</span>

    <span class="nd">@JsonView</span><span class="p">(</span><span class="n">Detail</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">zipCode</span><span class="p">;</span>

    <span class="nd">@JsonView</span><span class="p">(</span><span class="n">Detail</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">address</span><span class="p">;</span>

    <span class="c1">// (5)</span>
    <span class="kd">private</span> <span class="n">DateTime</span> <span class="n">createdAt</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">DateTime</span> <span class="n">lastModifiedAt</span><span class="p">;</span>

    <span class="c1">// omitted setter and getter</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A marker interface to specify the group which controls the output is defined.</div>
<div class="line">A group to be specified at the time of overview output is defined in the above example.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A marker interface to specify the group which controls the output is defined.</div>
<div class="line">A group to be specified at the time of details output is defined in the above example.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The items to be output in multiple groups can be assigned to multiple groups by setting arguments to an array and passing multiple marker interfaces.</div>
<div class="line">Since the items in the above example are to be assigned to both the groups, overview and details, 2 marker interfaces are set as arguments.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The items to be output in single group can be assigned to the corresponding group</div>
<div class="line">by setting the marker interface to argument.</div>
<div class="line">Since there is 1 element in this case, it is not necessary to set it in the array.</div>
<div class="line">Since the items in the above example are to be assigned only to the details group, 1 marker interface is set to an argument.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&#64;JsonView</span></code> is not set in the items those do not belong to the group.</div>
<div class="line">It can be changed whether the items those do not belong to the group are to be output, according to the settings.</div>
<div class="line">Method of setting is described later.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">MemberRestController.java</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.member</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.dozer.Mapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.HttpStatus</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.PathVariable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestBody</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ResponseStatus</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.examples.rest.domain.model.Member</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.examples.rest.domain.service.member.MemberService</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.annotation.JsonView</span><span class="p">;</span>

<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;members&quot;</span><span class="p">)</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRestController</span> <span class="p">{</span>

    <span class="nd">@Inject</span>
    <span class="n">MemberService</span> <span class="n">memberService</span><span class="p">;</span>

    <span class="nd">@Inject</span>
    <span class="n">Mapper</span> <span class="n">beanMapper</span><span class="p">;</span>

    <span class="c1">// (1)</span>
    <span class="nd">@JsonView</span><span class="p">(</span><span class="n">Summary</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;{memberId}&quot;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;format=summary&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>
    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">MemberResource</span> <span class="nf">getMemberSummary</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&quot;memberId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">memberId</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">getMember</span><span class="p">(</span><span class="n">memberId</span><span class="p">);</span>

        <span class="n">MemberResource</span> <span class="n">responseResource</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">member</span><span class="p">,</span>
                <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">responseResource</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// (2)</span>
    <span class="nd">@JsonView</span><span class="p">(</span><span class="n">Detail</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;{memberId}&quot;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;format=detail&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>
    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">MemberResource</span> <span class="nf">getMemberDetail</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&quot;memberId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">memberId</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">getMember</span><span class="p">(</span><span class="n">memberId</span><span class="p">);</span>

        <span class="n">MemberResource</span> <span class="n">responseResource</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">member</span><span class="p">,</span>
                <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">responseResource</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Attach <code class="docutils literal"><span class="pre">&#64;JsonView</span></code> and set the marker interface for the group to be output.</div>
<div class="line">Set <code class="docutils literal"><span class="pre">Summary</span></code> marker interface in the method that outputs the overview.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set <code class="docutils literal"><span class="pre">Detail</span></code> marker interface in the method that outputs the details.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Properties those belong to the group specified in Controller alone are displayed in the body that is output.</div>
<div class="line">The output example is as follows.</div>
</div>
<ul class="simple">
<li>Summary</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s">&quot;memberId&quot;</span> <span class="p">:</span> <span class="s">&quot;M000000001&quot;</span><span class="p">,</span>
  <span class="s">&quot;firstName&quot;</span> <span class="p">:</span> <span class="s">&quot;John&quot;</span><span class="p">,</span>
  <span class="s">&quot;lastName&quot;</span> <span class="p">:</span> <span class="s">&quot;Smith&quot;</span><span class="p">,</span>
  <span class="s">&quot;createdAt&quot;</span> <span class="p">:</span> <span class="s">&quot;2014-03-14T11:02:41.477Z&quot;</span><span class="p">,</span>
  <span class="s">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s">&quot;2014-03-14T11:02:41.477Z&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Detail</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s">&quot;memberId&quot;</span> <span class="p">:</span> <span class="s">&quot;M000000001&quot;</span><span class="p">,</span>
  <span class="s">&quot;firstName&quot;</span> <span class="p">:</span> <span class="s">&quot;John&quot;</span><span class="p">,</span>
  <span class="s">&quot;lastName&quot;</span> <span class="p">:</span> <span class="s">&quot;Smith&quot;</span><span class="p">,</span>
  <span class="s">&quot;genderCode&quot;</span> <span class="p">:</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
  <span class="s">&quot;dateOfBirth&quot;</span> <span class="p">:</span> <span class="s">&quot;2013-03-14&quot;</span><span class="p">,</span>
  <span class="s">&quot;emailAddress&quot;</span> <span class="p">:</span> <span class="s">&quot;user1394794959984@test.com&quot;</span><span class="p">,</span>
  <span class="s">&quot;telephoneNumber&quot;</span> <span class="p">:</span> <span class="s">&quot;09012345678&quot;</span><span class="p">,</span>
  <span class="s">&quot;zipCode&quot;</span> <span class="p">:</span> <span class="s">&quot;1710051&quot;</span><span class="p">,</span>
  <span class="s">&quot;address&quot;</span> <span class="p">:</span> <span class="s">&quot;Tokyo&quot;</span><span class="p">,</span>
  <span class="s">&quot;createdAt&quot;</span> <span class="p">:</span> <span class="s">&quot;2014-03-14T11:02:41.477Z&quot;</span><span class="p">,</span>
  <span class="s">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s">&quot;2014-03-14T11:02:41.477Z&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Properties without <code class="docutils literal"><span class="pre">&#64;JsonView</span></code> attached are output if <code class="docutils literal"><span class="pre">MapperFeature.DEFAULT_VIEW_INCLUSION</span></code> setting is enabled and are not output if disabled.</div>
<div class="line"><code class="docutils literal"><span class="pre">MapperFeature.DEFAULT_VIEW_INCLUSION</span></code> is enabled in the above output example.</div>
<div class="line">Set as follows when <code class="docutils literal"><span class="pre">MapperFeature.DEFAULT_VIEW_INCLUSION</span></code> is enabled.</div>
</div>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;objectMapper&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>

    <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;featuresToEnable&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;array&gt;</span>
            <span class="nt">&lt;util:constant</span> <span class="na">static-field=</span><span class="s">&quot;com.fasterxml.jackson.databind.MapperFeature.DEFAULT_VIEW_INCLUSION&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/array&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Setting is enabled by defining <code class="docutils literal"><span class="pre">MapperFeature.DEFAULT_VIEW_INCLUSION</span></code> in <code class="docutils literal"><span class="pre">featuresToEnable</span></code> element.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Set as follows when <code class="docutils literal"><span class="pre">MapperFeature.DEFAULT_VIEW_INCLUSION</span></code> is to be disabled.</div>
</div>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;objectMapper&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>

    <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;featuresToDisable&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;array&gt;</span>
            <span class="nt">&lt;util:constant</span> <span class="na">static-field=</span><span class="s">&quot;com.fasterxml.jackson.databind.MapperFeature.DEFAULT_VIEW_INCLUSION&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/array&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Setting is disabled by defining <code class="docutils literal"><span class="pre">MapperFeature.DEFAULT_VIEW_INCLUSION</span></code> in <code class="docutils literal"><span class="pre">featuresToDisable</span></code> element.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line">When <code class="docutils literal"><span class="pre">MapperFeature.DEFAULT_VIEW_INCLUSION</span></code> is disabled, contents of output in the earlier output example are changed as follows.</div>
</div>
<ul class="simple">
<li>Summary</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s">&quot;memberId&quot;</span> <span class="p">:</span> <span class="s">&quot;M000000001&quot;</span><span class="p">,</span>
  <span class="s">&quot;firstName&quot;</span> <span class="p">:</span> <span class="s">&quot;John&quot;</span><span class="p">,</span>
  <span class="s">&quot;lastName&quot;</span> <span class="p">:</span> <span class="s">&quot;Smith&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Detail</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s">&quot;memberId&quot;</span> <span class="p">:</span> <span class="s">&quot;M000000001&quot;</span><span class="p">,</span>
  <span class="s">&quot;firstName&quot;</span> <span class="p">:</span> <span class="s">&quot;John&quot;</span><span class="p">,</span>
  <span class="s">&quot;lastName&quot;</span> <span class="p">:</span> <span class="s">&quot;Smith&quot;</span><span class="p">,</span>
  <span class="s">&quot;genderCode&quot;</span> <span class="p">:</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
  <span class="s">&quot;dateOfBirth&quot;</span> <span class="p">:</span> <span class="s">&quot;2013-03-14&quot;</span><span class="p">,</span>
  <span class="s">&quot;emailAddress&quot;</span> <span class="p">:</span> <span class="s">&quot;user1394794959984@test.com&quot;</span><span class="p">,</span>
  <span class="s">&quot;telephoneNumber&quot;</span> <span class="p">:</span> <span class="s">&quot;09012345678&quot;</span><span class="p">,</span>
  <span class="s">&quot;zipCode&quot;</span> <span class="p">:</span> <span class="s">&quot;1710051&quot;</span><span class="p">,</span>
  <span class="s">&quot;address&quot;</span> <span class="p">:</span> <span class="s">&quot;Tokyo&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You need to be careful since the default value when <code class="docutils literal"><span class="pre">MapperFeature.DEFAULT_VIEW_INCLUSION</span></code> is not specified, varies according to the setting method for <code class="docutils literal"><span class="pre">ObjectMapper</span></code>.
It is also mentioned in <a class="reference internal" href="#resthowtouseapplicationsettingsofspringmvc"><span class="std std-ref">Settings for activating the Spring MVC components necessary for RESTful Web Service</span></a> that the default value becomes valid if the direct Bean definition is applied for the method to define Bean for <code class="docutils literal"><span class="pre">ObjectMapper</span></code>. If <code class="docutils literal"><span class="pre">Jackson2ObjectMapperFactoryBean</span></code> is used, the default value becomes invalid. For explicitly carrying out settings, it is recommended to include <code class="docutils literal"><span class="pre">MapperFeature.DEFAULT_VIEW_INCLUSION</span></code> specification for setting with either of the styles.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="docutils literal"><span class="pre">&#64;JsonView</span></code> is created using the following 2 functions. These are the functions those can be used when the common processes before and after object mapping are to be implemented in the process methods to which <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> in the Controller is added.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">org.springframework.web.servlet.mvc.method.annotation.RequestBodyAdvice</span></code></li>
<li><code class="docutils literal"><span class="pre">org.springframework.web.servlet.mvc.method.annotation.ResponseBodyAdvice</span></code></li>
</ul>
<p><code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> can be applied by adding it to the implementation class of these interfaces. Refer <a class="reference internal" href="../../ImplementationAtEachLayer/ApplicationLayer.html#application-layer-controller-advice"><span class="std std-ref">Implementing “&#64;ControllerAdvice”</span></a> for the details of <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code>.</p>
<p><code class="docutils literal"><span class="pre">RequestBodyAdvice</span></code> can implement the following method.</p>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">org.springframework.web.servlet.mvc.method.annotation.RequestBodyAdvice</span></code></li>
</ul>
<blockquote>
<div><table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Method name</th>
<th class="head">Overview</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">supports</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Determine whether this Advice is applied to the request sent. It is applied if <code class="docutils literal"><span class="pre">true</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">handleEmptyBody</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is called before the contents of request body are reflected in the object used in Controller and when the body is empty.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">beforeBodyRead</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is called before the contents of request body are reflected in the object used in Controller.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">afterBodyRead</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is called after the contents of request body are reflected in the object used in Controller.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>When it is not required to describe the processes with all above timings, they can be easily implemented by inheriting <code class="docutils literal"><span class="pre">org.springframework.web.servlet.mvc.method.annotation.RequestBodyAdviceAdapter</span></code> implemented with the above methods except supports not performing any action and overriding only the necessary portion.</p>
<p><code class="docutils literal"><span class="pre">ResponseBodyAdvice</span></code> can implement the following method.</p>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">org.springframework.web.servlet.mvc.method.annotation.ResponseBodyAdvice</span></code></li>
</ul>
<blockquote class="last">
<div><table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Method name</th>
<th class="head">Overview</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">supports</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Determine whether this Advice is applied to the request sent. It is applied if <code class="docutils literal"><span class="pre">true</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">beforeBodyWrite</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is called before reflecting the return value in the response after the process in Controller is completed.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="appendix">
<span id="restappendix"></span><h2><a class="toc-backref" href="#id76">5.1.6. Appendix</a><a class="headerlink" href="#appendix" title="Permalink to this headline">¶</a></h2>
<div class="section" id="configuration-while-using-jsr-310-date-and-time-api-joda-time">
<span id="restappendixusingjsr310-jodatime"></span><h3><a class="toc-backref" href="#id77">5.1.6.1. Configuration while using JSR-310 Date and Time API / Joda Time</a><a class="headerlink" href="#configuration-while-using-jsr-310-date-and-time-api-joda-time" title="Permalink to this headline">¶</a></h3>
<p>When JSR-310 Date and Time API is to be used as a property of JavaBean which represents a resource (Resource class),
it is not necessary to add a dependency relation since the dependency relation is defined in terasoluna-gfw-common-dependencies.
On the contrary, when Joda Time class is to be used,
an extension module provided by Jackson in <code class="docutils literal"><span class="pre">pom.xml</span></code> is added to dependent library.</p>
<p><strong>When Joda Time class is used</strong></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.terasoluna.gfw<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>terasoluna-gfw-jodatime-dependencies<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.datatype<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>jackson-datatype-joda<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<blockquote>
<div>In the above setting example, since it is assumed that the dependent library version is managed by the parent project terasoluna-gfw-parent , specifying the version in pom.xml is not necessary.
The above jackson-datatype-joda  used by terasoluna-gfw-parent is defined by <a class="reference external" href="http://platform.spring.io/platform/">Spring IO Platform</a>.</div></blockquote>
<p>Besides above, extension modules (<code class="docutils literal"><span class="pre">jackson-datatype-xxx</span></code>) for handling</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">java.nio.file.Path</span></code> added from Java SE 7</li>
<li><code class="docutils literal"><span class="pre">java.util.Optional</span></code> added from Java SE 8</li>
<li>Objects that are set as Proxy by using Lazy Load function of Hibernate ORM</li>
</ul>
<p class="last">are provided by another Jackson.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="settings-when-restful-web-service-and-client-application-are-operated-as-the-same-web-application">
<span id="restappendixsettingsofdeployinsamewarfilerestandclientapplication"></span><h3><a class="toc-backref" href="#id78">5.1.6.2. Settings when RESTful Web Service and client application are operated as the same Web application</a><a class="headerlink" href="#settings-when-restful-web-service-and-client-application-are-operated-as-the-same-web-application" title="Permalink to this headline">¶</a></h3>
<div class="section" id="how-to-set-dispatcherservlet-for-restful-web-service">
<span id="restappendixdividedispatcherservlet"></span><h4><a class="toc-backref" href="#id79">5.1.6.2.1. How to set <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> for RESTful Web Service</a><a class="headerlink" href="#how-to-set-dispatcherservlet-for-restful-web-service" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">When RESTful Web Service and client application are built as same Web application, it is recommended to divide as <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> that receives the requests for RESTful Web Service and <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> that receives client application requests.</div>
<div class="line">How to divide <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> is explained below.</div>
</div>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">web.xml</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- omitted --&gt;</span>

<span class="hll"><span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="nt">&lt;servlet&gt;</span>
    <span class="nt">&lt;servlet-name&gt;</span>appServlet<span class="nt">&lt;/servlet-name&gt;</span>
    <span class="nt">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="nt">&lt;/servlet-class&gt;</span>
    <span class="nt">&lt;init-param&gt;</span>
        <span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
        <span class="nt">&lt;param-value&gt;</span>classpath*:META-INF/spring/spring-mvc.xml<span class="nt">&lt;/param-value&gt;</span>
    <span class="nt">&lt;/init-param&gt;</span>
    <span class="nt">&lt;load-on-startup&gt;</span>1<span class="nt">&lt;/load-on-startup&gt;</span>
<span class="nt">&lt;/servlet&gt;</span>
<span class="nt">&lt;servlet-mapping&gt;</span>
    <span class="nt">&lt;servlet-name&gt;</span>appServlet<span class="nt">&lt;/servlet-name&gt;</span>
    <span class="nt">&lt;url-pattern&gt;</span>/<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/servlet-mapping&gt;</span>
<span class="hll">
</span><span class="hll"><span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll"><span class="nt">&lt;servlet&gt;</span>
</span><span class="hll">    <span class="nt">&lt;servlet-name&gt;</span>restAppServlet<span class="nt">&lt;/servlet-name&gt;</span>
</span>    <span class="nt">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="nt">&lt;/servlet-class&gt;</span>
    <span class="nt">&lt;init-param&gt;</span>
        <span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
<span class="hll">        <span class="c">&lt;!-- (3) --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;param-value&gt;</span>classpath*:META-INF/spring/spring-mvc-rest.xml<span class="nt">&lt;/param-value&gt;</span>
</span>    <span class="nt">&lt;/init-param&gt;</span>
    <span class="nt">&lt;load-on-startup&gt;</span>2<span class="nt">&lt;/load-on-startup&gt;</span>
<span class="nt">&lt;/servlet&gt;</span>
<span class="hll"><span class="c">&lt;!-- (4) --&gt;</span>
</span><span class="hll"><span class="nt">&lt;servlet-mapping&gt;</span>
</span><span class="hll">    <span class="nt">&lt;servlet-name&gt;</span>restAppServlet<span class="nt">&lt;/servlet-name&gt;</span>
</span><span class="hll">    <span class="nt">&lt;url-pattern&gt;</span>/api/v1/*<span class="nt">&lt;/url-pattern&gt;</span>
</span><span class="hll"><span class="nt">&lt;/servlet-mapping&gt;</span>
</span>
<span class="c">&lt;!-- omitted --&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Request mapping with the <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> that receives request for client application.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add Servlet (<code class="docutils literal"><span class="pre">DispatcherServlet</span></code>) that receives the request for RESTful Web Service.</div>
<div class="line">Specify a name indicating it as RESTful Web Service Servlet in <code class="docutils literal"><span class="pre">&lt;servlet-name&gt;</span></code> element.</div>
<div class="line">In the above example, <code class="docutils literal"><span class="pre">restAppServlet</span></code> is specified as the Servlet name.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify Spring MVC bean definition file to be used while building the <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> for RESTful Web Service.</div>
<div class="line">In the above example, <code class="file docutils literal"><span class="pre">META-INF/spring/spring-mvc-rest.xml</span></code> in class path, is specified as the Spring MVC bean definition file.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the pattern of servlet path mapped to the <code class="docutils literal"><span class="pre">DispatcherServlet</span></code>for RESTful Web Service.</div>
<div class="line">In the above example, the Servlet path under <code class="docutils literal"><span class="pre">/api/v1/</span></code> is mapped in the <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> for RESTful Web Service.</div>
<div class="line">Typically, Servlet paths like</div>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">/api/v1/</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">/api/v1/members</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">/api/v1/members/xxxxx</span></code></div>
</div>
<div class="line">are mapped in the <code class="docutils literal"><span class="pre">DispatcherServlet</span></code> (<code class="docutils literal"><span class="pre">restAppServlet</span></code>) for RESTful Web Service.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>Value to be specified in the value attribute of &#64;RequestMapping annotation</strong></p>
<p>Value in the wild card (<code class="docutils literal"><span class="pre">*</span></code>) part specified in <code class="docutils literal"><span class="pre">&lt;url-pattern&gt;</span></code> element, is specified as the value in “value” attribute of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.</p>
<p>For example, when <code class="docutils literal"><span class="pre">&#64;RequestMapping(value</span> <span class="pre">=</span> <span class="pre">&quot;members&quot;)</span></code> is specified, it is deployed as the method that performs process for path <code class="docutils literal"><span class="pre">/api/v1/members</span></code>.
Therefore, it is not necessary to specify the path (<code class="docutils literal"><span class="pre">api/v1</span></code>) that performs mapping in divided Servlets, in the value attribute of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.</p>
<p class="last">When specified as <code class="docutils literal"><span class="pre">&#64;RequestMapping(value</span> <span class="pre">=</span> <span class="pre">&quot;api/v1/members&quot;)</span></code>, it ends up being deployed as the method performing the process for path <code class="docutils literal"><span class="pre">/api/v1/api/v1/members</span></code>. Hence, please take note of same.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="implementing-hypermedia-link">
<span id="restappendixhypermedialink"></span><h3><a class="toc-backref" href="#id80">5.1.6.3. Implementing hypermedia link</a><a class="headerlink" href="#implementing-hypermedia-link" title="Permalink to this headline">¶</a></h3>
<p>Implementation for including a hypermedia link to a related resource in JSON, is explained here.</p>
<div class="section" id="implementing-common-parts">
<h4><a class="toc-backref" href="#id81">5.1.6.3.1. Implementing common parts</a><a class="headerlink" href="#implementing-common-parts" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Create a JavaBean that retains the link information.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.common.resource</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>

<span class="hll"><span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Link</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">rel</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">href</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">Link</span><span class="p">(</span><span class="n">String</span> <span class="n">rel</span><span class="p">,</span> <span class="n">String</span> <span class="n">href</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rel</span> <span class="o">=</span> <span class="n">rel</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">href</span> <span class="o">=</span> <span class="n">href</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getRel</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">rel</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getHref</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">href</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create a JavaBean for link information that retains the link name and URL.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li>Create an abstract class of Resource that retains collection of link information.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.common.resource</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.net.URI</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.LinkedHashSet</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Set</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.annotation.JsonInclude</span><span class="p">;</span>

<span class="hll"><span class="c1">// (2)</span>
</span><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AbstractLinksSupportedResource</span> <span class="p">{</span>

<span class="hll">    <span class="c1">// (3)</span>
</span>    <span class="nd">@JsonInclude</span><span class="p">(</span><span class="n">JsonInclude</span><span class="p">.</span><span class="na">Include</span><span class="p">.</span><span class="na">NON_EMPTY</span><span class="p">)</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Link</span><span class="o">&gt;</span> <span class="n">links</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashSet</span><span class="o">&lt;&gt;</span><span class="p">();</span>

    <span class="kd">public</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Link</span><span class="o">&gt;</span> <span class="nf">getLinks</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">links</span><span class="p">;</span>
    <span class="p">}</span>

<span class="hll">    <span class="c1">// (4)</span>
</span>    <span class="kd">public</span> <span class="n">AbstractLinksSupportedResource</span> <span class="nf">addLink</span><span class="p">(</span><span class="n">String</span> <span class="n">rel</span><span class="p">,</span> <span class="n">URI</span> <span class="n">href</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">links</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="n">Link</span><span class="p">(</span><span class="n">rel</span><span class="p">,</span> <span class="n">href</span><span class="p">.</span><span class="na">toString</span><span class="p">()));</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

<span class="hll">    <span class="c1">// (5)</span>
</span>    <span class="kd">public</span> <span class="n">AbstractLinksSupportedResource</span> <span class="nf">addSelf</span><span class="p">(</span><span class="n">URI</span> <span class="n">href</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">addLink</span><span class="p">(</span><span class="s">&quot;self&quot;</span><span class="p">,</span> <span class="n">href</span><span class="p">);</span>
    <span class="p">}</span>

<span class="hll">    <span class="c1">// (5)</span>
</span>    <span class="kd">public</span> <span class="n">AbstractLinksSupportedResource</span> <span class="nf">addParent</span><span class="p">(</span><span class="n">URI</span> <span class="n">href</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">addLink</span><span class="p">(</span><span class="s">&quot;parent&quot;</span><span class="p">,</span> <span class="n">href</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create an abstract class (JavaBean) of the Resource that retains collection of link information.</div>
<div class="line">It is assumed that this is the class inherited by the Resource class supporting hypermedia link.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define a field that retains information of multiple links.</div>
<div class="line">In the above example, <code class="docutils literal"><span class="pre">&#64;JsonInclude(JsonInclude.Include.NON_EMPTY)</span></code> is specified to prevent output to JSON when link is not specified.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create a method to add link information.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">If required, create a method to add common link information.</div>
<div class="line">In the above example, methods to add link information for accessing the resource itself (<code class="docutils literal"><span class="pre">self</span></code>) and to add link information for accessing parent resource (<code class="docutils literal"><span class="pre">&quot;parent&quot;</span></code>) are created.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementation-for-each-resource">
<h4><a class="toc-backref" href="#id82">5.1.6.3.2. Implementation for each resource</a><a class="headerlink" href="#implementation-for-each-resource" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Inherit an abstract class of Resource that retains collection of link information in Resource class.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.member</span><span class="p">;</span>

<span class="hll"><span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberResource</span> <span class="kd">extends</span>
    <span class="n">AbstractLinksSupportedResource</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inherit an abstract class of Resource that retains collection of link information.</div>
<div class="line">By this, the field (<code class="docutils literal"><span class="pre">links</span></code>) that retains collection of link information is imported, thus making it a Resource class that supports hypermedia link.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<ul class="simple">
<li>Adding hypermedia link by REST API process.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;members&quot;</span><span class="p">)</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRestController</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;{memberId}&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>
    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">MemberResource</span> <span class="nf">getMember</span><span class="p">(</span>
            <span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&quot;memberId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">memberId</span>
<span class="hll">            <span class="c1">// (2)</span>
</span>            <span class="n">UriComponentsBuilder</span> <span class="n">uriBuilder</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">getMember</span><span class="p">(</span><span class="n">memberId</span><span class="p">);</span>

        <span class="n">MemberResource</span> <span class="n">responseResource</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">member</span><span class="p">,</span>
                <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

<span class="hll">        <span class="c1">// (3)</span>
</span>        <span class="n">responseResource</span><span class="p">.</span><span class="na">addSelf</span><span class="p">(</span><span class="n">uriBuilder</span><span class="p">.</span><span class="na">path</span><span class="p">(</span><span class="s">&quot;/members&quot;</span><span class="p">).</span><span class="na">pathSegment</span><span class="p">(</span><span class="n">memberId</span><span class="p">)</span>
                <span class="p">.</span><span class="na">build</span><span class="p">().</span><span class="na">toUri</span><span class="p">());</span>

        <span class="k">return</span> <span class="n">responseResource</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">org.springframework.web.util.UriComponentsBuilder</span></code></div>
<div class="line">class, provided by Spring MVC, in method argument in order to build URI set in link information.</div>
<div class="line">When <code class="docutils literal"><span class="pre">UriComponentsBuilder</span></code> class is specified in method argument of Controller, instance of <code class="docutils literal"><span class="pre">org.springframework.web.servlet.support.ServletUriComponentsBuilder</span></code> class,</div>
<div class="line">that has inherited <code class="docutils literal"><span class="pre">UriComponentsBuilder</span></code> class in Spring MVC, is passed at the time of method execution.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add link information to resource.</div>
<div class="line">In the above example, <code class="docutils literal"><span class="pre">UriComponentsBuilder</span></code> class method is called to build URI set in link information and URI to access to one’s resource is added to resource.</div>
<div class="line"><br /></div>
<div class="line"><code class="docutils literal"><span class="pre">ServletUriComponentsBuilder</span></code> instances passed as method argument of Controller are initiated based on the information of <code class="docutils literal"><span class="pre">&lt;servlet-mapping&gt;</span></code> element described in web.xml. It is not resource dependent.</div>
<div class="line">By using <a class="reference external" href="http://docs.spring.io/spring/docs/4.3.14.RELEASE/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-uri-templates">URI Template Patterns</a> ,etc. provided in Spring Framework,</div>
<div class="line">an URI can be built based on the request information. Thus, a generic build process which is independent of a resource, can be implemented.</div>
<div class="line"><br /></div>
<div class="line">In the above example, when GET is done for <code class="docutils literal"><span class="pre">http://example.com/api/v1/members/M000000001</span></code>, built URI is same as the requested URI <code class="docutils literal"><span class="pre">(http://example.com/api/v1/members/M000000001)</span></code>.</div>
<div class="line"><br /></div>
<div class="line">Method that builds an URI to be set in link information should be implemented as required.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">When building an URL in <code class="docutils literal"><span class="pre">ServletUriComponentsBuilder</span></code>, by referring to “<code class="docutils literal"><span class="pre">X-Forwarded-Host</span></code> ” header, a configuration with a load balancer or Web server between client and the application server is considered.
However, it should be noted that the expected URI will not be built if it does not match with the path configuration.</p>
</div>
</div></blockquote>
<ul>
<li><div class="first line-block">
<div class="line">Response example</div>
<div class="line">Following response is obtained in actual operation.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="nf">GET</span> <span class="nn">/rest-api-web/api/v1/members/M000000001</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">text/plain, application/json, application/*+json, */*</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Java/1.7.0_51</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">localhost:8080</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="hll">  <span class="s">&quot;links&quot;</span> <span class="p">:</span> <span class="o">[</span> <span class="p">{</span>
</span><span class="hll">    <span class="s">&quot;rel&quot;</span> <span class="p">:</span> <span class="s">&quot;self&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="s">&quot;href&quot;</span> <span class="p">:</span> <span class="s">&quot;http://localhost:8080/rest-api-web/api/v1/members/M000000001&quot;</span>
</span><span class="hll">  <span class="p">}</span> <span class="o">]</span><span class="p">,</span>
</span>  <span class="s">&quot;memberId&quot;</span> <span class="p">:</span> <span class="s">&quot;M000000001&quot;</span><span class="p">,</span>
  <span class="s">&quot;firstName&quot;</span> <span class="p">:</span> <span class="s">&quot;John&quot;</span><span class="p">,</span>
  <span class="s">&quot;lastName&quot;</span> <span class="p">:</span> <span class="s">&quot;Smith&quot;</span><span class="p">,</span>
  <span class="s">&quot;genderCode&quot;</span> <span class="p">:</span> <span class="s">&quot;1&quot;</span><span class="p">,</span>
  <span class="s">&quot;dateOfBirth&quot;</span> <span class="p">:</span> <span class="s">&quot;2013-03-14&quot;</span><span class="p">,</span>
  <span class="s">&quot;emailAddress&quot;</span> <span class="p">:</span> <span class="s">&quot;user1394794959984@test.com&quot;</span><span class="p">,</span>
  <span class="s">&quot;telephoneNumber&quot;</span> <span class="p">:</span> <span class="s">&quot;09012345678&quot;</span><span class="p">,</span>
  <span class="s">&quot;zipCode&quot;</span> <span class="p">:</span> <span class="s">&quot;1710051&quot;</span><span class="p">,</span>
  <span class="s">&quot;address&quot;</span> <span class="p">:</span> <span class="s">&quot;Tokyo&quot;</span><span class="p">,</span>
  <span class="s">&quot;credential&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="s">&quot;signId&quot;</span> <span class="p">:</span> <span class="s">&quot;user1394794959984@test.com&quot;</span><span class="p">,</span>
    <span class="s">&quot;passwordLastChangedAt&quot;</span> <span class="p">:</span> <span class="s">&quot;2014-03-14T11:02:41.477Z&quot;</span><span class="p">,</span>
    <span class="s">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s">&quot;2014-03-14T11:02:41.477Z&quot;</span>
  <span class="p">},</span>
  <span class="s">&quot;createdAt&quot;</span> <span class="p">:</span> <span class="s">&quot;2014-03-14T11:02:41.477Z&quot;</span><span class="p">,</span>
  <span class="s">&quot;lastModifiedAt&quot;</span> <span class="p">:</span> <span class="s">&quot;2014-03-14T11:02:41.477Z&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="creating-restful-web-service-conforming-to-http-specifications">
<span id="restappendixrestapiofhttpcompliance"></span><h3><a class="toc-backref" href="#id83">5.1.6.4. Creating RESTful Web Service conforming to HTTP specifications</a><a class="headerlink" href="#creating-restful-web-service-conforming-to-http-specifications" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">A part of REST API implementation explained in this version does not conform to HTTP specifications.</div>
<div class="line">This section explains the implementation that creates the RESTful Web Service conforming to HTTP specifications.</div>
</div>
<div class="section" id="settings-for-location-header-at-the-time-of-post">
<h4><a class="toc-backref" href="#id84">5.1.6.4.1. Settings for location header at the time of POST</a><a class="headerlink" href="#settings-for-location-header-at-the-time-of-post" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">When conforming to HTTP specifications, it is necessary to set the URI of created resource in the response header of POST method (“Location header”).</div>
<div class="line">Implementation to set the URI of created resource in the response header in case of POST (“Location header”) is explained here.</div>
</div>
</div>
<div class="section" id="id3">
<h4><a class="toc-backref" href="#id85">5.1.6.4.2. Implementation for each resource</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>The URI of created resource is set in Location header by REST API process.</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;members&quot;</span><span class="p">)</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRestController</span> <span class="p">{</span>

    <span class="c1">// omitted</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">MemberResource</span><span class="o">&gt;</span> <span class="nf">postMembers</span><span class="p">(</span>
            <span class="nd">@RequestBody</span> <span class="nd">@Validated</span><span class="p">({</span> <span class="n">PostMembers</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
            <span class="n">MemberResource</span> <span class="n">requestedResource</span><span class="p">,</span>
<span class="hll">            <span class="c1">// (1)</span>
</span>            <span class="n">UriComponentsBuilder</span> <span class="n">uriBuilder</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">Member</span> <span class="n">creatingMember</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">requestedResource</span><span class="p">,</span> <span class="n">Member</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

        <span class="n">Member</span> <span class="n">createdMember</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">createMember</span><span class="p">(</span><span class="n">creatingMember</span><span class="p">);</span>

        <span class="n">MemberResource</span> <span class="n">responseResource</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">createdMember</span><span class="p">,</span>
                <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

<span class="hll">        <span class="c1">// (2)</span>
</span>        <span class="n">URI</span> <span class="n">createdUri</span> <span class="o">=</span> <span class="n">uriBuilder</span><span class="p">.</span><span class="na">path</span><span class="p">(</span><span class="s">&quot;/members/{memberId}&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="na">buildAndExpand</span><span class="p">(</span><span class="n">responseResource</span><span class="p">.</span><span class="na">getMemberId</span><span class="p">()).</span><span class="na">toUri</span><span class="p">();</span>

<span class="hll">        <span class="c1">// (3)</span>
</span>        <span class="k">return</span> <span class="n">ResponseEntity</span><span class="p">.</span><span class="na">created</span><span class="p">(</span><span class="n">createdUri</span><span class="p">).</span><span class="na">body</span><span class="p">(</span><span class="n">responseResource</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// omitted</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">org.springframework.web.util.UriComponentsBuilder</span></code> class provided by Spring MVC, in method argument in order to build an URI of created resource.</div>
<div class="line">When <code class="docutils literal"><span class="pre">UriComponentsBuilder</span></code> class is specified in method argument of Controller, an instance of <code class="docutils literal"><span class="pre">org.springframework.web.servlet.support.ServletUriComponentsBuilder</span></code> class,</div>
<div class="line">that has inherited <code class="docutils literal"><span class="pre">UriComponentsBuilder</span></code> class by Spring MVC, is passed at the time of method execution.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Build an URI of created resource.</div>
<div class="line">In above example, by <code class="docutils literal"><span class="pre">path</span></code> method, a path using URI Template Patterns is added to <code class="docutils literal"><span class="pre">ServletUriComponentsBuilder</span></code> instance passed as argument,</div>
<div class="line"><code class="docutils literal"><span class="pre">buildAndExpand</span></code> method is called and an URI of created resource is built by binding the ID of created resource.</div>
<div class="line"><br /></div>
<div class="line"><code class="docutils literal"><span class="pre">ServletUriComponentsBuilder</span></code> instances passed as method argument of Controller are initiated based on the information of <code class="docutils literal"><span class="pre">&lt;servlet-mapping&gt;</span></code> element described in web.xml. It is not resource dependent.</div>
<div class="line">By using <a class="reference external" href="http://docs.spring.io/spring/docs/4.3.14.RELEASE/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-uri-templates">URI Template Patterns</a> ,etc. provided by Spring Framework,</div>
<div class="line">an URI can be built based on the request information. Thus, a generic build process which is independent of a resource, can be implemented.</div>
<div class="line"><br /></div>
<div class="line">For example, if POST method is used for <code class="docutils literal"><span class="pre">http://example.com/api/v1/members</span></code>, the built URI will be “requested URI + “<code class="docutils literal"><span class="pre">/</span></code>”  + ID of created resource”.</div>
<div class="line">Typically, if <code class="docutils literal"><span class="pre">M000000001</span></code> is specified in ID, it becomes <code class="docutils literal"><span class="pre">http://example.com/api/v1/members/M000000001</span></code>.</div>
<div class="line"><br /></div>
<div class="line">Method that builds an URI to be set in link information should be implemented as required.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">Create the <code class="docutils literal"><span class="pre">org.springframework.http.ResponseEntity</span></code> instance using following parameters, and return it.</div>
</div>
<ul class="last simple">
<li>Status code : 201(Created)</li>
<li>Location header : Created resource’s URI</li>
<li>Response body : Created resource object</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">When building an URL in <code class="docutils literal"><span class="pre">ServletUriComponentsBuilder</span></code>, by referring to “<code class="docutils literal"><span class="pre">X-Forwarded-Host</span></code> ” header, a configuration with a load balancer or Web server between client and the application server is considered.
However, it should be noted that the expected URI will not be built if it does not match with the path configuration.</p>
</div>
</div></blockquote>
<ul>
<li><div class="first line-block">
<div class="line">Response example</div>
<div class="line">Following response header is obtained in the actual operation.</div>
</div>
</li>
</ul>
<blockquote>
<div><div class="highlight-http"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Server</span><span class="o">:</span> <span class="l">Apache-Coyote/1.1</span>
<span class="na">X-Track</span><span class="o">:</span> <span class="l">693e132312d64998a7d8d6cabf3d13ef</span>
<span class="hll"><span class="na">Location</span><span class="o">:</span> <span class="l">http://localhost:8080/rest-api-web/api/v1/members/M000000001</span>
</span><span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json;charset=UTF-8</span>
<span class="na">Transfer-Encoding</span><span class="o">:</span> <span class="l">chunked</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Fri, 14 Mar 2014 12:34:31 GMT</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="disabling-csrf-measures">
<span id="restappendixdisabledcsrfprotection"></span><h3><a class="toc-backref" href="#id86">5.1.6.5. Disabling CSRF measures</a><a class="headerlink" href="#disabling-csrf-measures" title="Permalink to this headline">¶</a></h3>
<p>Settings that prevent CSRF measures implementation for RESTful Web Service requests, are explained below.</p>
<blockquote>
<div><div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Need to use session is eliminated when CSRF measures are not to be implemented.</p>
<p class="last">In the following configuration example, session will not be used in Spring Security process.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>CSRF measures are enabled as per the default settings of Blank project. By adding following settings, the process for CSRF measures is
prevented for RESTful Web Service requests.</p>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">spring-security.xml</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- omitted --&gt;</span>

<span class="hll"><span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="hll"><span class="nt">&lt;sec:http</span>
</span><span class="hll">    <span class="na">pattern=</span><span class="s">&quot;/api/v1/**&quot;</span>
</span><span class="hll">    <span class="na">create-session=</span><span class="s">&quot;stateless&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">    <span class="nt">&lt;sec:http-basic</span> <span class="nt">/&gt;</span>
</span><span class="hll">    <span class="nt">&lt;sec:csrf</span> <span class="na">disabled=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll"><span class="nt">&lt;/sec:http&gt;</span>
</span><span class="hll">
</span><span class="nt">&lt;sec:http&gt;</span>
    <span class="nt">&lt;sec:access-denied-handler</span> <span class="na">ref=</span><span class="s">&quot;accessDeniedHandler&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;sec:custom-filter</span> <span class="na">ref=</span><span class="s">&quot;userIdMDCPutFilter&quot;</span> <span class="na">after=</span><span class="s">&quot;ANONYMOUS_FILTER&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;sec:form-login/&gt;</span>
    <span class="nt">&lt;sec:logout/&gt;</span>
    <span class="nt">&lt;sec:session-management</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>

<span class="c">&lt;!-- omitted --&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add Spring Security definition for REST API.</div>
<div class="line">URL pattern of REST API request path is specified in <code class="docutils literal"><span class="pre">pattern</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:http&gt;</span></code> element.</div>
<div class="line">In the above example, request path starting with <code class="docutils literal"><span class="pre">/api/v1/</span></code> is handled as the REST API request path.</div>
<div class="line">Further, session is no longer used in Spring Security process by setting <code class="docutils literal"><span class="pre">create-session</span></code> attribute to <code class="docutils literal"><span class="pre">stateless</span></code>.</div>
<div class="line"><br /></div>
<div class="line">Specify <code class="docutils literal"><span class="pre">disabled=&quot;true&quot;</span></code> in <code class="docutils literal"><span class="pre">&lt;sec:csrf&gt;</span></code> element for invalidating CSRF countermeasures.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="enabling-xxe-injection-measures">
<span id="restappendixenabledxxeinjectprotection"></span><h3><a class="toc-backref" href="#id87">5.1.6.6. Enabling XXE Injection measures</a><a class="headerlink" href="#enabling-xxe-injection-measures" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">When handling XML format data in RESTful Web Service, it is necessary to implement <a class="reference external" href="https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing">XXE (XML External Entity) Injection</a> measures.</div>
<div class="line">terasoluna-gfw-web 1.0.1.RELEASE or higher versions are Spring MVC (3.2.10.RELEASE and above) dependent. As these Spring MVC versions implement XXE Injection measures, it is not necessary to implement them individually.</div>
</div>
<blockquote>
<div><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>XXE (XML External Entity) Injection measures</strong></p>
<p class="last">When using terasoluna-gfw-web 1.0.0.RELEASE, a class provided by Spring-oxm should be used, as this version is dependent on the Spring MVC version (3.2.4.RELEASE), that does not implement XXE Injection measures.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Adding Spring-oxm as dependent artifact.</p>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">pom.xml</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- omitted --&gt;</span>

<span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-oxm<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${org.springframework-version}<span class="nt">&lt;/version&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="c">&lt;!-- omitted --&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add Spring-oxm as a dependent artifact.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring version should be fetched from the placeholder (${org.springframework-version}) that manages version number of Spring defined in <code class="file docutils literal"><span class="pre">pom.xml</span></code> of terasoluna-gfw-parent.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Perform Bean definition for mutual conversion between XML and object by using the class provided by Spring-oxm.</p>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">spring-mvc-rest.xml</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- omitted --&gt;</span>

<span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;xmlMarshaller&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework.oxm.jaxb.Jaxb2Marshaller&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;packagesToScan&quot;</span> <span class="na">value=</span><span class="s">&quot;com.examples.app&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!-- omitted --&gt;</span>

<span class="nt">&lt;mvc:annotation-driven&gt;</span>

    <span class="nt">&lt;mvc:message-converters&gt;</span>
        <span class="c">&lt;!-- (3) --&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.http.converter.xml.MarshallingHttpMessageConverter&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;marshaller&quot;</span> <span class="na">ref=</span><span class="s">&quot;xmlMarshaller&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (4) --&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;unmarshaller&quot;</span> <span class="na">ref=</span><span class="s">&quot;xmlMarshaller&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (5) --&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/mvc:message-converters&gt;</span>

    <span class="c">&lt;!-- omitted --&gt;</span>

<span class="nt">&lt;/mvc:annotation-driven&gt;</span>

<span class="c">&lt;!-- omitted --&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Perform Bean definition for <code class="docutils literal"><span class="pre">Jaxb2Marshaller</span></code> provided by Spring-oxm.</div>
<div class="line">For <code class="docutils literal"><span class="pre">Jaxb2Marshaller</span></code>, XXE injection measures are carried out by default.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify package name with JAXB JavaBean (JavaBean assigned with <code class="docutils literal"><span class="pre">javax.xml.bind.annotation.XmlRootElement</span></code> annotation) stored in <code class="docutils literal"><span class="pre">packagesToScan</span></code> property.</div>
<div class="line">JAXB JavaBean stored under the specified package is scanned and is registered as JavaBean for marshalling and unmarshalling.</div>
<div class="line">JavaBean is scanned by the mechanism same as base-package attribute of <code class="docutils literal"><span class="pre">&lt;context:component-scan&gt;</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add bean definition of <code class="docutils literal"><span class="pre">MarshallingHttpMessageConverter</span></code> to <code class="docutils literal"><span class="pre">&lt;mvc:message-converters&gt;</span></code> element which is the child element of <code class="docutils literal"><span class="pre">&lt;mvc:annotation-driven&gt;</span></code> element.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">Jaxb2Marshaller</span></code> bean defined in (1) in <code class="docutils literal"><span class="pre">marshaller</span></code> property.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">Jaxb2Marshaller</span></code> bean defined in (1) in <code class="docutils literal"><span class="pre">unmarshaller</span></code> property.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="how-to-copy-joda-time-classes-using-dozer">
<span id="restappendixcopyjodaobjectbybeanconvert"></span><h3><a class="toc-backref" href="#id88">5.1.6.7. How to copy Joda-Time classes using Dozer</a><a class="headerlink" href="#how-to-copy-joda-time-classes-using-dozer" title="Permalink to this headline">¶</a></h3>
<p>How to copy Joda-Time classes (<code class="docutils literal"><span class="pre">org.joda.time.DateTime</span></code>, <code class="docutils literal"><span class="pre">org.joda.time.LocalDate</span></code> etc.) using Dozer is explained here.</p>
<div class="line-block">
<div class="line">Create a custom converter for converting the Joda-Time class.</div>
<div class="line">For details of custom converter, refer to “<a class="reference internal" href="../GeneralFuncDetail/Dozer.html"><span class="doc">Bean Mapping (Dozer)</span></a>”.</div>
</div>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">JodaDateTimeConverter.java</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.infra.dozer.converter</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.dozer.DozerConverter</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.joda.time.DateTime</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JodaDateTimeConverter</span> <span class="kd">extends</span> <span class="n">DozerConverter</span><span class="o">&lt;</span><span class="n">DateTime</span><span class="p">,</span> <span class="n">DateTime</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="nf">JodaDateTimeConverter</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">DateTime</span> <span class="nf">convertTo</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">source</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">destination</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// This method not called, because type of from/to is same.</span>
        <span class="k">return</span> <span class="n">convertFrom</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">DateTime</span> <span class="nf">convertFrom</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">source</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">destination</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">source</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">JodaLocalDateConverter.java</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.infra.dozer.converter</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.dozer.DozerConverter</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.joda.time.LocalDate</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JodaLocalDateConverter</span> <span class="kd">extends</span>
                                   <span class="n">DozerConverter</span><span class="o">&lt;</span><span class="n">LocalDate</span><span class="p">,</span> <span class="n">LocalDate</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="nf">JodaLocalDateConverter</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">LocalDate</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">LocalDate</span> <span class="nf">convertTo</span><span class="p">(</span><span class="n">LocalDate</span> <span class="n">source</span><span class="p">,</span> <span class="n">LocalDate</span> <span class="n">destination</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// This method not called, because type of from/to is same.</span>
        <span class="k">return</span> <span class="n">convertFrom</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">destination</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">LocalDate</span> <span class="nf">convertFrom</span><span class="p">(</span><span class="n">LocalDate</span> <span class="n">source</span><span class="p">,</span> <span class="n">LocalDate</span> <span class="n">destination</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">source</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">Apply the created Custom converter to Dozer.</div>
<div class="line">For details of custom converter, refer to <a class="reference internal" href="../GeneralFuncDetail/Dozer.html"><span class="doc">Bean Mapping (Dozer)</span></a>.</div>
</div>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="hll"><span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;mappings</span> <span class="na">xmlns=</span><span class="s">&quot;http://dozer.sourceforge.net&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;</span>
<span class="s">        http://dozer.sourceforge.net http://dozer.sourceforge.net/schema/beanmapping.xsd</span>
<span class="s">    &quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;custom-converters&gt;</span>
<span class="hll">            <span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">            <span class="nt">&lt;converter</span> <span class="na">type=</span><span class="s">&quot;org.terasoluna.examples.rest.infra.dozer.converter.JodaDateTimeConverter&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;class-a&gt;</span>org.joda.time.DateTime<span class="nt">&lt;/class-a&gt;</span>
</span><span class="hll">                <span class="nt">&lt;class-b&gt;</span>org.joda.time.DateTime<span class="nt">&lt;/class-b&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/converter&gt;</span>
</span><span class="hll">            <span class="nt">&lt;converter</span> <span class="na">type=</span><span class="s">&quot;org.terasoluna.examples.rest.infra.dozer.converter.JodaLocalDateConverter&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;class-a&gt;</span>org.joda.time.LocalDate<span class="nt">&lt;/class-a&gt;</span>
</span><span class="hll">                <span class="nt">&lt;class-b&gt;</span>org.joda.time.LocalDate<span class="nt">&lt;/class-b&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/converter&gt;</span>
</span>        <span class="nt">&lt;/custom-converters&gt;</span>
    <span class="nt">&lt;/configuration&gt;</span>

<span class="nt">&lt;/mappings&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create a file that defines operation settings for Dozer.</div>
<div class="line"><br /></div>
<div class="line">In this implementation, it is stored in <code class="file docutils literal"><span class="pre">/xxx-domain/src/main/resources/META-INF/dozer/dozer-configration-mapping.xml</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In the above example, custom converter definitions for Joda-Time classes (<code class="docutils literal"><span class="pre">org.joda.time.DateTime</span></code> and <code class="docutils literal"><span class="pre">org.joda.time.LocalDate</span></code>) are added.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When Dozer is used in domain layer as well, it is recommended to store the file defining Dozer operation settings, in domain layer project (<code class="docutils literal"><span class="pre">xxx-domain</span></code>).</p>
<p class="last">When Dozer is used only in application layer, it may be stored in application layer project (<code class="docutils literal"><span class="pre">xxx-web</span></code>).</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="source-code-for-application-layer">
<span id="restappendixsorucecodesofapplicationlayer"></span><h3><a class="toc-backref" href="#id89">5.1.6.8. Source code for application layer</a><a class="headerlink" href="#source-code-for-application-layer" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Out of the application layer source codes used in explanation <a class="reference internal" href="#resthowtouse"><span class="std std-ref">How to use</span></a>, full version of the source code that was pasted in fragments, is attached herewith.</div>
</div>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="45%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Section</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">File name</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#resthowtouseapiimplementation"><span class="std std-ref">REST API implementation</span></a></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofmemberrestcontroller"><span class="std std-ref">MemberRestController.java</span></a></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#resthowtouseexceptionhandling"><span class="std std-ref">Implementing exception handling</span></a></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofapierrorcreator"><span class="std std-ref">ApiErrorCreator.java</span></a></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofapiglobalexceptionhandler"><span class="std std-ref">ApiGlobalExceptionHandler.java</span></a></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Following files are excluded.</p>
<ul class="simple">
<li>JavaBean</li>
<li>Configuration file</li>
</ul>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="memberrestcontroller-java">
<span id="restappendixsorucecodesofmemberrestcontroller"></span><h4><a class="toc-backref" href="#id90">5.1.6.8.1. MemberRestController.java</a><a class="headerlink" href="#memberrestcontroller-java" title="Permalink to this headline">¶</a></h4>
<p><code class="file docutils literal"><span class="pre">java/org/terasoluna/examples/rest/api/member/MemberRestController.java</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.member</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.groups.Default</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.dozer.Mapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.Page</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.PageImpl</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.Pageable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.HttpStatus</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.PathVariable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestBody</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ResponseStatus</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.examples.rest.api.member.MemberResource.PostMembers</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.examples.rest.api.member.MemberResource.PutMember</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.examples.rest.domain.model.Member</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.examples.rest.domain.service.member.MemberService</span><span class="p">;</span>

<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;members&quot;</span><span class="p">)</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRestController</span> <span class="p">{</span>

    <span class="nd">@Inject</span>
    <span class="n">MemberService</span> <span class="n">memberService</span><span class="p">;</span>

    <span class="nd">@Inject</span>
    <span class="n">Mapper</span> <span class="n">beanMapper</span><span class="p">;</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>

    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Page</span><span class="o">&lt;</span><span class="n">MemberResource</span><span class="o">&gt;</span> <span class="nf">getMembers</span><span class="p">(</span><span class="nd">@Validated</span> <span class="n">MembersSearchQuery</span> <span class="n">query</span><span class="p">,</span>
            <span class="n">Pageable</span> <span class="n">pageable</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">Page</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">searchMembers</span><span class="p">(</span><span class="n">query</span><span class="p">.</span><span class="na">getName</span><span class="p">(),</span> <span class="n">pageable</span><span class="p">);</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">MemberResource</span><span class="o">&gt;</span> <span class="n">memberResources</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Member</span> <span class="n">member</span> <span class="p">:</span> <span class="n">page</span><span class="p">.</span><span class="na">getContent</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">memberResources</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="n">Page</span><span class="o">&lt;</span><span class="n">MemberResource</span><span class="o">&gt;</span> <span class="n">responseResource</span> <span class="o">=</span>
            <span class="k">new</span> <span class="n">PageImpl</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">memberResources</span><span class="p">,</span> <span class="n">pageable</span><span class="p">,</span> <span class="n">page</span><span class="p">.</span><span class="na">getTotalElements</span><span class="p">());</span>

        <span class="k">return</span> <span class="n">responseResource</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>

    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">MemberResource</span><span class="o">&gt;</span> <span class="nf">getMembers</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">findAll</span><span class="p">();</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">MemberResource</span><span class="o">&gt;</span> <span class="n">memberResources</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Member</span> <span class="n">member</span> <span class="p">:</span> <span class="n">members</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">memberResources</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">memberResources</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">)</span>

    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">CREATED</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">MemberResource</span> <span class="nf">postMembers</span><span class="p">(</span><span class="nd">@RequestBody</span> <span class="nd">@Validated</span><span class="p">({</span>
            <span class="n">PostMembers</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span> <span class="n">MemberResource</span> <span class="n">requestedResource</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">Member</span> <span class="n">creatingMember</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">requestedResource</span><span class="p">,</span> <span class="n">Member</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

        <span class="n">Member</span> <span class="n">createdMember</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">createMember</span><span class="p">(</span><span class="n">creatingMember</span><span class="p">);</span>

        <span class="n">MemberResource</span> <span class="n">responseResource</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">createdMember</span><span class="p">,</span>
                <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">responseResource</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;{memberId}&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>

    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">MemberResource</span> <span class="nf">getMember</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&quot;memberId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">memberId</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">getMember</span><span class="p">(</span><span class="n">memberId</span><span class="p">);</span>

        <span class="n">MemberResource</span> <span class="n">responseResource</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">member</span><span class="p">,</span>
                <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">responseResource</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;{memberId}&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">PUT</span><span class="p">)</span>

    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">MemberResource</span> <span class="nf">putMember</span><span class="p">(</span>
            <span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&quot;memberId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">memberId</span><span class="p">,</span>
            <span class="nd">@RequestBody</span> <span class="nd">@Validated</span><span class="p">({</span>
            <span class="n">PutMember</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span> <span class="n">MemberResource</span> <span class="n">requestedResource</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">Member</span> <span class="n">updatingMember</span> <span class="o">=</span> <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">requestedResource</span><span class="p">,</span> <span class="n">Member</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

        <span class="n">Member</span> <span class="n">updatedMember</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">updateMember</span><span class="p">(</span><span class="n">memberId</span><span class="p">,</span>
                <span class="n">updatingMember</span><span class="p">);</span>

        <span class="n">Member</span> <span class="n">updatedMember</span> <span class="o">=</span> <span class="n">memberService</span><span class="p">.</span><span class="na">updateMember</span><span class="p">(</span><span class="n">memberId</span><span class="p">,</span>
                <span class="n">MemberResource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">responseResource</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;{memberId}&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">DELETE</span><span class="p">)</span>

    <span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">NO_CONTENT</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteMember</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&quot;memberId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">memberId</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">memberService</span><span class="p">.</span><span class="na">deleteMember</span><span class="p">(</span><span class="n">memberId</span><span class="p">);</span>

    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="apierrorcreator-java">
<span id="restappendixsorucecodesofapierrorcreator"></span><h4><a class="toc-backref" href="#id91">5.1.6.8.2. ApiErrorCreator.java</a><a class="headerlink" href="#apierrorcreator-java" title="Permalink to this headline">¶</a></h4>
<p><code class="file docutils literal"><span class="pre">java/org/terasoluna/examples/rest/api/common/error/ApiErrorCreator.java</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.common.error</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.context.MessageSource</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.support.DefaultMessageSourceResolvable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.FieldError</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.ObjectError</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.context.request.WebRequest</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.message.ResultMessage</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.message.ResultMessages</span><span class="p">;</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiErrorCreator</span> <span class="p">{</span>

    <span class="nd">@Inject</span>
    <span class="n">MessageSource</span> <span class="n">messageSource</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">ApiError</span> <span class="nf">createApiError</span><span class="p">(</span><span class="n">WebRequest</span> <span class="n">request</span><span class="p">,</span> <span class="n">String</span> <span class="n">errorCode</span><span class="p">,</span>
            <span class="n">String</span> <span class="n">defaultErrorMessage</span><span class="p">,</span> <span class="n">Object</span><span class="p">...</span> <span class="n">arguments</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">localizedMessage</span> <span class="o">=</span> <span class="n">messageSource</span><span class="p">.</span><span class="na">getMessage</span><span class="p">(</span><span class="n">errorCode</span><span class="p">,</span>
                <span class="n">arguments</span><span class="p">,</span> <span class="n">defaultErrorMessage</span><span class="p">,</span> <span class="n">request</span><span class="p">.</span><span class="na">getLocale</span><span class="p">());</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ApiError</span><span class="p">(</span><span class="n">errorCode</span><span class="p">,</span> <span class="n">localizedMessage</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">ApiError</span> <span class="nf">createBindingResultApiError</span><span class="p">(</span><span class="n">WebRequest</span> <span class="n">request</span><span class="p">,</span>
            <span class="n">String</span> <span class="n">errorCode</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">bindingResult</span><span class="p">,</span>
            <span class="n">String</span> <span class="n">defaultErrorMessage</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ApiError</span> <span class="n">apiError</span> <span class="o">=</span> <span class="n">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errorCode</span><span class="p">,</span>
                <span class="n">defaultErrorMessage</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">FieldError</span> <span class="n">fieldError</span> <span class="p">:</span> <span class="n">bindingResult</span><span class="p">.</span><span class="na">getFieldErrors</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">apiError</span><span class="p">.</span><span class="na">addDetail</span><span class="p">(</span><span class="n">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">fieldError</span><span class="p">,</span> <span class="n">fieldError</span>
                    <span class="p">.</span><span class="na">getField</span><span class="p">()));</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">ObjectError</span> <span class="n">objectError</span> <span class="p">:</span> <span class="n">bindingResult</span><span class="p">.</span><span class="na">getGlobalErrors</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">apiError</span><span class="p">.</span><span class="na">addDetail</span><span class="p">(</span><span class="n">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">objectError</span><span class="p">,</span> <span class="n">objectError</span>
                    <span class="p">.</span><span class="na">getObjectName</span><span class="p">()));</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">apiError</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="n">ApiError</span> <span class="nf">createApiError</span><span class="p">(</span><span class="n">WebRequest</span> <span class="n">request</span><span class="p">,</span>
            <span class="n">DefaultMessageSourceResolvable</span> <span class="n">messageResolvable</span><span class="p">,</span> <span class="n">String</span> <span class="n">target</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">localizedMessage</span> <span class="o">=</span> <span class="n">messageSource</span><span class="p">.</span><span class="na">getMessage</span><span class="p">(</span><span class="n">messageResolvable</span><span class="p">,</span>
                <span class="n">request</span><span class="p">.</span><span class="na">getLocale</span><span class="p">());</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ApiError</span><span class="p">(</span><span class="n">messageResolvable</span><span class="p">.</span><span class="na">getCode</span><span class="p">(),</span> <span class="n">localizedMessage</span><span class="p">,</span> <span class="n">target</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">ApiError</span> <span class="nf">createResultMessagesApiError</span><span class="p">(</span><span class="n">WebRequest</span> <span class="n">request</span><span class="p">,</span>
            <span class="n">String</span> <span class="n">rootErrorCode</span><span class="p">,</span> <span class="n">ResultMessages</span> <span class="n">resultMessages</span><span class="p">,</span>
            <span class="n">String</span> <span class="n">defaultErrorMessage</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ApiError</span> <span class="n">apiError</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">resultMessages</span><span class="p">.</span><span class="na">getList</span><span class="p">().</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ResultMessage</span> <span class="n">resultMessage</span> <span class="o">=</span> <span class="n">resultMessages</span><span class="p">.</span><span class="na">iterator</span><span class="p">().</span><span class="na">next</span><span class="p">();</span>
            <span class="n">String</span> <span class="n">errorCode</span> <span class="o">=</span> <span class="n">resultMessage</span><span class="p">.</span><span class="na">getCode</span><span class="p">();</span>
            <span class="n">String</span> <span class="n">errorText</span> <span class="o">=</span> <span class="n">resultMessage</span><span class="p">.</span><span class="na">getText</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">errorCode</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">errorText</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">errorCode</span> <span class="o">=</span> <span class="n">rootErrorCode</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">apiError</span> <span class="o">=</span> <span class="n">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errorCode</span><span class="p">,</span> <span class="n">errorText</span><span class="p">,</span>
                    <span class="n">resultMessage</span><span class="p">.</span><span class="na">getArgs</span><span class="p">());</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">apiError</span> <span class="o">=</span> <span class="n">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">rootErrorCode</span><span class="p">,</span>
                    <span class="n">defaultErrorMessage</span><span class="p">);</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ResultMessage</span> <span class="n">resultMessage</span> <span class="p">:</span> <span class="n">resultMessages</span><span class="p">.</span><span class="na">getList</span><span class="p">())</span> <span class="p">{</span>
                <span class="n">apiError</span><span class="p">.</span><span class="na">addDetail</span><span class="p">(</span><span class="n">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">resultMessage</span>
                        <span class="p">.</span><span class="na">getCode</span><span class="p">(),</span> <span class="n">resultMessage</span><span class="p">.</span><span class="na">getText</span><span class="p">(),</span> <span class="n">resultMessage</span>
                        <span class="p">.</span><span class="na">getArgs</span><span class="p">()));</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">apiError</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="apiglobalexceptionhandler-java">
<span id="restappendixsorucecodesofapiglobalexceptionhandler"></span><h4><a class="toc-backref" href="#id92">5.1.6.8.3. ApiGlobalExceptionHandler.java</a><a class="headerlink" href="#apiglobalexceptionhandler-java" title="Permalink to this headline">¶</a></h4>
<p><code class="file docutils literal"><span class="pre">java/org/terasoluna/examples/rest/api/common/error/ApiGlobalExceptionHandler.java</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.api.common.error</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.dao.OptimisticLockingFailureException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.dao.PessimisticLockingFailureException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.HttpHeaders</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.HttpStatus</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.ResponseEntity</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.converter.HttpMessageNotReadableException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.MethodArgumentNotValidException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ControllerAdvice</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ExceptionHandler</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.context.request.WebRequest</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.servlet.mvc.method.annotation.ResponseEntityExceptionHandler</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.exception.BusinessException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.exception.ExceptionCodeResolver</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.exception.ResourceNotFoundException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.exception.ResultMessagesNotificationException</span><span class="p">;</span>

<span class="nd">@ControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiGlobalExceptionHandler</span> <span class="kd">extends</span> <span class="n">ResponseEntityExceptionHandler</span> <span class="p">{</span>

    <span class="nd">@Inject</span>
    <span class="n">ApiErrorCreator</span> <span class="n">apiErrorCreator</span><span class="p">;</span>

    <span class="nd">@Inject</span>
    <span class="n">ExceptionCodeResolver</span> <span class="n">exceptionCodeResolver</span><span class="p">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleExceptionInternal</span><span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">,</span>
            <span class="n">Object</span> <span class="n">body</span><span class="p">,</span> <span class="n">HttpHeaders</span> <span class="n">headers</span><span class="p">,</span> <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">,</span>
            <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">final</span> <span class="n">Object</span> <span class="n">apiError</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">body</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">String</span> <span class="n">errorCode</span> <span class="o">=</span> <span class="n">exceptionCodeResolver</span><span class="p">.</span><span class="na">resolveExceptionCode</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
            <span class="n">apiError</span> <span class="o">=</span> <span class="n">apiErrorCreator</span><span class="p">.</span><span class="na">createApiError</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">errorCode</span><span class="p">,</span> <span class="n">ex</span>
                    <span class="p">.</span><span class="na">getLocalizedMessage</span><span class="p">());</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">apiError</span> <span class="o">=</span> <span class="n">body</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ResponseEntity</span><span class="p">.</span><span class="na">status</span><span class="p">(</span><span class="n">status</span><span class="p">).</span><span class="na">headers</span><span class="p">(</span><span class="n">headers</span><span class="p">).</span><span class="na">body</span><span class="p">(</span><span class="n">apiError</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleMethodArgumentNotValid</span><span class="p">(</span>
            <span class="n">MethodArgumentNotValidException</span> <span class="n">ex</span><span class="p">,</span> <span class="n">HttpHeaders</span> <span class="n">headers</span><span class="p">,</span>
            <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">,</span> <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">handleBindingResult</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ex</span><span class="p">.</span><span class="na">getBindingResult</span><span class="p">(),</span> <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span>
                <span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleBindException</span><span class="p">(</span><span class="n">BindException</span> <span class="n">ex</span><span class="p">,</span>
            <span class="n">HttpHeaders</span> <span class="n">headers</span><span class="p">,</span> <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">,</span> <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">handleBindingResult</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ex</span><span class="p">.</span><span class="na">getBindingResult</span><span class="p">(),</span> <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span>
                <span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleBindingResult</span><span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">,</span>
            <span class="n">BindingResult</span> <span class="n">bindingResult</span><span class="p">,</span> <span class="n">HttpHeaders</span> <span class="n">headers</span><span class="p">,</span>
            <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">,</span> <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">errorCode</span> <span class="o">=</span> <span class="n">exceptionCodeResolver</span><span class="p">.</span><span class="na">resolveExceptionCode</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
        <span class="n">ApiError</span> <span class="n">apiError</span> <span class="o">=</span> <span class="n">apiErrorCreator</span><span class="p">.</span><span class="na">createBindingResultApiError</span><span class="p">(</span>
                <span class="n">request</span><span class="p">,</span> <span class="n">errorCode</span><span class="p">,</span> <span class="n">bindingResult</span><span class="p">,</span> <span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
        <span class="k">return</span> <span class="n">handleExceptionInternal</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">apiError</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleHttpMessageNotReadable</span><span class="p">(</span>
            <span class="n">HttpMessageNotReadableException</span> <span class="n">ex</span><span class="p">,</span> <span class="n">HttpHeaders</span> <span class="n">headers</span><span class="p">,</span>
            <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">,</span> <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="na">getCause</span><span class="p">()</span> <span class="k">instanceof</span> <span class="n">Exception</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">handleExceptionInternal</span><span class="p">((</span><span class="n">Exception</span><span class="p">)</span> <span class="n">ex</span><span class="p">.</span><span class="na">getCause</span><span class="p">(),</span> <span class="kc">null</span><span class="p">,</span>
                    <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">handleExceptionInternal</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nd">@ExceptionHandler</span><span class="p">(</span><span class="n">ResourceNotFoundException</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleResourceNotFoundException</span><span class="p">(</span>
            <span class="n">ResourceNotFoundException</span> <span class="n">ex</span><span class="p">,</span> <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">handleResultMessagesNotificationException</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="k">new</span> <span class="n">HttpHeaders</span><span class="p">(),</span>
                <span class="n">HttpStatus</span><span class="p">.</span><span class="na">NOT_FOUND</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@ExceptionHandler</span><span class="p">(</span><span class="n">BusinessException</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleBusinessException</span><span class="p">(</span><span class="n">BusinessException</span> <span class="n">ex</span><span class="p">,</span>
            <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">handleResultMessagesNotificationException</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="k">new</span> <span class="n">HttpHeaders</span><span class="p">(),</span>
                <span class="n">HttpStatus</span><span class="p">.</span><span class="na">CONFLICT</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleResultMessagesNotificationException</span><span class="p">(</span>
            <span class="n">ResultMessagesNotificationException</span> <span class="n">ex</span><span class="p">,</span> <span class="n">HttpHeaders</span> <span class="n">headers</span><span class="p">,</span>
            <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">,</span> <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">errorCode</span> <span class="o">=</span> <span class="n">exceptionCodeResolver</span><span class="p">.</span><span class="na">resolveExceptionCode</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
        <span class="n">ApiError</span> <span class="n">apiError</span> <span class="o">=</span> <span class="n">apiErrorCreator</span><span class="p">.</span><span class="na">createResultMessagesApiError</span><span class="p">(</span>
                <span class="n">request</span><span class="p">,</span> <span class="n">errorCode</span><span class="p">,</span> <span class="n">ex</span><span class="p">.</span><span class="na">getResultMessages</span><span class="p">(),</span> <span class="n">ex</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
        <span class="k">return</span> <span class="n">handleExceptionInternal</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">apiError</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@ExceptionHandler</span><span class="p">({</span> <span class="n">OptimisticLockingFailureException</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
            <span class="n">PessimisticLockingFailureException</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleLockingFailureException</span><span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">,</span>
            <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">handleExceptionInternal</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="k">new</span> <span class="n">HttpHeaders</span><span class="p">(),</span>
                <span class="n">HttpStatus</span><span class="p">.</span><span class="na">CONFLICT</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@ExceptionHandler</span><span class="p">(</span><span class="n">Exception</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">handleSystemError</span><span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">,</span>
            <span class="n">WebRequest</span> <span class="n">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">handleExceptionInternal</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="k">new</span> <span class="n">HttpHeaders</span><span class="p">(),</span>
                <span class="n">HttpStatus</span><span class="p">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="p">,</span> <span class="n">request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="source-code-of-the-domain-layer-class-created-at-the-time-of-rest-api-implementation">
<span id="restappendixsorucecodesofdomainlayer"></span><h3><a class="toc-backref" href="#id93">5.1.6.9. Source code of the domain layer class created at the time of REST API implementation</a><a class="headerlink" href="#source-code-of-the-domain-layer-class-created-at-the-time-of-rest-api-implementation" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Source code of domain layer class called from REST API explained in <a class="reference internal" href="#resthowtouse"><span class="std std-ref">How to use</span></a> is attached herewith.</div>
<div class="line">Also, infrastructure layer is implemented by using MyBatis3.</div>
</div>
<blockquote>
<div><table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="35%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Classification</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">File name</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">model</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofmember"><span class="std std-ref">Member.java</span></a></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofmembercredentia"><span class="std std-ref">MemberCredentia.java</span></a></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofgender"><span class="std std-ref">Gender.java</span></a></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">repository</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofmemberrepository"><span class="std std-ref">MemberRepository.java</span></a></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">service</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofmemberservice"><span class="std std-ref">MemberService.java</span></a></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofmemberserviceimpl"><span class="std std-ref">MemberServiceImpl.java</span></a></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">other</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofdomainmessagecodes"><span class="std std-ref">DomainMessageCodes.java</span></a></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(8)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofgendertypehandler"><span class="std std-ref">GenderTypeHandler.java</span></a></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(9)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofmembermappingxml"><span class="std std-ref">member-mapping.xml</span></a></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(10)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofmybatisconfig"><span class="std std-ref">mybatis-config.xml</span></a></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(11)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><a class="reference internal" href="#restappendixsorucecodesofmemberrepositoryxml"><span class="std std-ref">MemberRepository.xml</span></a></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Following files are excluded.</p>
<ul class="simple">
<li>JavaBean other than Entity</li>
<li>Configuration files other than Dozer</li>
</ul>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="member-java">
<span id="restappendixsorucecodesofmember"></span><h4><a class="toc-backref" href="#id94">5.1.6.9.1. Member.java</a><a class="headerlink" href="#member-java" title="Permalink to this headline">¶</a></h4>
<p><code class="file docutils literal"><span class="pre">java/org/terasoluna/examples/rest/domain/model/Member.java</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.domain.model</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.joda.time.DateTime</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.joda.time.LocalDate</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">memberId</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">firstName</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">lastName</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">Gender</span> <span class="n">gender</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">LocalDate</span> <span class="n">dateOfBirth</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">emailAddress</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">telephoneNumber</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">zipCode</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">address</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">DateTime</span> <span class="n">createdAt</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">DateTime</span> <span class="n">lastModifiedAt</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kt">long</span> <span class="n">version</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">MemberCredential</span> <span class="n">credential</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMemberId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">memberId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setMemberId</span><span class="p">(</span><span class="n">String</span> <span class="n">memberId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">memberId</span> <span class="o">=</span> <span class="n">memberId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getFirstName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">firstName</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setFirstName</span><span class="p">(</span><span class="n">String</span> <span class="n">firstName</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">firstName</span> <span class="o">=</span> <span class="n">firstName</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getLastName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">lastName</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLastName</span><span class="p">(</span><span class="n">String</span> <span class="n">lastName</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">lastName</span> <span class="o">=</span> <span class="n">lastName</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Gender</span> <span class="nf">getGender</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">gender</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setGender</span><span class="p">(</span><span class="n">Gender</span> <span class="n">gender</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">gender</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getGenderCode</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">gender</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">gender</span><span class="p">.</span><span class="na">getCode</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setGenderCode</span><span class="p">(</span><span class="n">String</span> <span class="n">genderCode</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">Gender</span><span class="p">.</span><span class="na">getByCode</span><span class="p">(</span><span class="n">genderCode</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">LocalDate</span> <span class="nf">getDateOfBirth</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">dateOfBirth</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDateOfBirth</span><span class="p">(</span><span class="n">LocalDate</span> <span class="n">dateOfBirth</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">dateOfBirth</span> <span class="o">=</span> <span class="n">dateOfBirth</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getEmailAddress</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">emailAddress</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmailAddress</span><span class="p">(</span><span class="n">String</span> <span class="n">emailAddress</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">emailAddress</span> <span class="o">=</span> <span class="n">emailAddress</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTelephoneNumber</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">telephoneNumber</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTelephoneNumber</span><span class="p">(</span><span class="n">String</span> <span class="n">telephoneNumber</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">telephoneNumber</span> <span class="o">=</span> <span class="n">telephoneNumber</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getZipCode</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">zipCode</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setZipCode</span><span class="p">(</span><span class="n">String</span> <span class="n">zipCode</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">zipCode</span> <span class="o">=</span> <span class="n">zipCode</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getAddress</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">address</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAddress</span><span class="p">(</span><span class="n">String</span> <span class="n">address</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">address</span> <span class="o">=</span> <span class="n">address</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">DateTime</span> <span class="nf">getCreatedAt</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">createdAt</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setCreatedAt</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">createdAt</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">createdAt</span> <span class="o">=</span> <span class="n">createdAt</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">DateTime</span> <span class="nf">getLastModifiedAt</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">lastModifiedAt</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLastModifiedAt</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">lastModifiedAt</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">lastModifiedAt</span> <span class="o">=</span> <span class="n">lastModifiedAt</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getVersion</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">version</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setVersion</span><span class="p">(</span><span class="kt">long</span> <span class="n">version</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">version</span> <span class="o">=</span> <span class="n">version</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">MemberCredential</span> <span class="nf">getCredential</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">credential</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setCredential</span><span class="p">(</span><span class="n">MemberCredential</span> <span class="n">credential</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">credential</span> <span class="o">=</span> <span class="n">credential</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="membercredentia-java">
<span id="restappendixsorucecodesofmembercredentia"></span><h4><a class="toc-backref" href="#id95">5.1.6.9.2. MemberCredentia.java</a><a class="headerlink" href="#membercredentia-java" title="Permalink to this headline">¶</a></h4>
<p><code class="file docutils literal"><span class="pre">java/org/terasoluna/examples/rest/domain/model/MemberCredential.java</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.domain.model</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.joda.time.DateTime</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberCredential</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">memberId</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">signId</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">previousPassword</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">DateTime</span> <span class="n">passwordLastChangedAt</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">DateTime</span> <span class="n">lastModifiedAt</span><span class="p">;</span>

    <span class="kd">private</span> <span class="kt">long</span> <span class="n">version</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMemberId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">memberId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setMemberId</span><span class="p">(</span><span class="n">String</span> <span class="n">memberId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">memberId</span> <span class="o">=</span> <span class="n">memberId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getSignId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">signId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSignId</span><span class="p">(</span><span class="n">String</span> <span class="n">signId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">signId</span> <span class="o">=</span> <span class="n">signId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPassword</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">password</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPassword</span><span class="p">(</span><span class="n">String</span> <span class="n">password</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">password</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPreviousPassword</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">previousPassword</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPreviousPassword</span><span class="p">(</span><span class="n">String</span> <span class="n">previousPassword</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">previousPassword</span> <span class="o">=</span> <span class="n">previousPassword</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">DateTime</span> <span class="nf">getPasswordLastChangedAt</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">passwordLastChangedAt</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPasswordLastChangedAt</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">passwordLastChangedAt</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">passwordLastChangedAt</span> <span class="o">=</span> <span class="n">passwordLastChangedAt</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">DateTime</span> <span class="nf">getLastModifiedAt</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">lastModifiedAt</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLastModifiedAt</span><span class="p">(</span><span class="n">DateTime</span> <span class="n">lastModifiedAt</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">lastModifiedAt</span> <span class="o">=</span> <span class="n">lastModifiedAt</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getVersion</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">version</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setVersion</span><span class="p">(</span><span class="kt">long</span> <span class="n">version</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">version</span> <span class="o">=</span> <span class="n">version</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="gender-java">
<span id="restappendixsorucecodesofgender"></span><h4><a class="toc-backref" href="#id96">5.1.6.9.3. Gender.java</a><a class="headerlink" href="#gender-java" title="Permalink to this headline">¶</a></h4>
<p><code class="file docutils literal"><span class="pre">java/org/terasoluna/examples/rest/domain/model/Gender.java</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.domain.model</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Collections</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.util.Assert</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="n">Gender</span> <span class="p">{</span>

    <span class="n">UNKNOWN</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">),</span> <span class="n">MEN</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">),</span> <span class="n">WOMEN</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">);</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">Gender</span><span class="o">&gt;</span> <span class="n">genderMap</span><span class="p">;</span>

    <span class="kd">static</span> <span class="p">{</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">Gender</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">Gender</span> <span class="n">gender</span> <span class="p">:</span> <span class="n">values</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">gender</span><span class="p">.</span><span class="na">code</span><span class="p">,</span> <span class="n">gender</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">genderMap</span> <span class="o">=</span> <span class="n">Collections</span><span class="p">.</span><span class="na">unmodifiableMap</span><span class="p">(</span><span class="n">map</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">code</span><span class="p">;</span>

    <span class="kd">private</span> <span class="nf">Gender</span><span class="p">(</span><span class="n">String</span> <span class="n">code</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">code</span> <span class="o">=</span> <span class="n">code</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Gender</span> <span class="nf">getByCode</span><span class="p">(</span><span class="n">String</span> <span class="n">code</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Gender</span> <span class="n">gender</span> <span class="o">=</span> <span class="n">genderMap</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">code</span><span class="p">);</span>
        <span class="n">Assert</span><span class="p">.</span><span class="na">notNull</span><span class="p">(</span><span class="n">gender</span><span class="p">,</span> <span class="s">&quot;gender code is invalid. code : &quot;</span> <span class="o">+</span> <span class="n">code</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">gender</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getCode</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">code</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="memberrepository-java">
<span id="restappendixsorucecodesofmemberrepository"></span><h4><a class="toc-backref" href="#id97">5.1.6.9.4. MemberRepository.java</a><a class="headerlink" href="#memberrepository-java" title="Permalink to this headline">¶</a></h4>
<p><code class="file docutils literal"><span class="pre">java/org/terasoluna/examples/rest/domain/repository/member/MemberRepository.java</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.domain.repository.member</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.RowBounds</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.terasoluna.examples.rest.domain.model.Member</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepository</span> <span class="p">{</span>

    <span class="n">Member</span> <span class="nf">findOne</span><span class="p">(</span><span class="n">String</span> <span class="n">memberId</span><span class="p">);</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="p">();</span>

    <span class="kt">long</span> <span class="nf">countByContainsName</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span> <span class="nf">findPageByContainsName</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">RowBounds</span> <span class="n">rowBounds</span><span class="p">);</span>

    <span class="kt">void</span> <span class="nf">createMember</span><span class="p">(</span><span class="n">Member</span> <span class="n">creatingMember</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">createCredential</span><span class="p">(</span><span class="n">Member</span> <span class="n">creatingMember</span><span class="p">);</span>

    <span class="kt">boolean</span> <span class="nf">updateMember</span><span class="p">(</span><span class="n">Member</span> <span class="n">updatingMember</span><span class="p">);</span>

    <span class="kt">void</span> <span class="nf">deleteMember</span><span class="p">(</span><span class="n">String</span> <span class="n">memberId</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">deleteCredential</span><span class="p">(</span><span class="n">String</span> <span class="n">memberId</span><span class="p">);</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="memberservice-java">
<span id="restappendixsorucecodesofmemberservice"></span><h4><a class="toc-backref" href="#id98">5.1.6.9.5. MemberService.java</a><a class="headerlink" href="#memberservice-java" title="Permalink to this headline">¶</a></h4>
<p><code class="file docutils literal"><span class="pre">java/org/terasoluna/examples/rest/domain/service/member/MemberService.java</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.domain.service.member</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.Page</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.Pageable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.examples.rest.domain.model.Member</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberService</span> <span class="p">{</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="p">();</span>

    <span class="n">Page</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span> <span class="nf">searchMembers</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">Pageable</span> <span class="n">pageable</span><span class="p">);</span>

    <span class="n">Member</span> <span class="nf">getMember</span><span class="p">(</span><span class="n">String</span> <span class="n">memberId</span><span class="p">);</span>

    <span class="n">Member</span> <span class="nf">createMember</span><span class="p">(</span><span class="n">Member</span> <span class="n">creatingMember</span><span class="p">);</span>

    <span class="n">Member</span> <span class="nf">updateMember</span><span class="p">(</span><span class="n">String</span> <span class="n">memberId</span><span class="p">,</span> <span class="n">Member</span> <span class="n">updatingMember</span><span class="p">);</span>

    <span class="kt">void</span> <span class="nf">deleteMember</span><span class="p">(</span><span class="n">String</span> <span class="n">memberId</span><span class="p">);</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="memberserviceimpl-java">
<span id="restappendixsorucecodesofmemberserviceimpl"></span><h4><a class="toc-backref" href="#id99">5.1.6.9.6. MemberServiceImpl.java</a><a class="headerlink" href="#memberserviceimpl-java" title="Permalink to this headline">¶</a></h4>
<p><code class="file docutils literal"><span class="pre">java/org/terasoluna/examples/rest/domain/service/member/MemberServiceImpl.java</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.domain.service.member</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.RowBounds</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.dozer.Mapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.joda.time.DateTime</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.dao.DuplicateKeyException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.Page</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.PageImpl</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.Pageable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.orm.ObjectOptimisticLockingFailureException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.crypto.password.PasswordEncoder</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.transaction.annotation.Transactional</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.util.StringUtils</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.examples.rest.domain.message.DomainMessageCodes</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.examples.rest.domain.model.Member</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.examples.rest.domain.model.MemberCredential</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.examples.rest.domain.repository.member.MemberRepository</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.date.jodatime.JodaTimeDateFactory</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.exception.BusinessException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.exception.ResourceNotFoundException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.message.ResultMessages</span><span class="p">;</span>

<span class="nd">@Transactional</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberServiceImpl</span> <span class="kd">implements</span> <span class="n">MemberService</span> <span class="p">{</span>

    <span class="nd">@Inject</span>
    <span class="n">MemberRepository</span> <span class="n">memberRepository</span><span class="p">;</span>

    <span class="nd">@Inject</span>
    <span class="n">JodaTimeDateFactory</span> <span class="n">dateFactory</span><span class="p">;</span>

    <span class="nd">@Inject</span>
    <span class="n">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="p">;</span>

    <span class="nd">@Inject</span>
    <span class="n">Mapper</span> <span class="n">beanMapper</span><span class="p">;</span>

    <span class="nd">@Override</span>
    <span class="nd">@Transactional</span><span class="p">(</span><span class="n">readOnly</span> <span class="o">=</span> <span class="kc">true</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">RestMember</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">restMemberRepository</span><span class="p">.</span><span class="na">findAll</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="nd">@Transactional</span><span class="p">(</span><span class="n">readOnly</span> <span class="o">=</span> <span class="kc">true</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Page</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span> <span class="nf">searchMembers</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">Pageable</span> <span class="n">pageable</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="c1">// Count Members by search criteria</span>
        <span class="kt">long</span> <span class="n">total</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="p">.</span><span class="na">countByContainsName</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">total</span><span class="p">)</span> <span class="p">{</span>
             <span class="n">RowBounds</span> <span class="n">rowBounds</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RowBounds</span><span class="p">(</span><span class="n">pageable</span><span class="p">.</span><span class="na">getOffset</span><span class="p">(),</span> <span class="n">pageable</span><span class="p">.</span><span class="na">getPageSize</span><span class="p">());</span>
             <span class="n">members</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="p">.</span><span class="na">findPageByContainsName</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">rowBounds</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">members</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">PageImpl</span><span class="o">&lt;</span><span class="n">Member</span><span class="o">&gt;</span><span class="p">(</span><span class="n">members</span><span class="p">,</span> <span class="n">pageable</span><span class="p">,</span> <span class="n">total</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="nd">@Transactional</span><span class="p">(</span><span class="n">readOnly</span> <span class="o">=</span> <span class="kc">true</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Member</span> <span class="nf">getMember</span><span class="p">(</span><span class="n">String</span> <span class="n">memberId</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// find member</span>
        <span class="n">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="p">.</span><span class="na">findOne</span><span class="p">(</span><span class="n">memberId</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">member</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// If member is not exists</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">ResourceNotFoundException</span><span class="p">(</span><span class="n">ResultMessages</span><span class="p">.</span><span class="na">error</span><span class="p">().</span><span class="na">add</span><span class="p">(</span>
                            <span class="n">DomainMessageCodes</span><span class="p">.</span><span class="na">E_EX_MM_5001</span><span class="p">,</span> <span class="n">memberId</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">member</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Member</span> <span class="nf">createMember</span><span class="p">(</span><span class="n">Member</span> <span class="n">creatingMember</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">MemberCredential</span> <span class="n">creatingCredential</span> <span class="o">=</span> <span class="n">creatingMember</span>
                            <span class="p">.</span><span class="na">getCredential</span><span class="p">();</span>

        <span class="c1">// get processing current date time</span>
        <span class="n">DateTime</span> <span class="n">currentDateTime</span> <span class="o">=</span> <span class="n">dateFactory</span><span class="p">.</span><span class="na">newDateTime</span><span class="p">();</span>

        <span class="n">creatingMember</span><span class="p">.</span><span class="na">setCreatedAt</span><span class="p">(</span><span class="n">currentDateTime</span><span class="p">);</span>
        <span class="n">creatingMember</span><span class="p">.</span><span class="na">setLastModifiedAt</span><span class="p">(</span><span class="n">currentDateTime</span><span class="p">);</span>

        <span class="c1">// decide sign id(email-address)</span>
        <span class="n">String</span> <span class="n">signId</span> <span class="o">=</span> <span class="n">creatingCredential</span><span class="p">.</span><span class="na">getSignId</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">StringUtils</span><span class="p">.</span><span class="na">hasLength</span><span class="p">(</span><span class="n">signId</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">signId</span> <span class="o">=</span> <span class="n">creatingMember</span><span class="p">.</span><span class="na">getEmailAddress</span><span class="p">();</span>
            <span class="n">creatingCredential</span><span class="p">.</span><span class="na">setSignId</span><span class="p">(</span><span class="n">signId</span><span class="p">.</span><span class="na">toLowerCase</span><span class="p">());</span>
        <span class="p">}</span>

        <span class="c1">// encrypt password</span>
        <span class="n">String</span> <span class="n">rawPassword</span> <span class="o">=</span> <span class="n">creatingCredential</span><span class="p">.</span><span class="na">getPassword</span><span class="p">();</span>
        <span class="n">creatingCredential</span><span class="p">.</span><span class="na">setPassword</span><span class="p">(</span><span class="n">passwordEncoder</span><span class="p">.</span><span class="na">encode</span><span class="p">(</span><span class="n">rawPassword</span><span class="p">));</span>
        <span class="n">creatingCredential</span><span class="p">.</span><span class="na">setPasswordLastChangedAt</span><span class="p">(</span><span class="n">currentDateTime</span><span class="p">);</span>
        <span class="n">creatingCredential</span><span class="p">.</span><span class="na">setLastModifiedAt</span><span class="p">(</span><span class="n">currentDateTime</span><span class="p">);</span>

        <span class="c1">// save member &amp; member credential</span>
        <span class="k">try</span> <span class="p">{</span>

            <span class="c1">// Registering member details</span>
            <span class="n">memberRepository</span><span class="p">.</span><span class="na">createMember</span><span class="p">(</span><span class="n">creatingMember</span><span class="p">);</span>
            <span class="c1">// //Registering credential details</span>
            <span class="n">memberRepository</span><span class="p">.</span><span class="na">createCredential</span><span class="p">(</span><span class="n">creatingMember</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">creatingMember</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">DuplicateKeyException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// If sign id is already used</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">BusinessException</span><span class="p">(</span><span class="n">ResultMessages</span><span class="p">.</span><span class="na">error</span><span class="p">().</span><span class="na">add</span><span class="p">(</span>
                            <span class="n">DomainMessageCodes</span><span class="p">.</span><span class="na">E_EX_MM_8001</span><span class="p">,</span>
                            <span class="n">creatingCredential</span><span class="p">.</span><span class="na">getSignId</span><span class="p">()),</span> <span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Member</span> <span class="nf">updateMember</span><span class="p">(</span><span class="n">String</span> <span class="n">memberId</span><span class="p">,</span> <span class="n">Member</span> <span class="n">updatingMember</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// get member</span>
        <span class="n">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">getMember</span><span class="p">(</span><span class="n">memberId</span><span class="p">);</span>

        <span class="c1">// override updating member attributes</span>
        <span class="n">beanMapper</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">updatingMember</span><span class="p">,</span> <span class="n">member</span><span class="p">,</span> <span class="s">&quot;member.update&quot;</span><span class="p">);</span>

        <span class="c1">// get processing current date time</span>
        <span class="n">DateTime</span> <span class="n">currentDateTime</span> <span class="o">=</span> <span class="n">dateFactory</span><span class="p">.</span><span class="na">newDateTime</span><span class="p">();</span>
        <span class="n">member</span><span class="p">.</span><span class="na">setLastModifiedAt</span><span class="p">(</span><span class="n">currentDateTime</span><span class="p">);</span>

        <span class="c1">// save updating member</span>
        <span class="kt">boolean</span> <span class="n">updated</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="p">.</span><span class="na">updateMember</span><span class="p">(</span><span class="n">member</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">updated</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="n">ObjectOptimisticLockingFailureException</span><span class="p">(</span><span class="n">Member</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                                <span class="n">member</span><span class="p">.</span><span class="na">getMemberId</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">member</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteMember</span><span class="p">(</span><span class="n">String</span> <span class="n">memberId</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">// First Delete from credential (Child)</span>
        <span class="n">memberRepository</span><span class="p">.</span><span class="na">deleteCredential</span><span class="p">(</span><span class="n">memberId</span><span class="p">);</span>
        <span class="c1">// Delete member</span>
        <span class="n">memberRepository</span><span class="p">.</span><span class="na">deleteMember</span><span class="p">(</span><span class="n">memberId</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="domainmessagecodes-java">
<span id="restappendixsorucecodesofdomainmessagecodes"></span><h4><a class="toc-backref" href="#id100">5.1.6.9.7. DomainMessageCodes.java</a><a class="headerlink" href="#domainmessagecodes-java" title="Permalink to this headline">¶</a></h4>
<p><code class="file docutils literal"><span class="pre">java/org/terasoluna/examples/rest/domain/message/DomainMessageCodes.java</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.rest.domain.message</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * Message codes of domain layer message.</span>
<span class="cm"> * @author DomainMessageCodesGenerator</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DomainMessageCodes</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="nf">DomainMessageCodes</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// NOP</span>
    <span class="p">}</span>

    <span class="cm">/** e.ex.mm.5001=Specified member not found. member id : {0} */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">E_EX_MM_5001</span> <span class="o">=</span> <span class="s">&quot;e.ex.mm.5001&quot;</span><span class="p">;</span>

    <span class="cm">/** e.ex.mm.8001=Cannot use specified sign id. sign id : {0} */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">E_EX_MM_8001</span> <span class="o">=</span> <span class="s">&quot;e.ex.mm.8001&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="gendertypehandler-java">
<span id="restappendixsorucecodesofgendertypehandler"></span><h4><a class="toc-backref" href="#id101">5.1.6.9.8. GenderTypeHandler.java</a><a class="headerlink" href="#gendertypehandler-java" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">TypeHandler for mapping the Enum type code value.</div>
</div>
<p><code class="file docutils literal"><span class="pre">java/org/terasoluna/examples/infra/mybatis/typehandler/GenderTypeHandler.java</span></code></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">org.terasoluna.examples.infra.mybatis.typehandler</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.sql.CallableStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.sql.SQLException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.examples.domain.model.Gender</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.type.JdbcType</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.type.BaseTypeHandler</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenderTypeHandler</span> <span class="kd">extends</span> <span class="n">BaseTypeHandler</span><span class="o">&lt;</span><span class="n">Gender</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Gender</span> <span class="nf">getNullableResult</span><span class="p">(</span><span class="n">ResultSet</span> <span class="n">rs</span><span class="p">,</span> <span class="n">String</span> <span class="n">columnName</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">getByCode</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">columnName</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Gender</span> <span class="nf">getNullableResult</span><span class="p">(</span><span class="n">ResultSet</span> <span class="n">rs</span><span class="p">,</span> <span class="kt">int</span> <span class="n">columnIndex</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">getByCode</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">columnIndex</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Gender</span> <span class="nf">getNullableResult</span><span class="p">(</span><span class="n">CallableStatement</span> <span class="n">cs</span><span class="p">,</span> <span class="kt">int</span> <span class="n">columnIndex</span><span class="p">)</span>
                    <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">getByCode</span><span class="p">(</span><span class="n">cs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">columnIndex</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNonNullParameter</span><span class="p">(</span><span class="n">PreparedStatement</span> <span class="n">ps</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span>
                    <span class="n">Gender</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">JdbcType</span> <span class="n">jdbcType</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="p">{</span>
            <span class="n">ps</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">parameter</span><span class="p">.</span><span class="na">getCode</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="n">Gender</span> <span class="nf">getByCode</span><span class="p">(</span><span class="n">String</span> <span class="n">byCode</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">byCode</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">Gender</span><span class="p">.</span><span class="na">getByCode</span><span class="p">(</span><span class="n">byCode</span><span class="p">);</span>
            <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="member-mapping-xml">
<span id="restappendixsorucecodesofmembermappingxml"></span><h4><a class="toc-backref" href="#id102">5.1.6.9.9. member-mapping.xml</a><a class="headerlink" href="#member-mapping-xml" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">In the implemented Service class, “<a class="reference internal" href="../GeneralFuncDetail/Dozer.html"><span class="doc">Bean Mapping (Dozer)</span></a>” is used while copying the value specified by client in <code class="docutils literal"><span class="pre">Member</span></code> object.</div>
<div class="line">When it is alright to simply copy the field values, Bean mapping definition need not be added. However, in this implementation it needs to be ensured that, items which are not to be updated (<code class="docutils literal"><span class="pre">memberId</span></code>, <code class="docutils literal"><span class="pre">credential</span></code>, <code class="docutils literal"><span class="pre">createdAt</span></code> and <code class="docutils literal"><span class="pre">version</span></code>) are not copied.</div>
<div class="line">Bean mapping definition needs to be added in order to ensure that specific fields are not copied.</div>
</div>
<p><code class="file docutils literal"><span class="pre">resources/META-INF/dozer/member-mapping.xml</span></code></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;mappings</span> <span class="na">xmlns=</span><span class="s">&quot;http://dozer.sourceforge.net&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://dozer.sourceforge.net</span>
<span class="s">          http://dozer.sourceforge.net/schema/beanmapping.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;mapping</span> <span class="na">map-id=</span><span class="s">&quot;member.update&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;class-a&gt;</span>org.terasoluna.examples.rest.domain.model.Member<span class="nt">&lt;/class-a&gt;</span>
        <span class="nt">&lt;class-b&gt;</span>org.terasoluna.examples.rest.domain.model.Member<span class="nt">&lt;/class-b&gt;</span>
        <span class="nt">&lt;field-exclude&gt;</span>
            <span class="nt">&lt;a&gt;</span>memberId<span class="nt">&lt;/a&gt;</span>
            <span class="nt">&lt;b&gt;</span>memberId<span class="nt">&lt;/b&gt;</span>
        <span class="nt">&lt;/field-exclude&gt;</span>
        <span class="nt">&lt;field-exclude&gt;</span>
            <span class="nt">&lt;a&gt;</span>credential<span class="nt">&lt;/a&gt;</span>
            <span class="nt">&lt;b&gt;</span>credential<span class="nt">&lt;/b&gt;</span>
        <span class="nt">&lt;/field-exclude&gt;</span>
        <span class="nt">&lt;field-exclude&gt;</span>
            <span class="nt">&lt;a&gt;</span>createdAt<span class="nt">&lt;/a&gt;</span>
            <span class="nt">&lt;b&gt;</span>createdAt<span class="nt">&lt;/b&gt;</span>
        <span class="nt">&lt;/field-exclude&gt;</span>
        <span class="nt">&lt;field-exclude&gt;</span>
            <span class="nt">&lt;a&gt;</span>lastModifiedAt<span class="nt">&lt;/a&gt;</span>
            <span class="nt">&lt;b&gt;</span>lastModifiedAt<span class="nt">&lt;/b&gt;</span>
        <span class="nt">&lt;/field-exclude&gt;</span>
        <span class="nt">&lt;field-exclude&gt;</span>
            <span class="nt">&lt;a&gt;</span>version<span class="nt">&lt;/a&gt;</span>
            <span class="nt">&lt;b&gt;</span>version<span class="nt">&lt;/b&gt;</span>
        <span class="nt">&lt;/field-exclude&gt;</span>
    <span class="nt">&lt;/mapping&gt;</span>

<span class="nt">&lt;/mappings&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="mybatis-config-xml">
<span id="restappendixsorucecodesofmybatisconfig"></span><h4><a class="toc-backref" href="#id103">5.1.6.9.10. mybatis-config.xml</a><a class="headerlink" href="#mybatis-config-xml" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">MyBatis3 operations can be customized by adding a configuration values in MyBatis configuration file. MyBatis3 does not support Joda-time classes (org.joda.time.DateTime, org.joda.time.LocalDateTime, org.joda.time.LocalDate etc.).</div>
<div class="line">Hence, when Joda-Time class is used in the field of Entity class, it is necessary to provide a <code class="docutils literal"><span class="pre">TypeHandler</span></code>  for Joda-Time.</div>
<div class="line"><code class="docutils literal"><span class="pre">TypeHandler</span></code>  implementation for mapping the org.joda.time.DateTime with java.sql.Timestamp is done by referring [<a class="reference internal" href="../DataAccessDetail/DataAccessMyBatis3.html#dataaccessmybatis3howtoextendtypehandlerjoda"><span class="std std-ref">Implementing TypeHandler for Joda-Time</span></a>].</div>
</div>
<p><code class="file docutils literal"><span class="pre">resources/META-INF/mybatis/mybatis-config.xml</span></code></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org/DTD Config 3.0//EN&quot;</span>
<span class="cp">    &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>

    <span class="nt">&lt;settings&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&quot;jdbcTypeForNull&quot;</span> <span class="na">value=</span><span class="s">&quot;NULL&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/settings&gt;</span>

    <span class="nt">&lt;typeAliases&gt;</span>
        <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&quot;org.terasoluna.examples.infra.mybatis.typehandler&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/typeAliases&gt;</span>

    <span class="nt">&lt;typeHandlers&gt;</span>
       <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&quot;org.terasoluna.examples.infra.mybatis.typehandler&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/typeHandlers&gt;</span>

<span class="nt">&lt;/configuration&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="memberrepository-xml">
<span id="restappendixsorucecodesofmemberrepositoryxml"></span><h4><a class="toc-backref" href="#id104">5.1.6.9.11. MemberRepository.xml</a><a class="headerlink" href="#memberrepository-xml" title="Permalink to this headline">¶</a></h4>
<p><code class="file docutils literal"><span class="pre">resources/org/terasoluna/examples/rest/domain/repository/member/MemberRepository.xml</span></code></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
<span class="cp">    &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span>
    <span class="na">namespace=</span><span class="s">&quot;org.terasoluna.examples.rest.domain.repository.member.MemberRepository&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&quot;MemberResultMap&quot;</span> <span class="na">type=</span><span class="s">&quot;Member&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&quot;memberId&quot;</span> <span class="na">column=</span><span class="s">&quot;member_id&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;firstName&quot;</span> <span class="na">column=</span><span class="s">&quot;first_name&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;lastName&quot;</span> <span class="na">column=</span><span class="s">&quot;last_name&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;gender&quot;</span> <span class="na">column=</span><span class="s">&quot;gender&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;dateOfBirth&quot;</span> <span class="na">column=</span><span class="s">&quot;date_of_birth&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;emailAddress&quot;</span> <span class="na">column=</span><span class="s">&quot;email_address&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;telephoneNumber&quot;</span> <span class="na">column=</span><span class="s">&quot;telephone_number&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;zipCode&quot;</span> <span class="na">column=</span><span class="s">&quot;zip_code&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;address&quot;</span> <span class="na">column=</span><span class="s">&quot;address&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;createdAt&quot;</span> <span class="na">column=</span><span class="s">&quot;created_at&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;lastModifiedAt&quot;</span> <span class="na">column=</span><span class="s">&quot;last_modified_at&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;version&quot;</span> <span class="na">column=</span><span class="s">&quot;version&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;credential.memberId&quot;</span> <span class="na">column=</span><span class="s">&quot;member_id&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;credential.signId&quot;</span> <span class="na">column=</span><span class="s">&quot;sign_id&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;credential.password&quot;</span> <span class="na">column=</span><span class="s">&quot;password&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;credential.previousPassword&quot;</span> <span class="na">column=</span><span class="s">&quot;previous_password&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;credential.passwordLastChangedAt&quot;</span> <span class="na">column=</span><span class="s">&quot;password_last_changed_at&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;credential.lastModifiedAt&quot;</span> <span class="na">column=</span><span class="s">&quot;credential_last_modified_at&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;credential.version&quot;</span> <span class="na">column=</span><span class="s">&quot;credential_version&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>

    <span class="nt">&lt;sql</span> <span class="na">id=</span><span class="s">&quot;selectMember&quot;</span><span class="nt">&gt;</span>
        SELECT
         member.member_id as member_id
         ,member.first_name as first_name
         ,member.last_name as last_name
         ,member.gender as gender
         ,member.date_of_birth as date_of_birth
         ,member.email_address as email_address
         ,member.telephone_number as telephone_number
         ,member.zip_code as zip_code
         ,member.address as address
         ,member.created_at as created_at
         ,member.last_modified_at as last_modified_at
         ,member.version as version
         ,credential.sign_id as sign_id
         ,credential.password as password
         ,credential.previous_password as previous_password
         ,credential.password_last_changed_at as password_last_changed_at
         ,credential.last_modified_at as credential_last_modified_at
         ,credential.version as credential_version
        FROM
         t_member member
         INNER JOIN t_member_credential credential ON credential.member_id = member.member_id
    <span class="nt">&lt;/sql&gt;</span>

    <span class="nt">&lt;sql</span> <span class="na">id=</span><span class="s">&quot;whereMember&quot;</span><span class="nt">&gt;</span>
        WHERE
            member.first_name LIKE #{nameContainingCondition} ESCAPE &#39;~&#39;
            OR member.last_name LIKE #{nameContainingCondition} ESCAPE &#39;~&#39;
    <span class="nt">&lt;/sql&gt;</span>

    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;findAll&quot;</span> <span class="na">resultMap=</span><span class="s">&quot;RestMemberResultMap&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">&quot;selectRestMember&quot;</span> <span class="nt">/&gt;</span>
        ORDER BY member_id ASC
    <span class="nt">&lt;/select&gt;</span>

    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;findOne&quot;</span> <span class="na">parameterType=</span><span class="s">&quot;string&quot;</span> <span class="na">resultMap=</span><span class="s">&quot;MemberResultMap&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">&quot;selectMember&quot;</span> <span class="nt">/&gt;</span>
        WHERE
        member.member_id = #{memberId}
    <span class="nt">&lt;/select&gt;</span>

    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;countByContainsName&quot;</span> <span class="na">parameterType=</span><span class="s">&quot;string&quot;</span> <span class="na">resultType=</span><span class="s">&quot;_long&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bind</span> <span class="na">name=</span><span class="s">&quot;nameContainingCondition&quot;</span>
        <span class="na">value=</span><span class="s">&quot;@org.terasoluna.gfw.common.query.QueryEscapeUtils@toStartingWithCondition(_parameter)&quot;</span> <span class="nt">/&gt;</span>
        SELECT
        COUNT(*)
        FROM
        t_member member
        <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">&quot;whereMember&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/select&gt;</span>

    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;findPageByContainsName&quot;</span> <span class="na">parameterType=</span><span class="s">&quot;string&quot;</span>
        <span class="na">resultMap=</span><span class="s">&quot;MemberResultMap&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bind</span> <span class="na">name=</span><span class="s">&quot;nameContainingCondition&quot;</span>
        <span class="na">value=</span><span class="s">&quot;@org.terasoluna.gfw.common.query.QueryEscapeUtils@toStartingWithCondition(_parameter)&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">&quot;selectMember&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">&quot;whereMember&quot;</span> <span class="nt">/&gt;</span>
        ORDER BY member_id ASC
    <span class="nt">&lt;/select&gt;</span>

    <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&quot;createMember&quot;</span> <span class="na">parameterType=</span><span class="s">&quot;Member&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;selectKey</span> <span class="na">keyProperty=</span><span class="s">&quot;memberId&quot;</span> <span class="na">resultType=</span><span class="s">&quot;string&quot;</span> <span class="na">order=</span><span class="s">&quot;BEFORE&quot;</span><span class="nt">&gt;</span>
            SELECT &#39;M&#39;||TO_CHAR(NEXTVAL(&#39;s_member&#39;),&#39;FM000000000&#39;)
        <span class="nt">&lt;/selectKey&gt;</span>
        INSERT INTO
        t_member
        (
        member_id
        ,first_name
        ,last_name
        ,gender
        ,date_of_birth
        ,email_address
        ,telephone_number
        ,zip_code
        ,address
        ,created_at
        ,last_modified_at
        ,version
        )
        VALUES
        (
        #{memberId}
        ,#{firstName}
        ,#{lastName}
        ,#{gender}
        ,#{dateOfBirth}
        ,#{emailAddress}
        ,#{telephoneNumber}
        ,#{zipCode}
        ,#{address}
        ,#{createdAt}
        ,#{lastModifiedAt}
        ,1
        )
    <span class="nt">&lt;/insert&gt;</span>

    <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&quot;createCredential&quot;</span> <span class="na">parameterType=</span><span class="s">&quot;Member&quot;</span><span class="nt">&gt;</span>
        INSERT INTO
        t_member_credential
        (
        member_id
        ,sign_id
        ,password
        ,previous_password
        ,password_last_changed_at
        ,last_modified_at
        ,version
        )
        VALUES
        (
        #{memberId}
        ,#{credential.signId}
        ,#{credential.password}
        ,#{credential.previousPassword}
        ,#{credential.passwordLastChangedAt}
        ,#{credential.lastModifiedAt}
        ,1
        )
    <span class="nt">&lt;/insert&gt;</span>

    <span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&quot;updateMember&quot;</span> <span class="na">parameterType=</span><span class="s">&quot;Member&quot;</span><span class="nt">&gt;</span>
        UPDATE
            t_member
        SET
            first_name = #{firstName}
            ,last_name = #{lastName}
            ,gender = #{gender}
            ,date_of_birth = #{dateOfBirth}
            ,email_address = #{emailAddress}
            ,telephone_number = #{telephoneNumber}
            ,zip_code = #{zipCode}
            ,address = #{address}
            ,created_at = #{createdAt}
            ,last_modified_at = #{lastModifiedAt}
            ,version = version + 1
        WHERE
            member_id = #{memberId}
            AND version = #{version}
    <span class="nt">&lt;/update&gt;</span>

    <span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&quot;deleteCredential&quot;</span> <span class="na">parameterType=</span><span class="s">&quot;string&quot;</span><span class="nt">&gt;</span>
        DELETE FROM t_member_credential
        WHERE
        member_id = #{memberId}
    <span class="nt">&lt;/delete&gt;</span>

    <span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&quot;deleteMember&quot;</span> <span class="na">parameterType=</span><span class="s">&quot;string&quot;</span><span class="nt">&gt;</span>
        DELETE FROM t_member
        WHERE
        member_id = #{memberId}
    <span class="nt">&lt;/delete&gt;</span>

<span class="nt">&lt;/mapper&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="RestClient.html" title="5.2. REST Client (HTTP Client)"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="5. Web Services"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.4.1.RELEASE documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >5. Web Services</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
      © Copyright 2013-2018, NTT DATA Corporation. © Copyright 2013-2018, NTT Corporation.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.Theme is <a href="http://github.com/vimalkvn/solar-theme">Solar</a>
    </div>
    
    <script>
    
    $(function() {
    	var $sidebar	= $('.sphinxsidebar'),
    		$window		= $(window),
    		offset		= $sidebar.offset(),
    		topPadding	= 3,
    		$scroll		= $('#scroll');
    	
    	$window.scroll(function() {
    		if ($scroll.is(':checked')) {
				if ($window.scrollTop() > offset.top) {
					$sidebar.stop().animate({
						marginTop:$window.scrollTop() - offset.top + topPadding
					});
				} else {
					$sidebar.stop().animate({
						marginTop:0
					});
				}
			}
		});
    	
    	var $navList = $('ul:first', $sidebar);
    	$('li:first', $navList).addClass('open');
    	
    	$navList.treeview({
    		persist: "location",
    		collapsed: true,
    		unique: false
    	});
    	
	});
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-46550814-1', 'terasolunaorg.github.io');
    ga('send', 'pageview');
    </script>
  </body>
</html>
