<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>9.3. Authorization &#8212; TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.4.1.RELEASE documentation</title>
    <link rel="stylesheet" href="../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.4.1.RELEASE',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9.4. Session Management" href="SessionManagement.html" />
    <link rel="prev" title="9.2. Authentication" href="Authentication.html" /><script src="../_static/jquery.treeview.js" type="text/javascript"></script>
<!-- <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'> -->
<link href="../_static/solarized-dark.css" rel="stylesheet">
<link href="../_static/jquery.treeview.css" rel="stylesheet">
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="SessionManagement.html" title="9.4. Session Management"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Authentication.html" title="9.2. Authentication"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.4.1.RELEASE documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">9. Security countermeasures</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><br/><img src="../_static/logo_color.png" alt="TERASOLUNA"/><br/><label><input id="scroll" type="checkbox" checked> scroll sidebar</label>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">9.3. Authorization</a><ul>
<li><a class="reference internal" href="#overview">9.3.1. Overview</a><ul>
<li><a class="reference internal" href="#authorization-process-architecture">9.3.1.1. Authorization process architecture</a><ul>
<li><a class="reference internal" href="#exceptiontranslationfilter">9.3.1.1.1. ExceptionTranslationFilter</a></li>
<li><a class="reference internal" href="#filtersecurityinterceptor">9.3.1.1.2. FilterSecurityInterceptor</a></li>
<li><a class="reference internal" href="#accessdecisionmanager">9.3.1.1.3. AccessDecisionManager</a></li>
<li><a class="reference internal" href="#accessdecisionvoter">9.3.1.1.4. AccessDecisionVoter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use">9.3.2. How to use</a><ul>
<li><a class="reference internal" href="#how-to-describe-an-access-policy">9.3.2.1. How to describe an access policy</a><ul>
<li><a class="reference internal" href="#built-in-common-expressions">9.3.2.1.1. Built-In Common Expressions</a></li>
<li><a class="reference internal" href="#built-in-web-expressions">9.3.2.1.2. Built-In Web Expressions</a></li>
<li><a class="reference internal" href="#using-operator">9.3.2.1.3. Using operator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authorization-of-web-resource">9.3.2.2. Authorization of Web resource</a><ul>
<li><a class="reference internal" href="#applying-authorization-process">9.3.2.2.1. Applying authorization process</a></li>
<li><a class="reference internal" href="#defining-access-policy">9.3.2.2.2. Defining access policy</a><ul>
<li><a class="reference internal" href="#specifying-a-web-resource-for-applying-access-policy">9.3.2.2.2.1. Specifying a Web resource for applying access policy</a></li>
<li><a class="reference internal" href="#specifying-an-access-policy">9.3.2.2.2.2. Specifying an access policy</a></li>
<li><a class="reference internal" href="#reference-of-path-variables">9.3.2.2.2.3. Reference of path variables</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#authorization-for-the-method">9.3.2.3. Authorization for the method</a><ul>
<li><a class="reference internal" href="#enabling-aop">9.3.2.3.1. Enabling AOP</a></li>
<li><a class="reference internal" href="#id2">9.3.2.3.2. Applying authorization process</a></li>
<li><a class="reference internal" href="#id3">9.3.2.3.3. Defining access policy</a><ul>
<li><a class="reference internal" href="#specifying-an-access-policy-to-be-applied-prior-to-method-execution">9.3.2.3.3.1. Specifying an access policy to be applied prior to method execution</a></li>
<li><a class="reference internal" href="#specifying-access-policy-to-be-applied-after-method-execution">9.3.2.3.3.2. Specifying access policy to be applied after method execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#authorization-for-jsp-screen-fields">9.3.2.4. Authorization for JSP screen fields</a><ul>
<li><a class="reference internal" href="#defining-an-access-policy">9.3.2.4.1. Defining an access policy</a></li>
<li><a class="reference internal" href="#linking-with-the-access-policy-specified-in-the-web-resource">9.3.2.4.2. Linking with the access policy specified in the Web resource</a></li>
<li><a class="reference internal" href="#storing-determination-results-of-authorization-process-in-the-variable">9.3.2.4.3. Storing determination results of authorization process in the variable</a></li>
</ul>
</li>
<li><a class="reference internal" href="#response-at-the-time-of-authorization-error">9.3.2.5. Response at the time of authorization error</a><ul>
<li><a class="reference internal" href="#accessdeniedhandler">9.3.2.5.1. AccessDeniedHandler</a></li>
<li><a class="reference internal" href="#authenticationentrypoint">9.3.2.5.2. AuthenticationEntryPoint</a></li>
<li><a class="reference internal" href="#transition-destination-at-the-time-of-authorization-error">9.3.2.5.3. Transition destination at the time of authorization error</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-extend">9.3.3. How to extend</a><ul>
<li><a class="reference internal" href="#response-at-the-time-of-authorization-error-authenticated-user">9.3.3.1. Response at the time of authorization error (Authenticated user)</a><ul>
<li><a class="reference internal" href="#applying-accessdeniedhandler">9.3.3.1.1. Applying AccessDeniedHandler</a></li>
</ul>
</li>
<li><a class="reference internal" href="#response-at-the-time-of-authorization-error-unauthenticated-user">9.3.3.2. Response at the time of authorization error (Unauthenticated user)</a><ul>
<li><a class="reference internal" href="#applying-authenticationentrypoint-for-each-request">9.3.3.2.1. Applying AuthenticationEntryPoint for each request</a></li>
</ul>
</li>
<li><a class="reference internal" href="#role-hierarchy">9.3.3.3. Role hierarchy</a><ul>
<li><a class="reference internal" href="#setting-hierarchy-relation">9.3.3.3.1. Setting hierarchy relation</a></li>
<li><a class="reference internal" href="#applying-authorization-process-of-web-resource">9.3.3.3.2. Applying authorization process of Web resource</a></li>
<li><a class="reference internal" href="#applying-authorization-process-of-method">9.3.3.3.3. Applying authorization process of method</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="Authentication.html"
                        title="previous chapter">9.2. Authentication</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="SessionManagement.html"
                        title="next chapter">9.4. Session Management</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/Security/Authorization.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="authorization">
<span id="springsecurityauthorization"></span><h1>9.3. Authorization<a class="headerlink" href="#authorization" title="Permalink to this headline">¶</a></h1>
<div class="admonition caution">
  <p class="first admonition-title">Caution</p>
  <p><strong>This version is already obsolete</strong>. Please check <a href="http://terasolunaorg.github.io/guideline/">the latest guideline</a>.</p>
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id14">Overview</a><ul>
<li><a class="reference internal" href="#authorization-process-architecture" id="id15">Authorization process architecture</a><ul>
<li><a class="reference internal" href="#exceptiontranslationfilter" id="id16">ExceptionTranslationFilter</a></li>
<li><a class="reference internal" href="#filtersecurityinterceptor" id="id17">FilterSecurityInterceptor</a></li>
<li><a class="reference internal" href="#accessdecisionmanager" id="id18">AccessDecisionManager</a></li>
<li><a class="reference internal" href="#accessdecisionvoter" id="id19">AccessDecisionVoter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use" id="id20">How to use</a><ul>
<li><a class="reference internal" href="#how-to-describe-an-access-policy" id="id21">How to describe an access policy</a><ul>
<li><a class="reference internal" href="#built-in-common-expressions" id="id22">Built-In Common Expressions</a></li>
<li><a class="reference internal" href="#built-in-web-expressions" id="id23">Built-In Web Expressions</a></li>
<li><a class="reference internal" href="#using-operator" id="id24">Using operator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authorization-of-web-resource" id="id25">Authorization of Web resource</a><ul>
<li><a class="reference internal" href="#applying-authorization-process" id="id26">Applying authorization process</a></li>
<li><a class="reference internal" href="#defining-access-policy" id="id27">Defining access policy</a><ul>
<li><a class="reference internal" href="#specifying-a-web-resource-for-applying-access-policy" id="id28">Specifying a Web resource for applying access policy</a></li>
<li><a class="reference internal" href="#specifying-an-access-policy" id="id29">Specifying an access policy</a></li>
<li><a class="reference internal" href="#reference-of-path-variables" id="id30">Reference of path variables</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#authorization-for-the-method" id="id31">Authorization for the method</a><ul>
<li><a class="reference internal" href="#enabling-aop" id="id32">Enabling AOP</a></li>
<li><a class="reference internal" href="#id2" id="id33">Applying authorization process</a></li>
<li><a class="reference internal" href="#id3" id="id34">Defining access policy</a><ul>
<li><a class="reference internal" href="#specifying-an-access-policy-to-be-applied-prior-to-method-execution" id="id35">Specifying an access policy to be applied prior to method execution</a></li>
<li><a class="reference internal" href="#specifying-access-policy-to-be-applied-after-method-execution" id="id36">Specifying access policy to be applied after method execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#authorization-for-jsp-screen-fields" id="id37">Authorization for JSP screen fields</a><ul>
<li><a class="reference internal" href="#defining-an-access-policy" id="id38">Defining an access policy</a></li>
<li><a class="reference internal" href="#linking-with-the-access-policy-specified-in-the-web-resource" id="id39">Linking with the access policy specified in the Web resource</a></li>
<li><a class="reference internal" href="#storing-determination-results-of-authorization-process-in-the-variable" id="id40">Storing determination results of authorization process in the variable</a></li>
</ul>
</li>
<li><a class="reference internal" href="#response-at-the-time-of-authorization-error" id="id41">Response at the time of authorization error</a><ul>
<li><a class="reference internal" href="#accessdeniedhandler" id="id42">AccessDeniedHandler</a></li>
<li><a class="reference internal" href="#authenticationentrypoint" id="id43">AuthenticationEntryPoint</a></li>
<li><a class="reference internal" href="#transition-destination-at-the-time-of-authorization-error" id="id44">Transition destination at the time of authorization error</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-extend" id="id45">How to extend</a><ul>
<li><a class="reference internal" href="#response-at-the-time-of-authorization-error-authenticated-user" id="id46">Response at the time of authorization error (Authenticated user)</a><ul>
<li><a class="reference internal" href="#applying-accessdeniedhandler" id="id47">Applying AccessDeniedHandler</a></li>
</ul>
</li>
<li><a class="reference internal" href="#response-at-the-time-of-authorization-error-unauthenticated-user" id="id48">Response at the time of authorization error (Unauthenticated user)</a><ul>
<li><a class="reference internal" href="#applying-authenticationentrypoint-for-each-request" id="id49">Applying AuthenticationEntryPoint for each request</a></li>
</ul>
</li>
<li><a class="reference internal" href="#role-hierarchy" id="id50">Role hierarchy</a><ul>
<li><a class="reference internal" href="#setting-hierarchy-relation" id="id51">Setting hierarchy relation</a></li>
<li><a class="reference internal" href="#applying-authorization-process-of-web-resource" id="id52">Applying authorization process of Web resource</a></li>
<li><a class="reference internal" href="#applying-authorization-process-of-method" id="id53">Applying authorization process of method</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id14">9.3.1. Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This chapter explains authorization function provided by Spring Security.</p>
<p>Authorization process controls the resources that can be accessed by the users of the application.
The standard method to control the resources that can be accessed by the user include defining an access policy for each resource (or a group of resources)
and control the resources by checking the access policy when the user tries to access a resource.</p>
<p>Access policy defines whether to allow a user to access a particular resource.
An access policy for following 3 types of resources is defined in Spring Security.</p>
<ul class="simple">
<li>Web resource</li>
<li>Java method</li>
<li>Domain object <a class="footnote-reference" href="#fspringsecurityauthorization1" id="id1">[1]</a></li>
<li>Screen fields of JSP</li>
</ul>
<p>This section introduces an implementation example (definition example) wherein authorization process is applied to access “Web resource”, “Java method” and “Screen fields of JSP” and explains the authorization function of Spring Security.</p>
<table class="docutils footnote" frame="void" id="fspringsecurityauthorization1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>For authorization function to access domain object , refer <a class="reference external" href="http://docs.spring.io/spring-security/site/docs/4.2.4.RELEASE/reference/htmlsingle/#domain-acls">Spring Security Reference -Domain Object Security (ACLs)-</a>.</td></tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="authorization-process-architecture">
<h3><a class="toc-backref" href="#id15">9.3.1.1. Authorization process architecture</a><a class="headerlink" href="#authorization-process-architecture" title="Permalink to this headline">¶</a></h3>
<p>Spring Security performs authorization process as per the flow below.</p>
<div class="figure" id="id4">
<a class="reference internal image-reference" href="../_images/AuthorizationArchitecture.png"><img alt="../_images/AuthorizationArchitecture.png" src="../_images/AuthorizationArchitecture.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text"><strong>Authorization process architecture</strong></span></p>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A client accesses any resource.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">FilterSecurityInterceptor</span></code> class calls <code class="docutils literal"><span class="pre">AccessDecisionManager</span></code> interface method and checks whether the user has access rights for the resource.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">AffirmativeBased</span></code> class (Implementation class of <code class="docutils literal"><span class="pre">AccessDecisionManager</span></code> used as a default) calls <code class="docutils literal"><span class="pre">AccessDecisionVoter</span></code> interface method and votes for whether the user has access rights.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">FilterSecurityInterceptor</span></code> accesses the resource only if the access rights have been granted by <code class="docutils literal"><span class="pre">AccessDecisionManager</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="exceptiontranslationfilter">
<h4><a class="toc-backref" href="#id16">9.3.1.1.1. ExceptionTranslationFilter</a><a class="headerlink" href="#exceptiontranslationfilter" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">ExceptionTranslationFilter</span></code> is a security filter which handles exceptions generated by authorization process (<code class="docutils literal"><span class="pre">AccessDecisionManager</span></code>) and sends appropriate response to the client.
In the default implementation, a response to ask for authentication in case of access by an unauthenticated user and a response to throw an authorization error in case of an authenticated user are returned.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="filtersecurityinterceptor">
<h4><a class="toc-backref" href="#id17">9.3.1.1.2. FilterSecurityInterceptor</a><a class="headerlink" href="#filtersecurityinterceptor" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">FilterSecurityInterceptor</span></code> is a security filter to apply an authorization process for HTTP request and delegates actual authorization process to <code class="docutils literal"><span class="pre">AccessDecisionManager</span></code>.
While calling a method of <code class="docutils literal"><span class="pre">AccessDecisionManager</span></code> interface, it is linked with the access policy specified in the resource which a client trying to access.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="accessdecisionmanager">
<h4><a class="toc-backref" href="#id18">9.3.1.1.3. AccessDecisionManager</a><a class="headerlink" href="#accessdecisionmanager" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">AccessDecisionManager</span></code> interface checks whether the user has the access rights for the resource which he is trying to access.</p>
<p>Spring Security provides 3 types of implementation classes and all the classes call <code class="docutils literal"><span class="pre">AccessDecisionVoter</span></code> interface method and determine whether the access rights have been granted.
<code class="docutils literal"><span class="pre">AccessDecisionVoter</span></code> votes for “Assign”, “Deny” or Abstain” and then implementation class of <code class="docutils literal"><span class="pre">AccessDecisionManager</span></code> aggregates the voting results and determines final access rights.
<code class="docutils literal"><span class="pre">AccessDeniedException</span></code> exception is thrown and access is denied if determined as “no access rights”.</p>
<p>Note that, if all the voting results indicate “Abstain”, it is determined as “no access rights” in Spring Security by default.</p>
<table border="1" class="colwidths-given docutils" id="id5">
<caption><span class="caption-text"><strong>Implementation class of AccessDecisionManager provided by Spring Security</strong></span><a class="headerlink" href="#id5" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Class name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">AffirmativeBased</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An implementation class which assigns the access rights when 1 vote is given to “Assign”  during voting by <code class="docutils literal"><span class="pre">AccessDecisionVoter</span></code>.</div>
<div class="line"><strong>Implementation class used as a default.</strong></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">ConsensusBased</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An implementation class which assigns the access rights when the majority of votes are for “Assign” during voting for all <code class="docutils literal"><span class="pre">AccessDecisionVoter</span></code>.</div>
<div class="line">When 1 vote each is given to “Assign” and “Deny” or when it is a tie, it is considered as “Have access rights” by default in Spring Security.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">UnanimousBased</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An implementation class which <strong>does not give access rights</strong> when 1 vote is given to “Deny” during voting by <code class="docutils literal"><span class="pre">AccessDecisionVoter</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Selecting AccessDecisionVoter</strong></p>
<p class="last">If only one <code class="docutils literal"><span class="pre">AccessDecisionVoter</span></code> is used, no difference is observed in the operation regardless of the implementation class.
When multiple <code class="docutils literal"><span class="pre">AccessDecisionVoter</span></code> are used, implementation class should be selected in accordance with the requirements.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="accessdecisionvoter">
<h4><a class="toc-backref" href="#id19">9.3.1.1.4. AccessDecisionVoter</a><a class="headerlink" href="#accessdecisionvoter" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">AccessDecisionVoter</span></code> is an interface which checks the access policy specified in the resource which the user is trying to access and votes for whether the access rights are to be granted.</p>
<p>Main implementation classes provided by Spring Security are as given below.</p>
<table border="1" class="colwidths-given docutils" id="id6">
<caption><span class="caption-text"><strong>Main implementation class of AccessDecisionVoter provided by Spring Security</strong></span><a class="headerlink" href="#id6" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Class name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">WebExpressionVoter</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An implementation class which carries out voting by checking the rights information retained by authentication information (<code class="docutils literal"><span class="pre">Authentication</span></code>) through SpEL and request information (<code class="docutils literal"><span class="pre">HttpServletRequest</span></code>).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">RoleVoter</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An implementation class which carries out voting by checking the role of the user.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">RoleHierarchyVoter</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An implementation class which carries out voting by checking the role hierarchy of a user.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">AuthenticatedVoter</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An implementation class which carries out voting by checking the authentication status.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>AccessDecisionVoter to be applied by default</strong></p>
<p class="last">Implementation class of <code class="docutils literal"><span class="pre">AccessDecisionVoter</span></code> interface applied by default is integrated with <code class="docutils literal"><span class="pre">WebExpressionVoter</span></code> from Spring Security 4.0 onwards.
Since <code class="docutils literal"><span class="pre">WebExpressionVoter</span></code> can play the role similar to using <code class="docutils literal"><span class="pre">RoleVoter</span></code>,<code class="docutils literal"><span class="pre">RoleHierarchyVoter</span></code> and <code class="docutils literal"><span class="pre">AuthenticatedVoter</span></code>,
this guideline will also assume the use of default <code class="docutils literal"><span class="pre">WebExpressionVoter</span></code> for explaining authorization process.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="how-to-use">
<h2><a class="toc-backref" href="#id20">9.3.2. How to use</a><a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h2>
<p>A bean definition example (how to specify an access policy) and implementation method required for using authorization function are explained.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="how-to-describe-an-access-policy">
<span id="springsecurityauthorizationpolicy"></span><h3><a class="toc-backref" href="#id21">9.3.2.1. How to describe an access policy</a><a class="headerlink" href="#how-to-describe-an-access-policy" title="Permalink to this headline">¶</a></h3>
<p>How to describe an access policy is explained.</p>
<p>Spring Security supports Spring Expression Language (SpEL) as a method which describes how to specify an access policy.
Although there are other methods which do not use SpEL, this guideline explains how to specify an access policy by using Expression.
How to use SpEL is briefly explained in this section, however for detailed description, refer <a class="reference external" href="http://docs.spring.io/spring/docs/4.3.14.RELEASE/spring-framework-reference/htmlsingle/#expressions">Spring Framework Reference Documentation -Spring Expression Language (SpEL)-</a>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="built-in-common-expressions">
<h4><a class="toc-backref" href="#id22">9.3.2.1.1. Built-In Common Expressions</a><a class="headerlink" href="#built-in-common-expressions" title="Permalink to this headline">¶</a></h4>
<p>Common Expressions provided by Spring Security are as given below.</p>
<table border="1" class="colwidths-given longtable docutils" id="id7">
<caption><span class="caption-text"><strong>Common Expression provided by Spring Security</strong></span><a class="headerlink" href="#id7" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Expression</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">hasRole(String</span> <span class="pre">role)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return <code class="docutils literal"><span class="pre">true</span></code> when logged in user has a role specified in the argument.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">hasAnyRole(String...</span> <span class="pre">roles)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return <code class="docutils literal"><span class="pre">true</span></code> when logged in user has one of the roles specified in the argument.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">isAnonymous()</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return <code class="docutils literal"><span class="pre">true</span></code> in case of an anonymous user who has not logged in.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">isRememberMe()</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return <code class="docutils literal"><span class="pre">true</span></code> in case of a user logged in by using Remember Me authentication.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">isAuthenticated()</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return <code class="docutils literal"><span class="pre">true</span></code> in case of a login.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">isFullyAuthenticated()</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return <code class="docutils literal"><span class="pre">true</span></code> in case of a user who has logged in using normal authentication process instead of Remember Me authentication.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">permitAll</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Always return <code class="docutils literal"><span class="pre">true</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">denyAll</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Always return <code class="docutils literal"><span class="pre">false</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">principal</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return user information of authenticated user (an object of a class which implements <code class="docutils literal"><span class="pre">UserDetails</span></code> interface).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">authentication</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return authentication information of authenticated user (an object of a class which implements <code class="docutils literal"><span class="pre">Authentication</span></code> interface).</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Accessing authentication information which uses Expression</strong></p>
<p class="last">Since user information and authentication information of a logged in user can be accessed when <code class="docutils literal"><span class="pre">principal</span></code> and <code class="docutils literal"><span class="pre">authentication</span></code> are used as Expressions, an access policy can be set by using attributes other than role.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Role name prefix</strong></p>
<p>It was necessary to specify <code class="docutils literal"><span class="pre">ROLE_</span></code>  prefix to role name till Spring Security 3.2. However, specifying <code class="docutils literal"><span class="pre">ROLE_</span></code>  prefix is no longer required from Spring Security 4.0 onwards.</p>
<p>Example)</p>
<ul class="last simple">
<li>Before Spring Security 3.2 : <code class="docutils literal"><span class="pre">hasRole('ROLE_USER')</span></code></li>
<li>Spring Security 4.0 onwards : <code class="docutils literal"><span class="pre">hasRole('USER')</span></code></li>
</ul>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="built-in-web-expressions">
<span id="built-incommon-expressions"></span><h4><a class="toc-backref" href="#id23">9.3.2.1.2. Built-In Web Expressions</a><a class="headerlink" href="#built-in-web-expressions" title="Permalink to this headline">¶</a></h4>
<p>Expressions for Web applications provided by Spring Security are as below.</p>
<table border="1" class="colwidths-given docutils" id="id8">
<caption><span class="caption-text"><strong>Expressions for Web applications provided by Spring Security</strong></span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Expression</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">hasIpAddress(String</span> <span class="pre">ipAddress)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return <code class="docutils literal"><span class="pre">true</span></code>when requested IP address matches the IP address system specified in the argument.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="using-operator">
<h4><a class="toc-backref" href="#id24">9.3.2.1.3. Using operator</a><a class="headerlink" href="#using-operator" title="Permalink to this headline">¶</a></h4>
<p>Determination using an operator can also be performed.
In the example below, access can be granted if both role and requested IP address match.</p>
<ul>
<li><p class="first">Definition example of spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/**&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;) and hasIpAddress(&#39;192.168.10.1&#39;)&quot;</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<p><strong>List of operators that can be used</strong></p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operator</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">[expression-1]</span> <span class="pre">and</span> <span class="pre">[expression-2]</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return true when both expression-1 and expression-2 are true.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">[expression-1]</span> <span class="pre">or</span> <span class="pre">[expression-2]</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return true when one of the expressions is true.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">![expression]</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return false when expression is true and return true when expression is false.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="authorization-of-web-resource">
<span id="authorizationtowebresources"></span><h3><a class="toc-backref" href="#id25">9.3.2.2. Authorization of Web resource</a><a class="headerlink" href="#authorization-of-web-resource" title="Permalink to this headline">¶</a></h3>
<p>Spring Security performs authorization process for Web resource (HTTP request) using a servlet filter system.</p>
<div class="section" id="applying-authorization-process">
<h4><a class="toc-backref" href="#id26">9.3.2.2.1. Applying authorization process</a><a class="headerlink" href="#applying-authorization-process" title="Permalink to this headline">¶</a></h4>
<p>Define a bean as below when authorization process is to be applied for a Web resource.</p>
<ul class="simple">
<li>Definition example of spring-security.xml</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/**&quot;</span> <span class="na">access=</span><span class="s">&quot;isAuthenticated()&quot;</span> <span class="nt">/&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define an access policy in <code class="docutils literal"><span class="pre">&lt;sec:intercept-url&gt;</span></code> tag for a HTTP request.</div>
<div class="line">Here, an access policy is defined by using SpEL wherein “Only authenticated users are granted access for all the requests under a Web application”.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Default definition of use-expressions</strong></p>
<p class="last">Since default value of <code class="docutils literal"><span class="pre">use-expressions</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:http&gt;</span></code> tag is changed to <code class="docutils literal"><span class="pre">true</span></code> from Spring Security 4.0 onwards, it is no longer necessary to explicitly describe while using <code class="docutils literal"><span class="pre">true</span></code>.</p>
</div>
</div>
<div class="section" id="defining-access-policy">
<h4><a class="toc-backref" href="#id27">9.3.2.2.2. Defining access policy</a><a class="headerlink" href="#defining-access-policy" title="Permalink to this headline">¶</a></h4>
<p>How to define an access policy for a Web resource using a bean definition file is explained.</p>
<div class="section" id="specifying-a-web-resource-for-applying-access-policy">
<span id="access-policy-designate-web-resource"></span><h5><a class="toc-backref" href="#id28">9.3.2.2.2.1. Specifying a Web resource for applying access policy</a><a class="headerlink" href="#specifying-a-web-resource-for-applying-access-policy" title="Permalink to this headline">¶</a></h5>
<p>First, a resource (HTTP request) for which an access policy is to be applied, is specified.
Attribute under <code class="docutils literal"><span class="pre">&lt;sec:intercept-url&gt;</span></code> tag is used for the specification of a resource for which an access policy is to be applied.</p>
<table border="1" class="colwidths-given docutils" id="id9">
<caption><span class="caption-text"><strong>Attribute for specifying a resource for which an access policy is to be applied</strong></span><a class="headerlink" href="#id9" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">pattern</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An attribute which uses a resource matching with path pattern specified in Ant format or regular expression as an application target.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">method</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">An attribute which uses a resource as an application target when access is to be done by using specified HTTP methods (GET, POST etc).</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">requires-channel</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify “http” or “https”. An attribute for controlling the access by specified protocol.</div>
<div class="line">if it is not specified, either of these can be accessed.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>For the attributes other than above, refer <a class="reference external" href="http://docs.spring.io/spring-security/site/docs/4.2.4.RELEASE/reference/htmlsingle/#nsa-intercept-url">&lt;intercept-url&gt;</a>.</p>
<ul class="simple">
<li>Definition example of <code class="docutils literal"><span class="pre">&lt;sec:intercept-url&gt;</span></code> tag <code class="docutils literal"><span class="pre">pattern</span></code> attribute (spring-security.xml)</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/accounts/**&quot;</span> <span class="na">access=</span><span class="s">&quot;...&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/**&quot;</span> <span class="na">access=</span><span class="s">&quot;...&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/**&quot;</span> <span class="na">access=</span><span class="s">&quot;...&quot;</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<p>Spring Security matches the requests in the defined order and the definition which is matched at first is applied.
Therefore, definition order must be taken into consideration even while specifying an access policy by using a bean definition file.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>Interpretation of path pattern</strong></p>
<p>Path pattern is interpreted in Ant format, in the default operation of Spring Security.
When the path pattern is to be specified in the regular expression, <code class="docutils literal"><span class="pre">regex</span></code> should be specified in <code class="docutils literal"><span class="pre">request-matcher</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:http&gt;</span></code> tag</p>
<blockquote class="last">
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http</span> <span class="na">request-matcher=</span><span class="s">&quot;regex&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/accounts/.*&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ACCOUNT_MANAGER&#39;)&quot;</span> <span class="nt">/&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Specifications of path matching for <cite>AntPathRequestMatcher</cite>  used by Spring Security by default are now case sensitive for Spring Security 4.1 and subsequent versions.</p>
<p>For example, as shown below, when an access policy is to be defined for endpoint of Spring MVC which allocates <code class="docutils literal"><span class="pre">/Todo/List</span></code> path,
the values specified in <code class="docutils literal"><span class="pre">pattern</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:intercept-url&gt;</span></code> tag must be aligned for uppercase and lowercase letters like <code class="docutils literal"><span class="pre">/Todo/List</span></code> and <code class="docutils literal"><span class="pre">/Todo/*</span></code>.
If the values not aligned by uppercase and lowercase letters like <code class="docutils literal"><span class="pre">/todo/list</span></code> and <code class="docutils literal"><span class="pre">/todo/**</span></code> are specified accidentally, it should be noted that intended authorization control cannot be performed.</p>
<ul class="simple">
<li>Implementation example of Spring MVC endpoint</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">&quot;/Todo/List&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">viewTodoList</span><span class="o">(){</span>
   <span class="c1">//...</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>Definition example of access policy</li>
</ul>
<blockquote class="last">
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/Todo/List&quot;</span> <span class="na">access=</span><span class="s">&quot;isAuthenticated()&quot;</span> <span class="nt">/&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In Spring MVC and Spring Security, the mechanism of matching with the request is strictly different, and there is a vulnerability that breaks through the authorization function of Spring Security and can access the handler method using this difference.
For details of this vulnerability, refer to “<a class="reference external" href="https://pivotal.io/security/cve-2016-5007">CVE-2016-5007 Spring Security / MVC Path Matching Inconsistency</a>”.</p>
<p class="last">This vulnerability occurs when the Bean of <cite>org.springframework.util.AntPathMatcher</cite> set <cite>true</cite> to <cite>trimTokens</cite> property is applied to Spring MVC.
In Spring Framework 4.2 and earlier, the default value of the <cite>trimTokens</cite> property was set to <cite>true</cite> , but since the default value was changed to <cite>false</cite> from Spring Framework 4.3, this vulnerability does not occur unless user intentionally change the property.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>If an access policy for a specific URL is to be specified (wild cards like <code class="docutils literal"><span class="pre">*</span></code>, <code class="docutils literal"><span class="pre">**</span></code> etc are not included in <code class="docutils literal"><span class="pre">pattern</span></code> attribute),
an access policy with a pattern with an extension and a pattern with <code class="docutils literal"><span class="pre">/</span></code> appended at the end of request path must be added.</p>
<p>In the following configuration example, only the users with “ROLE_ADMIN” role are allowed to access by <code class="docutils literal"><span class="pre">/restrict</span></code>.</p>
<blockquote class="last">
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/restrict.*&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;)&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/restrict/&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;)&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/restrict&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;)&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define an access policy of the pattern with an extension (<code class="docutils literal"><span class="pre">/restrict.json</span></code> etc) in <code class="docutils literal"><span class="pre">/restrict</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define an access policy of the pattern wherein “<code class="docutils literal"><span class="pre">/</span></code>”  appended at the end of the request path (<code class="docutils literal"><span class="pre">/restrict/</span></code> etc) in <code class="docutils literal"><span class="pre">/restrict</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define an access policy for <code class="docutils literal"><span class="pre">/restrict</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div>
<div class="section" id="specifying-an-access-policy">
<h5><a class="toc-backref" href="#id29">9.3.2.2.2.2. Specifying an access policy</a><a class="headerlink" href="#specifying-an-access-policy" title="Permalink to this headline">¶</a></h5>
<p>Next, an access policy is specified.
Access policy is specified in <code class="docutils literal"><span class="pre">access</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:intercept-url&gt;</span></code> tag.</p>
<ul>
<li><p class="first">Definition example of <code class="docutils literal"><span class="pre">&lt;sec:intercept-url&gt;</span></code> tag <code class="docutils literal"><span class="pre">access</span></code> attribute (<code class="docutils literal"><span class="pre">spring-security.xml</span></code>)</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/accounts/**&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ACCOUNT_MANAGER&#39;)&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/configurations/**&quot;</span> <span class="na">access=</span><span class="s">&quot;hasIpAddress(&#39;127.0.0.1&#39;) and hasRole(&#39;CONFIGURATION_MANAGER&#39;)&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/**&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;)&quot;</span> <span class="nt">/&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils" id="id10">
<caption><span class="caption-text"><strong>Attribute for specifying an access policy</strong></span><a class="headerlink" href="#id10" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">access</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify access control expression using SpEL and a role that can be accessed.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line">A setting example with roles namely “ROLE_USER” and “ROLE_ADMIN” assigned to login user, is shown below.</div>
</div>
<ul>
<li><p class="first">Definition example of <code class="docutils literal"><span class="pre">&lt;sec:intercept-url&gt;</span></code> tag <code class="docutils literal"><span class="pre">pattern</span></code>attribute (spring-security.xml)</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/reserve/**&quot;</span> <span class="na">access=</span><span class="s">&quot;hasAnyRole(&#39;USER&#39;,&#39;ADMIN&#39;)&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/**&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;)&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/**&quot;</span> <span class="na">access=</span><span class="s">&quot;denyAll&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">To access <code class="docutils literal"><span class="pre">/reserve/**</span></code>, either the role “ROLE_USER” or “ROLE_ADMIN” is required.</div>
<div class="line"><code class="docutils literal"><span class="pre">hasAnyRole</span></code> will be described later.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">To access <code class="docutils literal"><span class="pre">/admin/**</span></code>, the role “ROLE_ADMIN” is required.</div>
<div class="line"><code class="docutils literal"><span class="pre">hasRole</span></code> will be described later.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">denyAll</span></code> is set for all patterns</div>
<div class="line">Any user should not be able to access a URL for which no rights settings are described.</div>
<div class="line"><code class="docutils literal"><span class="pre">denyAll</span></code> will be described later.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>About description sequence of URL pattern</strong></p>
<p class="last">The request received from client is matched with the pattern in intercept-url, starting from the top and access is granted for the matched pattern.
Therefore, pattern should always be described from limited patterns.</p>
</div>
</li>
</ul>
<p>SpEL is enabled in Spring Security by default.
SpEL described in <code class="docutils literal"><span class="pre">access</span></code> attribute is determined as a true value. If the expression is true, access is granted.
How to use is shown below.</p>
<ul>
<li><p class="first">Definition example of spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/**&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;)&quot;</span><span class="nt">/&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return true if the logged in user retains the specified role, by specifying <code class="docutils literal"><span class="pre">hasRole('Role</span> <span class="pre">name')</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p id="spring-el">For main Expression that can be used, refer <a class="reference internal" href="#springsecurityauthorizationpolicy"><span class="std std-ref">How to describe an access policy</span></a>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="reference-of-path-variables">
<h5><a class="toc-backref" href="#id30">9.3.2.2.2.3. Reference of path variables</a><a class="headerlink" href="#reference-of-path-variables" title="Permalink to this headline">¶</a></h5>
<p>In Spring Security 4.1 and subsequent versions, a path variable [#fPathVariableDescription]_ can be used while specifying a resource which applies the access policy
and can be referred by specifying <code class="docutils literal"><span class="pre">#path</span> <span class="pre">variable</span> <span class="pre">name</span></code> in the definition of access policy.</p>
<p>However, when access policy which uses a path variable for a path accessible with an extension is to be defined, it must be defined so that the extension part is not stored in the path variable value.</p>
<p>For example, when <code class="docutils literal"><span class="pre">/users/{userName}</span></code> is defined in the pattern and a request path <code class="docutils literal"><span class="pre">/users/personName.json</span></code> is sent,
<code class="docutils literal"><span class="pre">personName.json</span></code> gets stored in the path variable <code class="docutils literal"><span class="pre">#userName</span></code> referenced in the definition of access policy, instead of <code class="docutils literal"><span class="pre">personName</span></code>, and
unintended authorization control is performed.</p>
<p>In order to prevent this event, “access policy for path without extension” must be defined after defining “access policy for path with extension”.</p>
<p>In the example below, the access policy is defined so that the login users can access only their own user information.</p>
<ul>
<li><p class="first">Definition example of spring-security.xml (while using wild card)</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http&gt;</span>
    <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/users/{userName}.*&quot;</span>  <span class="na">access=</span><span class="s">&quot;isAuthenticated() and #userName == principal.username&quot;</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- (2) --&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/users/{userName}/**&quot;</span> <span class="na">access=</span><span class="s">&quot;isAuthenticated() and #userName == principal.username&quot;</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define “access policy for path with extension”.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define “access policy for path without extension”.</div>
<div class="line">Use wild card and define access policy for the path that starts with <code class="docutils literal"><span class="pre">/users/{userName}</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first">Definition example of spring-security.xml (while not using wild card)</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http&gt;</span>
    <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/users/{userName}.*&quot;</span> <span class="na">access=</span><span class="s">&quot;isAuthenticated() and #userName == principal.username&quot;</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- (2) --&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/users/{userName}/&quot;</span>  <span class="na">access=</span><span class="s">&quot;isAuthenticated() and #userName == principal.username&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/users/{userName}&quot;</span>   <span class="na">access=</span><span class="s">&quot;isAuthenticated() and #userName == principal.username&quot;</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define “access policy for the path with extension”.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define “access policy for the path without extension”.</div>
<div class="line">When wild card is not used, an access policy for the path which ends with “<code class="docutils literal"><span class="pre">/</span></code>” is defined in order to absorb the differences</div>
<div class="line-block">
<div class="line">of path matching for Spring MVC and Spring Security.</div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="authorization-for-the-method">
<span id="authorizationtomethod"></span><h3><a class="toc-backref" href="#id31">9.3.2.3. Authorization for the method</a><a class="headerlink" href="#authorization-for-the-method" title="Permalink to this headline">¶</a></h3>
<p>Spring Security performs authorization process for calling a method of Bean which is managed in DI container by using Spring AOP system.</p>
<p>Authorization process for the method is provided by considering its use for calling a domain layer (service layer) method.
If authorization process for the method is used, a detailed access policy can be defined since a property of domain object can be checked.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="enabling-aop">
<h4><a class="toc-backref" href="#id32">9.3.2.3.1. Enabling AOP</a><a class="headerlink" href="#enabling-aop" title="Permalink to this headline">¶</a></h4>
<p>When the authorization process for the method is to be used, a component (AOP) for performing authorization process for calling the method must be enabled.
If AOP is enabled, access policy can be defined in the method annotation.</p>
<p>Spring Security supports following annotations.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">&#64;PreAuthorize</span></code>, <code class="docutils literal"><span class="pre">&#64;PostAuthorize</span></code>, <code class="docutils literal"><span class="pre">&#64;PreFilter</span></code>, <code class="docutils literal"><span class="pre">&#64;PostFilter</span></code></li>
<li>JSR-250 (<code class="docutils literal"><span class="pre">javax.annotation.security</span></code> package) annotation (<code class="docutils literal"><span class="pre">&#64;RolesAllowed</span></code> etc.)</li>
<li><code class="docutils literal"><span class="pre">&#64;Secured</span></code></li>
</ul>
<p>This guideline explains how to use <code class="docutils literal"><span class="pre">&#64;PreAuthorize</span></code> and <code class="docutils literal"><span class="pre">&#64;PostAuthorize</span></code> which enable the use of access policy by Expression.</p>
<ul class="simple">
<li>Definition example of spring-security.xml</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:global-method-security</span> <span class="na">pre-post-annotations=</span><span class="s">&quot;enabled&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) (2) --&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">AOP which performs authorization process for method calling is enabled if <code class="docutils literal"><span class="pre">&lt;sec:global-method-security&gt;</span></code> tag is assigned.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">enabled</span></code> in <code class="docutils literal"><span class="pre">pre-post-annotations</span></code> attribute.</div>
<div class="line">If <code class="docutils literal"><span class="pre">enabled</span></code> is specified in <code class="docutils literal"><span class="pre">pre-post-annotations</span></code> attribute, the annotation that can define an access policy by specifying Expression is enabled.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="id2">
<h4><a class="toc-backref" href="#id33">9.3.2.3.2. Applying authorization process</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>An annotation which specifies an access policy is used and an access policy is defined for each method by applying authorization process for the method.</p>
</div>
<div class="section" id="id3">
<h4><a class="toc-backref" href="#id34">9.3.2.3.3. Defining access policy</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<div class="section" id="specifying-an-access-policy-to-be-applied-prior-to-method-execution">
<h5><a class="toc-backref" href="#id35">9.3.2.3.3.1. Specifying an access policy to be applied prior to method execution</a><a class="headerlink" href="#specifying-an-access-policy-to-be-applied-prior-to-method-execution" title="Permalink to this headline">¶</a></h5>
<p>When an access policy is to be specified for applying prior to method execution, <code class="docutils literal"><span class="pre">&#64;PreAuthorize</span></code> is used.</p>
<p>When the results of the Expression specified in <code class="docutils literal"><span class="pre">value</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;PreAuthorize</span></code> become <code class="docutils literal"><span class="pre">true</span></code>, execution of the method is allowed.
In the example below, it has been defined that only administrator can access the account information for other persons.</p>
<ul class="simple">
<li>Definition example of <code class="docutils literal"><span class="pre">&#64;PreAuthorize</span></code></li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="c1">// (1) (2)</span>
<span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;) or (#username == principal.username)&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">Account</span> <span class="nf">findOne</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">accountRepository</span><span class="o">.</span><span class="na">findOne</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;PreAuthorize</span></code> to the method which needs to be authorized.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define an access policy for the method, in <code class="docutils literal"><span class="pre">value</span></code> attribute.</div>
<div class="line">Here, an access policy - “Allow access to all accounts for the administrator” and “Allow access to only individual account when other than administrator” is defined.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>The part wherein a method argument is accessed from the Expression is discussed here.
Specifically, “<code class="docutils literal"><span class="pre">#username</span></code>” part accesses the argument.
A method argument can be accessed by specifying Expression of “# + argument name” format in Expression.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>Annotation which specifies argument name</strong></p>
<p>Spring Security resolves the argument name from debug information output in the class.
However an argument name can be explicitly specified by using an annotation (<code class="docutils literal"><span class="pre">&#64;org.springframework.security.access.method.P</span></code>)</p>
<p>A variable name can be specified explicitly by using the annotation if it is applicable to following cases.</p>
<ul>
<li><p class="first">Debug information of variable is not output in the class</p>
</li>
<li><p class="first">When it is to be accessed by using a name different from that of actual variable name in the Expression (for example shortened name)</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;) or (#username == principal.username)&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">Account</span> <span class="nf">findOne</span><span class="o">(</span><span class="nd">@P</span><span class="o">(</span><span class="s">&quot;username&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">accountRepository</span><span class="o">.</span><span class="na">findOne</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
</ul>
<p>Note that when <code class="docutils literal"><span class="pre">#username</span></code> and a method argument - <code class="docutils literal"><span class="pre">username</span></code> name are identical,  <code class="docutils literal"><span class="pre">&#64;P</span></code> can be omitted.
However, since Spring Security resolves the argument name by using an argument name of implementation class, note that the <strong>argument name of implementation class should match with #username specified in &#64;PreAuthorize</strong>
when <code class="docutils literal"><span class="pre">&#64;PreAuthorize</span></code> annotation  is defined in the interface.</p>
<p class="last">When compile option added from JDK 8 (<code class="docutils literal"><span class="pre">-parameters</span></code>) is used, meta data for reflection is generated in the method parameter. Hence argument name is resolved even when the annotation is not specified.</p>
</div>
</div>
<div class="section" id="specifying-access-policy-to-be-applied-after-method-execution">
<h5><a class="toc-backref" href="#id36">9.3.2.3.3.2. Specifying access policy to be applied after method execution</a><a class="headerlink" href="#specifying-access-policy-to-be-applied-after-method-execution" title="Permalink to this headline">¶</a></h5>
<p>When an access policy to be applied after execution of the method is specified, <code class="docutils literal"><span class="pre">&#64;PostAuthorize</span></code> is used.</p>
<p>When the results of the Expression specified in <code class="docutils literal"><span class="pre">value</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;PostAuthorize</span></code> become true, results of method execution are returned to the call source.
In the example below, it has been defined such that the user is not allowed to access the information of the user belonging to other department.</p>
<ul class="simple">
<li>Definition example of <code class="docutils literal"><span class="pre">&#64;PostAuthorize</span></code></li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">&quot;...&quot;</span><span class="o">)</span>
<span class="nd">@PostAuthorize</span><span class="o">(</span><span class="s">&quot;(returnObject == null) &quot;</span> <span class="o">+</span>
        <span class="s">&quot;or (returnObject.departmentCode == principal.account.departmentCode)&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">Account</span> <span class="nf">findOne</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">accountRepository</span><span class="o">.</span><span class="na">findOne</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The part wherein the return value of the method is accessed from the Expression is discussed here.
Specifically, “<code class="docutils literal"><span class="pre">returnObject.departmentCode</span></code>” part accesses the return value.
The return value of the method can be accessed by specifying <code class="docutils literal"><span class="pre">returnObject</span></code> in the Expression.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="authorization-for-jsp-screen-fields">
<h3><a class="toc-backref" href="#id37">9.3.2.4. Authorization for JSP screen fields</a><a class="headerlink" href="#authorization-for-jsp-screen-fields" title="Permalink to this headline">¶</a></h3>
<p>Spring Security can apply authorization process for JSP screen fields by using a JSP tag library.</p>
<p>Here, a method to apply authorization process for accessing JSP screen fields is explained using a simple definition as an example.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="defining-an-access-policy">
<h4><a class="toc-backref" href="#id38">9.3.2.4.1. Defining an access policy</a><a class="headerlink" href="#defining-an-access-policy" title="Permalink to this headline">¶</a></h4>
<p>A condition to allow display (access policy) is defined in JSP while defining an access policy for JSP screen fields using a JSP tag library.</p>
<ul class="simple">
<li>Definition example of access policy</li>
</ul>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;sec&quot;</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://www.springframework.org/security/tags&quot;</span> <span class="k">%&gt;</span>

<span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;sec:authorize</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ADMIN&#39;)&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
    <span class="nt">&lt;h2&gt;</span>Admin Menu<span class="nt">&lt;/h2&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:authorize&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Enclose part for which an access policy is to be applied with <code class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></code> tag.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define an access policy in <code class="docutils literal"><span class="pre">access</span></code> attribute. Here, an access policy - “allow display in case of administrator” is defined.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="linking-with-the-access-policy-specified-in-the-web-resource">
<h4><a class="toc-backref" href="#id39">9.3.2.4.2. Linking with the access policy specified in the Web resource</a><a class="headerlink" href="#linking-with-the-access-policy-specified-in-the-web-resource" title="Permalink to this headline">¶</a></h4>
<p>When an access policy is to be defined for buttons or links (screen fields associated with the requests to the server), it is linked with an access policy defined in the Web resource for request.
<code class="docutils literal"><span class="pre">url</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></code> tag is used for linking with access policy specified in the Web resource.</p>
<p>JSP process implemented in <code class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></code> tag is executed only when Web resource specified in <code class="docutils literal"><span class="pre">url</span></code> attribute can be accessed.</p>
<ul class="simple">
<li>Example of linking with access policy defined in Web resource</li>
</ul>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="nt">&lt;ul&gt;</span>
    <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;sec:authorize</span> <span class="na">url=</span><span class="s">&quot;/admin/accounts&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
        <span class="nt">&lt;li&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;&lt;c:url value=&#39;/admin/accounts&#39; /&gt;&quot;</span><span class="nt">&gt;</span>Account Management<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;/sec:authorize&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Enclose part which outputs button or link with <code class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></code> tag.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a URL for accessing a Web resource in <code class="docutils literal"><span class="pre">url</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></code> tag.</div>
<div class="line">Here, an access policy - “Allow display when a Web resource allocated with <code class="docutils literal"><span class="pre">/admin/accounts</span></code> URL can be accessed” is defined however it is not necessary to be directly aware of the access policy defined in Web resource.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Specifying a policy by HTTP method</strong></p>
<p class="last">When a different access policy is specified by HTTP method while defining an access policy of Web resource, the definition to be linked must be identified by using <code class="docutils literal"><span class="pre">method</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></code> tag.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>Notes related to display control</strong></p>
<p>When display for a button or link is to be controlled, it should always be linked with an access policy defined in the Web resource.</p>
<p class="last">If an access policy is not defined independently for a Web resource by specifying a direct access policy for button or link,
an unauthorized access such as accessing a URL directly cannot be prevented.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="storing-determination-results-of-authorization-process-in-the-variable">
<h4><a class="toc-backref" href="#id40">9.3.2.4.3. Storing determination results of authorization process in the variable</a><a class="headerlink" href="#storing-determination-results-of-authorization-process-in-the-variable" title="Permalink to this headline">¶</a></h4>
<p>Determination results of authorization process called by using <code class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></code> tag can be reused by storing in the variable.</p>
<ul class="simple">
<li>Implementation example of JSP</li>
</ul>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:authorize</span> <span class="na">url=</span><span class="s">&quot;/admin/accounts&quot;</span>
               <span class="na">var=</span><span class="s">&quot;hasAccountsAuthority&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>

<span class="nt">&lt;c:if</span> <span class="na">test=</span><span class="s">&quot;${hasAccountsAuthority}&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/c:if&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a variable name for storing determination results in <code class="docutils literal"><span class="pre">var</span></code> attribute.</div>
<div class="line">When access is allowed, <code class="docutils literal"><span class="pre">true</span></code> is set in the variable.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Refer variable value and implement display process.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="response-at-the-time-of-authorization-error">
<span id="authorizationerrorresponse"></span><h3><a class="toc-backref" href="#id41">9.3.2.5. Response at the time of authorization error</a><a class="headerlink" href="#response-at-the-time-of-authorization-error" title="Permalink to this headline">¶</a></h3>
<p>Spring Security handles the errors as shown in the following flow and controls the response when access to a resource is denied.</p>
<div class="figure" id="id11">
<a class="reference internal image-reference" href="../_images/AuthorizationAccessDeniedHandling.png"><img alt="../_images/AuthorizationAccessDeniedHandling.png" src="../_images/AuthorizationAccessDeniedHandling.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text"><strong>Mechanism for handling authorization error</strong></span></p>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Spring Security generates a <code class="docutils literal"><span class="pre">AccessDeniedException</span></code> for denying access to a resource or a method.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">ExceptionTranslationFilter</span></code> class catches <code class="docutils literal"><span class="pre">AccessDeniedException</span></code> and performs error handling by calling methods of <code class="docutils literal"><span class="pre">AccessDeniedHandler</span></code> or <code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code> interface.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Perform error handling by calling a method of <code class="docutils literal"><span class="pre">AccessDeniedHandler</span></code> interface in case of an access by authenticated user.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Perform error handling by calling a method of <code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code> interface in case of an access by unauthenticated user.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="accessdeniedhandler">
<h4><a class="toc-backref" href="#id42">9.3.2.5.1. AccessDeniedHandler</a><a class="headerlink" href="#accessdeniedhandler" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">AccessDeniedHandler</span></code> interface handles the error responses when the access is denied to authenticated users.
Spring Security offers following classes as the implementation class of <code class="docutils literal"><span class="pre">AccessDeniedHandler</span></code> interface.</p>
<table border="1" class="colwidths-given docutils" id="id12">
<caption><span class="caption-text"><strong>Implementation class of AccessDeniedHandler provided by Spring Security</strong></span><a class="headerlink" href="#id12" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Class name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">AccessDeniedHandlerImpl</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set 403 (Forbidden) in HTTP response code and move to specified error page.</div>
<div class="line">When error page is not specified, send error response (<code class="docutils literal"><span class="pre">HttpServletResponse#sendError</span></code>) by setting 403 (Forbidden) in HTTP response code.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">InvalidSessionAccessDeniedHandler</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Delegate the process to implementation class of <code class="docutils literal"><span class="pre">InvalidSessionStrategy</span></code> interface.</div>
<div class="line">This class is used when the settings to detect a session timeout is enabled by using CSRF countermeasure and session management function at the time when CSRF token does not exist in the session (a session timeout has occurred).</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">DelegatingAccessDeniedHandler</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Map implementation classes of <code class="docutils literal"><span class="pre">AccessDeniedException</span></code> and <code class="docutils literal"><span class="pre">AccessDeniedHandler</span></code> interface and delegate the process to the implementation class of <code class="docutils literal"><span class="pre">AccessDeniedHandler</span></code> interface corresponding to <code class="docutils literal"><span class="pre">AccessDeniedException</span></code> thus occurred.</div>
<div class="line"><code class="docutils literal"><span class="pre">InvalidSessionAccessDeniedHandler</span></code> is called by using this mechanism.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>In the default setting of Spring Security, <code class="docutils literal"><span class="pre">AccessDeniedHandlerImpl</span></code>is used wherein an error page is not specified.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="authenticationentrypoint">
<h4><a class="toc-backref" href="#id43">9.3.2.5.2. AuthenticationEntryPoint</a><a class="headerlink" href="#authenticationentrypoint" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code> interface handles the error responses when the access is denied to unauthenticated users.
Spring Security offers following class as an implementation class of <code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code> interface.</p>
<table border="1" class="colwidths-given docutils" id="id13">
<caption><span class="caption-text"><strong>Main implementation class of AuthenticationEntryPoint offered by Spring Security</strong></span><a class="headerlink" href="#id13" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Class Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">LoginUrlAuthenticationEntryPoint</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Display a login form for form authentication.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">BasicAuthenticationEntryPoint</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Send error response for Basic authentication.</div>
<div class="line">Specifically, set 401 (Unauthorized) in HTTP response code, <code class="docutils literal"><span class="pre">WWW-Authenticate</span></code> header for Basic authentication as a response header and send error response (<code class="docutils literal"><span class="pre">HttpServletResponse#sendError</span></code>).</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">DigestAuthenticationEntryPoint</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Send error response for Digest authentication.</div>
<div class="line">Specifically, set 401 (Unauthorised) in the HTTP response code, <code class="docutils literal"><span class="pre">WWW-Authenticate</span></code> header for Digest authentication as a response header and send error response (<code class="docutils literal"><span class="pre">HttpServletResponse#sendError</span></code>).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">Http403ForbiddenEntryPoint</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set 403 (Forbidden) in HTTP response code and send error response (<code class="docutils literal"><span class="pre">HttpServletResponse#sendError</span></code>).</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">DelegatingAuthenticationEntryPoint</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Map implementation class of <code class="docutils literal"><span class="pre">RequestMatcher</span></code> and <code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code> interface, and delegate the process to implementation class of <code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code> interface corresponding to HTTP request.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Implementation class of <code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code> interface corresponding to authentication method is used in the default setup of Spring Security.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="transition-destination-at-the-time-of-authorization-error">
<span id="springsecurityauthorizationonerror"></span><h4><a class="toc-backref" href="#id44">9.3.2.5.3. Transition destination at the time of authorization error</a><a class="headerlink" href="#transition-destination-at-the-time-of-authorization-error" title="Permalink to this headline">¶</a></h4>
<p>In the default setting of Spring Security, when the access is denied to the authenticated user, an error page of application server is displayed.
If error page of application server is displayed, it is likely to result in system degradation. Hence it is recommended to display an appropriate error screen.
Error page can be specified by defining a bean as below.</p>
<ul class="simple">
<li>Definition example of spring-security.xml</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
    <span class="nt">&lt;sec:access-denied-handler</span>
        <span class="na">error-page=</span><span class="s">&quot;/WEB-INF/views/common/error/accessDeniedError.jsp&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify an error page for authorization error in <code class="docutils literal"><span class="pre">error-page</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:access-denied-handler&gt;</span></code> tag.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>Using error page function of servlet container</strong></p>
<p>Error page for authorization error can also be specified by using an error page function of servlet container.</p>
<p>When error page function of servlet container is used, error page is specified by using <code class="docutils literal"><span class="pre">&lt;error-page&gt;</span></code> tag of <code class="docutils literal"><span class="pre">web.xml</span></code>.</p>
<blockquote class="last">
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;error-page&gt;</span>
    <span class="nt">&lt;error-code&gt;</span>403<span class="nt">&lt;/error-code&gt;</span>
    <span class="nt">&lt;location&gt;</span>/WEB-INF/views/common/error/accessDeniedError.jsp<span class="nt">&lt;/location&gt;</span>
<span class="nt">&lt;/error-page&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
</div>
</div>
<div class="section" id="how-to-extend">
<h2><a class="toc-backref" href="#id45">9.3.3. How to extend</a><a class="headerlink" href="#how-to-extend" title="Permalink to this headline">¶</a></h2>
<p>This section explains customization points and extension methods offered by Spring Security.</p>
<p>Spring Security provides a lot of customization points of which only a few will be introduced here.
This section will focus on some typical customization points.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="response-at-the-time-of-authorization-error-authenticated-user">
<h3><a class="toc-backref" href="#id46">9.3.3.1. Response at the time of authorization error (Authenticated user)</a><a class="headerlink" href="#response-at-the-time-of-authorization-error-authenticated-user" title="Permalink to this headline">¶</a></h3>
<p>Here, a method to customise the operation when an access from authenticated user is denied, is explained.</p>
<div class="section" id="applying-accessdeniedhandler">
<span id="springsecurityauthorizationaccessdeniedhandler"></span><h4><a class="toc-backref" href="#id47">9.3.3.1.1. Applying AccessDeniedHandler</a><a class="headerlink" href="#applying-accessdeniedhandler" title="Permalink to this headline">¶</a></h4>
<p>When the requirements are not met only by customising default operation provided by Spring Security, implementation class of <code class="docutils literal"><span class="pre">AccessDeniedHandler</span></code> interface can be directly applied.</p>
<p>For example, when an authorization error occurs in Ajax request (REST API etc), error information is displayed in JSON format instead of displaying an error page (HTML).
In such a case, an implementation class of <code class="docutils literal"><span class="pre">AccessDeniedHandler</span></code> interface can be created and applied in Spring Security.</p>
<ul class="simple">
<li>How to create an implementation class of AccessDeniedHandler interface</li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JsonDelegatingAccessDeniedHandler</span> <span class="kd">implements</span> <span class="n">AccessDeniedHandler</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">RequestMatcher</span> <span class="n">jsonRequestMatcher</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">AccessDeniedHandler</span> <span class="n">delegateHandler</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">JsonDelegatingAccessDeniedHandler</span><span class="o">(</span>
            <span class="n">RequestMatcher</span> <span class="n">jsonRequestMatcher</span><span class="o">,</span> <span class="n">AccessDeniedHandler</span> <span class="n">delegateHandler</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">jsonRequestMatcher</span> <span class="o">=</span> <span class="n">jsonRequestMatcher</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">delegateHandler</span> <span class="o">=</span> <span class="n">delegateHandler</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span>
                       <span class="n">AccessDeniedException</span> <span class="n">accessDeniedException</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">ServletException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">jsonRequestMatcher</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="n">request</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">// response error information of JSON format</span>
            <span class="n">response</span><span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="n">HttpServletResponse</span><span class="o">.</span><span class="na">SC_FORBIDDEN</span><span class="o">);</span>
            <span class="c1">// omitted</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="c1">// response error page of HTML format</span>
            <span class="n">delegateHandler</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span>
                    <span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">,</span> <span class="n">accessDeniedException</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<ul class="simple">
<li>Definition example of spring-security.xml</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;accessDeniedHandler&quot;</span>
      <span class="na">class=</span><span class="s">&quot;com.example.web.security.JsonDelegatingAccessDeniedHandler&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.util.matcher.AntPathRequestMatcher&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">&quot;/api/**&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/constructor-arg&gt;</span>
    <span class="nt">&lt;constructor-arg&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.access.AccessDeniedHandlerImpl&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;errorPage&quot;</span>
                      <span class="na">value=</span><span class="s">&quot;/WEB-INF/views/common/error/accessDeniedError.jsp&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/constructor-arg&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;sec:http&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
    <span class="nt">&lt;sec:access-denied-handler</span> <span class="na">ref=</span><span class="s">&quot;accessDeniedHandler&quot;</span> <span class="nt">/&gt;</span>  <span class="c">&lt;!-- (2) --&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>(1)</td>
<td>Define a bean for implementation class of <code class="docutils literal"><span class="pre">AccessDeniedHandler</span></code> interface and register in DI container.</td>
</tr>
<tr class="row-odd"><td>(2)</td>
<td>Specify a bean for <code class="docutils literal"><span class="pre">AccessDeniedHandler</span></code> in  <code class="docutils literal"><span class="pre">ref</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:access-denied-handler&gt;</span></code> tag.</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="response-at-the-time-of-authorization-error-unauthenticated-user">
<h3><a class="toc-backref" href="#id48">9.3.3.2. Response at the time of authorization error (Unauthenticated user)</a><a class="headerlink" href="#response-at-the-time-of-authorization-error-unauthenticated-user" title="Permalink to this headline">¶</a></h3>
<p>Here, a method to customise operation when access is denied to an unauthenticated user, is explained.</p>
<div class="section" id="applying-authenticationentrypoint-for-each-request">
<h4><a class="toc-backref" href="#id49">9.3.3.2.1. Applying AuthenticationEntryPoint for each request</a><a class="headerlink" href="#applying-authenticationentrypoint-for-each-request" title="Permalink to this headline">¶</a></h4>
<p>Similarly to authenticated user, when authorization error occurs in Ajax request (REST API etc), error information is displayed in JSON format instead of displaying it in login page (HTML).
In such a case, implementation class of <code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code> interface for each pattern of request is applied in Spring Security.</p>
<ul class="simple">
<li>Definition example of spring-security.xml</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;authenticationEntryPoint&quot;</span>
      <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.authentication.DelegatingAuthenticationEntryPoint&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg&gt;</span>
        <span class="nt">&lt;map&gt;</span>
            <span class="nt">&lt;entry&gt;</span>
                <span class="nt">&lt;key&gt;</span>
                    <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.util.matcher.AntPathRequestMatcher&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">&quot;/api/**&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/bean&gt;</span>
                <span class="nt">&lt;/key&gt;</span>
                <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;com.example.web.security.JsonAuthenticationEntryPoint&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/entry&gt;</span>
        <span class="nt">&lt;/map&gt;</span>
    <span class="nt">&lt;/constructor-arg&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;defaultEntryPoint&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">value=</span><span class="s">&quot;/login&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;sec:http</span> <span class="na">entry-point-ref=</span><span class="s">&quot;authenticationEntryPoint&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define a bean for implementation class of <code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code> interface and register in DI container.</div>
<div class="line">Here, an implementation class of <code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code> interface is applied for each pattern of request by using <code class="docutils literal"><span class="pre">DelegatingAuthenticationEntryPoint</span></code> class offered by Spring Security.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a bean for <code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code>in <code class="docutils literal"><span class="pre">entry-point-ref</span></code> attribute of  <code class="docutils literal"><span class="pre">&lt;sec:http&gt;</span></code> tag.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>AuthenticationEntryPoint applied by default</strong></p>
<p class="last">When the implementation class of <code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code> interface corresponding to request is not specified, the implementation class of <code class="docutils literal"><span class="pre">AuthenticationEntryPoint</span></code> interface defined by Spring Security by default is used.
When form authentication is used as an authentication method, <code class="docutils literal"><span class="pre">LoginUrlAuthenticationEntryPoint</span></code> class is used and login form is displayed.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="role-hierarchy">
<h3><a class="toc-backref" href="#id50">9.3.3.3. Role hierarchy</a><a class="headerlink" href="#role-hierarchy" title="Permalink to this headline">¶</a></h3>
<p>A hierarchy can be set for a role in the authorization process.</p>
<p>Higher level roles can also access the resources for which access is granted to the lower level roles.
When the role relation is complex, hierarchy relation must also be established.</p>
<p>For example, when a hierarchy relation is established wherein “ROLE_ADMIN” is a higher role and “ROLE_USER” is a lower role,
and if an access policy is set as below, user with “ROLE_ADMIN” rights can access a path under <code class="docutils literal"><span class="pre">/user</span></code>(a path which can be accessed by a user with “ROLE_USER” rights).</p>
<ul class="simple">
<li>Definition example of spring-security.xml</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;sec:http&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/user/**&quot;</span> <span class="na">access=</span><span class="s">&quot;hasAnyRole(&#39;USER&#39;)&quot;</span> <span class="nt">/&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="setting-hierarchy-relation">
<h4><a class="toc-backref" href="#id51">9.3.3.3.1. Setting hierarchy relation</a><a class="headerlink" href="#setting-hierarchy-relation" title="Permalink to this headline">¶</a></h4>
<p>Role hierarchy relation is resolved by using implementation class of <code class="docutils literal"><span class="pre">org.springframework.security.access.hierarchicalroles.RoleHierarchy</span></code> interface.</p>
<ul class="simple">
<li>Definition example of spring-security.xml</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;roleHierarchy&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.springframework.security.access.hierarchicalroles.RoleHierarchyImpl&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;hierarchy&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
        <span class="nt">&lt;value&gt;</span>
            ROLE_ADMIN &gt; ROLE_STAFF
            ROLE_STAFF &gt; ROLE_USER
        <span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">org.springframework.security.access.hierarchicalroles.RoleHierarchyImpl</span></code> class.</div>
<div class="line"><code class="docutils literal"><span class="pre">RoleHierarchyImpl</span></code> is a default implementation class offered by Spring Security.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define the hierarchy relation in <code class="docutils literal"><span class="pre">hierarchy</span></code> property.</div>
<div class="line"><br /></div>
<div class="line">Format : [Higher role] &gt; [Lower role]</div>
<div class="line"><br /></div>
<div class="line">In the example above,</div>
<div class="line">STAFF can also access resources authorised by USER.</div>
<div class="line">ADMIN can also access resources authorised by USER and STAFF.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="applying-authorization-process-of-web-resource">
<h4><a class="toc-backref" href="#id52">9.3.3.3.2. Applying authorization process of Web resource</a><a class="headerlink" href="#applying-authorization-process-of-web-resource" title="Permalink to this headline">¶</a></h4>
<p>A method to apply role hierarchy to authorization process for Web resource and JSP screen fields is explained.</p>
<ul>
<li><p class="first">Definition example of spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;webExpressionHandler&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;roleHierarchy&quot;</span> <span class="na">ref=</span><span class="s">&quot;roleHierarchy&quot;</span><span class="nt">/&gt;</span>  <span class="c">&lt;!-- (2) --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;sec:http&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
    <span class="nt">&lt;sec:expression-handler</span> <span class="na">ref=</span><span class="s">&quot;webExpressionHandler&quot;</span> <span class="nt">/&gt;</span>  <span class="c">&lt;!-- (3) --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
</li>
</ul>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Explanation</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define a Bean for <code class="docutils literal"><span class="pre">org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a Bean for implementation class of <code class="docutils literal"><span class="pre">RoleHierarchy</span></code> interface in <code class="docutils literal"><span class="pre">roleHierarchy</span></code> property.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a Bean for implementation class of <code class="docutils literal"><span class="pre">org.springframework.security.access.expression.SecurityExpressionHandler</span></code> interface in <code class="docutils literal"><span class="pre">ref</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:expression-handler&gt;</span></code> tag.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="applying-authorization-process-of-method">
<h4><a class="toc-backref" href="#id53">9.3.3.3.3. Applying authorization process of method</a><a class="headerlink" href="#applying-authorization-process-of-method" title="Permalink to this headline">¶</a></h4>
<p>A method to apply role hierarchy to authorization process for Java method is explained.</p>
<ul class="simple">
<li>Definition example of spring-security.xml</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;methodExpressionHandler&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;roleHierarchy&quot;</span> <span class="na">ref=</span><span class="s">&quot;roleHierarchy&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;sec:global-method-security</span> <span class="na">pre-post-annotations=</span><span class="s">&quot;enabled&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;sec:expression-handler</span> <span class="na">ref=</span><span class="s">&quot;methodExpressionHandler&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
<span class="nt">&lt;/sec:global-method-security&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define a Bean for <code class="docutils literal"><span class="pre">org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a Bean for implementation class of <code class="docutils literal"><span class="pre">RoleHierarchy</span></code> interface in <code class="docutils literal"><span class="pre">roleHierarchy</span></code> property.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a Bean for implementation class of <code class="docutils literal"><span class="pre">org.springframework.security.access.expression.SecurityExpressionHandler</span></code> interface in <code class="docutils literal"><span class="pre">ref</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:expression-handler&gt;</span></code> tag.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="SessionManagement.html" title="9.4. Session Management"
             >next</a> |</li>
        <li class="right" >
          <a href="Authentication.html" title="9.2. Authentication"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.4.1.RELEASE documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >9. Security countermeasures</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
      © Copyright 2013-2018, NTT DATA Corporation. © Copyright 2013-2018, NTT Corporation.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.Theme is <a href="http://github.com/vimalkvn/solar-theme">Solar</a>
    </div>
    
    <script>
    
    $(function() {
    	var $sidebar	= $('.sphinxsidebar'),
    		$window		= $(window),
    		offset		= $sidebar.offset(),
    		topPadding	= 3,
    		$scroll		= $('#scroll');
    	
    	$window.scroll(function() {
    		if ($scroll.is(':checked')) {
				if ($window.scrollTop() > offset.top) {
					$sidebar.stop().animate({
						marginTop:$window.scrollTop() - offset.top + topPadding
					});
				} else {
					$sidebar.stop().animate({
						marginTop:0
					});
				}
			}
		});
    	
    	var $navList = $('ul:first', $sidebar);
    	$('li:first', $navList).addClass('open');
    	
    	$navList.treeview({
    		persist: "location",
    		collapsed: true,
    		unique: false
    	});
    	
	});
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-46550814-1', 'terasolunaorg.github.io');
    ga('send', 'pageview');
    </script>
  </body>
</html>
