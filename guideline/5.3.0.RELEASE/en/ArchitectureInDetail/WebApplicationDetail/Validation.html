<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>4.1. Input Validation &#8212; TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.3.0.RELEASE documentation</title>
    <link rel="stylesheet" href="../../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '5.3.0.RELEASE',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.2. Exception Handling" href="ExceptionHandling.html" />
    <link rel="prev" title="4. Web Application Development Features" href="index.html" /><script async src="https://www.googletagmanager.com/gtag/js?id=G-847V2Q99G8"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date()); gtag('config', 'G-847V2Q99G8');
</script>
<script src="../../_static/jquery.treeview.js" type="text/javascript"></script>
<!-- <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'> -->
<link href="../../_static/solarized-dark.css" rel="stylesheet">
<link href="../../_static/jquery.treeview.css" rel="stylesheet">
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ExceptionHandling.html" title="4.2. Exception Handling"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="4. Web Application Development Features"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.3.0.RELEASE documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">4. Web Application Development Features</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><label><input id="scroll" type="checkbox" checked> scroll sidebar</label>

  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">4.1. Input Validation</a><ul>
<li><a class="reference internal" href="#overview">4.1.1. Overview</a><ul>
<li><a class="reference internal" href="#classification-of-input-validation">4.1.1.1. Classification of input validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use">4.1.2. How to use</a><ul>
<li><a class="reference internal" href="#adding-dependent-libraries">4.1.2.1. Adding dependent libraries</a></li>
<li><a class="reference internal" href="#single-item-check">4.1.2.2. Single item check</a><ul>
<li><a class="reference internal" href="#basic-single-item-check">4.1.2.2.1. Basic single item check</a></li>
<li><a class="reference internal" href="#date-and-time-format-check">4.1.2.2.2. Date and time format check</a></li>
<li><a class="reference internal" href="#single-item-check-of-nested-bean">4.1.2.2.3. Single item check of nested Bean</a></li>
<li><a class="reference internal" href="#grouped-validation">4.1.2.2.4. Grouped validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#correlation-item-check">4.1.2.3. Correlation item check</a><ul>
<li><a class="reference internal" href="#correlation-item-check-implementation-using-spring-validator">4.1.2.3.1. Correlation item check implementation using Spring Validator</a></li>
<li><a class="reference internal" href="#implementation-of-input-check-of-correlated-items-using-bean-validation">4.1.2.3.2. Implementation of input check of correlated items using Bean Validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#definition-of-error-messages">4.1.2.4. Definition of error messages</a><ul>
<li><a class="reference internal" href="#messages-to-be-defined-in-validationmessages-properties">4.1.2.4.1. Messages to be defined in ValidationMessages.properties</a></li>
<li><a class="reference internal" href="#messages-to-be-defined-in-application-messages-properties">4.1.2.4.2. Messages to be defined in application-messages.properties</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-extend">4.1.3. How to extend</a><ul>
<li><a class="reference internal" href="#creation-of-bean-validation-annotation-by-combining-existing-rules">4.1.3.1. Creation of Bean Validation annotation by combining existing rules</a></li>
<li><a class="reference internal" href="#how-to-check-the-values-in-the-collection-using-bean-validation-s-annotation">4.1.3.2. How to check the values in the collection using Bean Validation’s annotation</a><ul>
<li><a class="reference internal" href="#implementation-with-java-se-8-and-hibernate-validator-5-2">4.1.3.2.1. Implementation with Java SE 8 and Hibernate Validator 5.2+</a></li>
<li><a class="reference internal" href="#implementation-of-wrapper-class-of-string-using-java-bean">4.1.3.2.2. Implementation of wrapper class of String using Java bean</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creation-of-bean-validation-annotation-by-implementing-new-rules">4.1.3.3. Creation of Bean Validation annotation by implementing new rules</a><ul>
<li><a class="reference internal" href="#rules-that-cannot-be-implemented-by-combining-the-existing-rules">4.1.3.3.1. Rules that cannot be implemented by combining the existing rules</a></li>
<li><a class="reference internal" href="#check-rules-for-correlated-items">4.1.3.3.2. Check rules for correlated items</a></li>
<li><a class="reference internal" href="#business-logic-check">4.1.3.3.3. Business logic check</a></li>
</ul>
</li>
<li><a class="reference internal" href="#method-validation">4.1.3.4. Method Validation</a><ul>
<li><a class="reference internal" href="#application-settings">4.1.3.4.1. Application settings</a></li>
<li><a class="reference internal" href="#how-to-define-for-the-method-for-method-validation-target">4.1.3.4.2. How to define for the method for Method Validation target</a></li>
<li><a class="reference internal" href="#exception-handling-at-the-time-of-violation-of-constraint">4.1.3.4.3. Exception handling at the time of violation of constraint</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#appendix">4.1.4. Appendix</a><ul>
<li><a class="reference internal" href="#input-validation-rules-provided-by-hibernate-validator">4.1.4.1. Input validation rules provided by Hibernate Validator</a><ul>
<li><a class="reference internal" href="#bean-validation-check-rules">4.1.4.1.1. Bean Validation check rules</a></li>
<li><a class="reference internal" href="#hibernate-validator-check-rules">4.1.4.1.2. Hibernate Validator check rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#default-messages-provided-by-hibernate-validator">4.1.4.2. Default messages provided by Hibernate Validator</a></li>
<li><a class="reference internal" href="#input-check-rules-provided-by-a-common-library">4.1.4.3. Input check rules provided by a common library</a><ul>
<li><a class="reference internal" href="#terasoluna-gfw-common-check-rules">4.1.4.3.1. terasoluna-gfw-common check rules</a></li>
<li><a class="reference internal" href="#terasoluna-gfw-codepoints-check-rules">4.1.4.3.2. terasoluna-gfw-codepoints check rules</a></li>
<li><a class="reference internal" href="#terasoluna-gfw-validator-check-rules">4.1.4.3.3. terasoluna-gfw-validator check rules</a></li>
<li><a class="reference internal" href="#how-to-apply-check-rules-of-common-library">4.1.4.3.4. How to apply check rules of common library</a></li>
<li><a class="reference internal" href="#how-to-extend-check-rules-of-common-library">4.1.4.3.5. How to extend check rules of common library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#type-mismatch">4.1.4.4. Type mismatch</a></li>
<li><a class="reference internal" href="#binding-null-to-blank-string-field">4.1.4.5. Binding null to blank string field</a></li>
<li><a class="reference internal" href="#reading-messages-which-are-not-converted-from-native-to-ascii">4.1.4.6. Reading messages which are not converted from Native to Ascii</a></li>
<li><a class="reference internal" href="#os-command-injection-countermeasures">4.1.4.7. OS Command Injection Countermeasures</a><ul>
<li><a class="reference internal" href="#what-is-os-command-injection">4.1.4.7.1. What is OS command injection -</a></li>
<li><a class="reference internal" href="#countermeasures">4.1.4.7.2. Countermeasures</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">4. Web Application Development Features</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ExceptionHandling.html"
                        title="next chapter">4.2. Exception Handling</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/ArchitectureInDetail/WebApplicationDetail/Validation.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="input-validation">
<h1><a class="toc-backref" href="#id4">4.1. Input Validation</a><a class="headerlink" href="#input-validation" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#input-validation" id="id4">Input Validation</a><ul>
<li><a class="reference internal" href="#overview" id="id5">Overview</a><ul>
<li><a class="reference internal" href="#classification-of-input-validation" id="id6">Classification of input validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use" id="id7">How to use</a><ul>
<li><a class="reference internal" href="#adding-dependent-libraries" id="id8">Adding dependent libraries</a></li>
<li><a class="reference internal" href="#single-item-check" id="id9">Single item check</a><ul>
<li><a class="reference internal" href="#basic-single-item-check" id="id10">Basic single item check</a></li>
<li><a class="reference internal" href="#date-and-time-format-check" id="id11">Date and time format check</a></li>
<li><a class="reference internal" href="#single-item-check-of-nested-bean" id="id12">Single item check of nested Bean</a></li>
<li><a class="reference internal" href="#grouped-validation" id="id13">Grouped validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#correlation-item-check" id="id14">Correlation item check</a><ul>
<li><a class="reference internal" href="#correlation-item-check-implementation-using-spring-validator" id="id15">Correlation item check implementation using Spring Validator</a></li>
<li><a class="reference internal" href="#implementation-of-input-check-of-correlated-items-using-bean-validation" id="id16">Implementation of input check of correlated items using Bean Validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#definition-of-error-messages" id="id17">Definition of error messages</a><ul>
<li><a class="reference internal" href="#messages-to-be-defined-in-validationmessages-properties" id="id18">Messages to be defined in ValidationMessages.properties</a></li>
<li><a class="reference internal" href="#messages-to-be-defined-in-application-messages-properties" id="id19">Messages to be defined in application-messages.properties</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-extend" id="id20">How to extend</a><ul>
<li><a class="reference internal" href="#creation-of-bean-validation-annotation-by-combining-existing-rules" id="id21">Creation of Bean Validation annotation by combining existing rules</a></li>
<li><a class="reference internal" href="#how-to-check-the-values-in-the-collection-using-bean-validation-s-annotation" id="id22">How to check the values in the collection using Bean Validation’s annotation</a><ul>
<li><a class="reference internal" href="#implementation-with-java-se-8-and-hibernate-validator-5-2" id="id23">Implementation with Java SE 8 and Hibernate Validator 5.2+</a></li>
<li><a class="reference internal" href="#implementation-of-wrapper-class-of-string-using-java-bean" id="id24">Implementation of wrapper class of String using Java bean</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creation-of-bean-validation-annotation-by-implementing-new-rules" id="id25">Creation of Bean Validation annotation by implementing new rules</a><ul>
<li><a class="reference internal" href="#rules-that-cannot-be-implemented-by-combining-the-existing-rules" id="id26">Rules that cannot be implemented by combining the existing rules</a></li>
<li><a class="reference internal" href="#check-rules-for-correlated-items" id="id27">Check rules for correlated items</a></li>
<li><a class="reference internal" href="#business-logic-check" id="id28">Business logic check</a></li>
</ul>
</li>
<li><a class="reference internal" href="#method-validation" id="id29">Method Validation</a><ul>
<li><a class="reference internal" href="#application-settings" id="id30">Application settings</a></li>
<li><a class="reference internal" href="#how-to-define-for-the-method-for-method-validation-target" id="id31">How to define for the method for Method Validation target</a></li>
<li><a class="reference internal" href="#exception-handling-at-the-time-of-violation-of-constraint" id="id32">Exception handling at the time of violation of constraint</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#appendix" id="id33">Appendix</a><ul>
<li><a class="reference internal" href="#input-validation-rules-provided-by-hibernate-validator" id="id34">Input validation rules provided by Hibernate Validator</a><ul>
<li><a class="reference internal" href="#bean-validation-check-rules" id="id35">Bean Validation check rules</a></li>
<li><a class="reference internal" href="#hibernate-validator-check-rules" id="id36">Hibernate Validator check rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#default-messages-provided-by-hibernate-validator" id="id37">Default messages provided by Hibernate Validator</a></li>
<li><a class="reference internal" href="#input-check-rules-provided-by-a-common-library" id="id38">Input check rules provided by a common library</a><ul>
<li><a class="reference internal" href="#terasoluna-gfw-common-check-rules" id="id39">terasoluna-gfw-common check rules</a></li>
<li><a class="reference internal" href="#terasoluna-gfw-codepoints-check-rules" id="id40">terasoluna-gfw-codepoints check rules</a></li>
<li><a class="reference internal" href="#terasoluna-gfw-validator-check-rules" id="id41">terasoluna-gfw-validator check rules</a></li>
<li><a class="reference internal" href="#how-to-apply-check-rules-of-common-library" id="id42">How to apply check rules of common library</a></li>
<li><a class="reference internal" href="#how-to-extend-check-rules-of-common-library" id="id43">How to extend check rules of common library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#type-mismatch" id="id44">Type mismatch</a></li>
<li><a class="reference internal" href="#binding-null-to-blank-string-field" id="id45">Binding null to blank string field</a></li>
<li><a class="reference internal" href="#reading-messages-which-are-not-converted-from-native-to-ascii" id="id46">Reading messages which are not converted from Native to Ascii</a></li>
<li><a class="reference internal" href="#os-command-injection-countermeasures" id="id47">OS Command Injection Countermeasures</a><ul>
<li><a class="reference internal" href="#what-is-os-command-injection" id="id48">What is OS command injection -</a></li>
<li><a class="reference internal" href="#countermeasures" id="id49">Countermeasures</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id5">4.1.1. Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>It is mandatory to check whether the value entered by the user is correct.
Validation of input value is broadly classified into</p>
<ol class="arabic simple">
<li>Validation to determine whether the input value is valid by just looking at it irrespective of the context such as size and format.</li>
<li>Validation of whether the changes in input value are valid depending on the system status.</li>
</ol>
<p>1. is an example of mandatory check and number of digits check and 2. is an example of check of whether EMail is registered and
whether order count is within the count of the available stock.</p>
<p>In this section, 1. is explained and this check is called “Input validation”.
2. is called “Business logic check”. For business logic check,
refer to <a class="reference internal" href="../../ImplementationAtEachLayer/DomainLayer.html"><span class="doc">Domain Layer Implementation</span></a>.</p>
<p>In this guideline, validation check should be performed in application layer
whereas business logic check should be performed in domain layer.</p>
<p>Input validation of Web application is performed at server side and client side (JavaScript).
It is mandatory to check at the Server Side. However, if the same check is performed at the client side also,
usability improves since validation results can be analyzed without communicating with the server.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Input validation should be performed at the server side as the process at client side may be altered using JavaScript.
If the validation is performed only at the client side without performing at the server side, the system may be exposed to danger.</p>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Input validation at client side will be explained later. Only input validation at the server side is mentioned in the first version.</p>
</div>
<div class="section" id="classification-of-input-validation">
<h3><a class="toc-backref" href="#id6">4.1.1.1. Classification of input validation</a><a class="headerlink" href="#classification-of-input-validation" title="Permalink to this headline">¶</a></h3>
<p>Input validation is classified into single item check and correlation item check.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="15%" />
<col width="30%" />
<col width="25%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Description</th>
<th class="head">Example</th>
<th class="head">Implementation method</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Single item check</td>
<td><div class="first last line-block">
<div class="line">Check completed in single field</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Input mandatory check</div>
<div class="line">Digit check</div>
<div class="line">Type check</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Bean Validation (Hibernate Validator is used as implementation library)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>Correlation item check</td>
<td><div class="first last line-block">
<div class="line">Check comparing multiple fields</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Password and confirm password check</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Bean Validation or Validation class implementing <a class="reference external" href="http://docs.spring.io/spring/docs/4.3.5.RELEASE/spring-framework-reference/html/validation.html#validator">org.springframework.validation.Validator</a></div>
<div class="line">interface</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Spring supports Bean Validation which is a Java standard.
This Bean Validation is used for single item check.
Bean Validation or <code class="docutils literal"><span class="pre">org.springframework.validation.Validator</span></code> interface provided by Spring is used for correlation item check.</p>
</div>
</div>
<div class="section" id="how-to-use">
<span id="validation-how-to-use"></span><h2><a class="toc-backref" href="#id7">4.1.2. How to use</a><a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h2>
<div class="section" id="adding-dependent-libraries">
<h3><a class="toc-backref" href="#id8">4.1.2.1. Adding dependent libraries</a><a class="headerlink" href="#adding-dependent-libraries" title="Permalink to this headline">¶</a></h3>
<p>When Bean validation 1.1 (Hibernate Validator 5.x) or higher version is to be used,
in addition to jar file of Hibernate Validator and jar file storing API specifications class (<code class="docutils literal"><span class="pre">javax.validation</span></code> package class) of Bean Validation,
libraries that store the following classes are required.</p>
<ul class="simple">
<li>API specifications class of Expression Language 2.2 or higher version (<code class="docutils literal"><span class="pre">javax.el</span></code> package class)</li>
<li>Reference implementation class of Expression Language 2.2 or higher version</li>
</ul>
<p>If the file is run by deploying on application server,
dependent libraries need not be added;
since these libraries are provided by application server.
However, when it is run in standalone environment (JUnit etc.), these libraries need to be added as dependent libraries.</p>
<p>An example of adding libraries which are required when running Bean Validation 1.1 or higher version in standalone environment is given below.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.tomcat.embed<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>tomcat-embed-el<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">Add a library wherein a class for Expression Language is stored,
in <code class="file docutils literal"><span class="pre">pom.xml</span></code> file of the project to be run in standalone environment.</p>
<p class="last">In the above example, libraries provided for Apache Tomcat to be embedded are specified.
API specifications classes of Expression Language and reference implementation classes are both stored in jar file of <code class="docutils literal"><span class="pre">tomcat-embed-el</span></code>.</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>When dependent libraries are required to execute JUnit, an appropriate scope is <code class="docutils literal"><span class="pre">test</span></code>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the above setting example, since it is assumed that the dependent library version is managed by the parent project terasoluna-gfw-parent , specifying the version in pom.xml is not necessary.
The above dependent library used by terasoluna-gfw-parent is defined by <a class="reference external" href="http://platform.spring.io/platform/">Spring IO Platform</a>.</p>
</div>
</div>
<div class="section" id="single-item-check">
<span id="validation-single-check"></span><h3><a class="toc-backref" href="#id9">4.1.2.2. Single item check</a><a class="headerlink" href="#single-item-check" title="Permalink to this headline">¶</a></h3>
<p>For the implementation of single item check following points are necessary,</p>
<ul class="simple">
<li>Bean Validation annotation should be assigned to the field of form class</li>
<li><code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation should be assigned in Controller for validation</li>
<li>Tag for displaying validation error message should be added to JSP</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">&lt;mvc:annotation-driven&gt;</span></code> settings are carried out in spring-mvc.xml, Bean Validation is enabled.</p>
</div>
<div class="section" id="basic-single-item-check">
<span id="validation-basic-validation"></span><h4><a class="toc-backref" href="#id10">4.1.2.2.1. Basic single item check</a><a class="headerlink" href="#basic-single-item-check" title="Permalink to this headline">¶</a></h4>
<p>Implementation method is explained using “New user registration” process as an example. Rules for checking “New user registration” form are provided below.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field name</th>
<th class="head">Type</th>
<th class="head">Rules</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">name</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">20 characters</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">email</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">50 characters</div>
<div class="line">Email format</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">age</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.Integer</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">200</div>
</div>
</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Form class</p>
<p>Assign Bean Validation annotation to each field of form class.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.Max</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Min</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.hibernate.validator.constraints.Email</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

  <span class="nd">@NotNull</span> <span class="c1">// (1)</span>
  <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="c1">// (2)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>

  <span class="nd">@NotNull</span>
  <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
  <span class="nd">@Email</span> <span class="c1">// (3)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="p">;</span>

  <span class="nd">@NotNull</span> <span class="c1">// (4)</span>
  <span class="nd">@Min</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">// (5)</span>
  <span class="nd">@Max</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span> <span class="c1">// (6)</span>
  <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="p">;</span>

  <span class="c1">// omitted setter/getter</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">javax.validation.constraints.NotNull</span></code> indicating that the target field is not <code class="docutils literal"><span class="pre">null</span></code>.</div>
<div class="line"><br /></div>
<div class="line">In Spring MVC, when form is sent with input fields left blank,</div>
<div class="line"><strong>empty string instead of null binds</strong>to form object by default.</div>
<div class="line">This <code class="docutils literal"><span class="pre">&#64;NotNull</span></code> checks that <code class="docutils literal"><span class="pre">name</span></code> exists as request parameter.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">javax.validation.constraints.Size</span></code> indicating that the string length (or collection size) of the target field is within the specified size range.</div>
<div class="line"><br /></div>
<div class="line">Since empty string binds to the field where string is left blank by default in Spring MVC,</div>
<div class="line">‘1 or more character’ rule indicates Mandatory input.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">org.hibernate.validator.constraints.Email</span></code> indicating that the target field is in RFC2822-compliant E-mail format.</div>
<div class="line">When E-mail format requirements are flexible than RFC2822-compliant constraints, regular expression should be specified using  <code class="docutils literal"><span class="pre">javax.validation.constraints.Pattern</span></code> instead of <code class="docutils literal"><span class="pre">&#64;Email</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When form is sent without entering any number in input field, <code class="docutils literal"><span class="pre">null</span></code> binds to form object so <code class="docutils literal"><span class="pre">&#64;NotNull</span></code> indicates mandatory input of <code class="docutils literal"><span class="pre">age</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">javax.validation.constraints.Min</span></code> indicating that the target field value must be greater than the specified value.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">javax.validation.constraints.Max</span></code> indicating that the target field value must be less than the specified value.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Refer to <a class="reference internal" href="#validation-jsr303-doc"><span class="std std-ref">Bean Validation check rules</span></a> and <a class="reference internal" href="#validation-validator-list"><span class="std std-ref">Hibernate Validator check rules</span></a> for standard annotations of Bean Validation and annotations provided by Hibernate.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Refer to <a class="reference internal" href="#validation-string-trimmer-editor"><span class="std std-ref">Binding null to blank string field</span></a> for the method of binding <code class="docutils literal"><span class="pre">null</span></code> when input field is left blank.</p>
</div>
</li>
<li><p class="first">Controller class</p>
<p>Assign <code class="docutils literal"><span class="pre">&#64;Validated</span></code> to form class for input validation.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="p">{</span>

  <span class="nd">@ModelAttribute</span>
  <span class="kd">public</span> <span class="n">UserForm</span> <span class="nf">setupForm</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">UserForm</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="p">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">createForm</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="p">;</span> <span class="c1">// (1)</span>
  <span class="p">}</span>

  <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span><span class="p">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirm</span><span class="p">(</span><span class="nd">@Validated</span> <span class="cm">/* (2) */</span> <span class="n">UserForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="cm">/* (3) */</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">hasErrors</span><span class="p">())</span> <span class="p">{</span> <span class="c1">// (4)</span>
      <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="s">&quot;user/createConfirm&quot;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">create</span><span class="p">(</span><span class="nd">@Validated</span> <span class="n">UserForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// (5)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">hasErrors</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// omitted business logic</span>
    <span class="k">return</span> <span class="s">&quot;redirect:/user/create?complete&quot;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;complete&quot;</span><span class="p">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">createComplete</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s">&quot;user/createComplete&quot;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Display “New user registration” form screen.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">org.springframework.validation.annotation.Validated</span></code> to the form class argument to perform input validation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add <code class="docutils literal"><span class="pre">org.springframework.validation.BindingResult</span></code> that stores check result of input validation performed in step (2).</div>
<div class="line">This <code class="docutils literal"><span class="pre">BindingResult</span></code> must be specified immediately after the form argument.</div>
<div class="line"><br /></div>
<div class="line">When not specified immediately, <code class="docutils literal"><span class="pre">org.springframework.validation.BindException</span></code> is thrown.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Use <code class="docutils literal"><span class="pre">BindingResult.hasErrors()</span></code> method to determine the check result of step (2).</div>
<div class="line">When the result of  <code class="docutils literal"><span class="pre">hasErrors()</span></code> is <code class="docutils literal"><span class="pre">true</span></code>, return to form display screen as there is an error in input value.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><strong>Input validation should be executed again</strong>even at the time of submission on the confirmation screen.</div>
<div class="line">There is a possibility of data tempering and hence Input validation must be performed just before entering business logic.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">&#64;Validated</span></code> is not a standard Bean Validation annotation. It is an independent annotation provided by Spring.
Bean Validation standard <code class="docutils literal"><span class="pre">javax.validation.Valid</span></code> annotation can also be used. However, <code class="docutils literal"><span class="pre">&#64;Validated</span></code> is better as compared to <code class="docutils literal"><span class="pre">&#64;Valid</span></code> annotation.
Validation group can be specified in case of <code class="docutils literal"><span class="pre">&#64;Validated</span></code> and hence <code class="docutils literal"><span class="pre">&#64;Validated</span></code> is recommended in this guideline.</p>
</div>
</li>
</ul>
<ul class="simple" id="validation-jsp-impl-sample">
<li>JSP</li>
</ul>
<blockquote>
<div><p>When there is input error, it can be displayed in <code class="docutils literal"><span class="pre">&lt;form:errors&gt;</span></code> tag.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="k">&lt;%-</span><span class="o">-</span> <span class="n">WEB</span><span class="o">-</span><span class="n">INF</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">createForm</span><span class="p">.</span><span class="na">jsp</span> <span class="o">--</span><span class="k">%&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;userForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
        <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/user/create&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;</span><span class="k">&lt;%-</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">--</span><span class="k">%&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span><span class="nt">&gt;</span>Email:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span><span class="nt">&gt;</span>Age:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
    <span class="nt">&lt;/form:form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify target field name in <code class="docutils literal"><span class="pre">path</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;form:errors&gt;</span></code> tag.</div>
<div class="line">Error message is displayed next to input field of each field.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>Form is displayed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-first-sample1.png"><img alt="../../_images/validations-first-sample1.png" src="../../_images/validations-first-sample1.png" style="width: 60%;" /></a>
</div>
<p>Error message is displayed as follows if this form is sent with all the input fields left blank.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-first-sample2.png"><img alt="../../_images/validations-first-sample2.png" src="../../_images/validations-first-sample2.png" style="width: 60%;" /></a>
</div>
<p>Error messages state that Name and Email are blank and Age is <code class="docutils literal"><span class="pre">null</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In Bean Validation, <code class="docutils literal"><span class="pre">null</span></code> is a valid input value except the following annotations.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">javax.validation.constraints.NotNull</span></code></li>
<li><code class="docutils literal"><span class="pre">org.hibernate.validator.constraints.NotEmpty</span></code></li>
<li><code class="docutils literal"><span class="pre">org.hibernate.validator.constraints.NotBlank</span></code></li>
</ul>
<p class="last">In the above example, error messages related to <code class="docutils literal"><span class="pre">&#64;Min</span></code> and <code class="docutils literal"><span class="pre">&#64;Max</span></code> annotations are not displayed. This is because <code class="docutils literal"><span class="pre">null</span></code> is a valid value for <code class="docutils literal"><span class="pre">&#64;Min</span></code> and <code class="docutils literal"><span class="pre">&#64;Max</span></code> annotations.</p>
</div>
<p>Next, send the form by entering any value in the field.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-first-sample3.png"><img alt="../../_images/validations-first-sample3.png" src="../../_images/validations-first-sample3.png" style="width: 60%;" /></a>
</div>
<div class="line-block">
<div class="line">Error message is not displayed since input value of Name fulfills validation conditions.</div>
<div class="line">Error message is displayed since input value of Email is not in Email format though it fulfills the conditions related to string length.</div>
<div class="line">Error message is displayed since input value of Age exceeds maximum value.</div>
</div>
<p>Change the form as follows to change the style at the time of error.</p>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;userForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
    <span class="na">class=</span><span class="s">&quot;form-horizontal&quot;</span>
    <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/user/create&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">--</span><span class="k">%&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">--</span><span class="k">%&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">--</span><span class="k">%&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Email:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Age:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
<span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify class name for <code class="docutils literal"><span class="pre">&lt;label&gt;</span></code> tag in <code class="docutils literal"><span class="pre">cssErrorClass</span></code> attribute at the time of error.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify class name for <code class="docutils literal"><span class="pre">&lt;input&gt;</span></code> tag in <code class="docutils literal"><span class="pre">cssErrorClass</span></code> attribute at the time of error.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify class name for  error messages in <code class="docutils literal"><span class="pre">cssClass</span></code> attribute.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>For example, if the following CSS is applied to this JSP, error screen is displayed as follows.</p>
<div class="highlight-css"><div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">form-horizontal</span> <span class="nt">input</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="kc">block</span><span class="p">;</span>
    <span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">form-horizontal</span> <span class="nt">label</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="kc">block</span><span class="p">;</span>
    <span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
    <span class="k">text-align</span><span class="p">:</span> <span class="kc">right</span><span class="p">;</span>
    <span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">form-horizontal</span> <span class="nt">br</span> <span class="p">{</span>
    <span class="k">clear</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">error-label</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#b94a48</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">error-input</span> <span class="p">{</span>
    <span class="k">border-color</span><span class="p">:</span> <span class="mh">#b94a48</span><span class="p">;</span>
    <span class="k">margin-left</span><span class="p">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">error-messages</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#b94a48</span><span class="p">;</span>
    <span class="k">display</span><span class="p">:</span> <span class="kc">block</span><span class="p">;</span>
    <span class="k">padding-left</span><span class="p">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">overflow-x</span><span class="p">:</span> <span class="kc">auto</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-has-errors1.png"><img alt="../../_images/validations-has-errors1.png" src="../../_images/validations-has-errors1.png" style="width: 60%;" /></a>
</div>
<p>CSS can be customized as per the requirements of screen.</p>
<p>Instead of displaying the error messages next to each input field,
output them collectively.</p>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;userForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
    <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/user/create&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;*&quot;</span> <span class="na">element=</span><span class="s">&quot;div&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-message-list&quot;</span> <span class="nt">/&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">--</span><span class="k">%&gt;</span>

    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Email:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Age:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
<span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">By specifying <code class="docutils literal"><span class="pre">*</span></code> in <code class="docutils literal"><span class="pre">path</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;form:errors&gt;</span></code> in <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> tag,</div>
<div class="line">all error messages related to Model specified in <code class="docutils literal"><span class="pre">modelAttribute</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> can be output.</div>
<div class="line">Tag name including these error messages can be specified in <code class="docutils literal"><span class="pre">element</span></code> attribute. By default, it is <code class="docutils literal"><span class="pre">span</span></code>. However,</div>
<div class="line">specify <code class="docutils literal"><span class="pre">div</span></code> to output error message list as block element.</div>
<div class="line">Specify CSS class in <code class="docutils literal"><span class="pre">cssClass</span></code> attribute.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>An example of error message is shown when the following CSS class is applied.</p>
<div class="highlight-css"><div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">form-horizontal</span> <span class="nt">input</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="kc">block</span><span class="p">;</span>
    <span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">form-horizontal</span> <span class="nt">label</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="kc">block</span><span class="p">;</span>
    <span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
    <span class="k">text-align</span><span class="p">:</span> <span class="kc">right</span><span class="p">;</span>
    <span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">form-horizontal</span> <span class="nt">br</span> <span class="p">{</span>
    <span class="k">clear</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">error-label</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#b94a48</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">error-input</span> <span class="p">{</span>
    <span class="k">border-color</span><span class="p">:</span> <span class="mh">#b94a48</span><span class="p">;</span>
    <span class="k">margin-left</span><span class="p">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">error-message-list</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#b94a48</span><span class="p">;</span>
    <span class="k">padding</span><span class="p">:</span><span class="mi">5</span><span class="kt">px</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">background-color</span><span class="p">:</span> <span class="mh">#fde9f3</span><span class="p">;</span>
    <span class="k">border</span><span class="p">:</span><span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="mh">#c98186</span><span class="p">;</span>
    <span class="k">border-radius</span><span class="p">:</span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">margin-bottom</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-has-errors2.png"><img alt="../../_images/validations-has-errors2.png" src="../../_images/validations-has-errors2.png" style="width: 60%;" /></a>
</div>
<div class="line-block">
<div class="line">By default, field name is not included in error message, hence it is difficult to understand which error message corresponds to which field.</div>
<div class="line">Therefore, when an error message is to be displayed in a list, it is necessary to define the message such that field name is included in the error message.</div>
<div class="line">For method of defining error messages, refer to “<a class="reference internal" href="#validation-message-def"><span class="std std-ref">Definition of error messages</span></a>”.</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Points to be noted when displaying error messages in a list</strong></p>
<p>Error messages are output in a random order and the output order cannot be controlled by standard function.
Therefore, when an output order needs to be controlled (to be kept constant), an extended implementation such as sorting the error information, etc. is required.</p>
<p>In the method of “Displaying error messages in a list”,</p>
<ul class="simple">
<li>Error message definition in feed unit</li>
<li>Extended implementation to control the output order of error messages</li>
</ul>
<p>are required. Therefore, the cost is higher as compared to “displaying error messages next to input field”.
<strong>This guideline recommends the method of “displaying error messages next to input field” when there are no constraints due to screen requirements.</strong></p>
<p class="last">Further, following method can be considered as extended methods to control output order of error message.
Creating inherited class of <code class="docutils literal"><span class="pre">org.springframework.validation.beanvalidation.LocalValidatorFactoryBean</span></code> provided by Spring Framework,
and sorting error information by overriding <code class="docutils literal"><span class="pre">processConstraintViolations</span></code> method, etc.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>About &#64;GroupSequence annotation</strong></p>
<p>A mechanism of <a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.2/reference/en-US/html/ch05.html#section-default-group-class">&#64;GroupSequence annotation</a> is provided to control the check sequence;
however, add a note that this mechanism is not to control the output order of error message as operations given below are performed.</p>
<ul class="last simple">
<li>When an error occurs, checking for subsequent groups is not executed.</li>
<li>If multiple errors (errors in multiple fields) occur in the check of identical groups, then the output order of error messages would be random.</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Use <code class="docutils literal"><span class="pre">&lt;spring:nestedPath&gt;</span></code> tag to display error messages collectively outside the <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> tag.</p>
<blockquote class="last">
<div><div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="hll"><span class="nt">&lt;spring:nestedPath</span> <span class="na">path=</span><span class="s">&quot;userForm&quot;</span><span class="nt">&gt;</span>
</span>    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;*&quot;</span> <span class="na">element=</span><span class="s">&quot;div&quot;</span>
        <span class="na">cssClass=</span><span class="s">&quot;error-message-list&quot;</span> <span class="nt">/&gt;</span>
<span class="hll"><span class="nt">&lt;/spring:nestedPath&gt;</span>
</span><span class="nt">&lt;hr&gt;</span>
<span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;userForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
    <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/user/create&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Email:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Age:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
<span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="date-and-time-format-check">
<h4><a class="toc-backref" href="#id11">4.1.2.2.2. Date and time format check</a><a class="headerlink" href="#date-and-time-format-check" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">In case of performing the date and time format check, it is recommend the use of <code class="docutils literal"><span class="pre">&#64;DateTimeFormat</span></code> annotation offered by Spring rather than the use of Bean Validation mechanism.</div>
<div class="line">About how to use the <code class="docutils literal"><span class="pre">&#64;DateTimeFormat</span></code> annotation, refer <a class="reference internal" href="../../ImplementationAtEachLayer/ApplicationLayer.html#applicationlayer-datetimeformat"><span class="std std-ref">Date and time format conversion of fields</span></a>.</div>
<div class="line">It is also possible to check the date and time format using <code class="docutils literal"><span class="pre">&#64;Pattern</span></code> annotation of the Bean Validation.</div>
<div class="line">However, it is necessary to write the date and time format in regular expressions while using <code class="docutils literal"><span class="pre">&#64;Pattern</span></code> annotation. If you want to check the date and time that does not exist, the description is complicated.</div>
<div class="line">Therefore <code class="docutils literal"><span class="pre">&#64;DateTimeFormat</span></code> annotation is more simpler than the <code class="docutils literal"><span class="pre">&#64;Pattern</span></code> annotation.</div>
</div>
<div class="line-block">
<div class="line">Since <code class="docutils literal"><span class="pre">&#64;DateTimeFormat</span></code> annotation is one of the type conversion mechanism provided by Spring, instead of the error messages of Bean Validation, the error message of the type mismatch exception (<code class="docutils literal"><span class="pre">TypeMismatchException</span></code>) has been displayed on screen at the time of input error.</div>
<div class="line">In order to avoid the actual exception message gets displayed on the screen, it is necessary to configure the error message in the <strong>property file</strong> which will be displayed at the time of type mismatch is occurred.</div>
<div class="line">For more detail, refer <a class="reference internal" href="#validation-type-mismatch"><span class="std std-ref">Type mismatch</span></a>.</div>
</div>
</div>
<div class="section" id="single-item-check-of-nested-bean">
<h4><a class="toc-backref" href="#id12">4.1.2.2.3. Single item check of nested Bean</a><a class="headerlink" href="#single-item-check-of-nested-bean" title="Permalink to this headline">¶</a></h4>
<p>The method to validate nested Bean using Bean Validation is explained below.</p>
<p>“Ordering” process of an EC site is considered as an example. Rules for checking “Order” form are provided below.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="30%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field name</th>
<th class="head">Type</th>
<th class="head">Rules</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">coupon</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">5 or less characters</div>
<div class="line">Single byte alphanumeric characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Coupon code</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">receiverAddress.name</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">50 characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Receiver name</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">receiverAddress.postcode</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">10 characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Receiver postal code</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">receiverAddress.address</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">100 characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Receiver address</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">senderAddress.name</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">50 characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Sender name</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">senderAddress.postcode</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">10 characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Sender postal code</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">senderAddress.address</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">100 characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Sender address</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Use the same form class since <code class="docutils literal"><span class="pre">receiverAddress</span></code> and <code class="docutils literal"><span class="pre">senderAddress</span></code> are objects of the same class.</p>
<ul>
<li><p class="first">Form class</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.Valid</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Pattern</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="nd">@Size</span><span class="p">(</span><span class="n">max</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
    <span class="nd">@Pattern</span><span class="p">(</span><span class="n">regexp</span> <span class="o">=</span> <span class="s">&quot;[a-zA-Z0-9]*&quot;</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">coupon</span><span class="p">;</span>

    <span class="nd">@NotNull</span> <span class="c1">// (1)</span>
    <span class="nd">@Valid</span> <span class="c1">// (2)</span>
    <span class="kd">private</span> <span class="n">AddressForm</span> <span class="n">receiverAddress</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Valid</span>
    <span class="kd">private</span> <span class="n">AddressForm</span> <span class="n">senderAddress</span><span class="p">;</span>

    <span class="c1">// omitted setter/getter</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AddressForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">postcode</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">address</span><span class="p">;</span>

    <span class="c1">// omitted setter/getter</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">This indicates that the child form is mandatory.</div>
<div class="line">When not set, it will be considered as valid even if <code class="docutils literal"><span class="pre">null</span></code> is set in <code class="docutils literal"><span class="pre">receiverAddress</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">javax.validation.Valid</span></code> annotation to enable Bean Validation of the nested Bean.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Controller class</p>
<p>It is not different from the Controller described earlier.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>

<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;order&quot;</span><span class="p">)</span>
<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderController</span> <span class="p">{</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">OrderForm</span> <span class="nf">setupForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">OrderForm</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;order&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">orderForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;order/orderForm&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;order&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">orderConfirm</span><span class="p">(</span><span class="nd">@Validated</span> <span class="n">OrderForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">hasErrors</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;order/orderForm&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="s">&quot;order/orderConfirm&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">JSP</p>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="k">&lt;%-</span><span class="o">-</span> <span class="n">WEB</span><span class="o">-</span><span class="n">INF</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">order</span><span class="o">/</span><span class="n">orderForm</span><span class="p">.</span><span class="na">jsp</span> <span class="o">--</span><span class="k">%&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;style</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">&gt;</span>
  /* omitted (same as previous sample) */
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;orderForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
        <span class="na">class=</span><span class="s">&quot;form-horizontal&quot;</span>
        <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/order/order&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;coupon&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Coupon Code:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;coupon&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;coupon&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;fieldset&gt;</span>
        <span class="nt">&lt;legend&gt;</span>Receiver<span class="nt">&lt;/legend&gt;</span>
        <span class="k">&lt;%-</span><span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">--</span><span class="k">%&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;receiverAddress&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="k">&lt;%-</span><span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">--</span><span class="k">%&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.name&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.name&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.name&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.postcode&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Postcode:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.postcode&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.postcode&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.address&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Address:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.address&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.address&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/fieldset&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;fieldset&gt;</span>
        <span class="nt">&lt;legend&gt;</span>Sender<span class="nt">&lt;/legend&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;senderAddress&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;senderAddress.name&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;senderAddress.name&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;senderAddress.name&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;senderAddress.postcode&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Postcode:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;senderAddress.postcode&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;senderAddress.postcode&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;senderAddress.address&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Address:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;senderAddress.address&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;senderAddress.address&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/fieldset&gt;</span>

        <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
    <span class="nt">&lt;/form:form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When <code class="docutils literal"><span class="pre">receiverAddress.name</span></code>, <code class="docutils literal"><span class="pre">receiverAddress.postcode</span></code>, <code class="docutils literal"><span class="pre">receiverAddress.address</span></code> are not sent as</div>
<div class="line">request parameters due to invalid operation, <code class="docutils literal"><span class="pre">receiverAddress</span></code> is considered as <code class="docutils literal"><span class="pre">null</span></code> and error message is displayed.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Fields of nested bean are specified as <code class="docutils literal"><span class="pre">[parent</span> <span class="pre">field</span> <span class="pre">name].[child</span> <span class="pre">field</span> <span class="pre">name]</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>Form is displayed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-nested1.png"><img alt="../../_images/validations-nested1.png" src="../../_images/validations-nested1.png" style="width: 60%;" /></a>
</div>
<p>Error message is displayed as follows if this form is sent with all the input fields left blank.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-nested2.png"><img alt="../../_images/validations-nested2.png" src="../../_images/validations-nested2.png" style="width: 60%;" /></a>
</div>
<p>Validation of nested bean is enabled for collections also.</p>
<p>Add a field such that up to 3 addresses can be registered in “user registration” form explained at the beginning.</p>
<ul>
<li><p class="first">Add list of <code class="docutils literal"><span class="pre">AddressForm</span></code> as a field in the form class.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.Valid</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Max</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Min</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.hibernate.validator.constraints.Email</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nd">@Email</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Min</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="nd">@Max</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="p">;</span>

<span class="hll">    <span class="nd">@NotNull</span>
</span><span class="hll">    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">// (1)</span>
</span><span class="hll">    <span class="nd">@Valid</span>
</span><span class="hll">    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">AddressForm</span><span class="o">&gt;</span> <span class="n">addresses</span><span class="p">;</span>
</span>
    <span class="c1">// omitted setter/getter</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is possible to use <code class="docutils literal"><span class="pre">&#64;Size</span></code> annotation for checking size of collection as well.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">JSP</p>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="k">&lt;%-</span><span class="o">-</span> <span class="n">WEB</span><span class="o">-</span><span class="n">INF</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">createForm</span><span class="p">.</span><span class="na">jsp</span> <span class="o">--</span><span class="k">%&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;style</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">&gt;</span>
  /* omitted (same as previous sample) */
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>

    <span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;userForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
        <span class="na">class=</span><span class="s">&quot;form-horizontal&quot;</span>
        <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/user/create&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Email:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Age:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
<span class="hll">        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;addresses&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">        <span class="nt">&lt;c:forEach</span> <span class="na">items=</span><span class="s">&quot;${userForm.addresses}&quot;</span> <span class="na">varStatus=</span><span class="s">&quot;status&quot;</span><span class="nt">&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">            <span class="nt">&lt;fieldset</span> <span class="na">class=</span><span class="s">&quot;address&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;legend&gt;</span>Address${f:h(status.index + 1)}<span class="nt">&lt;/legend&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].name&quot;</span>
</span><span class="hll">                    <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].name&quot;</span>
</span><span class="hll">                    <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].name&quot;</span>
</span><span class="hll">                    <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;br&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].postcode&quot;</span>
</span><span class="hll">                    <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Postcode:<span class="nt">&lt;/form:label&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].postcode&quot;</span>
</span><span class="hll">                    <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].postcode&quot;</span>
</span><span class="hll">                    <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;br&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].address&quot;</span>
</span><span class="hll">                    <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Address:<span class="nt">&lt;/form:label&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].address&quot;</span>
</span><span class="hll">                    <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].address&quot;</span>
</span><span class="hll">                    <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;c:if</span> <span class="na">test=</span><span class="s">&quot;${status.index &gt; 0}&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;br&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">&quot;remove-address-button&quot;</span><span class="nt">&gt;</span>Remove<span class="nt">&lt;/button&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/c:if&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/fieldset&gt;</span>
</span><span class="hll">            <span class="nt">&lt;br&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/c:forEach&gt;</span>
</span><span class="hll">        <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">&quot;add-address-button&quot;</span><span class="nt">&gt;</span>Add address<span class="nt">&lt;/button&gt;</span>
</span><span class="hll">        <span class="nt">&lt;br&gt;</span>
</span>        <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
    <span class="nt">&lt;/form:form&gt;</span>
    <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span>
        <span class="na">src=</span><span class="s">&quot;${pageContext.request.contextPath}/resources/vendor/js/jquery-1.10.2.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span>
        <span class="na">src=</span><span class="s">&quot;${pageContext.request.contextPath}/resources/app/js/AddressesView.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Display error message related to <code class="docutils literal"><span class="pre">address</span></code> field.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Process the collection of child forms in a loop using <code class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></code> tag.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inside the loop, Specify the field of child form using <code class="docutils literal"><span class="pre">[parent</span> <span class="pre">field</span> <span class="pre">name][Index].[child</span> <span class="pre">field</span> <span class="pre">name]</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Controller class</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="p">{</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">UserForm</span> <span class="nf">setupForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">UserForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UserForm</span><span class="p">();</span>
<span class="hll">        <span class="n">List</span><span class="o">&lt;</span><span class="n">AddressForm</span><span class="o">&gt;</span> <span class="n">addresses</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">AddressForm</span><span class="o">&gt;</span><span class="p">();</span>
</span><span class="hll">        <span class="n">addresses</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span> <span class="n">AddressForm</span><span class="p">());</span>
</span><span class="hll">        <span class="n">form</span><span class="p">.</span><span class="na">setAddresses</span><span class="p">(</span><span class="n">addresses</span><span class="p">);</span> <span class="c1">// (1)</span>
</span>        <span class="k">return</span> <span class="n">form</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirm</span><span class="p">(</span><span class="nd">@Validated</span> <span class="n">UserForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">hasErrors</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="s">&quot;user/createConfirm&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Edit the form object to display a single address form at the time of initial display of “user registration” form.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">JavaScript</p>
<p>Below is the JavaScript to dynamically add address input field. However, the explanation of this code is omitted as it is not required.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// webapp/resources/app/js/AddressesView.js</span>

<span class="kd">function</span> <span class="nx">AddressesView</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">addressSize</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;fieldset.address&#39;</span><span class="p">).</span><span class="nx">size</span><span class="p">();</span>
<span class="p">};</span>

<span class="nx">AddressesView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">addAddress</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">$address</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;fieldset.address&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">newHtml</span> <span class="o">=</span> <span class="nx">addressTemplate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">addressSize</span><span class="o">++</span><span class="p">);</span>
  <span class="nx">$address</span><span class="p">.</span><span class="nx">last</span><span class="p">().</span><span class="nx">next</span><span class="p">().</span><span class="nx">after</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">newHtml</span><span class="p">));</span>
<span class="p">};</span>

<span class="nx">AddressesView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">removeAddress</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$fieldset</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$fieldset</span><span class="p">.</span><span class="nx">next</span><span class="p">().</span><span class="nx">remove</span><span class="p">();</span> <span class="c1">// remove &lt;br&gt;</span>
  <span class="nx">$fieldset</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span> <span class="c1">// remove &lt;fieldset&gt;</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">addressTemplate</span><span class="p">(</span><span class="nx">number</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s1">&#39;\</span>
<span class="s1">&lt;fieldset class=&quot;address&quot;&gt;\</span>
<span class="s1">    &lt;legend&gt;Address&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/legend&gt;\</span>
<span class="s1">    &lt;label for=&quot;addresses&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;.name&quot;&gt;Name:&lt;/label&gt;\</span>
<span class="s1">    &lt;input id=&quot;addresses&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;.name&quot; name=&quot;addresses[&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;].name&quot; type=&quot;text&quot; value=&quot;&quot;/&gt;&lt;br&gt;\</span>
<span class="s1">    &lt;label for=&quot;addresses&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;.postcode&quot;&gt;Postcode:&lt;/label&gt;\</span>
<span class="s1">    &lt;input id=&quot;addresses&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;.postcode&quot; name=&quot;addresses[&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;].postcode&quot; type=&quot;text&quot; value=&quot;&quot;/&gt;&lt;br&gt;\</span>
<span class="s1">    &lt;label for=&quot;addresses&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;.address&quot;&gt;Address:&lt;/label&gt;\</span>
<span class="s1">    &lt;input id=&quot;addresses&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;.address&quot; name=&quot;addresses[&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;].address&quot; type=&quot;text&quot; value=&quot;&quot;/&gt;&lt;br&gt;\</span>
<span class="s1">    &lt;button class=&quot;remove-address-button&quot;&gt;Remove&lt;/button&gt;\</span>
<span class="s1">&lt;/fieldset&gt;\</span>
<span class="s1">&lt;br&gt;\</span>
<span class="s1">&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">addressesView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AddressesView</span><span class="p">();</span>

  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#add-address-button&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="nx">addressesView</span><span class="p">.</span><span class="nx">addAddress</span><span class="p">();</span>
  <span class="p">});</span>

  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;.remove-address-button&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="o">===</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
      <span class="kd">var</span> <span class="nx">$this</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// this button</span>
      <span class="kd">var</span> <span class="nx">$fieldset</span> <span class="o">=</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">parent</span><span class="p">();</span> <span class="c1">// fieldset</span>
      <span class="nx">addressesView</span><span class="p">.</span><span class="nx">removeAddress</span><span class="p">(</span><span class="nx">$fieldset</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>

<span class="p">});</span>
</pre></div>
</div>
</li>
</ul>
<p>Form is displayed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-nested-collection1.png"><img alt="../../_images/validations-nested-collection1.png" src="../../_images/validations-nested-collection1.png" style="width: 60%;" /></a>
</div>
<p>Add 2 address forms by clicking “Add address” button twice.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-nested-collection2.png"><img alt="../../_images/validations-nested-collection2.png" src="../../_images/validations-nested-collection2.png" style="width: 60%;" /></a>
</div>
<p>Error message is displayed as follows if this form is sent with all the input fields left blank.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-nested-collection3.png"><img alt="../../_images/validations-nested-collection3.png" src="../../_images/validations-nested-collection3.png" style="width: 60%;" /></a>
</div>
</div>
<div class="section" id="grouped-validation">
<span id="validationgroupvalidation"></span><h4><a class="toc-backref" href="#id13">4.1.2.2.4. Grouped validation</a><a class="headerlink" href="#grouped-validation" title="Permalink to this headline">¶</a></h4>
<p>By creating validation group, input validation rules for a field can be specified for each group.</p>
<p>In the “new user registration” example, add “Must be an adult” rule for the <code class="docutils literal"><span class="pre">age</span></code> field.
Add <code class="docutils literal"><span class="pre">country</span></code> field also as “Adult” rules differ with country.</p>
<p>To specify group in Bean Validation, set any <code class="docutils literal"><span class="pre">java.lang.Class</span></code> object representing a group in <code class="docutils literal"><span class="pre">group</span></code> attribute of the annotation.</p>
<p>Create the following 3 groups (interface) here.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Group</th>
<th class="head">Adult condition</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">Chinese</span></code></td>
<td>18 years or more</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">Japanese</span></code></td>
<td>20 years or more</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">Singaporean</span></code></td>
<td>21 years or more</td>
</tr>
</tbody>
</table>
<p>An example of executing validation using these groups is shown here.</p>
<ul>
<li><p class="first">Form class</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.Valid</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Max</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Min</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.hibernate.validator.constraints.Email</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

<span class="hll">    <span class="c1">// (1)</span>
</span><span class="hll">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Chinese</span> <span class="p">{</span>
</span><span class="hll">    <span class="p">};</span>
</span><span class="hll">
</span><span class="hll">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Japanese</span> <span class="p">{</span>
</span><span class="hll">    <span class="p">};</span>
</span><span class="hll">
</span><span class="hll">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Singaporean</span> <span class="p">{</span>
</span><span class="hll">    <span class="p">};</span>
</span>
    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nd">@Email</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
<span class="hll">    <span class="nd">@Min.List</span><span class="p">({</span> <span class="c1">// (2)</span>
</span><span class="hll">            <span class="nd">@Min</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">Chinese</span><span class="p">.</span><span class="na">class</span><span class="p">),</span> <span class="c1">// (3)</span>
</span><span class="hll">            <span class="nd">@Min</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">Japanese</span><span class="p">.</span><span class="na">class</span><span class="p">),</span>
</span><span class="hll">            <span class="nd">@Min</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">Singaporean</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
</span><span class="hll">            <span class="p">})</span>
</span>    <span class="nd">@Max</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">country</span><span class="p">;</span> <span class="c1">// (4)</span>

    <span class="c1">// omitted setter/getter</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define each group as an interface.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&#64;Min.List</span></code> annotation is used to specify multiple <code class="docutils literal"><span class="pre">&#64;Min</span></code> rules on a single field.</div>
<div class="line">It is same even while using other annotations.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify corresponding group class in the <code class="docutils literal"><span class="pre">group</span></code> attribute, in order to define rules for each group.</div>
<div class="line">When <code class="docutils literal"><span class="pre">group</span></code> attribute is not specified, <code class="docutils literal"><span class="pre">javax.validation.groups.Default</span></code> group is used.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add a field which will be used to determine which group is to be applied.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">JSP</p>
<p>There are no major changes in JSP.</p>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;userForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
    <span class="na">class=</span><span class="s">&quot;form-horizontal&quot;</span>
    <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/user/create&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Email:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Age:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
<span class="hll">    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;country&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Country:<span class="nt">&lt;/form:label&gt;</span>
</span><span class="hll">    <span class="nt">&lt;form:select</span> <span class="na">path=</span><span class="s">&quot;country&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">        <span class="nt">&lt;form:option</span> <span class="na">value=</span><span class="s">&quot;cn&quot;</span><span class="nt">&gt;</span>China<span class="nt">&lt;/form:option&gt;</span>
</span><span class="hll">        <span class="nt">&lt;form:option</span> <span class="na">value=</span><span class="s">&quot;jp&quot;</span><span class="nt">&gt;</span>Japan<span class="nt">&lt;/form:option&gt;</span>
</span><span class="hll">        <span class="nt">&lt;form:option</span> <span class="na">value=</span><span class="s">&quot;sg&quot;</span><span class="nt">&gt;</span>Singapore<span class="nt">&lt;/form:option&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/form:select&gt;</span>
</span><span class="hll">    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;country&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
</span>    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
<span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Controller class</p>
</li>
</ul>
<blockquote>
<div><p>By giving a group name to <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation, the rules defined for that group will be applied.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>


<span class="kn">import</span> <span class="nn">javax.validation.groups.Default</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.example.sample.app.validation.UserForm.Chinese</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.example.sample.app.validation.UserForm.Japanese</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.example.sample.app.validation.UserForm.Singaporean</span><span class="p">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="p">{</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">UserForm</span> <span class="nf">setupForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">UserForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UserForm</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">form</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">String</span> <span class="nf">createConfirm</span><span class="p">(</span><span class="n">UserForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">hasErrors</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="s">&quot;user/createConfirm&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;confirm&quot;</span><span class="p">,</span>  <span class="cm">/* (1) */</span> <span class="s">&quot;country=cn&quot;</span> <span class="p">})</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirmForChinese</span><span class="p">(</span><span class="nd">@Validated</span><span class="p">({</span> <span class="cm">/* (2) */</span> <span class="n">Chinese</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
            <span class="n">Default</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span> <span class="n">UserForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">createConfirm</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
    <span class="p">}</span>

<span class="hll">    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="hll">            <span class="s">&quot;confirm&quot;</span><span class="p">,</span> <span class="s">&quot;country=jp&quot;</span> <span class="p">})</span>
</span><span class="hll">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirmForJapanese</span><span class="p">(</span><span class="nd">@Validated</span><span class="p">({</span> <span class="n">Japanese</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
</span><span class="hll">            <span class="n">Default</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span> <span class="n">UserForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">createConfirm</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
</span><span class="hll">    <span class="p">}</span>
</span><span class="hll">
</span><span class="hll">    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
</span><span class="hll">            <span class="s">&quot;confirm&quot;</span><span class="p">,</span> <span class="s">&quot;country=sg&quot;</span> <span class="p">})</span>
</span><span class="hll">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirmForSingaporean</span><span class="p">(</span><span class="nd">@Validated</span><span class="p">({</span> <span class="n">Singaporean</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
</span><span class="hll">            <span class="n">Default</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span> <span class="n">UserForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">createConfirm</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
</span><span class="hll">    <span class="p">}</span>
</span><span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The parameter which is used as condition to dividing between the groups must be set to <code class="docutils literal"><span class="pre">param</span></code> attribute.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">All the annotations, except <code class="docutils literal"><span class="pre">&#64;Min</span></code> of <code class="docutils literal"><span class="pre">age</span></code> field, belongs to <code class="docutils literal"><span class="pre">Default</span></code> group; hence, specifying <code class="docutils literal"><span class="pre">Default</span></code> is mandatory.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>In this example, the check result of the combination of each input value is as follows.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><code class="docutils literal"><span class="pre">age</span></code> value</th>
<th class="head"><code class="docutils literal"><span class="pre">country</span></code> value</th>
<th class="head">Input validation result</th>
<th class="head">Error message</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">17</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">cn</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">NG</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">must be greater than or equal to 18</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">jp</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">NG</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">must be greater than or equal to 20</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">sg</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">NG</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">must be greater than or equal to 21</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">18</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">cn</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">jp</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">NG</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">must be greater than or equal to 20</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">sg</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">NG</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">must be greater than or equal to 21</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">20</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">cn</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">jp</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">sg</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">NG</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">must be greater than or equal to 21</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">21</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">cn</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">jp</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">sg</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Implementation of this Controller is inadequate; there is no handling when <code class="docutils literal"><span class="pre">country</span></code> value is neither “cn”, “jp”  nor “sg”.
400 error is returned when unexpected <code class="docutils literal"><span class="pre">country</span></code> value is encountered.</p>
</div>
<p>Next, we can think of a condition where the number of countries increase and adult condition of 18 years or more is be set as a default rule.</p>
<p>Rules are as follows.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Group</th>
<th class="head">Adult condition</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">Japanese</span></code></td>
<td>20 years or more</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">Singaporean</span></code></td>
<td>21 years or more</td>
</tr>
<tr class="row-even"><td>Country other than the above-mentioned(<code class="docutils literal"><span class="pre">Default</span></code>)</td>
<td>18 years or more</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Form class</p>
<p>In order to specify a value to <code class="docutils literal"><span class="pre">Default</span></code> group (18 years or more), all groups should be specified explicitly in other annotations as well.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.Valid</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Max</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Min</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.groups.Default</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.hibernate.validator.constraints.Email</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Japanese</span> <span class="p">{</span>
    <span class="p">};</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Singaporean</span> <span class="p">{</span>
    <span class="p">};</span>

    <span class="nd">@NotNull</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Japanese</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Singaporean</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span> <span class="c1">// (1)</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Japanese</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
            <span class="n">Singaporean</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>

    <span class="nd">@NotNull</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Japanese</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Singaporean</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Japanese</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
            <span class="n">Singaporean</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
    <span class="nd">@Email</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Japanese</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Singaporean</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="p">;</span>

    <span class="nd">@NotNull</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Japanese</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Singaporean</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
    <span class="nd">@Min.List</span><span class="p">({</span>
            <span class="nd">@Min</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span><span class="p">),</span> <span class="c1">// (2)</span>
            <span class="nd">@Min</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">Japanese</span><span class="p">.</span><span class="na">class</span><span class="p">),</span>
            <span class="nd">@Min</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">Singaporean</span><span class="p">.</span><span class="na">class</span><span class="p">)</span> <span class="p">})</span>
    <span class="nd">@Max</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="p">;</span>

    <span class="nd">@NotNull</span><span class="p">(</span><span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Japanese</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Singaporean</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="p">{</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">Japanese</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
            <span class="n">Singaporean</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">country</span><span class="p">;</span>

    <span class="c1">// omitted setter/getter</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set all groups to annotations other than <code class="docutils literal"><span class="pre">&#64;Min</span></code> of <code class="docutils literal"><span class="pre">age</span></code> field as well.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set the rule for <code class="docutils literal"><span class="pre">Default</span></code> group.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">JSP</p>
<p>No change in JSP</p>
</li>
<li><p class="first">Controller class</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.example.sample.app.validation.UserForm.Japanese</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.example.sample.app.validation.UserForm.Singaporean</span><span class="p">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="p">{</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">UserForm</span> <span class="nf">setupForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">UserForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UserForm</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">form</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">String</span> <span class="nf">createConfirm</span><span class="p">(</span><span class="n">UserForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">hasErrors</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="s">&quot;user/createConfirm&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;confirm&quot;</span> <span class="p">})</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirmForDefault</span><span class="p">(</span><span class="nd">@Validated</span> <span class="cm">/* (1) */</span> <span class="n">UserForm</span> <span class="n">form</span><span class="p">,</span>
            <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">createConfirm</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;confirm&quot;</span><span class="p">,</span> <span class="s">&quot;country=jp&quot;</span> <span class="p">})</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirmForJapanese</span><span class="p">(</span>
            <span class="nd">@Validated</span><span class="p">(</span><span class="n">Japanese</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>  <span class="cm">/* (2) */</span> <span class="n">UserForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">createConfirm</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;confirm&quot;</span><span class="p">,</span> <span class="s">&quot;country=sg&quot;</span> <span class="p">})</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirmForSingaporean</span><span class="p">(</span>
            <span class="nd">@Validated</span><span class="p">(</span><span class="n">Singaporean</span><span class="p">.</span><span class="na">class</span><span class="p">)</span> <span class="n">UserForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">createConfirm</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When the field <code class="docutils literal"><span class="pre">country</span></code> does not have a value, the request is mapped to a method in which <code class="docutils literal"><span class="pre">Default</span></code> group is specified in <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When the field <code class="docutils literal"><span class="pre">country</span></code> has a value, the request is mapped to a method in which <code class="docutils literal"><span class="pre">Default</span></code> group is not included in <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>Till now, 2 patterns of using grouped validation have been explained.</p>
<p>In the previous pattern, <code class="docutils literal"><span class="pre">Default</span></code> group is used in Controller class and in the later one,  <code class="docutils literal"><span class="pre">Default</span></code> group is used in form class.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Pattern</th>
<th class="head">Advantages</th>
<th class="head">Disadvantages</th>
<th class="head">Decision points</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Using <code class="docutils literal"><span class="pre">Default</span></code> group in Controller class</td>
<td><code class="docutils literal"><span class="pre">group</span></code> attribute need not be set for the rules that need not be grouped.</td>
<td>Since all patterns of group should be defined, it is difficult to define when there are many group patterns.</td>
<td>Should be used when there are only a limited number of group patterns (New create group, Update group and Delete group)</td>
</tr>
<tr class="row-odd"><td>Using <code class="docutils literal"><span class="pre">Default</span></code> group in form class</td>
<td>Since only the groups that do not belong to the default group need to be defined, it can be handled even if there are many patterns.</td>
<td><code class="docutils literal"><span class="pre">group</span></code> attribute should be set for the rules that need not be grouped making the process complicated.</td>
<td>Should be used when there are many group patterns and majority of patterns have a common value.</td>
</tr>
</tbody>
</table>
<p><strong>If none of the above decision points are applicable, then using Bean Validation itself might not be a good idea.</strong>After reviewing the design, usage of Spring Validator or implementation of validation in business logic should be considered.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In the examples explained so far, the switching of group validation is carried out using request parameter and parameter that can be specified in <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.
It is not possible to switch between groups, if switching is to be performed based on permissions in authentication object or any information which cannot be handled by <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.</p>
<p>In such a case, <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation must not be used but <code class="docutils literal"><span class="pre">org.springframework.validation.SmartValidator</span></code> must be used. Group validation can be performed inside the handler method of controller.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="p">{</span>

    <span class="nd">@Inject</span>
    <span class="n">SmartValidator</span> <span class="n">smartValidator</span><span class="p">;</span> <span class="c1">// (1)</span>

    <span class="c1">// omitted</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirm</span><span class="p">(</span><span class="cm">/* (2) */</span> <span class="n">UserForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// (3)</span>
        <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">validationGroup</span> <span class="o">=</span> <span class="n">Default</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>
        <span class="c1">// logic to determine validation group</span>
        <span class="c1">// if (xxx) {</span>
        <span class="c1">//     validationGroup = Xxx.class;</span>
        <span class="c1">// }</span>
        <span class="n">smartValidator</span><span class="p">.</span><span class="na">validate</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">validationGroup</span><span class="p">);</span> <span class="c1">// (4)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">hasErrors</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="s">&quot;user/createConfirm&quot;</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inject <code class="docutils literal"><span class="pre">SmartValidator</span></code>. Since <code class="docutils literal"><span class="pre">SmartValidator</span></code> can be used if <code class="docutils literal"><span class="pre">&lt;mvc:annotation-driven&gt;</span></code> setting is carried out so there is no need to define separately.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Do not use <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Determine a validation group.</div>
<div class="line">Logic to determine a validation group recommends delegating to Helper class and keeping logic in Controller in simple state.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Execute grouped validation using <code class="docutils literal"><span class="pre">validate</span></code> method of <code class="docutils literal"><span class="pre">SmartValidator</span></code>.</div>
<div class="line">Multiple groups can be specified in <code class="docutils literal"><span class="pre">validate</span></code> method.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p class="last">Since logic should not be written in Controller, if switching is possible using request parameters in <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code>annotation, <code class="docutils literal"><span class="pre">SmartValidator</span></code> must not be used.</p>
</div>
</div>
</div>
<div class="section" id="correlation-item-check">
<span id="validation-correlation-check"></span><h3><a class="toc-backref" href="#id14">4.1.2.3. Correlation item check</a><a class="headerlink" href="#correlation-item-check" title="Permalink to this headline">¶</a></h3>
<p>For the validation of correlated items,
Spring Validator(<code class="docutils literal"><span class="pre">Validator</span></code> implementing <code class="docutils literal"><span class="pre">org.springframework.validation.Validator</span></code> interface)
or Bean Validation must be used.</p>
<p>Each one of above has been explained below. However, before that, their features and usage have been explained.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="40%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Format</th>
<th class="head">Features</th>
<th class="head">Usage</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Spring Validator</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is easy to create input validation for a particular class.</div>
<div class="line">It is inconvenient to use in Controller.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Input validation implementation of unique business requirements depending on specific form</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Bean Validation</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Creation of input validation is not as easy as Spring Validator.</div>
<div class="line">It is easy to use in Controller.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Common input validation implementation of development project not depending on specific form</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="section" id="correlation-item-check-implementation-using-spring-validator">
<h4><a class="toc-backref" href="#id15">4.1.2.3.1. Correlation item check implementation using Spring Validator</a><a class="headerlink" href="#correlation-item-check-implementation-using-spring-validator" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Implementation method is explained with the help of “reset password” process as an example.</div>
<div class="line">Implement the following rules. Following rules are provided in the “reset password” form.</div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="30%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field name</th>
<th class="head">Type</th>
<th class="head">Rules</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">password</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">8 or more characters</div>
<div class="line"><strong>Must be same as confirmPassword</strong></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Password</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">confirmPassword</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Nothing in particular</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Confirm password</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Check rule “Must be same as confirmPassword” is validation of correlated items as <code class="docutils literal"><span class="pre">password</span></code> field and <code class="docutils literal"><span class="pre">confirmPassword</span></code> field should have the same value.</p>
<ul>
<li><p class="first">Form class</p>
<p>other than validation of correlated items, implement using Bean Validation annotation.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordResetForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">confirmPassword</span><span class="p">;</span>

    <span class="c1">// omitted setter/getter</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Password is normally saved in database after hashing it, hence there is no need to check the maximum number of characters.</p>
</div>
</li>
<li><p class="first">Validator class</p>
<p>Implement validation of correlated items using <code class="docutils literal"><span class="pre">org.springframework.validation.Validator</span></code> interface.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.Errors</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.Validator</span><span class="p">;</span>

<span class="nd">@Component</span> <span class="c1">// (1)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordEqualsValidator</span> <span class="kd">implements</span> <span class="n">Validator</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supports</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">clazz</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">PasswordResetForm</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">isAssignableFrom</span><span class="p">(</span><span class="n">clazz</span><span class="p">);</span> <span class="c1">// (2)</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">validate</span><span class="p">(</span><span class="n">Object</span> <span class="n">target</span><span class="p">,</span> <span class="n">Errors</span> <span class="n">errors</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">errors</span><span class="p">.</span><span class="na">hasFieldErrors</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// (3)</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">PasswordResetForm</span> <span class="n">form</span> <span class="o">=</span> <span class="p">(</span><span class="n">PasswordResetForm</span><span class="p">)</span> <span class="n">target</span><span class="p">;</span>
        <span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="n">form</span><span class="p">.</span><span class="na">getPassword</span><span class="p">();</span>
        <span class="n">String</span> <span class="n">confirmPassword</span> <span class="o">=</span> <span class="n">form</span><span class="p">.</span><span class="na">getConfirmPassword</span><span class="p">();</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">password</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">confirmPassword</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// (4)</span>
            <span class="n">errors</span><span class="p">.</span><span class="na">rejectValue</span><span class="p">(</span><span class="cm">/* (5) */</span> <span class="s">&quot;password&quot;</span><span class="p">,</span>
            <span class="cm">/* (6) */</span> <span class="s">&quot;PasswordEqualsValidator.passwordResetForm.password&quot;</span><span class="p">,</span>
            <span class="cm">/* (7) */</span> <span class="s">&quot;password and confirm password must be same.&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;Component</span></code> to make Validator the target of component scan.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Decide the argument is check target of this validator or not. Here <code class="docutils literal"><span class="pre">PasswordResetForm</span></code> class is the target to be checked.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">If an error occurs at the target fields during a single item check, do not perform correlation check in this Validator.</div>
<div class="line">If it is necessary to perform the correlation check, this determination logic is not required.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Implement check logic.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify field name where there is error.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify code name of error message. Here, code is</div>
<div class="line">“[validator name].[form attribute name].[property name]”</div>
<div class="line">Refer to <a class="reference internal" href="#validation-message-in-application-messages"><span class="std std-ref">Messages to be defined in application-messages.properties</span></a> for mesaage definition.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set default message to be used when error message does not get resolved using code.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Spring Validator implementation class should be placed in the same package as the Controller.</p>
</div>
</li>
<li><p class="first">Controller class</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.WebDataBinder</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.InitBinder</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordResetController</span> <span class="p">{</span>
    <span class="nd">@Inject</span>
    <span class="n">PasswordEqualsValidator</span> <span class="n">passwordEqualsValidator</span><span class="p">;</span> <span class="c1">// (1)</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">PasswordResetForm</span> <span class="nf">setupForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">PasswordResetForm</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@InitBinder</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinder</span><span class="p">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">binder</span><span class="p">.</span><span class="na">addValidators</span><span class="p">(</span><span class="n">passwordEqualsValidator</span><span class="p">);</span> <span class="c1">// (2)</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;reset&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">resetForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;password/resetForm&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;reset&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">reset</span><span class="p">(</span><span class="nd">@Validated</span> <span class="n">PasswordResetForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// (3)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">hasErrors</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;password/resetForm&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="s">&quot;redirect:/password/reset?complete&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;reset&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;complete&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">resetComplete</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;password/resetComplete&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inject Spring Validator to be used.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In the method having <code class="docutils literal"><span class="pre">&#64;InitBinder</span></code> annotation, add Validators using <code class="docutils literal"><span class="pre">WebDataBinder.addValidators</span></code> method.</div>
<div class="line">By this, the added Validator is called when validation is executed with the use of <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Implement input validation as per the process performed so far.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">JSP</p>
<p>There are no points to mention for JSP.</p>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="k">&lt;%-</span><span class="o">-</span> <span class="n">WEB</span><span class="o">-</span><span class="n">INF</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">password</span><span class="o">/</span><span class="n">resetForm</span><span class="p">.</span><span class="na">jsp</span> <span class="o">--</span><span class="k">%&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;style</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">&gt;</span>
/* omitted */
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;passwordResetForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
        <span class="na">class=</span><span class="s">&quot;form-horizontal&quot;</span>
        <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/password/reset&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;password&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Password:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:password</span> <span class="na">path=</span><span class="s">&quot;password&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;password&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;confirmPassword&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Password (Confirm):<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:password</span> <span class="na">path=</span><span class="s">&quot;confirmPassword&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;confirmPassword&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:button&gt;</span>Reset<span class="nt">&lt;/form:button&gt;</span>
    <span class="nt">&lt;/form:form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
</li>
</ul>
<p>Error message as shown below is displayed when form is sent by entering different values in <code class="docutils literal"><span class="pre">password</span></code> field and <code class="docutils literal"><span class="pre">confirmPassword</span></code> fields.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-correlation-check1.png"><img alt="../../_images/validations-correlation-check1.png" src="../../_images/validations-correlation-check1.png" style="width: 60%;" /></a>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When <code class="docutils literal"><span class="pre">&lt;form:password&gt;</span></code> tag is used, data gets cleared at the time of redisplay.</p>
</div>
<div class="admonition note" id="validation-how-to-cross-field-validation-for-multi-field-highlight">
<p class="first admonition-title">Note</p>
<p>Error information can be set for multiple fields for correlation check.
However, displaying error messages and applying style must always be performed in a set and only one part of the tasks cannot not be performed.</p>
<p>When you want to apply style to both the fields wherein correlation check error has occurred however you want to display only one error message,
it can be done by setting a null string in the error message.
An example is given below wherein style is applied to <code class="docutils literal"><span class="pre">password</span></code> field and <code class="docutils literal"><span class="pre">confirmPassword</span></code> field and error message is displayed only in <code class="docutils literal"><span class="pre">password</span></code> field.</p>
<blockquote class="last">
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.Errors</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.Validator</span><span class="p">;</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordEqualsValidator</span> <span class="kd">implements</span> <span class="n">Validator</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supports</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">clazz</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">PasswordResetForm</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">isAssignableFrom</span><span class="p">(</span><span class="n">clazz</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">validate</span><span class="p">(</span><span class="n">Object</span> <span class="n">target</span><span class="p">,</span> <span class="n">Errors</span> <span class="n">errors</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">// omitted</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">password</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">confirmPassword</span><span class="p">))</span> <span class="p">{</span>
            <span class="c1">// register a field error for password</span>
            <span class="n">errors</span><span class="p">.</span><span class="na">rejectValue</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">,</span>
                   <span class="s">&quot;PasswordEqualsValidator.passwordResetForm.password&quot;</span><span class="p">,</span>
                   <span class="s">&quot;password and confirm password must be same.&quot;</span><span class="p">);</span>

            <span class="c1">// register a field error for confirmPassword</span>
            <span class="n">errors</span><span class="p">.</span><span class="na">rejectValue</span><span class="p">(</span><span class="s">&quot;confirmPassword&quot;</span><span class="p">,</span> <span class="c1">// (1)</span>
                      <span class="s">&quot;PasswordEqualsValidator.passwordResetForm.confirmPassword&quot;</span><span class="p">,</span> <span class="c1">// (2)</span>
                      <span class="s">&quot;&quot;</span><span class="p">);</span> <span class="c1">// (3)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Register error in <code class="docutils literal"><span class="pre">confirmPassword</span></code>field.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify code name of error message. Specify a null string in the corresponding error message at that time.</div>
<div class="line">For message definition, refer <a class="reference internal" href="#validation-message-in-application-messages"><span class="std std-ref">Messages to be defined in application-messages.properties</span></a>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set a default message to be used when error message could not be resolved in the code.</div>
<div class="line">A null string is set in the example above.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When multiple forms are used in a single controller, model name should be specified in <code class="docutils literal"><span class="pre">&#64;InitBinder(&quot;xxx&quot;)</span></code> in order to limit the target of Validator.</p>
<blockquote class="last">
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;xxx&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">XxxController</span> <span class="p">{</span>
    <span class="c1">// omitted</span>
    <span class="nd">@ModelAttribute</span><span class="p">(</span><span class="s">&quot;aaa&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="nf">AaaForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">AaaForm</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@ModelAttribute</span><span class="p">(</span><span class="s">&quot;bbb&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="nf">BbbForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">BbbForm</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@InitBinder</span><span class="p">(</span><span class="s">&quot;aaa&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinderForAaa</span><span class="p">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// add validators for AaaForm</span>
        <span class="n">binder</span><span class="p">.</span><span class="na">addValidators</span><span class="p">(</span><span class="n">aaaValidator</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@InitBinder</span><span class="p">(</span><span class="s">&quot;bbb&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinderForBbb</span><span class="p">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// add validators for BbbForm</span>
        <span class="n">binder</span><span class="p">.</span><span class="na">addValidators</span><span class="p">(</span><span class="n">bbbValidator</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// omitted</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To change the check contents of correlated items check rules in accordance with a validation group (for example: To implement correlated items check only when specific validation group is specified, etc.), it is better to switch the process within validate method by implementing <code class="docutils literal"><span class="pre">org.springframework.validation.SmartValidator</span></code> interface instead of implementing <code class="docutils literal"><span class="pre">org.springframework.validation.Validator</span></code> interface.</p>
<blockquote class="last">
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.apache.commons.lang3.ArrayUtils</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.Errors</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.SmartValidator</span><span class="p">;</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordEqualsValidator</span> <span class="kd">implements</span> <span class="n">SmartValidator</span> <span class="p">{</span> <span class="c1">// Implements SmartValidator instead of Validator interface</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supports</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">clazz</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">PasswordResetForm</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">isAssignableFrom</span><span class="p">(</span><span class="n">clazz</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">validate</span><span class="p">(</span><span class="n">Object</span> <span class="n">target</span><span class="p">,</span> <span class="n">Errors</span> <span class="n">errors</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">validate</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="p">{});</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">validate</span><span class="p">(</span><span class="n">Object</span> <span class="n">target</span><span class="p">,</span> <span class="n">Errors</span> <span class="n">errors</span><span class="p">,</span> <span class="n">Object</span><span class="p">...</span> <span class="n">validationHints</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Check validationHints(groups) and apply validation logic only when &#39;Update.class&#39; is specified</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ArrayUtils</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">validationHints</span><span class="p">,</span> <span class="n">Update</span><span class="p">.</span><span class="na">class</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">PasswordResetForm</span> <span class="n">form</span> <span class="o">=</span> <span class="p">(</span><span class="n">PasswordResetForm</span><span class="p">)</span> <span class="n">target</span><span class="p">;</span>
            <span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="n">form</span><span class="p">.</span><span class="na">getPassword</span><span class="p">();</span>
            <span class="n">String</span> <span class="n">confirmPassword</span> <span class="o">=</span> <span class="n">form</span><span class="p">.</span><span class="na">getConfirmPassword</span><span class="p">();</span>

            <span class="c1">// omitted...</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="implementation-of-input-check-of-correlated-items-using-bean-validation">
<h4><a class="toc-backref" href="#id16">4.1.2.3.2. Implementation of input check of correlated items using Bean Validation</a><a class="headerlink" href="#implementation-of-input-check-of-correlated-items-using-bean-validation" title="Permalink to this headline">¶</a></h4>
<p>Independent validation rules should be added to implement validation of correlated items using Bean Validation.</p>
<p>It is explained in <a class="reference internal" href="#validation-custom-constraint"><span class="std std-ref">How to extend</span></a>.</p>
</div>
</div>
<div class="section" id="definition-of-error-messages">
<span id="validation-message-def"></span><h3><a class="toc-backref" href="#id17">4.1.2.4. Definition of error messages</a><a class="headerlink" href="#definition-of-error-messages" title="Permalink to this headline">¶</a></h3>
<p>Method to change error messages of input validation is explained.</p>
<p>Error messages of Bean Validation in Spring MVC are resolved in the following order.</p>
<ol class="arabic">
<li><div class="first line-block">
<div class="line">If there is any message which matches with the rule, among the messages defined in <code class="docutils literal"><span class="pre">org.springframework.context.MessageSource</span></code>, then it is to be used as error message (Spring rule).</div>
<div class="line">For default rules of Spring, refer to “<a class="reference external" href="http://docs.spring.io/spring/docs/4.3.5.RELEASE/javadoc-api/org/springframework/validation/DefaultMessageCodesResolver.html">JavaDoc of DefaultMessageCodesResolver</a> of DefaultMessageCodesResolver”.</div>
</div>
</li>
<li><p class="first">If message cannot be found as mentioned in step 1, then error message is acquired from the <code class="docutils literal"><span class="pre">message</span></code> attribute of the annotation. (Bean Validation rule)</p>
</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>When the value of <code class="docutils literal"><span class="pre">message</span></code> attribute is not in “{message key}” format, use that text as error message.</li>
<li>When the value of <code class="docutils literal"><span class="pre">message</span></code> attribute is in “{message key}” format, search messages corresponding to message key from ValidationMessages.properties under classpath.</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>When message corresponding to message key is defined, use that message</li>
<li>When message corresponding to message key is not defined, use “{message key}” as error message</li>
</ol>
</div></blockquote>
</div></blockquote>
<p>Basically, it is recommended to define error messages in properties file.</p>
<p>Messages should be defined at following places.</p>
<ul class="simple">
<li>properties file read by <code class="docutils literal"><span class="pre">org.springframework.context.MessageSource</span></code></li>
<li>ValidationMessages.properties under classpath</li>
</ul>
<p>Considering that the following settings are done in applicationContext.xml, former is called as “application-messages.properties” and latter is called “ValidationMessages.properties”.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;messageSource&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.springframework.context.support.ResourceBundleMessageSource&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;basenames&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;list&gt;</span>
            <span class="nt">&lt;value&gt;</span>i18n/application-messages<span class="nt">&lt;/value&gt;</span>
        <span class="nt">&lt;/list&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-message-properties-position-image.png"><img alt="../../_images/validations-message-properties-position-image.png" src="../../_images/validations-message-properties-position-image.png" style="width: 40%;" /></a>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Multiple <code class="docutils literal"><span class="pre">ValidationMessages.properties</span></code> files should not exist directly under class path.</p>
<p>If multiple <code class="docutils literal"><span class="pre">ValidationMessages.properties</span></code> files exist directly under class path,
an appropriate message may not be displayed, as either one file of them is read leaving rest of the files unread.</p>
<ul class="simple">
<li>When adopting multi project structure, please take care so that <code class="docutils literal"><span class="pre">ValidationMessages.properties</span></code> file is not placed in multiple projects.</li>
<li>When distributing common parts for Bean Validation as jar file, please take care so that <code class="docutils literal"><span class="pre">ValidationMessages.properties</span></code> file is not included in jar file.</li>
</ul>
<p class="last">Further, when a project is created from <a class="reference external" href="https://github.com/terasolunaorg/terasoluna-gfw-web-multi-blank">Blank project</a>  of version 1.0.2.RELEASE or higher,
<code class="docutils literal"><span class="pre">ValidationMessages.properties</span></code> is stored directly under <code class="docutils literal"><span class="pre">xxx-web/src/main/resources</span></code>.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>This guideline classifies the definition as follows.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Properties file name</th>
<th class="head">Contents to be defined</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">ValidationMessages.properties</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Default error messages of Bean Validation specified by the system</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">application-messages.properties</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Error message of Bean Validation to be overwritten separately</div>
<div class="line">Error message of input validation implemented in Spring Validator</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>When ValidationMessages.properties is not provided, <a class="reference internal" href="#validation-default-message-in-hibernate-validator"><span class="std std-ref">Default messages provided by Hibernate Validator</span></a> is used.</p>
<p>By working with <code class="docutils literal"><span class="pre">MessageSource</span></code>, you can handle Japanese messages directly without Native to Ascii.
For details,please refer <a class="reference internal" href="#validation-without-native2ascii"><span class="std std-ref">Reading messages which are not converted from Native to Ascii</span></a></p>
<div class="section" id="messages-to-be-defined-in-validationmessages-properties">
<span id="validation-message-in-validationmessages"></span><h4><a class="toc-backref" href="#id18">4.1.2.4.1. Messages to be defined in ValidationMessages.properties</a><a class="headerlink" href="#messages-to-be-defined-in-validationmessages-properties" title="Permalink to this headline">¶</a></h4>
<p>Define messages for message key specified in <code class="docutils literal"><span class="pre">message</span></code> attribute of Bean Validation annotation of
ValidationMessages.properties under class path (normal src/main/resources).</p>
<p>It is explained below using the following form used at the beginning of <a class="reference internal" href="#validation-basic-validation"><span class="std std-ref">Basic single item check</span></a>.</p>
<ul>
<li><p class="first">Form class (re-displayed)</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nd">@Email</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Min</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="nd">@Max</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="p">;</span>

    <span class="c1">// omitted getter/setter</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">ValidationMessages.properties</p>
<p>Change error messages of <code class="docutils literal"><span class="pre">&#64;NotNull</span></code>, <code class="docutils literal"><span class="pre">&#64;Size</span></code>, <code class="docutils literal"><span class="pre">&#64;Min</span></code>, <code class="docutils literal"><span class="pre">&#64;Max</span></code>, <code class="docutils literal"><span class="pre">&#64;Email</span></code>.</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">javax.validation.constraints.NotNull.message</span><span class="o">=</span><span class="s">is required.</span>
<span class="c"># (1)</span>
<span class="na">javax.validation.constraints.Size.message</span><span class="o">=</span><span class="s">size is not in the range {min} through {max}.</span>
<span class="na">javax.validation.constraints.Min.message</span><span class="o">=</span><span class="s">cannot be less than {value}.</span>
<span class="na">javax.validation.constraints.Max.message</span><span class="o">=</span><span class="s">cannot be greater than {value}.</span>
<span class="na">org.hibernate.validator.constraints.Email.message</span><span class="o">=</span><span class="s">is an invalid e-mail address.</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is possible to embed the value of attributes specified in the annotation using <code class="docutils literal"><span class="pre">{Attribute</span> <span class="pre">name}</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>When the form is sent with input fields left blank after adding the above settings, changed error messages are displayed as shown below.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-customize-message1.png"><img alt="../../_images/validations-customize-message1.png" src="../../_images/validations-customize-message1.png" style="width: 60%;" /></a>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Since <code class="docutils literal"><span class="pre">{FQCN</span> <span class="pre">of</span> <span class="pre">annotation.message}</span></code> is set in <code class="docutils literal"><span class="pre">message</span></code> attribute in Bean Validation standard annotations and independent Hibernate Validator annotations,
messages can be defined in properties file in the above format. However, since all annotations may not be in this format, Javadoc or source code of the target annotation should be checked.</p>
</div>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">FQCN of annotation.message</span> <span class="o">=</span> <span class="s">Message</span>
</pre></div>
</div>
<p>Add <code class="docutils literal"><span class="pre">{0}</span></code> to message as shown below when field name is to be included in error message.</p>
<ul class="simple">
<li>ValidationMessages.properties</li>
</ul>
<blockquote>
<div><p>Change error message of <code class="docutils literal"><span class="pre">&#64;NotNull</span></code>, <code class="docutils literal"><span class="pre">&#64;Size</span></code>, <code class="docutils literal"><span class="pre">&#64;Min</span></code>, <code class="docutils literal"><span class="pre">&#64;Max</span></code> and <code class="docutils literal"><span class="pre">&#64;Email</span></code>.</p>
<blockquote>
<div><div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">javax.validation.constraints.NotNull.message</span><span class="o">=</span><span class="s">&quot;{0}&quot; is required.</span>
<span class="na">javax.validation.constraints.Size.message</span><span class="o">=</span><span class="s">The size of &quot;{0}&quot; is not in the range {min} through {max}.</span>
<span class="na">javax.validation.constraints.Min.message</span><span class="o">=</span><span class="s">&quot;{0}&quot; cannot be less than {value}.</span>
<span class="na">javax.validation.constraints.Max.message</span><span class="o">=</span><span class="s">&quot;{0}&quot; cannot be greater than {value}.</span>
<span class="na">org.hibernate.validator.constraints.Email.message</span><span class="o">=</span><span class="s">&quot;{0}&quot; is an invalid e-mail address.</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<p>Error message is changed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-customize-message2.png"><img alt="../../_images/validations-customize-message2.png" src="../../_images/validations-customize-message2.png" style="width: 60%;" /></a>
</div>
<p>In this way, property name of form class gets displayed on the screen and so it is not user friendly.
To display an appropriate field name, it should be defined in <strong>application-messages.properties</strong> in the following format.</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">form property name</span><span class="o">=</span><span class="s">field name to be displayed</span>
</pre></div>
</div>
<p>It is good to define field names in the form.</p>
<p>Adding the same to our example.</p>
<ul>
<li><p class="first">application-messages.properties</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">name</span><span class="o">=</span><span class="s">Name</span>
<span class="na">email</span><span class="o">=</span><span class="s">Email</span>
<span class="na">age</span><span class="o">=</span><span class="s">Age</span>
</pre></div>
</div>
</li>
</ul>
<p>Error messages are changed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-customize-message3.png"><img alt="../../_images/validations-customize-message3.png" src="../../_images/validations-customize-message3.png" style="width: 60%;" /></a>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Inserting field name in place of <code class="docutils literal"><span class="pre">{0}</span></code> is the functionality of Spring and not of Bean Validation.
Therefore, the settings for changing field name should be defined in application-messages.properties(<code class="docutils literal"><span class="pre">ResourceBundleMessageSource</span></code>) which is directly under Spring management.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>In Bean Validation 1.1,
it is possible to use Expression Language (hereafter referred to as “EL expression”) in a message specified in <code class="file docutils literal"><span class="pre">ValidationMessages.properties</span></code>.
Hibernate Validator 5.x supports Expression Language 2.2 or higher version.</p>
<p>Executable EL expression version differs depending on the version of application server.
Therefore when EL expression is to be used, <strong>it should be used after confirming the version of EL expression supported by application server.</strong></p>
<p>Following is an example of using EL expression in a message which is defined in <code class="file docutils literal"><span class="pre">ValidationMessages.properties</span></code> provided by Hibernate Validator by default.</p>
<blockquote>
<div><div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># ...</span>
<span class="c"># (1)</span>
<span class="na">javax.validation.constraints.DecimalMax.message</span>  <span class="o">=</span> <span class="s">must be less than ${inclusive == true ? &#39;or equal to &#39; : &#39;&#39;}{value}</span>
<span class="c"># ...</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">An EL expression is a part of “<code class="docutils literal"><span class="pre">${inclusive</span> <span class="pre">==</span> <span class="pre">true</span> <span class="pre">?</span> <span class="pre">'or</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">'</span> <span class="pre">:</span> <span class="pre">''}</span></code> ” in a message.</p>
<p>From the above mentioned definition of message, 2 patterns of messages are created as given below.</p>
<ul class="simple">
<li>must be less than or equal to {value}</li>
<li>must be less than {value}</li>
</ul>
<p>(A value specified in <code class="docutils literal"><span class="pre">value</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;DecimalMax</span></code> annotation is embedded in <code class="docutils literal"><span class="pre">{value}</span></code> part)</p>
<p>Former is created when <code class="docutils literal"><span class="pre">true</span></code> is specified (or when not specified) in <code class="docutils literal"><span class="pre">inclusive</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;DecimalMax</span></code> annotation,
Latter is created when <code class="docutils literal"><span class="pre">false</span></code> is specified in <code class="docutils literal"><span class="pre">inclusive</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;DecimalMax</span></code> annotation.</p>
<p class="last">For handling of EL expressions in Bean Validation refer to:
<a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.2/reference/en-US/html/ch04.html#section-interpolation-with-message-expressions">Hibernate Validator Reference Guide(Interpolation with message expressions)</a>.</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Further, the value to be checked can be included in the error message by using <code class="docutils literal"><span class="pre">${validatedValue}</span></code> in the message which is specified in <code class="file docutils literal"><span class="pre">ValidationMessages.properties</span></code>.</p>
<p>How to use <code class="docutils literal"><span class="pre">${validatedValue}</span></code> is shown below.</p>
<blockquote class="last">
<div><div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># ...</span>
<span class="c"># (1)</span>
<span class="na">javax.validation.constraints.Pattern.message</span> <span class="o">=</span> <span class="s">The value entered &quot;${validatedValue}&quot; is invalid.</span>
<span class="c"># ...</span>
</pre></div>
</div>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">Messages that are actually generated from the message definition above are embedded with the values input in the form, in <code class="docutils literal"><span class="pre">${validatedValue}</span></code> part.
If confidential information is included in the input value, care must be taken not to use <code class="docutils literal"><span class="pre">${validatedValue}</span></code> so that confidential information is not displayed.</p>
<p class="last">For details, refer <a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.2/reference/en-US/html/ch04.html#section-interpolation-with-message-expressions">Hibernate Validator Reference Guide(Interpolation with message expressions)</a>.</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div>
<div class="section" id="messages-to-be-defined-in-application-messages-properties">
<span id="validation-message-in-application-messages"></span><h4><a class="toc-backref" href="#id19">4.1.2.4.2. Messages to be defined in application-messages.properties</a><a class="headerlink" href="#messages-to-be-defined-in-application-messages-properties" title="Permalink to this headline">¶</a></h4>
<p>Default messages to be used in system are defined in ValidationMessages.properties
however, depending on the screen, they may have to be changed from the default value.</p>
<p>In this case, define messages in the following format in application-messages.properties.</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">[annotation name].[form attribute name].[property name]</span> <span class="o">=</span> <span class="s">[target message]</span>
</pre></div>
</div>
<p>Apply “<a class="reference internal" href="#validation-message-in-validationmessages"><span class="std std-ref">Messages to be defined in ValidationMessages.properties</span></a>” and override the message for  <code class="docutils literal"><span class="pre">email</span></code> and <code class="docutils literal"><span class="pre">age</span></code> field using the below settings.</p>
<ul>
<li><p class="first">application-messages.properties</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># override messages</span>
<span class="c"># for email field</span>
<span class="na">Size.userForm.email</span><span class="o">=</span><span class="s">The size of &quot;{0}&quot; must be between {2} and {1}.</span>
<span class="c"># for age field</span>
<span class="na">NotNull.userForm.age</span><span class="o">=</span><span class="s">&quot;{0}&quot; is compulsory.</span>
<span class="na">Min.userForm.age</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be greater than or equal to {1}.</span>
<span class="na">Max.userForm.age</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be less than or equal to {1}.</span>

<span class="c"># filed names</span>
<span class="na">name</span><span class="o">=</span><span class="s">Name</span>
<span class="na">email</span><span class="o">=</span><span class="s">Email</span>
<span class="na">age</span><span class="o">=</span><span class="s">Age</span>
</pre></div>
</div>
</li>
</ul>
<p>Value of attributes of the annotation gets inserted after <code class="docutils literal"><span class="pre">{1}</span></code> onwards.
Incidentally, index position of attribute values are alphabetical ordering(ascending order) of attribute names.</p>
<p>For example, index positions of <code class="docutils literal"><span class="pre">&#64;Size</span></code> are as follow:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">{0}</span></code> : property name (physical name or logical name)</li>
<li><code class="docutils literal"><span class="pre">{1}</span></code> : value of <code class="docutils literal"><span class="pre">max</span></code> attribute</li>
<li><code class="docutils literal"><span class="pre">{2}</span></code> : value of <code class="docutils literal"><span class="pre">min</span></code> attribute</li>
</ul>
<p>For specification details, refer to <a class="reference external" href="http://docs.spring.io/spring/docs/4.3.5.RELEASE/javadoc-api/org/springframework/validation/beanvalidation/SpringValidatorAdapter.html#getArgumentsForConstraint-java.lang.String-java.lang.String-javax.validation.metadata.ConstraintDescriptor-">JavaDoc of SpringValidatorAdapter</a>.</p>
<p>Error messages are changed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-customize-message4.png"><img alt="../../_images/validations-customize-message4.png" src="../../_images/validations-customize-message4.png" style="width: 60%;" /></a>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="http://docs.spring.io/spring/docs/4.3.5.RELEASE/javadoc-api/org/springframework/validation/DefaultMessageCodesResolver.html">There are other formats</a> as well for the message key format of application-messages.properties;
however, if it is used with the purpose of overwriting some default messages, it should be in <code class="docutils literal"><span class="pre">[annotation</span> <span class="pre">name].[form</span> <span class="pre">attribute</span> <span class="pre">name].[property</span> <span class="pre">name]</span></code> format.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="how-to-extend">
<span id="validation-custom-constraint"></span><h2><a class="toc-backref" href="#id20">4.1.3. How to extend</a><a class="headerlink" href="#how-to-extend" title="Permalink to this headline">¶</a></h2>
<p>Other than standard check rules, bean validation has a mechanism to develop annotations for independent rules .</p>
<p>The method of creating independent rules can be widely classified into the following two broader criteria.</p>
<ul class="simple">
<li>Combination of existing rules</li>
<li>Creation of new rules</li>
</ul>
<p>Basically, the below template can be used to create annotation for each rule.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.ANNOTATION_TYPE</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.CONSTRUCTOR</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.FIELD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.METHOD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.PARAMETER</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.RetentionPolicy.RUNTIME</span><span class="p">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="p">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="p">{})</span>
<span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">Xxx</span> <span class="p">{</span>
    <span class="n">String</span> <span class="nf">message</span><span class="p">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.common.validation.Xxx.message}&quot;</span><span class="p">;</span>

    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
    <span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="p">{</span>
        <span class="n">Xxx</span><span class="o">[]</span> <span class="nf">value</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="creation-of-bean-validation-annotation-by-combining-existing-rules">
<span id="validation-convine-existing-constraint"></span><h3><a class="toc-backref" href="#id21">4.1.3.1. Creation of Bean Validation annotation by combining existing rules</a><a class="headerlink" href="#creation-of-bean-validation-annotation-by-combining-existing-rules" title="Permalink to this headline">¶</a></h3>
<p>Consider the following restrictions at the system level and domain level respectively.</p>
<div class="line-block">
<div class="line">At the system level,</div>
</div>
<ul class="simple">
<li>String must be single byte alphanumeric characters</li>
<li>Numbers must be positive</li>
</ul>
<div class="line-block">
<div class="line">Or at the domain level,</div>
</div>
<ul class="simple">
<li>“User ID” must be between 4 and 20 single byte characters</li>
<li>“Age” must be between 1 year and 150 years</li>
</ul>
<div class="line-block">
<div class="line">These can be implemented by combining <code class="docutils literal"><span class="pre">&#64;Pattern</span></code>, <code class="docutils literal"><span class="pre">&#64;Size</span></code>, <code class="docutils literal"><span class="pre">&#64;Min</span></code>, <code class="docutils literal"><span class="pre">&#64;Max</span></code> of the existing rules.</div>
<div class="line">However, if the same rules are to be used at multiple places, settings get distributed and maintainability worsens.</div>
</div>
<p>One rule can be created by combining multiple rules.
There is an advantage to be able to have not only common regular expression pattern and maximum/minimum values but also error message when an independent annotation is created.
By this, reusability and maintainability increases. Even if multiple rules are not combined, it also proves beneficial if used only to give specific value to an attribute.</p>
<p>Implementation example is shown below.</p>
<ul>
<li><p class="first">Implementation example of <code class="docutils literal"><span class="pre">&#64;Alphanumeric</span></code> annotation which is restricted to single byte alphanumeric characters</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ReportAsSingleViolation</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Pattern</span><span class="p">;</span>

<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.ANNOTATION_TYPE</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.CONSTRUCTOR</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.FIELD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.METHOD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.PARAMETER</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.RetentionPolicy.RUNTIME</span><span class="p">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="p">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="p">{})</span><span class="c1">// (1)</span>
<span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
<span class="hll"><span class="nd">@ReportAsSingleViolation</span> <span class="c1">// (2)</span>
</span><span class="hll"><span class="nd">@Pattern</span><span class="p">(</span><span class="n">regexp</span> <span class="o">=</span> <span class="s">&quot;[a-zA-Z0-9]*&quot;</span><span class="p">)</span> <span class="c1">// (3)</span>
</span><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">AlphaNumeric</span> <span class="p">{</span>
<span class="hll">    <span class="n">String</span> <span class="nf">message</span><span class="p">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.common.validation.AlphaNumeric.message}&quot;</span><span class="p">;</span> <span class="c1">// (4)</span>
</span>
    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
    <span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="p">{</span>
        <span class="n">AlphaNumeric</span><span class="o">[]</span> <span class="nf">value</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When implementing using existing annotations, <code class="docutils literal"><span class="pre">validatedBy</span></code>needs to be empty</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">This will consolidate error messages and return only the message of this annotation at the time of error.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define rules used by this annotation.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define default value of error message.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Implementation example of <code class="docutils literal"><span class="pre">&#64;NotNegative</span></code> annotation which is restricted to positive number</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ReportAsSingleViolation</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Min</span><span class="p">;</span>

<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.ANNOTATION_TYPE</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.CONSTRUCTOR</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.FIELD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.METHOD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.PARAMETER</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.RetentionPolicy.RUNTIME</span><span class="p">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="p">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="p">{})</span>
<span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
<span class="hll"><span class="nd">@ReportAsSingleViolation</span>
</span><span class="hll"><span class="nd">@Min</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</span><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">NotNegative</span> <span class="p">{</span>
<span class="hll">    <span class="n">String</span> <span class="nf">message</span><span class="p">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.common.validation.NotNegative.message}&quot;</span><span class="p">;</span>
</span>
    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
    <span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="p">{</span>
        <span class="n">NotNegative</span><span class="o">[]</span> <span class="nf">value</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Implementation example of <code class="docutils literal"><span class="pre">&#64;UserId</span></code> annotation which regulates the format of “User ID”.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.domain.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ReportAsSingleViolation</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Pattern</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>

<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.ANNOTATION_TYPE</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.CONSTRUCTOR</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.FIELD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.METHOD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.PARAMETER</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.RetentionPolicy.RUNTIME</span><span class="p">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="p">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="p">{})</span>
<span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
<span class="hll"><span class="nd">@ReportAsSingleViolation</span>
</span><span class="hll"><span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
</span><span class="hll"><span class="nd">@Pattern</span><span class="p">(</span><span class="n">regexp</span> <span class="o">=</span> <span class="s">&quot;[a-z]*&quot;</span><span class="p">)</span>
</span><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">UserId</span> <span class="p">{</span>
<span class="hll">    <span class="n">String</span> <span class="nf">message</span><span class="p">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.sample.domain.validation.UserId.message}&quot;</span><span class="p">;</span>
</span>
    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
    <span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="p">{</span>
        <span class="n">UserId</span><span class="o">[]</span> <span class="nf">value</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Implementation example of <code class="docutils literal"><span class="pre">&#64;Age</span></code> annotation which regulates the constraints on “Age”</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.domain.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ReportAsSingleViolation</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Max</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Min</span><span class="p">;</span>

<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.ANNOTATION_TYPE</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.CONSTRUCTOR</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.FIELD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.METHOD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.PARAMETER</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.RetentionPolicy.RUNTIME</span><span class="p">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="p">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="p">{})</span>
<span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
<span class="hll"><span class="nd">@ReportAsSingleViolation</span>
</span><span class="hll"><span class="nd">@Min</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class="hll"><span class="nd">@Max</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>
</span><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">Age</span> <span class="p">{</span>
<span class="hll">    <span class="n">String</span> <span class="nf">message</span><span class="p">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.sample.domain.validation.Age.message}&quot;</span><span class="p">;</span>
</span>
    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
    <span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="p">{</span>
        <span class="n">Age</span><span class="o">[]</span> <span class="nf">value</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If multiple rules are set in a single annotation, their AND condition forms the composite annotation.
In Hibernate Validator, <code class="docutils literal"><span class="pre">&#64;ConstraintComposition</span></code> annotation is provided to implement OR condition.
Refer to <a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.2/reference/en-US/html/ch11.html#section-boolean-constraint-composition">Hibernate Validator document</a> for details.</p>
<div class="last line-block">
<div class="line"><br /></div>
</div>
</div>
</li>
</ul>
</div>
<div class="section" id="how-to-check-the-values-in-the-collection-using-bean-validation-s-annotation">
<span id="validation-for-parameter-object-in-collection-corresponding-annotation"></span><h3><a class="toc-backref" href="#id22">4.1.3.2. How to check the values in the collection using Bean Validation’s annotation</a><a class="headerlink" href="#how-to-check-the-values-in-the-collection-using-bean-validation-s-annotation" title="Permalink to this headline">¶</a></h3>
<p>When dealing with multiple selectable screen items (such as checkboxes and multiple selection dropdown), it is common to treat screen items as collections of basic types such as <code class="docutils literal"><span class="pre">String</span></code>in form classes.
In the standard specification of Bean Validation, each value in the collection can not be checked by using Bean Validation annotation, but by using original features of Java SE 8 and Hibernate Validator, or if original functions of Java SE 8 and Hibernate Validator are not used, a wrapper class for the value of the screen item can be created and it can be treated as a collection so that the value in the collection using Bean Validation can be checked.</p>
<p>Here, annotations to check whether the input value provided by the common library is a code value defined in the code list,
input checking for Strings in the collection using <code class="docutils literal"><span class="pre">org.terasoluna.gfw.common.codelist.ExistInCodeList</span></code>is explained as an example.</p>
<p>Implementation method for matching <code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code>annotation with multiple selectable screen items (check boxes, multiple selection drop down, etc.) is shown below.</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><a class="reference internal" href="#validation-exist-in-codelist-javase8"><span class="std std-ref">Implementation with Java SE 8 and Hibernate Validator 5.2+</span></a></dt>
<dd>Method of implementing original annotations that can be added to <code class="docutils literal"><span class="pre">List</span></code>of <code class="docutils literal"><span class="pre">String</span></code>by using the original functions of Java SE 8 and Hibernate Validator.
<strong>It is easier and simpler to implement than the latter, so we recommend this method in environments where the original features of Java SE 8 and Hibernate Validator can be used.</strong> In addition, this method will be standardized in the future version of Bean Validation in future.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="#validation-exist-in-codelist-formatter"><span class="std std-ref">Implementation of wrapper class of String using Java bean</span></a></dt>
<dd>Method of setting the <code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code>annotation for the property wrapped in the Java bean class.
For users who do not use Java SE 8 and Hibernate Validator’s original features. In environments where the original features of Java SE 8 and Hibernate Validator can be used, <a class="reference internal" href="#validation-exist-in-codelist-javase8"><span class="std std-ref">Implementation with Java SE 8 and Hibernate Validator 5.2+</span></a>is recommended.</dd>
</dl>
</li>
</ul>
<div class="section" id="implementation-with-java-se-8-and-hibernate-validator-5-2">
<span id="validation-exist-in-codelist-javase8"></span><h4><a class="toc-backref" href="#id23">4.1.3.2.1. Implementation with Java SE 8 and Hibernate Validator 5.2+</a><a class="headerlink" href="#implementation-with-java-se-8-and-hibernate-validator-5-2" title="Permalink to this headline">¶</a></h4>
<p>Here,by creating original annotation <code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code>provided by the common library is wrapped,
and how to make it correspond to collection is shown.</p>
<p><code class="docutils literal"><span class="pre">java.lang.annotation.ElementType.TYPE_USE</span></code>has been added in Java SE 8.
This makes it possible to add annotations to not only declarations of conventional classes and methods, but also general types (types of local variables, etc.),
Hibernate Validator 5.2+ for Java SE 8 supports constraint annotations attached to parameterized types such as <code class="docutils literal"><span class="pre">Collection</span></code>, <code class="docutils literal"><span class="pre">Map</span></code>, <code class="docutils literal"><span class="pre">Optional</span></code>.By reading it, it is possible to check the values in the collection.</p>
<p>By combining Java SE 8 with Hibernate Validator 5.2+, like <code class="docutils literal"><span class="pre">List&lt;&#64;NotNullForTypeArgument</span> <span class="pre">String&gt;</span></code>,
Annotations that can be added to the type specification part of the list can be created, and the values in the collection can be checked.
For details,please refer Hibernate Validator document(<a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.2/reference/en-US/html_single/#type-arguments-constraints">Type argument constraints</a>).</p>
<p><code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code>provided by the common library does not correspond to <code class="docutils literal"><span class="pre">TYPE_USE</span></code>because it is Java SE 7 compatible,
By creating original annotation that can be added to the type specifying part of the list as described above, it is possible to check the value in the collection.</p>
<p>The main steps are as follows.</p>
<ul class="simple">
<li>Use “TYPE_USE” and implement annotations extending <code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code>which can be added to the type usage place.</li>
<li>Set the annotation to be checked.</li>
</ul>
<p>Input check for Role (<code class="docutils literal"><span class="pre">List</span></code>of <code class="docutils literal"><span class="pre">String</span></code>) that can set multiple items is used as an example to explain.</p>
<p>Multiple item configurable Role</p>
<p>Implementation example of <code class="docutils literal"><span class="pre">&#64;ExistInCodeListForTypeArgument</span></code>which can be added to type usage.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="p">;</span>

<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.TYPE_USE</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.RetentionPolicy.RUNTIME</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.OverridesAttribute</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ReportAsSingleViolation</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.codelist.ExistInCodeList</span><span class="p">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="p">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="p">{})</span>
<span class="nd">@Target</span><span class="p">(</span><span class="n">TYPE_USE</span><span class="p">)</span> <span class="c1">// (1)</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
<span class="nd">@ReportAsSingleViolation</span>
<span class="nd">@ExistInCodeList</span><span class="p">(</span><span class="n">codeListId</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="c1">// (2)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">ExistInCodeListForTypeArgument</span> <span class="p">{</span>
    <span class="n">String</span> <span class="nf">message</span><span class="p">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.common.validation.ExistInCodeListForTypeArgument.message}&quot;</span><span class="p">;</span> <span class="c1">// (3)</span>

    <span class="nd">@OverridesAttribute</span><span class="p">(</span><span class="n">constraint</span> <span class="o">=</span> <span class="n">ExistInCodeList</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;codeListId&quot;</span><span class="p">)</span> <span class="c1">// (4)</span>
    <span class="n">String</span> <span class="nf">codeListId</span><span class="p">();</span>


    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="nd">@Target</span><span class="p">(</span><span class="n">TYPE_USE</span><span class="p">)</span> <span class="c1">// (1)</span>
    <span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
    <span class="nd">@Documented</span>
    <span class="nd">@interface</span> <span class="n">List</span> <span class="p">{</span>
        <span class="n">ExistInCodeListForTypeArgument</span><span class="o">[]</span> <span class="nf">value</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set <code class="docutils literal"><span class="pre">TYPE_USE</span></code>, so that this annotation can be added at the type usage place.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define the rules (<code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code>) used by this annotation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define the default value of the error message. Also define any error message in ValidationMessages.properties.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Override the <code class="docutils literal"><span class="pre">codeListId</span></code> attribute of the <code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code>annotation.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first">Form class</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.example.common.validation.ExistInCodeListForTypeArgument</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleForm</span> <span class="p">{</span>
    <span class="nd">@NotNull</span>
    <span class="nd">@Valid</span> <span class="c1">// (1)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="nd">@ExistInCodeListForTypeArgument</span><span class="p">(</span><span class="n">codeListId</span> <span class="o">=</span> <span class="s">&quot;CL_ROLE&quot;</span><span class="p">)</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">roles</span><span class="p">;</span> <span class="c1">// (2)</span>

    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">getRoles</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roles</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setRoles</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">roles</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">roles</span> <span class="o">=</span> <span class="n">roles</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Give <code class="docutils literal"><span class="pre">javax.validation.Valid</span></code>annotation to enable input checking of element values in <code class="docutils literal"><span class="pre">List</span></code></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set the <code class="docutils literal"><span class="pre">&#64;ExistInCodeListForTypeArgument</span></code>annotation for the type specification part of the collection to be checked for input.</div>
<div class="line">Specify the code list as the check source in the <code class="docutils literal"><span class="pre">codeListId</span></code> parameter of the annotation.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first">JSP</p>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;sampleForm&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;form:checkboxes</span> <span class="na">path=</span><span class="s">&quot;roles&quot;</span> <span class="na">items=</span><span class="s">&quot;${CL_ROLE}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;roles*&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;form:button&gt;</span>Submit<span class="nt">&lt;/form:button&gt;</span>
<span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Implement <code class="docutils literal"><span class="pre">&lt;form:checkboxes&gt;</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementation-of-wrapper-class-of-string-using-java-bean">
<span id="validation-exist-in-codelist-formatter"></span><h4><a class="toc-backref" href="#id24">4.1.3.2.2. Implementation of wrapper class of String using Java bean</a><a class="headerlink" href="#implementation-of-wrapper-class-of-string-using-java-bean" title="Permalink to this headline">¶</a></h4>
<p>The implementation introduced here is for users who do not use Java SE 8 and Hibernate Validator’s original functions. In environments where the original features of Java SE 8 and Hibernate Validator can be used, <a class="reference internal" href="#validation-exist-in-codelist-javase8"><span class="std std-ref">Implementation with Java SE 8 and Hibernate Validator 5.2+</span></a>is recommended.</p>
<p>Since you can not use Bean Validation annotation for elements in the collection as described above when Java SE 8 and Hibernate Validator’s original functions are not used,
<code class="docutils literal"><span class="pre">String</span></code>is wrapped with a Java bean and input check is done by appending <code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code>to the property of the nested bean.</p>
<p>When using a Spring-supplied tag library for a wrapper class, it is necessary to perform type conversion between a character string and a wrapper class in order to bind to a form. This is a <cite>type conversion mechanism provided by Spring (Formatter) &lt;http://docs.spring.io/spring/docs/4.3.5.RELEASE/spring-framework-reference/htmlsingle/#format&gt;</cite> _
is used for implementation.</p>
<p>By adding a type conversion from <code class="docutils literal"><span class="pre">String</span></code>to <code class="docutils literal"><span class="pre">Role</span></code>, <code class="docutils literal"><span class="pre">Role</span></code>to <code class="docutils literal"><span class="pre">String</span></code>in Formatter,as with <code class="docutils literal"><span class="pre">List&lt;String&gt;</span></code>,
it can be implemented using  <code class="docutils literal"><span class="pre">&lt;form:checkboxes&gt;</span></code>without complicated implementation.</p>
<p>The main steps are as follows.</p>
<ul class="simple">
<li>Set the <code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code>annotation for checking.</li>
<li>Create a class that implements the <code class="docutils literal"><span class="pre">Formatter</span></code>class which is the interface for conversion.</li>
<li>Using <code class="docutils literal"><span class="pre">ConversionServiceFactoryBean</span></code>register the created <code class="docutils literal"><span class="pre">Formatter</span></code>in Spring.</li>
</ul>
<p>Also, in order to display items that have been successfully selected with <code class="docutils literal"><span class="pre">&lt;form:checkboxes&gt;</span></code>, you need to override the <code class="docutils literal"><span class="pre">toString</span></code>method of the wrapper class in addition to the Formatter implementation .</p>
<p><code class="docutils literal"><span class="pre">&lt;form:checkboxes&gt;</span></code>displays the elements of the collection specified by the <code class="docutils literal"><span class="pre">items</span></code>attribute as selected items, if the value of the selected item specified by the <code class="docutils literal"><span class="pre">path</span></code>attribute matches with the value of the property, it is displayed as the selected item.
To determine this consistency, Formatter is used when the property is a single item, and in the case of an array or collection, the result of the <code class="docutils literal"><span class="pre">toString</span></code>method of the specified property is used.</p>
<p>In order to display it as a selected item successfully, you need to override the <code class="docutils literal"><span class="pre">toString</span></code>method in a wrapper class and return the wrapped value string as in the example below.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For details, please refer the actual determination method of selected <code class="docutils literal"><span class="pre">org.springframework.web.servlet.tags.form.SelectedValueComparator</span></code>class’s <a class="reference external" href="https://github.com/spring-projects/spring-framework/blob/v4.3.5.RELEASE/spring-webmvc/src/main/java/org/springframework/web/servlet/tags/form/SelectedValueComparator.java">javadoc</a></p>
</div>
<p>Input check for <code class="docutils literal"><span class="pre">Role</span></code>(Java Bean’s <code class="docutils literal"><span class="pre">List</span></code>) that can set multiple items is used as an example for explaination.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first">Form class</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.Valid</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.example.sample.domain.model.Role</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleForm</span> <span class="p">{</span>
    <span class="nd">@NotNull</span>
    <span class="nd">@Valid</span> <span class="c1">// (1)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;</span> <span class="n">roles</span><span class="p">;</span> <span class="c1">// (2)</span>

    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;</span> <span class="nf">getRoles</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roles</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setRoles</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;</span> <span class="n">roles</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">roles</span> <span class="o">=</span> <span class="n">roles</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">javax.validation.Valid</span></code>annotation to enable bean validation of nested beans.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">You cannot add <code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code>to <code class="docutils literal"><span class="pre">List</span></code>of  <code class="docutils literal"><span class="pre">String</span></code>but
by wrapping <code class="docutils literal"><span class="pre">String</span></code>with a Java bean you can add <code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code>to the nested bean’s <code class="docutils literal"><span class="pre">String</span></code>property.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first">JavaBean class</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.domain.model</span>

<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.codelist.ExistInCodeList</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Role</span> <span class="p">{</span>
    <span class="nd">@ExistInCodeList</span><span class="p">(</span><span class="n">codeListId</span> <span class="o">=</span> <span class="s">&quot;CL_ROLE&quot;</span><span class="p">)</span> <span class="c1">// (1)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">value</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getValue</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">value</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setValue</span><span class="p">(</span><span class="n">String</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span> <span class="c1">// (2)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">getValue</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set the <code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code>annotation for the property wrapped in the <code class="docutils literal"><span class="pre">Role</span></code>class to perform input check, and specify the code list to check <code class="docutils literal"><span class="pre">codeListId</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Override in order to draw the screen properly when multiple selection is made and return the character string of the wrapped value.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Implement the Formatter class that performs type conversion and register it in Spring.</p>
<p>As mentioned above, it is necessary to wrap <code class="docutils literal"><span class="pre">String</span></code>with <code class="docutils literal"><span class="pre">Role</span></code>(Java bean) to perform input checking.
Implement type conversion by <code class="docutils literal"><span class="pre">Formatter</span></code>to convert from screen input (<code class="docutils literal"><span class="pre">String</span></code>) to wrapped <code class="docutils literal"><span class="pre">Role</span></code>and vice versa.</p>
<p>By adding type conversion, mutual conversion between <code class="docutils literal"><span class="pre">String</span></code>and <code class="docutils literal"><span class="pre">Role</span></code>is done automatically.
On the Controller side, it is treated as <code class="docutils literal"><span class="pre">List</span></code>of <code class="docutils literal"><span class="pre">Role</span></code>, on JSP side  <code class="docutils literal"><span class="pre">List</span></code>of <code class="docutils literal"><span class="pre">String</span></code>.</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">Formatter</span></code>class</p>
<p>Implementation of <code class="docutils literal"><span class="pre">Formatter</span></code>which performs mutual conversion between <code class="docutils literal"><span class="pre">String</span></code>and <code class="docutils literal"><span class="pre">Role</span></code>.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation.formatter</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.text.ParseException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Locale</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.format.Formatter</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.example.usermanagement.domain.model.Role</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RoleFormatter</span> <span class="kd">implements</span> <span class="n">Formatter</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;</span> <span class="p">{</span> <span class="c1">//(1)</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">print</span><span class="p">(</span><span class="n">Role</span> <span class="n">source</span><span class="p">,</span> <span class="n">Locale</span> <span class="n">locale</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">source</span><span class="p">.</span><span class="na">getValue</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Role</span> <span class="nf">parse</span><span class="p">(</span><span class="n">String</span> <span class="n">source</span><span class="p">,</span> <span class="n">Locale</span> <span class="n">locale</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">ParseException</span> <span class="p">{</span>
        <span class="n">Role</span> <span class="n">role</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Role</span><span class="p">();</span>
        <span class="n">role</span><span class="p">.</span><span class="na">setValue</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">role</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Implement the interface <code class="docutils literal"><span class="pre">org.springframework.format.Formatter&lt;T&gt;</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first">Bean definition for applying original <code class="docutils literal"><span class="pre">Formatter</span></code></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;conversionService&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.springframework.format.support.FormattingConversionServiceFactoryBean&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;formatters&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;list&gt;</span>
            <span class="c">&lt;!-- (2) --&gt;</span>
            <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;com.example.sample.app.validation.formatter.RoleFormatter&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/list&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- (3) --&gt;</span>
<span class="nt">&lt;mvc:annotation-driven</span> <span class="na">conversion-service=</span><span class="s">&quot;conversionService&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/mvc:annotation-driven&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add bean definition of <code class="docutils literal"><span class="pre">FormattingConversionServiceFactoryBean</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set the created Formatter class(<code class="docutils literal"><span class="pre">RoleFormatter</span></code>).</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">To use the customized type conversion, set the bean defined in (1) to the <code class="docutils literal"><span class="pre">conversion-service</span></code>attribute of <code class="docutils literal"><span class="pre">mvc:annotation-driven</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first">JSP</p>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;sampleForm&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;form:checkboxes</span> <span class="na">path=</span><span class="s">&quot;roles&quot;</span> <span class="na">items=</span><span class="s">&quot;${CL_ROLE}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;roles*&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;form:button&gt;</span>Submit<span class="nt">&lt;/form:button&gt;</span>
<span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;form:checkboxes&gt;</span></code>can be used same as <code class="docutils literal"><span class="pre">List&lt;String&gt;</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="creation-of-bean-validation-annotation-by-implementing-new-rules">
<span id="validation-implement-new-constraint"></span><h3><a class="toc-backref" href="#id25">4.1.3.3. Creation of Bean Validation annotation by implementing new rules</a><a class="headerlink" href="#creation-of-bean-validation-annotation-by-implementing-new-rules" title="Permalink to this headline">¶</a></h3>
<p>Any rule can be created by implementing <code class="docutils literal"><span class="pre">javax.validation.ConstraintValidator</span></code> interface and creating annotation that uses this Validator.</p>
<p>The following 3 ways can be cited as applications.</p>
<ul class="simple">
<li>Rules that cannot be implemented by combining the existing rules</li>
<li>check rule for correlated items</li>
<li>Business logic check</li>
</ul>
<div class="section" id="rules-that-cannot-be-implemented-by-combining-the-existing-rules">
<span id="validation-cannot-expressed-existing"></span><h4><a class="toc-backref" href="#id26">4.1.3.3.1. Rules that cannot be implemented by combining the existing rules</a><a class="headerlink" href="#rules-that-cannot-be-implemented-by-combining-the-existing-rules" title="Permalink to this headline">¶</a></h4>
<p>For the rules that cannot be implemented by combining <code class="docutils literal"><span class="pre">&#64;Pattern</span></code>, <code class="docutils literal"><span class="pre">&#64;Size</span></code>, <code class="docutils literal"><span class="pre">&#64;Min</span></code>, <code class="docutils literal"><span class="pre">&#64;Max</span></code>, implement <code class="docutils literal"><span class="pre">javax.validation.ConstraintValidator</span></code>.</p>
<p>For example, rules that check ISBN (International Standard Book Number)-13 format are given.</p>
<ul>
<li><p class="first">Annotation</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.ANNOTATION_TYPE</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.CONSTRUCTOR</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.FIELD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.METHOD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.PARAMETER</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.RetentionPolicy.RUNTIME</span><span class="p">;</span>

<span class="nd">@Documented</span>
<span class="hll"><span class="nd">@Constraint</span><span class="p">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="p">{</span> <span class="n">ISBN13Validator</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span> <span class="c1">// (1)</span>
</span><span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">ISBN13</span> <span class="p">{</span>
    <span class="n">String</span> <span class="nf">message</span><span class="p">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.common.validation.ISBN13.message}&quot;</span><span class="p">;</span>

    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
    <span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="p">{</span>
        <span class="n">ISBN13</span><span class="o">[]</span> <span class="nf">value</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the <code class="docutils literal"><span class="pre">ConstraintValidator</span></code> implementation class which will get executed when this annotation is used. Multiple constraints can also be specified.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Validator</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidator</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidatorContext</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ISBN13Validator</span> <span class="kd">implements</span> <span class="n">ConstraintValidator</span><span class="o">&lt;</span><span class="n">ISBN13</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="p">{</span> <span class="c1">// (1)</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">ISBN13</span> <span class="n">constraintAnnotation</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// (2)</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="p">(</span><span class="n">String</span> <span class="n">value</span><span class="p">,</span> <span class="n">ConstraintValidatorContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// (3)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span> <span class="c1">// (4)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">isISBN13Valid</span><span class="p">(</span><span class="n">value</span><span class="p">);</span> <span class="c1">// (5)</span>
    <span class="p">}</span>

    <span class="c1">// This logic is written in http://en.wikipedia.org/wiki/International_Standard_Book_Number</span>
    <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isISBN13Valid</span><span class="p">(</span><span class="n">String</span> <span class="n">isbn</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">isbn</span><span class="p">.</span><span class="na">length</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">13</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">check</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">check</span> <span class="o">+=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">isbn</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">check</span> <span class="o">+=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">isbn</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">3</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">check</span> <span class="o">+=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">isbn</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="mi">12</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">NumberFormatException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">check</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify target annotation and field type in generics parameter.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Implement initialization process in <code class="docutils literal"><span class="pre">initialize</span></code> method.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Implement input validation in <code class="docutils literal"><span class="pre">isValid</span></code> method.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Consider input value as correct in case of <code class="docutils literal"><span class="pre">null</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Check ISBN-13 format.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Example of <a class="reference internal" href="FileUpload.html#fileupload-validator"><span class="std std-ref">Bean Validation of file upload</span></a> is classified in this category. Further, in common library as well, <a class="reference internal" href="Codelist.html#codelist-validate"><span class="std std-ref">&#64;ExistInCodeList</span></a> is implemented in this way.</p>
</div>
</div>
<div class="section" id="check-rules-for-correlated-items">
<span id="validation-correlation-item-check"></span><h4><a class="toc-backref" href="#id27">4.1.3.3.2. Check rules for correlated items</a><a class="headerlink" href="#check-rules-for-correlated-items" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Check of correlated items, which span over multiple fields, can be done using Bean Validation as explained in  <a class="reference internal" href="#validation-correlation-check"><span class="std std-ref">Correlation item check</span></a>.</div>
<div class="line">It is recommended to target generalized rules, in case of deciding to use Bean Validation for check of correlated items.</div>
</div>
<p>An example of implementing the rule, “Contents of a field should match with its confirmation field” is given below.</p>
<p>Set constraint of assigning “confirm” as the prefix of confirmation field.</p>
<ul>
<li><p class="first">Annotation</p>
<p>Define such that annotation for validation of correlated items can be used at class level as well.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.ANNOTATION_TYPE</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.TYPE</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.RetentionPolicy.RUNTIME</span><span class="p">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="p">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="p">{</span> <span class="n">ConfirmValidator</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
<span class="hll"><span class="nd">@Target</span><span class="p">({</span> <span class="n">TYPE</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span> <span class="p">})</span> <span class="c1">// (1)</span>
</span><span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">Confirm</span> <span class="p">{</span>
    <span class="n">String</span> <span class="nf">message</span><span class="p">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.common.validation.Confirm.message}&quot;</span><span class="p">;</span>

    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="cm">/**</span>
<span class="cm">     * Field name</span>
<span class="cm">     */</span>
<span class="hll">    <span class="n">String</span> <span class="nf">field</span><span class="p">();</span> <span class="c1">// (2)</span>
</span>
    <span class="nd">@Target</span><span class="p">({</span> <span class="n">TYPE</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span> <span class="p">})</span>
    <span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="p">{</span>
        <span class="n">Confirm</span><span class="o">[]</span> <span class="nf">value</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Narrow down the target of using this annotation, such that it can be added only to class or annotation.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define parameter to pass to annotation.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Validator</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidator</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidatorContext</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.BeanWrapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.BeanWrapperImpl</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.util.ObjectUtils</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.util.StringUtils</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConfirmValidator</span> <span class="kd">implements</span> <span class="n">ConstraintValidator</span><span class="o">&lt;</span><span class="n">Confirm</span><span class="p">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">field</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">confirmField</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span><span class="p">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">Confirm</span> <span class="n">constraintAnnotation</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">constraintAnnotation</span><span class="p">.</span><span class="na">field</span><span class="p">();</span>
        <span class="n">confirmField</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span> <span class="o">+</span> <span class="n">StringUtils</span><span class="p">.</span><span class="na">capitalize</span><span class="p">(</span><span class="n">field</span><span class="p">);</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">constraintAnnotation</span><span class="p">.</span><span class="na">message</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="p">(</span><span class="n">Object</span> <span class="n">value</span><span class="p">,</span> <span class="n">ConstraintValidatorContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">BeanWrapper</span> <span class="n">beanWrapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BeanWrapperImpl</span><span class="p">(</span><span class="n">value</span><span class="p">);</span> <span class="c1">// (1)</span>
        <span class="n">Object</span> <span class="n">fieldValue</span> <span class="o">=</span> <span class="n">beanWrapper</span><span class="p">.</span><span class="na">getPropertyValue</span><span class="p">(</span><span class="n">field</span><span class="p">);</span> <span class="c1">// (2)</span>
        <span class="n">Object</span> <span class="n">confirmFieldValue</span> <span class="o">=</span> <span class="n">beanWrapper</span><span class="p">.</span><span class="na">getPropertyValue</span><span class="p">(</span><span class="n">confirmField</span><span class="p">);</span>
        <span class="kt">boolean</span> <span class="n">matched</span> <span class="o">=</span> <span class="n">ObjectUtils</span><span class="p">.</span><span class="na">nullSafeEquals</span><span class="p">(</span><span class="n">fieldValue</span><span class="p">,</span>
                <span class="n">confirmFieldValue</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">matched</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">context</span><span class="p">.</span><span class="na">disableDefaultConstraintViolation</span><span class="p">();</span> <span class="c1">// (3)</span>
            <span class="n">context</span><span class="p">.</span><span class="na">buildConstraintViolationWithTemplate</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                    <span class="p">.</span><span class="na">addPropertyNode</span><span class="p">(</span><span class="n">field</span><span class="p">).</span><span class="na">addConstraintViolation</span><span class="p">();</span> <span class="c1">// (4)</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Use <code class="docutils literal"><span class="pre">org.springframework.beans.BeanWrapper</span></code> which is very convenient to access JavaBean properties.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Acquire property value from the form object through <code class="docutils literal"><span class="pre">BeanWrapper</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Disable the creation of default <code class="docutils literal"><span class="pre">ConstraintViolation</span></code> object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create an independent <code class="docutils literal"><span class="pre">ConstraintViolation</span></code> object.</div>
<div class="line">Define message to be output in <code class="docutils literal"><span class="pre">ConstraintValidatorContext.buildConstraintViolationWithTemplate</span></code>.</div>
<div class="line">Specify field name to output error message in <code class="docutils literal"><span class="pre">ConstraintViolationBuilder.addPropertyNode</span></code>.</div>
<div class="line">Refer to <a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/validation/ConstraintValidatorContext.html">JavaDoc of ConstraintValidatorContext</a> for details.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<blockquote>
<div><div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><code class="docutils literal"><span class="pre">ConstraintViolationBuilder.addPropertyNode</span></code> method has been added from the Bean Validation 1.1.</p>
<p><code class="docutils literal"><span class="pre">ConstraintViolationBuilder.addNode</span></code> method had been used in Bean Validation 1.0; however, it is a deprecated API from Bean Validation 1.1.</p>
<p class="last">For deprecated API of Bean Validation, refer to <a class="reference external" href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/deprecated-list.html">Bean Validation API Document (Deprecated API)</a>.</p>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>As introduced in correlation item  check using Spring Validator, even in Bean Validation,
<a class="reference internal" href="#validation-how-to-cross-field-validation-for-multi-field-highlight"><span class="std std-ref">Set error information for multiple fields for correlation check</span></a> can be performed.</p>
<p>An example is shown below wherein styles are applied to <code class="docutils literal"><span class="pre">password</span></code>field and <code class="docutils literal"><span class="pre">confirmPassword</span></code>field in Bean Validation and error message is displayed only for <code class="docutils literal"><span class="pre">password</span></code>field.</p>
<blockquote class="last">
<div><div class="highlight-java"><div class="highlight"><pre><span></span><span class="c1">// omitted</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConfirmValidator</span> <span class="kd">implements</span> <span class="n">ConstraintValidator</span><span class="o">&lt;</span><span class="n">Confirm</span><span class="p">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">field</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">confirmField</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span><span class="p">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">Confirm</span> <span class="n">constraintAnnotation</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// omitted</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="p">(</span><span class="n">Object</span> <span class="n">value</span><span class="p">,</span> <span class="n">ConstraintValidatorContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// omitted</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">matched</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">context</span><span class="p">.</span><span class="na">disableDefaultConstraintViolation</span><span class="p">();</span>

            <span class="c1">//new ConstraintViolation to be generated for field</span>
            <span class="n">context</span><span class="p">.</span><span class="na">buildConstraintViolationWithTemplate</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                    <span class="p">.</span><span class="na">addPropertyNode</span><span class="p">(</span><span class="n">field</span><span class="p">).</span><span class="na">addConstraintViolation</span><span class="p">();</span>

            <span class="c1">//new ConstraintViolation to be generated for confirmField</span>
            <span class="n">context</span><span class="p">.</span><span class="na">buildConstraintViolationWithTemplate</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span> <span class="c1">// (1)</span>
                    <span class="p">.</span><span class="na">addPropertyNode</span><span class="p">(</span><span class="n">confirmField</span><span class="p">).</span><span class="na">addConstraintViolation</span><span class="p">();</span>

            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Register error of <code class="docutils literal"><span class="pre">confirmPassword</span></code>field. A null string is set in error message at that time.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<p>Check below for the changes, if the “Reset password” is re-implemented using <code class="docutils literal"><span class="pre">&#64;Confirm</span></code> annotation.</p>
<ul>
<li><p class="first">Form class</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.example.common.validation.Confirm</span><span class="p">;</span>

<span class="nd">@Confirm</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s">&quot;password&quot;</span><span class="p">)</span> <span class="c1">// (1)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordResetForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">confirmPassword</span><span class="p">;</span>

    <span class="c1">// omitted getter/setter</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;Confirm</span></code> annotation at class level.</div>
<div class="line">By this, form object is passed as an argument to <code class="docutils literal"><span class="pre">ConstraintValidator.isValid</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Controller class</p>
<p>There is no need to inject Validator and add Validator using <code class="docutils literal"><span class="pre">&#64;InitBinder</span></code>.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;password&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordResetController</span> <span class="p">{</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">PasswordResetForm</span> <span class="nf">setupForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">PasswordResetForm</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;reset&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">resetForm</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;password/resetForm&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;reset&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">reset</span><span class="p">(</span><span class="nd">@Validated</span> <span class="n">PasswordResetForm</span> <span class="n">form</span><span class="p">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">hasErrors</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;password/resetForm&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="s">&quot;redirect:/password/reset?complete&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;reset&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;complete&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">resetComplete</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;password/resetComplete&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="business-logic-check">
<span id="validation-business-logic-check"></span><h4><a class="toc-backref" href="#id28">4.1.3.3.3. Business logic check</a><a class="headerlink" href="#business-logic-check" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Business logic check should implement <a class="reference internal" href="../../ImplementationAtEachLayer/DomainLayer.html#service-implementation-label"><span class="std std-ref">Implementation in Service of domain layer</span></a> and store result message in <code class="docutils literal"><span class="pre">ResultMessages</span></code> object.</div>
<div class="line">Accordingly, it is expected that, <a class="reference internal" href="MessageManagement.html#message-display"><span class="std std-ref">they will be normally displayed at the top of the screen</span></a>.</div>
</div>
<p>However, there are cases, where business logic error message (such as, “whether the entered user name is already registered”) of target input field is to be displayed next to the field.
In such a case, service class is injected in Validator class and business logic check is executed in <code class="docutils literal"><span class="pre">ConstraintValidator.isValid</span></code>.</p>
<p>An example of implementing, “whether the entered user name is already registered” in Bean Validation is shown below.</p>
<ul>
<li><p class="first">Service class</p>
<p>Implementation class (UserServiceImpl) is omitted.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.domain.service.user</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserService</span> <span class="p">{</span>

    <span class="kt">boolean</span> <span class="nf">isUnusedUserId</span><span class="p">(</span><span class="n">String</span> <span class="n">userId</span><span class="p">);</span>

    <span class="c1">// omitted other methods</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Annotation</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.domain.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.ANNOTATION_TYPE</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.CONSTRUCTOR</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.FIELD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.METHOD</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.PARAMETER</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.RetentionPolicy.RUNTIME</span><span class="p">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="p">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="p">{</span> <span class="n">UnusedUserIdValidator</span><span class="p">.</span><span class="na">class</span> <span class="p">})</span>
<span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">UnusedUserId</span> <span class="p">{</span>
    <span class="n">String</span> <span class="nf">message</span><span class="p">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.sample.domain.validation.UnusedUserId.message}&quot;</span><span class="p">;</span>

    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="nd">@Target</span><span class="p">({</span> <span class="n">METHOD</span><span class="p">,</span> <span class="n">FIELD</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span><span class="p">,</span> <span class="n">CONSTRUCTOR</span><span class="p">,</span> <span class="n">PARAMETER</span> <span class="p">})</span>
    <span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="p">{</span>
        <span class="n">UnusedUserId</span><span class="o">[]</span> <span class="nf">value</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Validator class</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.domain.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidator</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidatorContext</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.example.sample.domain.service.user.UserService</span><span class="p">;</span>

<span class="hll"><span class="nd">@Component</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UnusedUserIdValidator</span> <span class="kd">implements</span>
                                  <span class="n">ConstraintValidator</span><span class="o">&lt;</span><span class="n">UnusedUserId</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="p">{</span>

<span class="hll">    <span class="nd">@Inject</span> <span class="c1">// (2)</span>
</span><span class="hll">    <span class="n">UserService</span> <span class="n">userService</span><span class="p">;</span>
</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">UnusedUserId</span> <span class="n">constraintAnnotation</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="p">(</span><span class="n">String</span> <span class="n">value</span><span class="p">,</span> <span class="n">ConstraintValidatorContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">userService</span><span class="p">.</span><span class="na">isUnusedUserId</span><span class="p">(</span><span class="n">value</span><span class="p">);</span> <span class="c1">// (3)</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Settings to enable component scan of the Validator class.</div>
<div class="line">Target package must be included in <code class="docutils literal"><span class="pre">&lt;context:component-scan</span> <span class="pre">base-package=&quot;...&quot;</span> <span class="pre">/&gt;</span></code> of Bean definition file.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inject the service class to be called.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return the result of business logic error check. Process should be delegated to service class. Logic must not be written directly in the <code class="docutils literal"><span class="pre">isValid</span></code> method.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="method-validation">
<span id="methodvalidation"></span><h3><a class="toc-backref" href="#id29">4.1.3.4. Method Validation</a><a class="headerlink" href="#method-validation" title="Permalink to this headline">¶</a></h3>
<p>A method to check validity of actual argument and return value of method using Bean Validation, is described.
In order to explain, the method is called Method Validation in this chapter.
While performing defensive programming etc, method I/O should be checked in the class other than Controller.
If Bean Validation library is used at that time, constraint annotation of Bean Validation used in Controller can be reused.</p>
<div class="section" id="application-settings">
<span id="methodvalidationonspringframeworkhowtousesettings"></span><h4><a class="toc-backref" href="#id30">4.1.3.4.1. Application settings</a><a class="headerlink" href="#application-settings" title="Permalink to this headline">¶</a></h4>
<p>When Method Validation offered by Spring Framework is used,
a bean must be defined for <code class="docutils literal"><span class="pre">org.springframework.validation.beanvalidation.MethodValidationPostProcessor</span></code> class offered by Spring Framework.</p>
<p>Bean definition file which defines <code class="docutils literal"><span class="pre">MethodValidationPostProcessor</span></code> differs depending on where you use the Method Validation.</p>
<p>Here, a setup example is given wherein Method Validation is used in the multi-project environment recommended in this guideline.</p>
<p>Setup for both the projects below must be changed</p>
<ul class="simple">
<li>Project (<code class="docutils literal"><span class="pre">projectName-web</span></code>) for application layer</li>
<li>Project (<code class="docutils literal"><span class="pre">projectName-domain</span></code>) for domain layer</li>
<li><code class="file docutils literal"><span class="pre">projectName-domain/src/main/resources/META-INF/spring/projectName-domain.xml</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;validator&quot;</span>
      <span class="na">class=</span><span class="s">&quot;org.springframework.validation.beanvalidation.LocalValidatorFactoryBean&quot;</span><span class="nt">/&gt;</span>

<span class="c">&lt;!-- (2) --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.validation.beanvalidation.MethodValidationPostProcessor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;validator&quot;</span> <span class="na">ref=</span><span class="s">&quot;validator&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">projectName-web/src/main/resources/META-INF/spring/spring-mvc.xml</span></code></li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- (3) --&gt;</span>
<span class="nt">&lt;mvc:annotation-driven</span> <span class="na">validator=</span><span class="s">&quot;validator&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/mvc:annotation-driven&gt;</span>

<span class="c">&lt;!-- (4) --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.validation.beanvalidation.MethodValidationPostProcessor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;validator&quot;</span> <span class="na">ref=</span><span class="s">&quot;validator&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
</div></blockquote>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Define a bean for <code class="docutils literal"><span class="pre">LocalValidatorFactoryBean</span></code>.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><p class="first">Define a bean for <code class="docutils literal"><span class="pre">MethodValidationPostProcessor</span></code> and ensure that
Method Validation is executed for a domain layer class method.</p>
<p class="last">Specify a bean defined in (1), in <code class="docutils literal"><span class="pre">validator</span></code> property.</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><p class="first">Specify a bean defined in (1), in the <code class="docutils literal"><span class="pre">validator</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;mvc:annotation-driven&gt;</span></code> element.</p>
<p class="last">A <code class="docutils literal"><span class="pre">Validator</span></code> instance is generated that is different from the instance created in (1) in the absence of this setup.</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><p class="first">Define a bean for <code class="docutils literal"><span class="pre">MethodValidationPostProcessor</span></code> and ensure that
Method Validation is executed for an application layer class method.</p>
<p class="last">Specify Bean defined in (1), in <code class="docutils literal"><span class="pre">validator</span></code> property.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><code class="docutils literal"><span class="pre">LocalValidatorFactoryBean</span></code> is a class to generate a wrapper <code class="docutils literal"><span class="pre">Validator</span></code> object
in order to link <code class="docutils literal"><span class="pre">Validator</span></code> class provided by Bean Validation(Hibernate Validator) and Spring Framework.</p>
<p class="last">By using the wrapper <code class="docutils literal"><span class="pre">Validator</span></code> generated by this class,
message management function (<code class="docutils literal"><span class="pre">MessageSource</span></code>) offered by Spring Framework and DI container can be linked.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>In Spring Framework, Method Validation for calling the method of Bean which is managed by DI container is executed
by using AOP system.</p>
<p class="last"><code class="docutils literal"><span class="pre">MethodValidationPostProcessor</span></code> is a class to apply AOP in order to execute Method Validation.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the example above, an identical <code class="docutils literal"><span class="pre">Validator</span></code> object (instance) is set for <code class="docutils literal"><span class="pre">validator</span></code> property of each Bean, but
this is not necessarily required.
However, it is recommended to set an identical object (instance) unless there is a reason to do otherwise.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="how-to-define-for-the-method-for-method-validation-target">
<span id="methodvalidationonspringframeworkhowtouseapplytarget"></span><h4><a class="toc-backref" href="#id31">4.1.3.4.2. How to define for the method for Method Validation target</a><a class="headerlink" href="#how-to-define-for-the-method-for-method-validation-target" title="Permalink to this headline">¶</a></h4>
<p>When Method Validation is applied to the method,
annotation which indicates inclusion of target method and the constraint annotation of Bean Validation should be specified in class level
and, method and dummy argument respectively.</p>
<p>AOP which executes Method Validation is not applicable for “<a class="reference internal" href="#methodvalidationonspringframeworkhowtousesettings"><span class="std std-ref">Application settings</span></a>”.
It is necessary to assign <code class="docutils literal"><span class="pre">&#64;</span> <span class="pre">org.springframework.validation.annotation.Validated</span></code> annotation to interface or class in order to apply AOP which executes Method Validation.</p>
<p>Here, a method to specify an annotation for interface is introduced.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.domain.service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="p">;</span>

<span class="nd">@Validated</span> <span class="c1">// (1)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">HelloService</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">Specify <code class="docutils literal"><span class="pre">Validated</span></code> annotation in the interface acting as a target for Method Validation.</p>
<p class="last">In the example above, AOP which executes Method Validation is applied to implementation method of <code class="docutils literal"><span class="pre">HelloService</span></code> interface.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>By specifying a group interface in <code class="docutils literal"><span class="pre">value</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation,
a validation belonging to a specified group can alone be executed as well.</p>
<p>Further, the validation groups can be changed for each method by assigning <code class="docutils literal"><span class="pre">Validated</span></code> annotation in method level.</p>
<p class="last">Refer “<a class="reference internal" href="#validationgroupvalidation"><span class="std std-ref">Grouped validation</span></a>” for validation group.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Next, a method is described wherein constraint annotation of Bean Validation is specified in the method and dummy argument.
Basically,</p>
<p>Specify constraint annotation of Bean Validation for</p>
<ul class="simple">
<li>Method arguments</li>
<li>JavaBean field specified in method argument</li>
</ul>
<p>and constraint annotation of Bean Validation for</p>
<ul class="simple">
<li>Return value of method</li>
<li>JavaBean field returned as return value of method.</li>
</ul>
<p>A basic specification method is described below.
A method to specify annotation in the interface is introduced in the description hereafter.</p>
<p>First, a method that specifies constraint annotation is described for the method using basic types (primitive type or primitive wrapper type etc) as a signature of the method</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.domain.service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>

<span class="nd">@Validated</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">HelloService</span> <span class="p">{</span>

    <span class="c1">// (2)</span>
    <span class="nd">@NotNull</span>
    <span class="n">String</span> <span class="nf">hello</span><span class="p">(</span><span class="nd">@NotNull</span> <span class="cm">/* (1) */</span> <span class="n">String</span> <span class="n">message</span><span class="p">);</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">Specify a constraint annotation of Bean Validation as an argument annotation of method.</p>
<p class="last"><code class="docutils literal"><span class="pre">&#64;NotNull</span></code> is a constraint that signifies that <code class="docutils literal"><span class="pre">message</span></code> argument does not allow Null value.
When Null value is specified in the argument, <code class="docutils literal"><span class="pre">javax.validation.ConstraintViolationException</span></code> is thrown.</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><p class="first">Specify constraint annotation of Bean Validatio as a method annotation.</p>
<p class="last">In the above example, it is shown that the return value is not a Null value,
when Null value is returned as a return value, <code class="docutils literal"><span class="pre">javax.validation.ConstraintViolationException</span></code> is thrown.</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Next, a method that specifies constraint annotation of Bean Validation is described  for the method using JavaBean as a signature of method.</p>
<p>Here, a method which species annotation for interface is introduced.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The main point is to specify <code class="docutils literal"><span class="pre">&#64;javax.validation.Valid</span></code> annotation.
The specification method is described below in detail using sample code.</p>
</div>
<p><strong>Service interface</strong></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.domain.service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>

<span class="nd">@Validated</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">HelloService</span> <span class="p">{</span>

    <span class="nd">@NotNull</span> <span class="c1">// (3)</span>
    <span class="nd">@Valid</span>   <span class="c1">// (4)</span>
    <span class="n">HelloOutput</span> <span class="nf">hello</span><span class="p">(</span><span class="nd">@NotNull</span> <span class="cm">/* (1) */</span> <span class="nd">@Valid</span> <span class="cm">/* (2) */</span> <span class="n">HelloInput</span> <span class="n">input</span><span class="p">);</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">Specify constraint annotation of Bean Validation as an argument annotation.</p>
<p class="last">It indicates that <code class="docutils literal"><span class="pre">input</span></code> argument (JavaBean) does not allow Null value.
When Null value is specified in the argument, <code class="docutils literal"><span class="pre">javax.validation.ConstraintViolationException</span></code> is thrown.</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><p class="first">Specify <code class="docutils literal"><span class="pre">&#64;javax.validation.Valid</span></code> annotation as an argument annotation of method.</p>
<p class="last">By assigning <code class="docutils literal"><span class="pre">&#64;Valid</span></code> annotation, constraint annotation of Bean Validation specified in JavaBean field of argument becomes valid.
When the constraint specified in JavaBean is not fulfilled, <code class="docutils literal"><span class="pre">javax.validation.ConstraintViolationException</span></code> is thrown.</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><p class="first">Specify constraint annotation of Bean Validation as a method annotation.</p>
<p class="last">It indicates that JavaBean of return value is not Null value.
When Null value is returned as a return value, an exception is thrown.</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><p class="first">Specify <code class="docutils literal"><span class="pre">&#64;Valid</span></code> annotation as a method annotation.</p>
<p class="last">By assigning <code class="docutils literal"><span class="pre">&#64;Valid</span></code> annotation, constraint annotation of Bean Validation specified in JavaBean field of return value becomes valid.
When constraint specified in JavaBean is not fulfilled, <code class="docutils literal"><span class="pre">javax.validation.ConstraintViolationException</span></code> is thrown.</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Implementation sample of JavaBean is introduced below.</div>
<div class="line">Basically, only constraint annotation of Bean Validation is specified, however care must be taken while performing further nesting of JavaBean in JavaBean.</div>
</div>
<p><strong>JavaBean for Input</strong></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.domain.service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Past</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloInput</span> <span class="p">{</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Past</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">visitDate</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">visitMessage</span><span class="p">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">userId</span><span class="p">;</span>

    <span class="c1">// ...</span>

<span class="p">}</span>
</pre></div>
</div>
<p><strong>JavaBean for Output</strong></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.domain.service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.example.domain.model.User</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.Valid</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Past</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloOutput</span> <span class="p">{</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Past</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">acceptDate</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">acceptMessage</span><span class="p">;</span>

    <span class="nd">@Valid</span> <span class="c1">// (5)</span>
    <span class="kd">private</span> <span class="n">User</span> <span class="n">user</span><span class="p">;</span>

    <span class="c1">// ...</span>

<span class="p">}</span>
</pre></div>
</div>
<p><strong>JavaBean nested in JavaBean for Output</strong></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.domain.model</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Past</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="p">{</span>

    <span class="nd">@NotNull</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">userId</span><span class="p">;</span>

    <span class="nd">@NotNull</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">userName</span><span class="p">;</span>

    <span class="nd">@Past</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">dateOfBirth</span><span class="p">;</span>

    <span class="c1">// ...</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><p class="first">When constraint annotation of Bean Validation specified in nested JavaBean is to be enabled,
specify <code class="docutils literal"><span class="pre">&#64;Valid</span></code> annotation as field annotation.</p>
<p class="last">By assigning <code class="docutils literal"><span class="pre">&#64;Valid</span></code> annotation, constraint annotation of Bean Validation specified in nested JavaBean field becomes valid.
When constraint specified in nested JavaBean is not fulfilled, <code class="docutils literal"><span class="pre">javax.validation.ConstraintViolationException</span></code> is thrown.</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="exception-handling-at-the-time-of-violation-of-constraint">
<span id="methodvalidationonspringframeworkhowtouseexceptionhandling"></span><h4><a class="toc-backref" href="#id32">4.1.3.4.3. Exception handling at the time of violation of constraint</a><a class="headerlink" href="#exception-handling-at-the-time-of-violation-of-constraint" title="Permalink to this headline">¶</a></h4>
<p>When a constraint violation occurs, <code class="docutils literal"><span class="pre">javax.validation.ConstraintViolationException</span></code> is thrown.</p>
<p>When <code class="docutils literal"><span class="pre">ConstraintViolationException</span></code> is thrown, the method generated from stack trace can be identified,  however,
basic violation details cannot be identified.</p>
<p>An exception handling class should be created which outputs log by handling <code class="docutils literal"><span class="pre">ConstraintViolationException</span></code> exception in order to identify violation details.</p>
<p>An example to show how to create an exception handling class is given below.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.app</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.ConstraintViolationException</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ControllerAdvice</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ExceptionHandler</span><span class="p">;</span>

<span class="nd">@ControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConstraintViolationExceptionHandler</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">log</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">ConstraintViolationExceptionHandler</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

    <span class="c1">// (1)</span>
    <span class="nd">@ExceptionHandler</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">handleConstraintViolationException</span><span class="p">(</span><span class="n">ConstraintViolationException</span> <span class="n">e</span><span class="p">){</span>
        <span class="c1">// (2)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">log</span><span class="p">.</span><span class="na">isErrorEnabled</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;ConstraintViolations[\n{}\n]&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="na">getConstraintViolations</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="s">&quot;common/error/systemError&quot;</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">Create a <code class="docutils literal"><span class="pre">&#64;ExceptionHandler</span></code> method to handle <code class="docutils literal"><span class="pre">ConstraintViolationException</span></code>.</p>
<p class="last">Receive <code class="docutils literal"><span class="pre">ConstraintViolationException</span></code> as an argument of method.</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Output violation details  (<code class="docutils literal"><span class="pre">Set</span></code> of <code class="docutils literal"><span class="pre">ConstraintViolation</span></code>) in a log which are retained by <code class="docutils literal"><span class="pre">ConstraintViolationException</span></code>received by method argument.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to “<a class="reference internal" href="../../ImplementationAtEachLayer/ApplicationLayer.html#application-layer-controller-advice"><span class="std std-ref">Implementing “&#64;ControllerAdvice”</span></a>” for details of <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>An error message can occur by using the  <code class="docutils literal"><span class="pre">ConstraintViolation#getMessage</span></code>method, but since the message completion by Spring’s function is not done, field names in error message at <code class="docutils literal"><span class="pre">{0}</span></code>cannot be embedded.</p>
<p>Instead, field names can be obtained with the <code class="docutils literal"><span class="pre">ConstraintViolation#getPropertyPath</span></code>method.</p>
<p>For message completion by Spring’s function, please see the note of:ref:<cite>Validation_message_in_validationmessages</cite>.</p>
<p class="last">For details about <code class="docutils literal"><span class="pre">ConstraintViolation</span></code>,please refer <a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.2/reference/en-US/html_single/#section-constraint-violation-methods">Hibernate Validator reference</a>.</p>
</div>
</div>
</div>
</div>
<div class="section" id="appendix">
<h2><a class="toc-backref" href="#id33">4.1.4. Appendix</a><a class="headerlink" href="#appendix" title="Permalink to this headline">¶</a></h2>
<div class="section" id="input-validation-rules-provided-by-hibernate-validator">
<h3><a class="toc-backref" href="#id34">4.1.4.1. Input validation rules provided by Hibernate Validator</a><a class="headerlink" href="#input-validation-rules-provided-by-hibernate-validator" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Hibernate Validator provides additional validation annotations, in addition to the annotations defined in Bean Validation.</div>
<div class="line">Refer to <a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.2/reference/en-US/html/ch02.html#section-builtin-constraints">Here</a>for the annotation list that can be used for validation.</div>
</div>
<div class="section" id="bean-validation-check-rules">
<span id="validation-jsr303-doc"></span><h4><a class="toc-backref" href="#id35">4.1.4.1.1. Bean Validation check rules</a><a class="headerlink" href="#bean-validation-check-rules" title="Permalink to this headline">¶</a></h4>
<p>Bean Validation standard annotations(<code class="docutils literal"><span class="pre">javax.validation.*</span></code>) are shown below.</p>
<p>Refer to Chapter 7 <a class="reference external" href="http://download.oracle.com/otn-pub/jcp/bean_validation-1_1-fr-eval-spec/bean-validation-specification.pdf">Bean Validation specification</a> for details.</p>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="15%" />
<col width="30%" />
<col width="30%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Annotation</th>
<th class="head">Target type</th>
<th class="head">Description</th>
<th class="head">Usage example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;NotNull</span></code></td>
<td>Arbitrary</td>
<td>Validates that the target field is not <code class="docutils literal"><span class="pre">null</span></code>.</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@NotNull</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;Null</span></code></td>
<td>Arbitrary</td>
<td><div class="first last line-block">
<div class="line">Validates that the target field is <code class="docutils literal"><span class="pre">null</span></code>.</div>
<div class="line">(Example: usage in group validation)</div>
</div>
</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Null</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="p">{</span><span class="n">Update</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;Pattern</span></code></td>
<td><code class="docutils literal"><span class="pre">String</span></code></td>
<td><div class="first last line-block">
<div class="line">Whether the target field matches with the regular expression</div>
<div class="line">(In case of Hibernate Validator implementation, it is also possible to use it with arbitrary implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code> interface)</div>
</div>
</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Pattern</span><span class="p">(</span><span class="n">regexp</span> <span class="o">=</span> <span class="s">&quot;[0-9]+&quot;</span><span class="p">)</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">tel</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;Min</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">BigDecimal</span></code>, <code class="docutils literal"><span class="pre">BigInteger</span></code>, <code class="docutils literal"><span class="pre">byte</span></code>, <code class="docutils literal"><span class="pre">short</span></code>, <code class="docutils literal"><span class="pre">int</span></code>, <code class="docutils literal"><span class="pre">long</span></code> and wrapper</div>
<div class="line">(In case of Hibernate Validator implementation, it is also possible to use it with arbitrary implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code> interface, <code class="docutils literal"><span class="pre">Number</span></code> inherited class. However, only in cases where string can be converted to a number.)</div>
</div>
</td>
<td>Validate whether the value is greater than the minimum value.</td>
<td>Refer <code class="docutils literal"><span class="pre">&#64;Max</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;Max</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">BigDecimal</span></code>, <code class="docutils literal"><span class="pre">BigInteger</span></code>, <code class="docutils literal"><span class="pre">byte</span></code>, <code class="docutils literal"><span class="pre">short</span></code>, <code class="docutils literal"><span class="pre">int</span></code>, <code class="docutils literal"><span class="pre">long</span></code> and wrapper</div>
<div class="line">(In case of Hibernate Validator implementation, it is also possible to use it with arbitrary implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code> interface, <code class="docutils literal"><span class="pre">Number</span></code> inherited class. However, only in cases where string can be converted to a number.)</div>
</div>
</td>
<td>Validate whether the value is less than the maximum value.</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Min</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nd">@Max</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="kd">private</span> <span class="kt">int</span> <span class="n">quantity</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;DecimalMin</span></code></td>
<td><code class="docutils literal"><span class="pre">BigDecimal</span></code>, <code class="docutils literal"><span class="pre">BigInteger</span></code>, <code class="docutils literal"><span class="pre">String</span></code>, <code class="docutils literal"><span class="pre">byte</span></code>, <code class="docutils literal"><span class="pre">short</span></code>, <code class="docutils literal"><span class="pre">int</span></code>, <code class="docutils literal"><span class="pre">long</span></code> and wrapper
(In case of Hibernate Validator implementation, it is also possible to use it with arbitrary implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code> interface, <code class="docutils literal"><span class="pre">Number</span></code> inherited class.)</td>
<td><div class="first last line-block">
<div class="line">Validate whether the Decimal value is greater than or equal to minimum value.</div>
<div class="line">By specifying <code class="docutils literal"><span class="pre">inclusive</span> <span class="pre">=</span> <span class="pre">false</span></code>, it is possible to change to an operation so as to validate whether the value is greater than the minimum value.</div>
</div>
</td>
<td>Refer <code class="docutils literal"><span class="pre">&#64;DecimalMax</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;DecimalMax</span></code></td>
<td><code class="docutils literal"><span class="pre">BigDecimal</span></code>, <code class="docutils literal"><span class="pre">BigInteger</span></code>, <code class="docutils literal"><span class="pre">String</span></code>, <code class="docutils literal"><span class="pre">byte</span></code>, <code class="docutils literal"><span class="pre">short</span></code>, <code class="docutils literal"><span class="pre">int</span></code>, <code class="docutils literal"><span class="pre">long</span></code> and wrapper
(In case of Hibernate Validator implementation, it is also possible to use it with arbitrary implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code> interface, <code class="docutils literal"><span class="pre">Number</span></code> inherited class.)</td>
<td><div class="first last line-block">
<div class="line">Validate whether the decimal value is less than or equal to the maximum value.</div>
<div class="line">By specifying <code class="docutils literal"><span class="pre">inclusive</span> <span class="pre">=</span> <span class="pre">false</span></code>, it is possible to change to an operation so as to validate whether the value is less than the maximum value.</div>
</div>
</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@DecimalMin</span><span class="p">(</span><span class="s">&quot;0.0&quot;</span><span class="p">)</span>
<span class="nd">@DecimalMax</span><span class="p">(</span><span class="s">&quot;99999.99&quot;</span><span class="p">)</span>
<span class="kd">private</span> <span class="n">BigDecimal</span> <span class="n">price</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;Size</span></code></td>
<td><code class="docutils literal"><span class="pre">String</span></code>(string length), <code class="docutils literal"><span class="pre">Collection</span></code>(elements size), <code class="docutils literal"><span class="pre">Map</span></code>(elements size), Array(array length)
(In case of Hibernate Validator implementation, it is also possible to use it with arbitrary implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code> interface.)</td>
<td><div class="first last line-block">
<div class="line">Validate whether elements length or size is between <code class="docutils literal"><span class="pre">min</span></code> and <code class="docutils literal"><span class="pre">max</span></code>.</div>
<div class="line">It is possible to omit <code class="docutils literal"><span class="pre">min</span></code> and <code class="docutils literal"><span class="pre">max</span></code>. In that case, <code class="docutils literal"><span class="pre">min=0</span></code> and <code class="docutils literal"><span class="pre">max=Integer.MAX_VALUE</span></code> by default.</div>
</div>
</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Size</span><span class="p">(</span><span class="n">min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;Digits</span></code></td>
<td><code class="docutils literal"><span class="pre">BigDecimal</span></code>, <code class="docutils literal"><span class="pre">BigInteger</span></code>, <code class="docutils literal"><span class="pre">String</span></code>, <code class="docutils literal"><span class="pre">byte</span></code>, <code class="docutils literal"><span class="pre">short</span></code>, <code class="docutils literal"><span class="pre">int</span></code>, <code class="docutils literal"><span class="pre">long</span></code> and wrapper</td>
<td><div class="first last line-block">
<div class="line">Check whether the value is a numerical value within the specified range.</div>
<div class="line">Specify the maximum number of integer digits permitted in the <code class="docutils literal"><span class="pre">integer</span></code> and the maximum value of decimal digits permitted in <code class="docutils literal"><span class="pre">fraction</span></code>.</div>
</div>
</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Digits</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="kd">private</span> <span class="n">BigDecimal</span> <span class="n">price</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;AssertTrue</span></code></td>
<td><code class="docutils literal"><span class="pre">boolean</span></code>,<code class="docutils literal"><span class="pre">Boolean</span></code></td>
<td>Validate that the target field is <code class="docutils literal"><span class="pre">true</span></code>(Example: Whether it agrees to the terms）</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@AssertTrue</span>
<span class="kd">private</span> <span class="kt">boolean</span> <span class="n">checked</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;AssertFalse</span></code></td>
<td><code class="docutils literal"><span class="pre">boolean</span></code>,<code class="docutils literal"><span class="pre">Boolean</span></code></td>
<td>Validate whether the target field is <code class="docutils literal"><span class="pre">false</span></code></td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@AssertFalse</span>
<span class="kd">private</span> <span class="kt">boolean</span> <span class="n">checked</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;Future</span></code></td>
<td><code class="docutils literal"><span class="pre">Date</span></code>, <code class="docutils literal"><span class="pre">Calendar</span></code>(In case of Hibernate Validator implementation, it is also applicable to Joda-Time class)</td>
<td>Validate whether it is a future date.</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Future</span>
<span class="kd">private</span> <span class="n">Date</span> <span class="n">eventDate</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;Past</span></code></td>
<td><code class="docutils literal"><span class="pre">Date</span></code>, <code class="docutils literal"><span class="pre">Calendar</span></code>(In case of Hibernate Validator implementation, it is also applicable to Joda-Time class)</td>
<td>Validate whether it is a past date.</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Past</span>
<span class="kd">private</span> <span class="n">Date</span> <span class="n">eventDate</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;Valid</span></code></td>
<td>Optional non-primitive type</td>
<td>Validate recursively for related objects.</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Valid</span>
<span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Employer</span><span class="o">&gt;</span> <span class="n">employers</span><span class="p">;</span>

<span class="nd">@Valid</span>
<span class="kd">private</span> <span class="n">Dept</span> <span class="n">dept</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><code class="docutils literal"><span class="pre">inclusive</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;DecimalMin</span></code> and <code class="docutils literal"><span class="pre">&#64;DecimalMax</span></code> annotation is,
an attribute added from Bean Validation 1.1.</p>
<p class="last">By specifying <code class="docutils literal"><span class="pre">true</span></code> (to allow same value of specified threshold) to the default value of <code class="docutils literal"><span class="pre">inclusive</span></code> attribute,
compatibility with Bean Validation 1.0 is maintained.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>In <code class="docutils literal"><span class="pre">&#64;Size</span></code> annotation, characters represented by char type 2 (32 bits) called as surrogate pair are not considered.</p>
<p>When a string consisiting of a surrogate pair is excluded from the check, adequate care must be taken since number of characters that are counted are likely to be more than the actual number of characters.</p>
<p class="last">For length of the string including surrogate pair, refer <a class="reference internal" href="../GeneralFuncDetail/StringProcessing.html#stringprocessinghowtogetsurrogatepairstringlength"><span class="std std-ref">Fetching string length</span></a>.</p>
</div>
</div>
<div class="section" id="hibernate-validator-check-rules">
<span id="validation-validator-list"></span><h4><a class="toc-backref" href="#id36">4.1.4.1.2. Hibernate Validator check rules</a><a class="headerlink" href="#hibernate-validator-check-rules" title="Permalink to this headline">¶</a></h4>
<p>All the major annotations(<code class="docutils literal"><span class="pre">org.hibernate.validator.constraints.*</span></code>) of Hibernate Validator are shown below.</p>
<p>Refer to <a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.2/reference/en-US/html/ch02.html#validator-defineconstraints-hv-constraints">Hibernate Validator specifications</a> for details.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="15%" />
<col width="30%" />
<col width="30%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Annotation</th>
<th class="head">Target type</th>
<th class="head">Description</th>
<th class="head">Usage example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;CreditCardNumber</span></code></td>
<td>It is applicable to any implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code> interface</td>
<td><div class="first last line-block">
<div class="line">Validate whether the credit card number is valid as per Luhn algorithm. It does not necessarily check whether the credit card number is available.</div>
<div class="line">By specifying <code class="docutils literal"><span class="pre">ignoreNonDigitCharacters</span> <span class="pre">=</span> <span class="pre">true</span></code>, it is possible to validate by ignoring non-numeric characters.</div>
</div>
</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@CreditCardNumber</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">cardNumber</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;Email</span></code></td>
<td>It is applicable to any implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code> interface</td>
<td>Validate whether the Email address is complaint with RFC2822.</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Email</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;URL</span></code></td>
<td>It is applicable to any implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code> interface</td>
<td>Verify that it is valid as URL. Character string is validated by using <code class="docutils literal"><span class="pre">java.net.URL</span></code> constructor
and the protocol that is validated as a URL is dependent on the protocols supported by JVM (<code class="docutils literal"><span class="pre">http</span></code>,<code class="docutils literal"><span class="pre">https</span></code>,<code class="docutils literal"><span class="pre">file</span></code>,<code class="docutils literal"><span class="pre">jar</span></code> etc).</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@URL</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">url</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;NotBlank</span></code></td>
<td>It is applicable to any implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code> interface</td>
<td>Validate that it is not <code class="docutils literal"><span class="pre">null</span></code>, empty string (<code class="docutils literal"><span class="pre">&quot;&quot;</span></code>) and space only.</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@NotBlank</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">userId</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;NotEmpty</span></code></td>
<td>It is applicable to <code class="docutils literal"><span class="pre">Collection</span></code>, <code class="docutils literal"><span class="pre">Map</span></code>, Array, and any implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code> interface</td>
<td><div class="first last line-block">
<div class="line">Validate that it is not <code class="docutils literal"><span class="pre">null</span></code> or empty.</div>
<div class="line"><code class="docutils literal"><span class="pre">&#64;NotEmpty</span></code> should be used when check is to be done in <code class="docutils literal"><span class="pre">&#64;NotNull</span></code> + <code class="docutils literal"><span class="pre">&#64;Min(1)</span></code> combination.</div>
</div>
</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@NotEmpty</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>In <code class="docutils literal"><span class="pre">&#64;URL</span></code>, when the verification is to be performed for validating the protocol not supported by JVM, <code class="docutils literal"><span class="pre">org.hibernate.validator.constraintvalidators.RegexpURLValidator</span></code> provided by Hibernate is used.
This class is a Validator class corresponding to <code class="docutils literal"><span class="pre">&#64;URL</span></code> annotation and it can be checked whether it is a URL format by a regular expression. It can also verify the validation for the protocols not supported by JVM.</p>
<ul class="simple">
<li>If the check rules of <code class="docutils literal"><span class="pre">&#64;URL</span></code> of overall application can be changed, Validator class is changed to <code class="docutils literal"><span class="pre">RegexpURLValidator</span></code> in XML,
as described in <a class="reference external" href="https://docs.jboss.org/hibernate/validator/5.2/api/org/hibernate/validator/constraints/URL.html">JavaDoc</a>.</li>
<li>When only some of the items are to be validated by using regular expressions and default rules are to be used for <code class="docutils literal"><span class="pre">&#64;URL</span></code>, a new annotation and an implementation class <code class="docutils literal"><span class="pre">javax.validation.ConstraintValidator</span></code> that performs validation similar to <code class="docutils literal"><span class="pre">RegexpURLValidator</span></code> are created
and the validation by the annotation thus created is applied to the required items.</li>
</ul>
<p>These can be applied as per the intended use.</p>
<p class="last">For details of check rule change by XML, refer to <a class="reference external" href="https://docs.jboss.org/hibernate/validator/5.2/reference/en-US/html/ch07.html#section-configuration-validation-xml">Hibernate reference</a>and for how to create a new annotation, refer to <a class="reference internal" href="#validation-implement-new-constraint"><span class="std std-ref">Creation of Bean Validation annotation by implementing new rules</span></a> respectively..</p>
</div>
</div>
</div>
<div class="section" id="default-messages-provided-by-hibernate-validator">
<span id="validation-default-message-in-hibernate-validator"></span><h3><a class="toc-backref" href="#id37">4.1.4.2. Default messages provided by Hibernate Validator</a><a class="headerlink" href="#default-messages-provided-by-hibernate-validator" title="Permalink to this headline">¶</a></h3>
<p>In hibernate-validator-&lt;version&gt;.jar, there is a ValidationMessages.properties file at org/hibernate/validator location, which contains the default messages of all Hibernate provided annotations.</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">javax.validation.constraints.AssertFalse.message</span> <span class="o">=</span> <span class="s">must be false</span>
<span class="na">javax.validation.constraints.AssertTrue.message</span>  <span class="o">=</span> <span class="s">must be true</span>
<span class="na">javax.validation.constraints.DecimalMax.message</span>  <span class="o">=</span> <span class="s">must be less than ${inclusive == true ? &#39;or equal to &#39; : &#39;&#39;}{value}</span>
<span class="na">javax.validation.constraints.DecimalMin.message</span>  <span class="o">=</span> <span class="s">must be greater than ${inclusive == true ? &#39;or equal to &#39; : &#39;&#39;}{value}</span>
<span class="na">javax.validation.constraints.Digits.message</span>      <span class="o">=</span> <span class="s">numeric value out of bounds (&lt;{integer} digits&gt;.&lt;{fraction} digits&gt; expected)</span>
<span class="na">javax.validation.constraints.Future.message</span>      <span class="o">=</span> <span class="s">must be in the future</span>
<span class="na">javax.validation.constraints.Max.message</span>         <span class="o">=</span> <span class="s">must be less than or equal to {value}</span>
<span class="na">javax.validation.constraints.Min.message</span>         <span class="o">=</span> <span class="s">must be greater than or equal to {value}</span>
<span class="na">javax.validation.constraints.NotNull.message</span>     <span class="o">=</span> <span class="s">may not be null</span>
<span class="na">javax.validation.constraints.Null.message</span>        <span class="o">=</span> <span class="s">must be null</span>
<span class="na">javax.validation.constraints.Past.message</span>        <span class="o">=</span> <span class="s">must be in the past</span>
<span class="na">javax.validation.constraints.Pattern.message</span>     <span class="o">=</span> <span class="s">must match &quot;{regexp}&quot;</span>
<span class="na">javax.validation.constraints.Size.message</span>        <span class="o">=</span> <span class="s">size must be between {min} and {max}</span>

<span class="na">org.hibernate.validator.constraints.CreditCardNumber.message</span>        <span class="o">=</span> <span class="s">invalid credit card number</span>
<span class="na">org.hibernate.validator.constraints.EAN.message</span>                     <span class="o">=</span> <span class="s">invalid {type} barcode</span>
<span class="na">org.hibernate.validator.constraints.Email.message</span>                   <span class="o">=</span> <span class="s">not a well-formed email address</span>
<span class="na">org.hibernate.validator.constraints.Length.message</span>                  <span class="o">=</span> <span class="s">length must be between {min} and {max}</span>
<span class="na">org.hibernate.validator.constraints.LuhnCheck.message</span>               <span class="o">=</span> <span class="s">The check digit for ${validatedValue} is invalid, Luhn Modulo 10 checksum failed</span>
<span class="na">org.hibernate.validator.constraints.Mod10Check.message</span>              <span class="o">=</span> <span class="s">The check digit for ${validatedValue} is invalid, Modulo 10 checksum failed</span>
<span class="na">org.hibernate.validator.constraints.Mod11Check.message</span>              <span class="o">=</span> <span class="s">The check digit for ${validatedValue} is invalid, Modulo 11 checksum failed</span>
<span class="na">org.hibernate.validator.constraints.ModCheck.message</span>                <span class="o">=</span> <span class="s">The check digit for ${validatedValue} is invalid, ${modType} checksum failed</span>
<span class="na">org.hibernate.validator.constraints.NotBlank.message</span>                <span class="o">=</span> <span class="s">may not be empty</span>
<span class="na">org.hibernate.validator.constraints.NotEmpty.message</span>                <span class="o">=</span> <span class="s">may not be empty</span>
<span class="na">org.hibernate.validator.constraints.ParametersScriptAssert.message</span>  <span class="o">=</span> <span class="s">script expression &quot;{script}&quot; didn&#39;t evaluate to true</span>
<span class="na">org.hibernate.validator.constraints.Range.message</span>                   <span class="o">=</span> <span class="s">must be between {min} and {max}</span>
<span class="na">org.hibernate.validator.constraints.SafeHtml.message</span>                <span class="o">=</span> <span class="s">may have unsafe html content</span>
<span class="na">org.hibernate.validator.constraints.ScriptAssert.message</span>            <span class="o">=</span> <span class="s">script expression &quot;{script}&quot; didn&#39;t evaluate to true</span>
<span class="na">org.hibernate.validator.constraints.URL.message</span>                     <span class="o">=</span> <span class="s">must be a valid URL</span>

<span class="na">org.hibernate.validator.constraints.br.CNPJ.message</span>                 <span class="o">=</span> <span class="s">invalid Brazilian corporate taxpayer registry number (CNPJ)</span>
<span class="na">org.hibernate.validator.constraints.br.CPF.message</span>                  <span class="o">=</span> <span class="s">invalid Brazilian individual taxpayer registry number (CPF)</span>
<span class="na">org.hibernate.validator.constraints.br.TituloEleitoral.message</span>      <span class="o">=</span> <span class="s">invalid Brazilian Voter ID card number</span>
</pre></div>
</div>
</div>
<div class="section" id="input-check-rules-provided-by-a-common-library">
<span id="validation-terasoluna-gfw"></span><h3><a class="toc-backref" href="#id38">4.1.4.3. Input check rules provided by a common library</a><a class="headerlink" href="#input-check-rules-provided-by-a-common-library" title="Permalink to this headline">¶</a></h3>
<p>A common library provides an independent annotation for verification.
Here, how to specify input check rules which use annotation provided by common library is explained.</p>
<div class="section" id="terasoluna-gfw-common-check-rules">
<span id="validation-terasoluna-gfw-list"></span><h4><a class="toc-backref" href="#id39">4.1.4.3.1. terasoluna-gfw-common check rules</a><a class="headerlink" href="#terasoluna-gfw-common-check-rules" title="Permalink to this headline">¶</a></h4>
<p>Annotation provided by <a class="reference external" href="https://github.com/terasolunaorg/terasoluna-gfw/tree/master/terasoluna-gfw-common">terasoluna-gfw-common</a> (<code class="docutils literal"><span class="pre">org.terasoluna.gfw.common.codelist.*</span></code>) is shown below.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="15%" />
<col width="30%" />
<col width="30%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Annotation</th>
<th class="head">Target type</th>
<th class="head">Description</th>
<th class="head">Usage example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;ExistInCodeList</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">Character</span></code></div>
<div class="line">Implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code></div>
<div class="line">(<code class="docutils literal"><span class="pre">String</span></code>, <code class="docutils literal"><span class="pre">StringBuilder</span></code>etc)</div>
</div>
</td>
<td>Verify whether value is incorporated in the code list.</td>
<td>Refer <a class="reference internal" href="Codelist.html#codelist-validate"><span class="std std-ref">&#64;ExistInCodeList</span></a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="terasoluna-gfw-codepoints-check-rules">
<h4><a class="toc-backref" href="#id40">4.1.4.3.2. terasoluna-gfw-codepoints check rules</a><a class="headerlink" href="#terasoluna-gfw-codepoints-check-rules" title="Permalink to this headline">¶</a></h4>
<p>Annotation (<code class="docutils literal"><span class="pre">org.terasoluna.gfw.common.codepoints.*</span></code>) offered by <a class="reference external" href="https://github.com/terasolunaorg/terasoluna-gfw/tree/master/terasoluna-gfw-codepoints">terasoluna-gfw-codepoints</a> is shown below. Further, <code class="docutils literal"><span class="pre">terasoluna-gfw-codepoints</span></code> can be used in 5.1.0.RELEASE and subsequent versions.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="15%" />
<col width="30%" />
<col width="30%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Annotation</th>
<th class="head">Target type</th>
<th class="head">Description</th>
<th class="head">Usage example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;ConsistOf</span></code></td>
<td><div class="first last line-block">
<div class="line">Implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code></div>
<div class="line">(<code class="docutils literal"><span class="pre">String</span></code>, <code class="docutils literal"><span class="pre">StringBuilder</span></code> etc)</div>
</div>
</td>
<td>Verify whether all the character strings to be checked are included in the specified code point set.</td>
<td>Refer <a class="reference internal" href="../GeneralFuncDetail/StringProcessing.html#stringprocessinghowtousecodepointsvalidator"><span class="std std-ref">&#64;ConsistOf</span></a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="terasoluna-gfw-validator-check-rules">
<h4><a class="toc-backref" href="#id41">4.1.4.3.3. terasoluna-gfw-validator check rules</a><a class="headerlink" href="#terasoluna-gfw-validator-check-rules" title="Permalink to this headline">¶</a></h4>
<p>Annotation (<code class="docutils literal"><span class="pre">org.terasoluna.gfw.common.validator.constraints.*</span></code>) offered by <a class="reference external" href="https://github.com/terasolunaorg/terasoluna-gfw/tree/master/terasoluna-gfw-validator">terasoluna-gfw-validator</a> is shown below. Further, <code class="docutils literal"><span class="pre">terasoluna-gfw-validator</span></code>can be used in 5.1.0.RELEASE and subsequent versions.</p>
<table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="15%" />
<col width="30%" />
<col width="30%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Annotation</th>
<th class="head">Target type</th>
<th class="head">Description</th>
<th class="head">Usage example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;ByteMin</span></code></td>
<td><div class="first last line-block">
<div class="line">Implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code></div>
<div class="line">(<code class="docutils literal"><span class="pre">String</span></code>, <code class="docutils literal"><span class="pre">StringBuilder</span></code> etc)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Verify whether byte length value is greater than or equal to minimum value.</div>
<div class="line"><br /></div>
<div class="line"><strong>[Annotation attributes]</strong></div>
<div class="line"><code class="docutils literal"><span class="pre">long</span> <span class="pre">value</span></code> - Specify minimum value of byte length.</div>
<div class="line"><code class="docutils literal"><span class="pre">String</span> <span class="pre">charset</span></code> - Specify string character set used while encoding the value in byte sequence. Default value is <code class="docutils literal"><span class="pre">UTF-8</span></code>.</div>
</div>
</td>
<td>Refer <code class="docutils literal"><span class="pre">&#64;ByteMax</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;ByteMax</span></code></td>
<td><div class="first last line-block">
<div class="line">Implementation class of <code class="docutils literal"><span class="pre">CharSequence</span></code></div>
<div class="line">(<code class="docutils literal"><span class="pre">String</span></code>, <code class="docutils literal"><span class="pre">StringBuilder</span></code> etc)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Verify whether byte length value is less than or equal to maximum value.</div>
<div class="line"><br /></div>
<div class="line"><strong>[Annotation attribute]</strong></div>
<div class="line"><code class="docutils literal"><span class="pre">long</span> <span class="pre">value</span></code> - Specify maximum value for byte length.</div>
<div class="line"><code class="docutils literal"><span class="pre">String</span> <span class="pre">charset</span></code> - Specify string character set used while encoding the value in byte sequence. Default value is <code class="docutils literal"><span class="pre">UTF-8</span></code>.</div>
</div>
</td>
<td><div class="first last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@ByteMin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nd">@ByteMax</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">charset</span> <span class="o">=</span> <span class="s">&quot;Shift_JIS&quot;</span><span class="p">)</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;Compare</span></code></td>
<td><div class="first last line-block">
<div class="line">Implementation class of <code class="docutils literal"><span class="pre">Comparable</span></code> interface can be applied to any JavaBean with a property</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">Verify that the magnitude relation of specified property value is correct.</div>
<div class="line"><br /></div>
<div class="line"><strong>[Annotation attribute]</strong></div>
<div class="line"><code class="docutils literal"><span class="pre">String</span> <span class="pre">left</span></code> - Specify the property name to be used as a comparison source in the object. A message is displayed in the property in case of a validation error.</div>
<div class="line"><code class="docutils literal"><span class="pre">String</span> <span class="pre">right</span></code> - Specify property name to be used as a comparison destination in the object.</div>
<div class="line"><code class="docutils literal"><span class="pre">org.terasoluna.gfw.common.validator.constraints.Compare.Operator</span> <span class="pre">operator</span></code> - Specify Enum type <code class="docutils literal"><span class="pre">Operator</span></code> value which shows expected magnitude relation. Values that can be specified are as below.</div>
</div>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">EQUAL</span></code> : <code class="docutils literal"><span class="pre">left</span> <span class="pre">=</span> <span class="pre">right</span></code></li>
<li><code class="docutils literal"><span class="pre">GREATER_THAN</span></code> : <code class="docutils literal"><span class="pre">left</span> <span class="pre">&gt;</span> <span class="pre">right</span></code></li>
<li><code class="docutils literal"><span class="pre">GREATER_THAN_OR_EQUAL</span></code> : <code class="docutils literal"><span class="pre">left</span> <span class="pre">&gt;=</span> <span class="pre">right</span></code></li>
<li><code class="docutils literal"><span class="pre">LESS_THAN</span></code> : <code class="docutils literal"><span class="pre">left</span> <span class="pre">&lt;</span> <span class="pre">right</span></code></li>
<li><code class="docutils literal"><span class="pre">LESS_THAN_OR_EQUAL</span></code> : <code class="docutils literal"><span class="pre">left</span> <span class="pre">&lt;=</span> <span class="pre">right</span></code></li>
</ul>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">boolean</span> <span class="pre">requireBoth</span></code> - Specify whether values must be entered in the fields specified by both <code class="docutils literal"><span class="pre">left</span></code> attribute and <code class="docutils literal"><span class="pre">right</span></code> attribute (should not be <code class="docutils literal"><span class="pre">null</span></code>).</div>
</div>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">true</span></code> : Considered as a validation error if value is entered in only one of the fields. However, considered as “validation success” when values are not entered in both the fields.</li>
<li><code class="docutils literal"><span class="pre">false</span></code> : Considered as “validation success” when only one of the fields contain a value. (Default)</li>
</ul>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">org.terasoluna.gfw.common.validator.constraints.Compare.Node</span> <span class="pre">node</span></code> - Specify Enum type <code class="docutils literal"><span class="pre">Node</span></code> value which indicates path to output error message. Values that can be specified are as below.</div>
</div>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">PROPERTY</span></code> : Output as an error for the field specified in <code class="docutils literal"><span class="pre">left</span></code> attribute. (Default)</li>
<li><code class="docutils literal"><span class="pre">ROOT_BEAN</span></code> : Output as an error of object which has been checked.</li>
</ul>
</td>
<td><p class="first">Check whether the mail address matches with the mail address entered for checking. Implementation is as below when entire form is to be displayed as an error message.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Compare</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="s">&quot;email&quot;</span><span class="p">,</span>
        <span class="n">right</span> <span class="o">=</span> <span class="s">&quot;confirmEmail&quot;</span><span class="p">,</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="n">Compare</span><span class="p">.</span><span class="na">Operator</span><span class="p">.</span><span class="na">EQUAL</span><span class="p">,</span>
        <span class="n">requireBoth</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">Compare</span><span class="p">.</span><span class="na">Node</span><span class="p">.</span><span class="na">ROOT_BEAN</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserRegisterForm</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">confirmEmail</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>When period start date and period end date are both entered, check that start date is earlier than the end date. Implementation is as below when error message is displayed for period start date.</p>
<div class="last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Compare</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="p">,</span>
        <span class="n">right</span> <span class="o">=</span> <span class="s">&quot;to&quot;</span><span class="p">,</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="n">Compare</span><span class="p">.</span><span class="na">Operator</span><span class="p">.</span><span class="na">LESS_THAN_OR_EQUAL</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Period</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">from</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">to</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>For mandatory input during correlated item check</strong></p>
<p>For unit item check, whether a value is entered in the input field（ should not be <code class="docutils literal"><span class="pre">null</span></code>) can be checked by using <code class="docutils literal"><span class="pre">&#64;NotNull</span></code> in combination. However, in correlated item check, the check like “if value is entered in one field, value is entered forcefully in another field” cannot be implemented by using <code class="docutils literal"><span class="pre">&#64;NotNull</span></code> alone. Hence, <code class="docutils literal"><span class="pre">&#64;Compare</span></code> provides <code class="docutils literal"><span class="pre">requireBoth</span></code> attribute which controls mandatory input for checking which can then be used for implementing the check whenever required.</p>
<p>Also, when a value is not entered in the input field, <code class="docutils literal"><span class="pre">requireBoth</span></code> attribute can be used only when <code class="docutils literal"><span class="pre">null</span></code> is bound. If a form is sent in Spring MVC when a value is not entered in input field of string, it must be noted that empty string is bound in the form object by default instead of <code class="docutils literal"><span class="pre">null</span></code>. When a value is not entered in the string field, refer <a class="reference internal" href="#validation-string-trimmer-editor"><span class="std std-ref">Binding null to blank string field</span></a> to bind <code class="docutils literal"><span class="pre">null</span></code> in form object instead of empty string.</p>
<p>Expected check requirements and configuration example are shown below using “checking whether period start date is earlier than end date” as an example.</p>
<blockquote class="last">
<div><table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Check requirements</th>
<th class="head">Configuration example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">from</span></code> and <code class="docutils literal"><span class="pre">to</span></code> both are mandatory, compare <code class="docutils literal"><span class="pre">from</span></code> and <code class="docutils literal"><span class="pre">to</span></code>.</td>
<td><p class="first">Assign <code class="docutils literal"><span class="pre">&#64;NotNull</span></code>in <code class="docutils literal"><span class="pre">from</span></code> and <code class="docutils literal"><span class="pre">to</span></code> and use default value （ <code class="docutils literal"><span class="pre">false</span></code>）in <code class="docutils literal"><span class="pre">requireBoth</span></code> attribute.</p>
<div class="last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Compare</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="n">Compare</span><span class="p">.</span><span class="na">Operator</span><span class="p">.</span><span class="na">LESS_THAN_OR_EQUAL</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Period</span> <span class="p">{</span>
  <span class="nd">@NotNull</span>
  <span class="n">LocalDate</span> <span class="n">from</span><span class="p">;</span>
  <span class="nd">@NotNull</span>
  <span class="n">LocalDate</span> <span class="n">to</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td>Only <code class="docutils literal"><span class="pre">from</span></code> is mandatory, however carry out comparison check when a value is entered in <code class="docutils literal"><span class="pre">to</span></code> as well.</td>
<td><p class="first">Assign <code class="docutils literal"><span class="pre">&#64;NotNull</span></code>only in  <code class="docutils literal"><span class="pre">from</span></code> and use default value （ <code class="docutils literal"><span class="pre">false</span></code>）in <code class="docutils literal"><span class="pre">requireBoth</span></code> attribute.</p>
<div class="last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Compare</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="n">Compare</span><span class="p">.</span><span class="na">Operator</span><span class="p">.</span><span class="na">LESS_THAN_OR_EQUAL</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Period</span> <span class="p">{</span>
  <span class="nd">@NotNull</span>
  <span class="n">LocalDate</span> <span class="n">from</span><span class="p">;</span>
  <span class="n">LocalDate</span> <span class="n">to</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">from</span></code> and <code class="docutils literal"><span class="pre">to</span></code> are not both required, carry out comparison check only when values are entered in both <code class="docutils literal"><span class="pre">from</span></code> and <code class="docutils literal"><span class="pre">to</span></code>. When the value is entered in only one of the fields, comparison check is not carried out.</td>
<td><p class="first">Do not assign <code class="docutils literal"><span class="pre">&#64;NotNull</span></code>and use default value （ <code class="docutils literal"><span class="pre">false</span></code>）in <code class="docutils literal"><span class="pre">requireBoth</span></code> attribute.</p>
<div class="last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Compare</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="n">Compare</span><span class="p">.</span><span class="na">Operator</span><span class="p">.</span><span class="na">LESS_THAN_OR_EQUAL</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Period</span> <span class="p">{</span>
  <span class="n">LocalDate</span> <span class="n">from</span><span class="p">;</span>
  <span class="n">LocalDate</span> <span class="n">to</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">from</span></code> and <code class="docutils literal"><span class="pre">to</span></code> are not both required, when values are entered in either of the <code class="docutils literal"><span class="pre">from</span></code>or <code class="docutils literal"><span class="pre">to</span></code>, carry out comparison check by always entering values in both fields.</td>
<td><p class="first">Do not assign <code class="docutils literal"><span class="pre">&#64;NotNull</span></code>and specify <code class="docutils literal"><span class="pre">true</span></code> in <code class="docutils literal"><span class="pre">requireBoth</span></code> attribute.</p>
<div class="last highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Compare</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="s">&quot;from&quot;</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="s">&quot;to&quot;</span><span class="p">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="n">Compare</span><span class="p">.</span><span class="na">Operator</span><span class="p">.</span><span class="na">LESS_THAN_OR_EQUAL</span><span class="p">,</span> <span class="n">requireBoth</span> <span class="o">=</span> <span class="kc">true</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Period</span> <span class="p">{</span>
  <span class="n">LocalDate</span> <span class="n">from</span><span class="p">;</span>
  <span class="n">LocalDate</span> <span class="n">to</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="how-to-apply-check-rules-of-common-library">
<h4><a class="toc-backref" href="#id42">4.1.4.3.4. How to apply check rules of common library</a><a class="headerlink" href="#how-to-apply-check-rules-of-common-library" title="Permalink to this headline">¶</a></h4>
<p>Apply check rules of common library using the procedure below.</p>
<p>Add a dependent library for the rules that are to be used. An example for how to add <code class="docutils literal"><span class="pre">terasoluna-gfw-validator</span></code> is shown below.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.terasoluna.gfw<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>terasoluna-gfw-validator<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the above setting example, since it is assumed that the dependent library version is managed by the parent project terasoluna-gfw-parent , specifying the version in pom.xml is not necessary.</p>
</div>
<p>Next, a message definition corresponding to annotation is added to <code class="file docutils literal"><span class="pre">ValidationMessages.properties</span></code>  as explained in <a class="reference internal" href="#validation-message-in-validationmessages"><span class="std std-ref">Messages to be defined in ValidationMessages.properties</span></a>.</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># (1)</span>
<span class="na">org.terasoluna.gfw.common.validator.constraints.ByteMin.message</span> <span class="o">=</span> <span class="s">must be greater than or equal to {value} Bytes</span>
<span class="na">org.terasoluna.gfw.common.validator.constraints.ByteMax.message</span> <span class="o">=</span> <span class="s">must be less than or equal to {value} Bytes</span>
<span class="na">org.terasoluna.gfw.common.validator.constraints.Compare.message</span> <span class="o">=</span> <span class="s">not match &#39;{left}&#39; and &#39;{right}&#39;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Add a message definition for each annotation. Annotation attribute value can be incorporated in the message by using placeholder (<code class="docutils literal"><span class="pre">{attribute</span> <span class="pre">name}</span></code> format).</td>
</tr>
</tbody>
</table>
<p>In the end, assign an annotation to JavaBean property as explained in <a class="reference internal" href="#validation-basic-validation"><span class="std std-ref">Basic single item check</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When validation cannot be implemented in Bean Validation due to invalid attribute value of annotation, <code class="docutils literal"><span class="pre">javax.validation.ValidationException</span></code> is thrown. Modify the attribute value to a valid value by referring the reason that is output in stack trace.</p>
<p class="last">Refer Chapter 9 of <a class="reference external" href="http://download.oracle.com/otn-pub/jcp/bean_validation-1_1-fr-eval-spec/bean-validation-specification.pdf">Bean Validation specification</a> for details.</p>
</div>
</div>
<div class="section" id="how-to-extend-check-rules-of-common-library">
<span id="validation-terasoluna-gfw-how-to-extend"></span><h4><a class="toc-backref" href="#id43">4.1.4.3.5. How to extend check rules of common library</a><a class="headerlink" href="#how-to-extend-check-rules-of-common-library" title="Permalink to this headline">¶</a></h4>
<p>Any rule can be created by using check rules provided by common library.</p>
<p>An example is introduced below wherein <code class="docutils literal"><span class="pre">&#64;Confirm</span></code> annotation independently implemented by <a class="reference internal" href="#validation-correlation-item-check"><span class="std std-ref">Check rules for correlated items</span></a> is created by using check rules provided by common library.</p>
<p>Create <code class="docutils literal"><span class="pre">&#64;Confirm</span></code> annotation by using <code class="docutils literal"><span class="pre">&#64;Compare</span></code> as described in <a class="reference internal" href="#validation-convine-existing-constraint"><span class="std std-ref">Creation of Bean Validation annotation by combining existing rules</span></a>.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.domain.validation</span><span class="p">;</span>

<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.ANNOTATION_TYPE</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.ElementType.TYPE</span><span class="p">;</span>
<span class="kn">import static</span> <span class="nn">java.lang.annotation.RetentionPolicy.RUNTIME</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.OverridesAttribute</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ReportAsSingleViolation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.validator.constraints.Compare</span><span class="p">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="p">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="p">{})</span>
<span class="nd">@Target</span><span class="p">({</span> <span class="n">TYPE</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span> <span class="p">})</span> <span class="c1">// (1)</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
<span class="nd">@ReportAsSingleViolation</span> <span class="c1">// (2)</span>
<span class="nd">@Compare</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="n">Compare</span><span class="p">.</span><span class="na">Operator</span><span class="p">.</span><span class="na">EQUAL</span><span class="p">,</span> <span class="n">requireBoth</span> <span class="o">=</span> <span class="kc">true</span><span class="p">)</span> <span class="c1">// (3)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">Confirm</span> <span class="p">{</span>

    <span class="n">String</span> <span class="nf">message</span><span class="p">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.sample.domain.validation.Confirm.message}&quot;</span><span class="p">;</span> <span class="c1">// (4)</span>

    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="p">()</span> <span class="k">default</span> <span class="p">{};</span>

    <span class="nd">@OverridesAttribute</span><span class="p">(</span><span class="n">constraint</span> <span class="o">=</span> <span class="n">Compare</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;left&quot;</span><span class="p">)</span> <span class="c1">// (5)</span>
    <span class="n">String</span> <span class="nf">field</span><span class="p">();</span>

    <span class="nd">@OverridesAttribute</span><span class="p">(</span><span class="n">constraint</span> <span class="o">=</span> <span class="n">Compare</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;right&quot;</span><span class="p">)</span> <span class="c1">// (6)</span>
    <span class="n">String</span> <span class="nf">confirmField</span><span class="p">();</span>

    <span class="nd">@Documented</span>
    <span class="nd">@Target</span><span class="p">({</span> <span class="n">TYPE</span><span class="p">,</span> <span class="n">ANNOTATION_TYPE</span> <span class="p">})</span>
    <span class="nd">@Retention</span><span class="p">(</span><span class="n">RUNTIME</span><span class="p">)</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="p">{</span>
        <span class="n">Confirm</span><span class="o">[]</span> <span class="nf">value</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Restrict the location where the annotation can be assigned to class or annotation.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Message specified in <code class="docutils literal"><span class="pre">message</span></code> attribute of this annotation should be used at the time of error.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">Compare.Operator.EQUAL</span></code>(should be equivalent value) in <code class="docutils literal"><span class="pre">operator</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;Compare</span></code> annotation. Specify <code class="docutils literal"><span class="pre">true</span></code> in <code class="docutils literal"><span class="pre">requireBoth</span></code>attribute since an error occurs if a value is not entered in either of the fields.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define default value of error message.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Override <code class="docutils literal"><span class="pre">left</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;Compare</span></code> annotation and change attribute name to <code class="docutils literal"><span class="pre">field</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Similarly, override <code class="docutils literal"><span class="pre">right</span></code> attribute and change attribute name to <code class="docutils literal"><span class="pre">confirmField</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Use annotation created above instead of annotation implemented in <a class="reference internal" href="#validation-correlation-item-check"><span class="std std-ref">Check rules for correlated items</span></a>.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.example.common.validation.Confirm</span><span class="p">;</span>

<span class="nd">@Confirm</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s">&quot;password&quot;</span><span class="p">,</span> <span class="n">confirmField</span> <span class="o">=</span> <span class="s">&quot;confirmPassword&quot;</span><span class="p">)</span> <span class="c1">// (1)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordResetForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="p">;</span>

    <span class="nd">@NotNull</span> <span class="c1">// (2)</span>
    <span class="nd">@Size</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="p">;</span>

    <span class="nd">@NotNull</span> <span class="c1">// (3)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">confirmPassword</span><span class="p">;</span>

    <span class="c1">// omitted geter/setter</span>
<span class="p">}</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;Confirm</span></code> annotation to class level.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Since <code class="docutils literal"><span class="pre">&#64;Confirm</span></code> verification is passed when <code class="docutils literal"><span class="pre">password</span></code> field is <code class="docutils literal"><span class="pre">null</span></code>, perform <code class="docutils literal"><span class="pre">null</span></code> check by assigning <code class="docutils literal"><span class="pre">&#64;NotNull</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Similarly assign <code class="docutils literal"><span class="pre">&#64;NotNull</span></code> annotation in <code class="docutils literal"><span class="pre">confirmPassword</span></code> field as well.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="type-mismatch">
<span id="validation-type-mismatch"></span><h3><a class="toc-backref" href="#id44">4.1.4.4. Type mismatch</a><a class="headerlink" href="#type-mismatch" title="Permalink to this headline">¶</a></h3>
<p>Pertaining the non-String fields of the form object, if values which cannot be converted to the corresponding data-type have been submitted, <code class="docutils literal"><span class="pre">org.springframework.beans.TypeMismatchException</span></code> is thrown.</p>
<p>In the “New user registration” example, The data-type of “Age” is <code class="docutils literal"><span class="pre">Integer</span></code>. However, if the value entered in this field cannot be converted to an integer, error message is displayed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-typemismatch1.png"><img alt="../../_images/validations-typemismatch1.png" src="../../_images/validations-typemismatch1.png" style="width: 60%;" /></a>
</div>
<p>Cause of exception is displayed as it is and is not appropriate as an error message.
It is possible to define the error message for type mismatch in the properties file (application-messages.properties) which is read by <code class="docutils literal"><span class="pre">org.springframework.context.MessageSource</span></code>.</p>
<p>Error messages can be defined with the following rules.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="35%" />
<col width="40%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Message key</th>
<th class="head">Message contents</th>
<th class="head">Application</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">typeMismatch</span></code></td>
<td>Default message for all type mismatch errors</td>
<td>Default value for entire system</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">typeMismatch.[target</span> <span class="pre">FQCN]</span></code></td>
<td>Default message for specific type mismatch error</td>
<td>Default value for entire system</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">typeMismatch.[form</span> <span class="pre">attribute</span> <span class="pre">name].[property</span> <span class="pre">name]</span></code></td>
<td>Type mismatch error message for specific form field</td>
<td>Customized message for each screen</td>
</tr>
</tbody>
</table>
<p>When the following messages are added to application-messages.properties,</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="c"># typemismatch</span>
<span class="na">typeMismatch</span><span class="o">=</span><span class="s">&quot;{0}&quot; is invalid.</span>
<span class="na">typeMismatch.int</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be an integer.</span>
<span class="na">typeMismatch.double</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a double.</span>
<span class="na">typeMismatch.float</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a float.</span>
<span class="na">typeMismatch.long</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a long.</span>
<span class="na">typeMismatch.short</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a short.</span>
<span class="na">typeMismatch.java.lang.Integer</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be an integer.</span>
<span class="na">typeMismatch.java.lang.Double</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a double.</span>
<span class="na">typeMismatch.java.lang.Float</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a float.</span>
<span class="na">typeMismatch.java.lang.Long</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a long.</span>
<span class="na">typeMismatch.java.lang.Short</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a short.</span>
<span class="na">typeMismatch.java.util.Date</span><span class="o">=</span><span class="s">&quot;{0}&quot; is not a date.</span>

<span class="c"># field names</span>
<span class="na">name</span><span class="o">=</span><span class="s">Name</span>
<span class="na">email</span><span class="o">=</span><span class="s">Email</span>
<span class="na">age</span><span class="o">=</span><span class="s">Age</span>
</pre></div>
</div>
<p>Error message gets changed as shown below.</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-typemismatch2.png"><img alt="../../_images/validations-typemismatch2.png" src="../../_images/validations-typemismatch2.png" style="width: 60%;" /></a>
</div>
<div class="line-block">
<div class="line">Field name can be inserted in the message by specifying <code class="docutils literal"><span class="pre">{0}</span></code> in the message; This is as per the description in <a class="reference internal" href="#validation-message-in-application-messages"><span class="std std-ref">Messages to be defined in application-messages.properties</span></a>.</div>
<div class="line"><strong>Default messages should be defined</strong>.</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Refer to <a class="reference external" href="http://docs.spring.io/spring/docs/4.3.5.RELEASE/javadoc-api/org/springframework/validation/DefaultMessageCodesResolver.html">Javadoc of DefaultMessageCodesResolver</a> for the details of message key rules.</p>
</div>
</div>
<div class="section" id="binding-null-to-blank-string-field">
<span id="validation-string-trimmer-editor"></span><h3><a class="toc-backref" href="#id45">4.1.4.5. Binding null to blank string field</a><a class="headerlink" href="#binding-null-to-blank-string-field" title="Permalink to this headline">¶</a></h3>
<p>When the form is sent with input fields left blank in Spring MVC,
empty string instead of <code class="docutils literal"><span class="pre">null</span></code> binds to form object by default.</p>
<p>In this case, the conditions like “blank is allowed but if specified, it must have at least 6 characters” is not satisfied by the use of existing annotations.</p>
<div class="line-block">
<div class="line">To bind <code class="docutils literal"><span class="pre">null</span></code> instead of empty string to the properties without any input,</div>
<div class="line"><code class="docutils literal"><span class="pre">org.springframework.beans.propertyeditors.StringTrimmerEditor</span></code> can be used as follows.</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;xxx&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">XxxController</span> <span class="p">{</span>

    <span class="nd">@InitBinder</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinder</span><span class="p">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// bind empty strings as null</span>
        <span class="n">binder</span><span class="p">.</span><span class="na">registerCustomEditor</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="k">new</span> <span class="n">StringTrimmerEditor</span><span class="p">(</span><span class="kc">true</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="c1">// omitted ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the help of this configuration, it can be specified in the controller whether empty strings which are to be considered as <code class="docutils literal"><span class="pre">null</span></code> or not.</p>
<p><a class="reference internal" href="../../ImplementationAtEachLayer/ApplicationLayer.html#application-layer-controller-advice"><span class="std std-ref">&#64;ControllerAdvice</span></a> can be set as a configuration common to the entire project when you want to set reply empty string to <code class="docutils literal"><span class="pre">null</span></code> in the entire project.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>About attribute of &#64;ControllerAdvice annotation added from Spring Framework 4.0</strong></p>
<p class="last">By specifying attribute of <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation,
it has been improved to allow flexibility in specifying Controller to apply a method implemented in a class wherein <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> is assigned.
For details about attribute refer to <a class="reference internal" href="../../ImplementationAtEachLayer/ApplicationLayer.html#application-layer-controller-advice-attribute"><span class="std std-ref">Attribute of &#64;ControllerAdvice</span></a>.</p>
</div>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@ControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">XxxControllerAdvice</span> <span class="p">{</span>

    <span class="nd">@InitBinder</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinder</span><span class="p">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// bind empty strings as null</span>
        <span class="n">binder</span><span class="p">.</span><span class="na">registerCustomEditor</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="k">new</span> <span class="n">StringTrimmerEditor</span><span class="p">(</span><span class="kc">true</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="c1">// omitted ...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">When this setting is made, all empty String values set to String fields of form object become <code class="docutils literal"><span class="pre">null</span></code>.</div>
<div class="line">Therefore it must be noted that, it becomes necessary to specify <code class="docutils literal"><span class="pre">&#64;NotNull</span></code> in case of mandatory check.</div>
</div>
</div>
<div class="section" id="reading-messages-which-are-not-converted-from-native-to-ascii">
<span id="validation-without-native2ascii"></span><h3><a class="toc-backref" href="#id46">4.1.4.6. Reading messages which are not converted from Native to Ascii</a><a class="headerlink" href="#reading-messages-which-are-not-converted-from-native-to-ascii" title="Permalink to this headline">¶</a></h3>
<p>A method to read Bean Validation message （<code class="docutils literal"><span class="pre">ValidationMessage.properties</span></code>） is introduced without converting the message from  Native to Ascii.</p>
<p>When the Japanese message is to be handled directly without converting from  Native to Ascii, it can be easily implemented if it is linked with <code class="docutils literal"><span class="pre">MessageSource</span></code> of Spring.</p>
<p>If it is defined as below,, message read by <code class="docutils literal"><span class="pre">MessageSource</span></code> function can be used in <code class="docutils literal"><span class="pre">Hibernate</span> <span class="pre">Validator</span></code>.</p>
<ul>
<li><p class="first">Bean definition</p>
<p><code class="docutils literal"><span class="pre">*-domain.xml</span></code></p>
</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;validator&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework.validation.beanvalidation.LocalValidatorFactoryBean&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;validationMessageSource&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- (2) --&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.context.support.ResourceBundleMessageSource&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;basenames&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;list&gt;</span>
                    <span class="nt">&lt;value&gt;</span>ValidationMessages<span class="nt">&lt;/value&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
                <span class="nt">&lt;/list&gt;</span>
            <span class="nt">&lt;/property&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;defaultEncoding&quot;</span> <span class="na">value=</span><span class="s">&quot;UTF-8&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!-- (4) --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.validation.beanvalidation.MethodValidationPostProcessor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;validator&quot;</span> <span class="na">ref=</span><span class="s">&quot;validator&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">spring-mvc.xml</span></code></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- (5) --&gt;</span>
<span class="nt">&lt;mvc:annotation-driven</span> <span class="na">validator=</span><span class="s">&quot;validator&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- ommited --&gt;</span>
<span class="nt">&lt;/mvc:annotation-driven&gt;</span>

<span class="c">&lt;!-- (6) --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.validation.beanvalidation.MethodValidationPostProcessor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;validator&quot;</span> <span class="na">ref=</span><span class="s">&quot;validator&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Define a Bean for <code class="docutils literal"><span class="pre">LocalValidatorFactoryBean</span></code>.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Define <code class="docutils literal"><span class="pre">MessageSource</span></code>. Here, <code class="docutils literal"><span class="pre">ResourceBundleMessageSource</span></code> is used.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Specify a resource bundle to be read in <code class="docutils literal"><span class="pre">ApplicationContext</span></code>.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify a Bean defined by (1) in <code class="docutils literal"><span class="pre">validator</span></code> property of <code class="docutils literal"><span class="pre">MethodValidationPostProcessor</span></code> while using <a class="reference internal" href="#methodvalidation"><span class="std std-ref">Method Validation</span></a>.</div>
<div class="line">When Method Validation is not used, the Bean definition is not required.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td>Specify a Bean defined in (1), in  <code class="docutils literal"><span class="pre">validator</span></code>attribute of <code class="docutils literal"><span class="pre">&lt;mvc:annotation-driven&gt;</span></code>element.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td>Same as (4).</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">By using <code class="docutils literal"><span class="pre">MessageSource</span></code>function,
property file is not necessarily restricted to be placed just under class path. Further, multiple property files can also be specified.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="os-command-injection-countermeasures">
<span id="validation-os-command-injection"></span><h3><a class="toc-backref" href="#id47">4.1.4.7. OS Command Injection Countermeasures</a><a class="headerlink" href="#os-command-injection-countermeasures" title="Permalink to this headline">¶</a></h3>
<p>OS command injection, a type of security vulnerability and its countermeasures are explained here.</p>
<div class="section" id="what-is-os-command-injection">
<h4><a class="toc-backref" href="#id48">4.1.4.7.1. What is OS command injection -</a><a class="headerlink" href="#what-is-os-command-injection" title="Permalink to this headline">¶</a></h4>
<p>OS command injection is an issue which occurs when malicious commands are supplied to the user input string resulting in illegal manipulation of the computer,
when command execution strings are assembled from user input strings in the application.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">For details, refer <a class="reference external" href="https://www.owasp.org/index.php/OS_Command_Injection">Description page</a> of OWASP.</p>
</div>
<p>In Java, OS command injection can occur when following are used as the commands to be executed when commands are executed
using <code class="docutils literal"><span class="pre">exec</span></code> method of <code class="docutils literal"><span class="pre">ProcessBuilder</span></code>class  and <code class="docutils literal"><span class="pre">Runtime</span></code> class.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">/bin/sh</span></code> (in case of Unix system) or <code class="docutils literal"><span class="pre">cmd.exe</span></code> (In case of Windows)</li>
<li>String input by user</li>
</ul>
<p>An example wherein OS command injection occurs when <code class="docutils literal"><span class="pre">/bin/sh</span></code> is used, is shown below.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">ProcessBuilder</span> <span class="n">pb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ProcessBuilder</span><span class="p">(</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">,</span> <span class="s">&quot;-c&quot;</span><span class="p">,</span> <span class="n">script</span><span class="p">);</span> <span class="c1">// (1)</span>
<span class="n">Process</span> <span class="n">p</span> <span class="o">=</span> <span class="n">pb</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">For example, when “exec.sh ; cat /etc/passwd” is input in the <code class="docutils literal"><span class="pre">script</span></code>, semicolon in the string is interpreted as a delimiter by <code class="docutils literal"><span class="pre">/bin/sh</span></code> and “cat /etc/passwd” is executed.</div>
<div class="line">Hence, <code class="docutils literal"><span class="pre">/etc/passwd</span></code> is likely to be output depending on how the standard output is handled.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>How to use ScriptEngine and ScriptTemplateViewResolver</strong></p>
<p>Another language  (<code class="docutils literal"><span class="pre">Ruby</span></code>or <code class="docutils literal"><span class="pre">Python</span></code>etc) can be used on JVM , in <code class="docutils literal"><span class="pre">ScriptEngine</span></code> added from  Java SE 6
or <code class="docutils literal"><span class="pre">ScriptTemplateViewResolver</span></code> added from  Spring Framework 4.2.</p>
<p class="last">When code of another language is to be executed using this function, care must be taken while using the function
since OS command injection is likely to occur during writing the code.</p>
</div>
</div>
<div class="section" id="countermeasures">
<h4><a class="toc-backref" href="#id49">4.1.4.7.2. Countermeasures</a><a class="headerlink" href="#countermeasures" title="Permalink to this headline">¶</a></h4>
<p>Running external processes should be avoided as much as possible in order to prevent occurrence of OS command injection. However, if it is necessary to execute the external process due to certain circumstances,
it must be executed after implementing the countermeasures below.</p>
<ul class="simple">
<li>Commands which use <code class="docutils literal"><span class="pre">/bin/sh</span></code> (in case of Unix system) and <code class="docutils literal"><span class="pre">cmd.exe</span></code> (in case of Windows) should not be executed as far as possible.</li>
<li>Check whether the characters entered by user are allowed by the application using the whitelist system</li>
</ul>
<p>The rules to check whether commands and arguments entered by the user are configured  by the specified string are shown below.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Pattern</span><span class="p">(</span><span class="n">regexp</span> <span class="o">=</span> <span class="s">&quot;batch0\\d\\.sh&quot;</span><span class="p">)</span> <span class="c1">// (1)</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">cmdStr</span><span class="p">;</span>

<span class="nd">@Pattern</span><span class="p">(</span><span class="n">regexp</span> <span class="o">=</span> <span class="s">&quot;[\\w=_]+&quot;</span><span class="p">)</span>  <span class="c1">// (2)</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">arg</span><span class="p">;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify rule to allow only <code class="docutils literal"><span class="pre">batch0X.sh</span></code>(X is a single byte numeral from 0 to 9).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify rule to allow only the strings configured from  innocuous alphanumeric characters (\w）、<code class="docutils literal"><span class="pre">=</span></code>、<code class="docutils literal"><span class="pre">_</span></code>) as arguments.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this example, directory traversal is prevented by establishing a rule wherein the path is not included in the commands or arguments.</p>
</div>
<p>When <code class="docutils literal"><span class="pre">&#64;Pattern</span></code> is used, regular expressions specified in <code class="docutils literal"><span class="pre">&#64;Pattern</span></code> are output as error messages and
are considered invalid as messages due to following points.</p>
<ul class="simple">
<li>Significance of error is not clear, not user-friendly</li>
<li>logic for the countermeasures to the vulnerability is exposed to the user</li>
</ul>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-os-command-injection.png"><img alt="../../_images/validations-os-command-injection.png" src="../../_images/validations-os-command-injection.png" style="width: 60%;" /></a>
</div>
<p>A valid message is defined in application-messages.properties to conceal the logic by clarifying the significance of error.
For how to define a message, refer <a class="reference internal" href="#validation-message-in-application-messages"><span class="std std-ref">Messages to be defined in application-messages.properties</span></a>.</p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">Pattern.cmdForm.cmdStr</span> <span class="o">=</span> <span class="s">permit command name: batch00.sh - batch09.sh</span>
<span class="na">Pattern.cmdForm.arg</span> <span class="o">=</span> <span class="s">permit parameter characters and symbols: alphanumeric, =, _</span>
</pre></div>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/validations-os-command-injection2.png"><img alt="../../_images/validations-os-command-injection2.png" src="../../_images/validations-os-command-injection2.png" style="width: 60%;" /></a>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ExceptionHandling.html" title="4.2. Exception Handling"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="4. Web Application Development Features"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.3.0.RELEASE documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >4. Web Application Development Features</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
      © Copyright 2013-2017, NTT DATA Corporation. © Copyright 2017, NTT Corporation.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.Theme by <a href="http://github.com/vkvn">vkvn</a>
    </div>
    
    <script>
    
    $(function() {
    	var $sidebar	= $('.sphinxsidebar'),
    		$window		= $(window),
    		offset		= $sidebar.offset(),
    		topPadding	= 3,
    		$scroll		= $('#scroll');
    	
    	$window.scroll(function() {
    		if ($scroll.is(':checked')) {
				if ($window.scrollTop() > offset.top) {
					$sidebar.stop().animate({
						marginTop:$window.scrollTop() - offset.top + topPadding
					});
				} else {
					$sidebar.stop().animate({
						marginTop:0
					});
				}
			}
		});
    	
    	var $navList = $('ul:first', $sidebar);
    	$('li:first', $navList).addClass('open');
    	
    	$navList.treeview({
    		persist: "location",
    		collapsed: true,
    		unique: false
    	});
    	
	});
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-46550814-1', 'terasolunaorg.github.io');
    ga('send', 'pageview');
    </script>
  </body>
</html>