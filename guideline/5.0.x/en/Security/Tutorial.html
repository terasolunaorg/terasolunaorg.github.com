<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6.2. Spring Security Tutorial &mdash; TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.1.0-SNAPSHOT documentation</title>
    
    <link rel="stylesheet" href="../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.1.0-SNAPSHOT',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.1.0-SNAPSHOT documentation" href="../index.html" />
    <link rel="up" title="6. Security for TERASOLUNA Server Framework for Java (5.x)" href="index.html" />
    <link rel="next" title="6.3. Authentication" href="Authentication.html" />
    <link rel="prev" title="6.1. Spring Security Overview" href="SpringSecurity.html" /><script src="../_static/jquery.treeview.js" type="text/javascript"></script>
<!-- <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'> -->
<link href="../_static/solarized-dark.css" rel="stylesheet">
<link href="../_static/jquery.treeview.css" rel="stylesheet">
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Authentication.html" title="6.3. Authentication"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="SpringSecurity.html" title="6.1. Spring Security Overview"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.1.0-SNAPSHOT documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">6. Security for TERASOLUNA Server Framework for Java (5.x)</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><label><input id="scroll" type="checkbox" checked> scroll sidebar</label>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">6.2. Spring Security Tutorial</a><ul>
<li><a class="reference internal" href="#introduction">6.2.1. Introduction</a><ul>
<li><a class="reference internal" href="#topics-covered-in-this-tutorial">6.2.1.1. Topics covered in this Tutorial</a></li>
<li><a class="reference internal" href="#target-audience">6.2.1.2. Target Audience</a></li>
</ul>
</li>
<li><a class="reference internal" href="#about-application-to-be-created">6.2.2. About application to be created</a><ul>
<li><a class="reference internal" href="#overview-of-application">6.2.2.1. Overview of application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-environment">6.2.3. Creating environment</a><ul>
<li><a class="reference internal" href="#creating-project">6.2.3.1. Creating project</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-application">6.2.4. Creating application</a><ul>
<li><a class="reference internal" href="#implementing-domain-layer">6.2.4.1. Implementing domain layer</a><ul>
<li><a class="reference internal" href="#creating-domain-object">6.2.4.1.1. Creating Domain Object</a></li>
<li><a class="reference internal" href="#creating-accountrepository">6.2.4.1.2. Creating AccountRepository</a></li>
<li><a class="reference internal" href="#creation-of-accountservice">6.2.4.1.3. Creation of AccountService</a></li>
<li><a class="reference internal" href="#creating-authentication-service">6.2.4.1.4. Creating Authentication Service</a></li>
<li><a class="reference internal" href="#package-explorer-after-creating-domain-layer">6.2.4.1.5. Package Explorer after Creating Domain Layer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation-of-application-layer">6.2.4.2. Implementation of Application Layer</a><ul>
<li><a class="reference internal" href="#spring-security-settings">6.2.4.2.1. Spring Security settings</a></li>
<li><a class="reference internal" href="#settings-of-sql-scripts-to-be-executed-at-the-time-of-starting-the-application">6.2.4.2.2. Settings of SQL scripts to be executed at the time of starting the application</a></li>
<li><a class="reference internal" href="#creating-login-screen">6.2.4.2.3. Creating Login Screen</a></li>
<li><a class="reference internal" href="#accessing-login-account-information-from-jsp">6.2.4.2.4. Accessing Login account information from JSP</a></li>
<li><a class="reference internal" href="#creation-of-login-account-information-display-page">6.2.4.2.5. Creation of Login Account Information Display Page</a></li>
<li><a class="reference internal" href="#package-explorer-after-creating-application-layer">6.2.4.2.6. Package explorer after creating application layer</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#summary">6.2.5. Summary</a></li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="SpringSecurity.html"
                        title="previous chapter">6.1. Spring Security Overview</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Authentication.html"
                        title="next chapter">6.3. Authentication</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/Security/Tutorial.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="spring-security-tutorial">
<h1>6.2. Spring Security Tutorial<a class="headerlink" href="#spring-security-tutorial" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id3">Introduction</a><ul>
<li><a class="reference internal" href="#topics-covered-in-this-tutorial" id="id4">Topics covered in this Tutorial</a></li>
<li><a class="reference internal" href="#target-audience" id="id5">Target Audience</a></li>
</ul>
</li>
<li><a class="reference internal" href="#about-application-to-be-created" id="id6">About application to be created</a><ul>
<li><a class="reference internal" href="#overview-of-application" id="id7">Overview of application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-environment" id="id8">Creating environment</a><ul>
<li><a class="reference internal" href="#creating-project" id="id9">Creating project</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-application" id="id10">Creating application</a><ul>
<li><a class="reference internal" href="#implementing-domain-layer" id="id11">Implementing domain layer</a><ul>
<li><a class="reference internal" href="#creating-domain-object" id="id12">Creating Domain Object</a></li>
<li><a class="reference internal" href="#creating-accountrepository" id="id13">Creating AccountRepository</a></li>
<li><a class="reference internal" href="#creation-of-accountservice" id="id14">Creation of AccountService</a></li>
<li><a class="reference internal" href="#creating-authentication-service" id="id15">Creating Authentication Service</a></li>
<li><a class="reference internal" href="#package-explorer-after-creating-domain-layer" id="id16">Package Explorer after Creating Domain Layer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation-of-application-layer" id="id17">Implementation of Application Layer</a><ul>
<li><a class="reference internal" href="#spring-security-settings" id="id18">Spring Security settings</a></li>
<li><a class="reference internal" href="#settings-of-sql-scripts-to-be-executed-at-the-time-of-starting-the-application" id="id19">Settings of SQL scripts to be executed at the time of starting the application</a></li>
<li><a class="reference internal" href="#creating-login-screen" id="id20">Creating Login Screen</a></li>
<li><a class="reference internal" href="#accessing-login-account-information-from-jsp" id="id21">Accessing Login account information from JSP</a></li>
<li><a class="reference internal" href="#creation-of-login-account-information-display-page" id="id22">Creation of Login Account Information Display Page</a></li>
<li><a class="reference internal" href="#package-explorer-after-creating-application-layer" id="id23">Package explorer after creating application layer</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#summary" id="id24">Summary</a></li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id3">6.2.1. Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<div class="section" id="topics-covered-in-this-tutorial">
<h3><a class="toc-backref" href="#id4">6.2.1.1. Topics covered in this Tutorial</a><a class="headerlink" href="#topics-covered-in-this-tutorial" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Basic authentication/authorization using Spring Security</li>
<li>Login using the account information in the database</li>
<li>Fetching authenticated account object</li>
</ul>
</div>
<div class="section" id="target-audience">
<h3><a class="toc-backref" href="#id5">6.2.1.2. Target Audience</a><a class="headerlink" href="#target-audience" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Completed implementation of <a class="reference internal" href="../TutorialTodo/index.html"><em>Tutorial (Todo Application)</em></a></li>
<li>Understanding of basic operations of Maven</li>
</ul>
</div>
</div>
<div class="section" id="about-application-to-be-created">
<h2><a class="toc-backref" href="#id6">6.2.2. About application to be created</a><a class="headerlink" href="#about-application-to-be-created" title="Permalink to this headline">¶</a></h2>
<div class="section" id="overview-of-application">
<h3><a class="toc-backref" href="#id7">6.2.2.1. Overview of application</a><a class="headerlink" href="#overview-of-application" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Login is possible. Account information for login has been stored in the database.</li>
<li>There is a Welcome screen and Account information display screen which can be viewed only by the logged in users.</li>
<li>Logout is possible.</li>
</ul>
<p>Overview of application is shown in the following figure.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/security_tutorial_applicatioin_overview.png"><img alt="../_images/security_tutorial_applicatioin_overview.png" src="../_images/security_tutorial_applicatioin_overview.png" style="width: 80%;" /></a>
</div>
<p>URL list is shown below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="15%" />
<col width="15%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Process name</th>
<th class="head">HTTP method</th>
<th class="head">URL</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>Login form display</td>
<td>GET</td>
<td>/login.jsp</td>
<td>Displays login form</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>Login</td>
<td>POST</td>
<td>/authentication</td>
<td>Authenticates using username and password entered from login form (performed by Spring Security)</td>
</tr>
<tr class="row-even"><td>3</td>
<td>Welcome page display</td>
<td>GET</td>
<td>/</td>
<td>Displays Welcome page.</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>Account information display</td>
<td>GET</td>
<td>/account</td>
<td>Displays logged in account information.</td>
</tr>
<tr class="row-even"><td>5</td>
<td>Logout</td>
<td>GET</td>
<td>/logout</td>
<td>Performs logout (performed by Spring Security)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="creating-environment">
<h2><a class="toc-backref" href="#id8">6.2.3. Creating environment</a><a class="headerlink" href="#creating-environment" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-project">
<h3><a class="toc-backref" href="#id9">6.2.3.1. Creating project</a><a class="headerlink" href="#creating-project" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Create <a class="reference external" href="https://github.com/terasolunaorg/terasoluna-gfw-web-blank">TERASOLUNA Server Framework for Java (5.x) template</a> using Maven archetype.</div>
<div class="line">For the method  of importing Spring tool suite and method to start the application server, refer to <em class="xref std std-ref">CreateProjectFromBlank_create-new-project</em>.</div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> mvn archetype:generate -DarchetypeCatalog<span class="o">=</span>http://repo.terasoluna.org/nexus/content/repositories/terasoluna-gfw-releases
<span class="go">[INFO] Scanning for projects...</span>
<span class="go">[INFO]</span>
<span class="go">[INFO] ------------------------------------------------------------------------</span>
<span class="go">[INFO] Building Maven Stub Project (No POM) 1</span>
<span class="go">[INFO] ------------------------------------------------------------------------</span>
<span class="go">[INFO]</span>
<span class="go">[INFO] &gt;&gt;&gt; maven-archetype-plugin:2.2:generate (default-cli) @ standalone-pom &gt;&gt;&gt;</span>
<span class="go">[INFO]</span>
<span class="go">[INFO] &lt;&lt;&lt; maven-archetype-plugin:2.2:generate (default-cli) @ standalone-pom &lt;&lt;&lt;</span>
<span class="go">[INFO]</span>
<span class="go">[INFO] --- maven-archetype-plugin:2.2:generate (default-cli) @ standalone-pom ---</span>
<span class="go">[INFO] Generating project in Interactive mode</span>
<span class="go">[INFO] No archetype defined. Using maven-archetype-quickstart (org.apache.maven.archetypes:maven-archetype-quickstart:1.0)</span>
<span class="go">Choose archetype:</span>
<span class="go">1: http://repo.terasoluna.org/nexus/content/repositories/terasoluna-gfw-releases -&gt; org.terasoluna.gfw.blank:terasoluna-gfw-web-blank-archetype (Blank project using TERASOLUNA Server Framework for Java (5.x))</span>
<span class="go">2: http://repo.terasoluna.org/nexus/content/repositories/terasoluna-gfw-releases -&gt; org.terasoluna.gfw.blank:terasoluna-gfw-web-blank-jpa-archetype (Blank project using TERASOLUNA Server Framework for Java (5.x) (JPA))</span>
<span class="go">3: http://repo.terasoluna.org/nexus/content/repositories/terasoluna-gfw-releases -&gt; org.terasoluna.gfw.blank:terasoluna-gfw-web-blank-mybatis2-archetype (Blank project using TERASOLUNA Server Framework for Java (5.x) (MyBatis2))</span>
</pre></div>
</div>
<p>The user is asked to select a type. Select &#8220;3&#8221; since this option uses MyBatis2 to access data.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): : 3</span>
</pre></div>
</div>
<p>groupId, artifactId, version and package are as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><th class="stub">groupId</th>
<td>com.example.security</td>
</tr>
<tr class="row-even"><th class="stub">artifactId</th>
<td>first-springsecurity</td>
</tr>
<tr class="row-odd"><th class="stub">version</th>
<td>1.0-SNAPSHOT</td>
</tr>
<tr class="row-even"><th class="stub">package</th>
<td>com.example.security</td>
</tr>
</tbody>
</table>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Define value for property &#39;groupId&#39;: : com.example.security</span>
<span class="go">Define value for property &#39;artifactId&#39;: : first-springsecurity</span>
<span class="go">Define value for property &#39;version&#39;:  1.0-SNAPSHOT: :</span>
<span class="go">Define value for property &#39;package&#39;:  com.example.security: :</span>
<span class="go">Confirm properties configuration:</span>
<span class="go">groupId: com.example.security</span>
<span class="go">artifactId: first-springsecurity</span>
<span class="go">version: 1.0-SNAPSHOT</span>
<span class="go">package: com.example.security</span>
<span class="go"> Y: :</span>
<span class="go">[INFO] ----------------------------------------------------------------------------</span>
<span class="go">[INFO] Using following parameters for creating project from Archetype: terasoluna-gfw-web-blank-mybatis2-archetype:1.0.0.RELEASE</span>
<span class="go">[INFO] ----------------------------------------------------------------------------</span>
<span class="go">[INFO] Parameter: groupId, Value: com.example.security</span>
<span class="go">[INFO] Parameter: artifactId, Value: first-springsecurity</span>
<span class="go">[INFO] Parameter: version, Value: 1.0-SNAPSHOT</span>
<span class="go">[INFO] Parameter: package, Value: com.example.security</span>
<span class="go">[INFO] Parameter: packageInPathFormat, Value: com/example/security</span>
<span class="go">[INFO] Parameter: package, Value: com.example.security</span>
<span class="go">[INFO] Parameter: version, Value: 1.0-SNAPSHOT</span>
<span class="go">[INFO] Parameter: groupId, Value: com.example.security</span>
<span class="go">[INFO] Parameter: artifactId, Value: first-springsecurity</span>
<span class="go">[INFO] project created from Archetype in dir: /Users/xxx/first-springsecurity</span>
<span class="go">[INFO] ------------------------------------------------------------------------</span>
<span class="go">[INFO] BUILD SUCCESS</span>
<span class="go">[INFO] ------------------------------------------------------------------------</span>
<span class="go">[INFO] Total time: 51.891s</span>
<span class="go">[INFO] Finished at: Mon Dec 02 14:03:11 JST 2013</span>
<span class="go">[INFO] Final Memory: 13M/116M</span>
<span class="go">[INFO] ------------------------------------------------------------------------</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-application">
<h2><a class="toc-backref" href="#id10">6.2.4. Creating application</a><a class="headerlink" href="#creating-application" title="Permalink to this headline">¶</a></h2>
<div class="section" id="implementing-domain-layer">
<h3><a class="toc-backref" href="#id11">6.2.4.1. Implementing domain layer</a><a class="headerlink" href="#implementing-domain-layer" title="Permalink to this headline">¶</a></h3>
<p>The flow of authentication process of Spring Security is as follows:</p>
<ol class="arabic simple">
<li>Search user information from the entered <tt class="docutils literal"><span class="pre">username</span></tt>.</li>
<li>When user information exists, compare the password having user information with the hashed password.</li>
<li>When the passwords match, authentication is considered successful.</li>
</ol>
<p>When user information is not found and if the passwords do not match, authentication fails.</p>
<p>In domain layer, process of fetching the Account object from user name is essential. The process is executed in the following order.</p>
<ol class="arabic simple">
<li>Creation of Domain Object(Account)</li>
<li>Creation of AccountRepository</li>
<li>Creation of AccountService</li>
</ol>
<p>Use the following for Account table (add post processing for DDL script).</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">account</span><span class="p">(</span>
    <span class="n">username</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span><span class="n">w</span>
    <span class="n">password</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span>
    <span class="n">first_name</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span>
    <span class="n">last_name</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span>
    <span class="k">constraint</span> <span class="n">pk_tbl_account</span> <span class="k">primary</span> <span class="k">key</span> <span class="p">(</span><span class="n">username</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="section" id="creating-domain-object">
<h4><a class="toc-backref" href="#id12">6.2.4.1.1. Creating Domain Object</a><a class="headerlink" href="#creating-domain-object" title="Permalink to this headline">¶</a></h4>
<p>Provide the following <tt class="docutils literal"><span class="pre">Account</span></tt> class. This class contains authentication information (user name and password).</p>
<ul>
<li><p class="first">src/main/java/com/example/security/domain/model/Account.java</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">model</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Account</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">username</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">lastName</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getUsername</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">username</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUsername</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">username</span> <span class="o">=</span> <span class="n">username</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPassword</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">password</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPassword</span><span class="o">(</span><span class="n">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">password</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getFirstName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">firstName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setFirstName</span><span class="o">(</span><span class="n">String</span> <span class="n">firstName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">firstName</span> <span class="o">=</span> <span class="n">firstName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getLastName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">lastName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLastName</span><span class="o">(</span><span class="n">String</span> <span class="n">lastName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">lastName</span> <span class="o">=</span> <span class="n">lastName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;Account [username=&quot;</span> <span class="o">+</span> <span class="n">username</span> <span class="o">+</span> <span class="s">&quot;, password=&quot;</span> <span class="o">+</span> <span class="n">password</span>
                <span class="o">+</span> <span class="s">&quot;, firstName=&quot;</span> <span class="o">+</span> <span class="n">firstName</span> <span class="o">+</span> <span class="s">&quot;, lastName=&quot;</span> <span class="o">+</span> <span class="n">lastName</span> <span class="o">+</span> <span class="s">&quot;]&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="creating-accountrepository">
<h4><a class="toc-backref" href="#id13">6.2.4.1.2. Creating AccountRepository</a><a class="headerlink" href="#creating-accountrepository" title="Permalink to this headline">¶</a></h4>
<p>Implement data access logic for fetching Account object from user name in <tt class="docutils literal"><span class="pre">AccountRepository</span></tt>.</p>
<ul>
<li><p class="first">src/main/java/com/example/security/domain/repository/account/AccountRepository.java</p>
<p>First, define the interface. Then define <tt class="docutils literal"><span class="pre">findOne(username)</span></tt>for fetching Account object from user name.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">repository</span><span class="o">.</span><span class="na">account</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.example.security.domain.model.Account</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AccountRepository</span> <span class="o">{</span>
    <span class="n">Account</span> <span class="nf">findOne</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
<li><p class="first">src/main/java/com/example/security/domain/repository/account/AccountRepositoryImpl.java</p>
<p>Implement data access logic in <tt class="docutils literal"><span class="pre">AccountRepositoryImpl</span></tt>.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">repository</span><span class="o">.</span><span class="na">account</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">jp.terasoluna.fw.dao.QueryDAO</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.example.security.domain.model.Account</span><span class="o">;</span>

<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AccountRepositoryImpl</span> <span class="kd">implements</span> <span class="n">AccountRepository</span> <span class="o">{</span>
    <span class="nd">@Inject</span>
    <span class="n">QueryDAO</span> <span class="n">queryDAO</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Account</span> <span class="nf">findOne</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="n">queryDAO</span><span class="o">.</span><span class="na">executeForObject</span><span class="o">(</span><span class="s">&quot;account.findOne&quot;</span><span class="o">,</span>
                <span class="n">username</span><span class="o">,</span> <span class="n">Account</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">account</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</li>
<li><p class="first">src/main/resources/META-INF/mybatis/sql/account-sqlmap.xml</p>
<p>Define SQL corresponding to SQLID <tt class="docutils literal"><span class="pre">&quot;account.findOne&quot;</span></tt> for fetching <tt class="docutils literal"><span class="pre">Account</span></tt> in SQLMap file.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE sqlMap</span>
<span class="cp">            PUBLIC &quot;-//ibatis.apache.org//DTD SQL Map 2.0//EN&quot;</span>
<span class="cp">            &quot;http://ibatis.apache.org/dtd/sql-map-2.dtd&quot;&gt;</span>

<span class="nt">&lt;sqlMap</span> <span class="na">namespace=</span><span class="s">&quot;account&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&quot;account&quot;</span>
        <span class="na">class=</span><span class="s">&quot;com.example.security.domain.model.Account&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;username&quot;</span> <span class="na">column=</span><span class="s">&quot;username&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;password&quot;</span> <span class="na">column=</span><span class="s">&quot;password&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;firstName&quot;</span> <span class="na">column=</span><span class="s">&quot;first_name&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&quot;lastName&quot;</span> <span class="na">column=</span><span class="s">&quot;last_name&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>


    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;findOne&quot;</span> <span class="na">parameterClass=</span><span class="s">&quot;java.lang.String&quot;</span>
        <span class="na">resultMap=</span><span class="s">&quot;account&quot;</span><span class="nt">&gt;</span><span class="cp">&lt;![CDATA[</span>
<span class="cp">SELECT username,</span>
<span class="cp">       password,</span>
<span class="cp">       first_name,</span>
<span class="cp">       last_name</span>
<span class="cp">FROM   account</span>
<span class="cp">WHERE  username = #value#</span>
<span class="cp">]]&gt;</span><span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/sqlMap&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="creation-of-accountservice">
<h4><a class="toc-backref" href="#id14">6.2.4.1.3. Creation of AccountService</a><a class="headerlink" href="#creation-of-accountservice" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>src/main/java/com/example/security/domain/service/account/AccountService.java</li>
</ul>
<blockquote>
<div><p>Implement business logic for fetching  <tt class="docutils literal"><span class="pre">Account</span></tt> object from user name in <tt class="docutils literal"><span class="pre">AccountService</span></tt>.</p>
<blockquote>
<div><p>This logic is later used from authentication service of Spring Security; hence class name should be <tt class="docutils literal"><span class="pre">AccountSharedService</span></tt>.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">service</span><span class="o">.</span><span class="na">account</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.example.security.domain.model.Account</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AccountSharedService</span> <span class="o">{</span>
    <span class="n">Account</span> <span class="nf">findOne</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<ul>
<li><p class="first">src/main/java/com/example/security/domain/service/account/AccountServiceImpl.java</p>
<p>As a result of data access, if the corresponding <tt class="docutils literal"><span class="pre">Account</span></tt> does not exist, <tt class="docutils literal"><span class="pre">ResourceNotFoundException</span></tt> is thrown.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">service</span><span class="o">.</span><span class="na">account</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.exception.ResourceNotFoundException</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.example.security.domain.model.Account</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.example.security.domain.repository.account.AccountRepository</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AccountSharedServiceImpl</span> <span class="kd">implements</span> <span class="n">AccountSharedService</span> <span class="o">{</span>
    <span class="nd">@Inject</span>
    <span class="n">AccountRepository</span> <span class="n">accountRepository</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Account</span> <span class="nf">findOne</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="n">accountRepository</span><span class="o">.</span><span class="na">findOne</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">account</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ResourceNotFoundException</span><span class="o">(</span><span class="s">&quot;The given account is not found! username=&quot;</span>
                    <span class="o">+</span> <span class="n">username</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">account</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="creating-authentication-service">
<h4><a class="toc-backref" href="#id15">6.2.4.1.4. Creating Authentication Service</a><a class="headerlink" href="#creating-authentication-service" title="Permalink to this headline">¶</a></h4>
<p>Implement <tt class="docutils literal"><span class="pre">org.springframework.security.core.userdetails.UserDetails</span></tt> interface for authentication user information to be used in Spring Security.
Here, create project-specific <tt class="docutils literal"><span class="pre">UserDetails</span></tt> implementation class by inheriting it from <tt class="docutils literal"><span class="pre">org.springframework.security.core.userdetails.User</span></tt> class which in turn is implementation class of &#8220;UserDetails`` interface.</p>
<ul>
<li><p class="first">src/main/java/com/example/security/domain/service/userdetails/SampleUserDetails.java</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">service</span><span class="o">.</span><span class="na">userdetails</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Collection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collections</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.security.core.GrantedAuthority</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.core.authority.SimpleGrantedAuthority</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.core.userdetails.User</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.example.security.domain.model.Account</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleUserDetails</span> <span class="kd">extends</span> <span class="n">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Account</span> <span class="n">account</span><span class="o">;</span> <span class="c1">// (1)</span>

    <span class="kd">public</span> <span class="nf">SampleUserDetails</span><span class="o">(</span><span class="n">Account</span> <span class="n">account</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">account</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span> <span class="n">account</span><span class="o">.</span><span class="na">getPassword</span><span class="o">(),</span> <span class="n">createRole</span><span class="o">(</span><span class="n">account</span><span class="o">));</span> <span class="c1">// (2)</span>
        <span class="k">this</span><span class="o">.</span><span class="na">account</span> <span class="o">=</span> <span class="n">account</span><span class="o">;</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">GrantedAuthority</span><span class="o">&gt;</span> <span class="n">createRole</span><span class="o">(</span>
            <span class="n">Account</span> <span class="n">account</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// sample role</span>
        <span class="k">return</span> <span class="n">Collections</span>
                <span class="o">.</span><span class="na">singletonList</span><span class="o">(</span><span class="k">new</span> <span class="n">SimpleGrantedAuthority</span><span class="o">(</span><span class="s">&quot;ROLE_USER&quot;</span><span class="o">));</span> <span class="c1">// (3)</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Account</span> <span class="nf">getAccount</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// (4)</span>
        <span class="k">return</span> <span class="n">account</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><p class="first last">Sr. No.</p>
</th>
<th class="head"><p class="first last">Description</p>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Maintain account information of this project in authentication user class of Spring.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call the constructor of <tt class="docutils literal"><span class="pre">User</span></tt> class. The first argument is user name, the second is password and the third is authority list.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">As a simple implementation, create an authority containing only the role <tt class="docutils literal"><span class="pre">&quot;ROLE_USER&quot;</span></tt>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Provide getter of account information. This enables fetching of logged in <tt class="docutils literal"><span class="pre">Account</span></tt> object.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">src/main/java/com/example/security/domain/service/userdetails/SampleUserDetailsService.java</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">service</span><span class="o">.</span><span class="na">userdetails</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.security.core.userdetails.UserDetails</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.core.userdetails.UserDetailsService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.core.userdetails.UsernameNotFoundException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.terasoluna.gfw.common.exception.ResourceNotFoundException</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.example.security.domain.model.Account</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.example.security.domain.service.account.AccountSharedService</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleUserDetailsService</span> <span class="kd">implements</span> <span class="n">UserDetailsService</span> <span class="o">{</span>
    <span class="nd">@Inject</span>
    <span class="n">AccountSharedService</span> <span class="n">accountSharedService</span><span class="o">;</span> <span class="c1">// (1)</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">UserDetails</span> <span class="nf">loadUserByUsername</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">UsernameNotFoundException</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="n">accountSharedService</span><span class="o">.</span><span class="na">findOne</span><span class="o">(</span><span class="n">username</span><span class="o">);</span> <span class="c1">// (2)</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">SampleUserDetails</span><span class="o">(</span><span class="n">account</span><span class="o">);</span> <span class="c1">// (3)</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ResourceNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UsernameNotFoundException</span><span class="o">(</span><span class="s">&quot;user not found&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span> <span class="c1">// (4)</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><p class="first last">Sr. No.</p>
</th>
<th class="head"><p class="first last">Description</p>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inject <tt class="docutils literal"><span class="pre">AccountSharedService</span></tt>.</div>
<div class="line">In this guideline, Service calling is deprecated from Service and is being named as <tt class="docutils literal"><span class="pre">AccountSharedService</span></tt> instead of <tt class="docutils literal"><span class="pre">AccountService</span></tt>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Delegate the process of fetching <tt class="docutils literal"><span class="pre">Account</span></tt>object from <tt class="docutils literal"><span class="pre">username</span></tt> to <tt class="docutils literal"><span class="pre">AccountSharedService</span></tt>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create project specific <tt class="docutils literal"><span class="pre">UserDetails</span></tt> object using the fetched <tt class="docutils literal"><span class="pre">Account</span></tt> object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When <tt class="docutils literal"><span class="pre">UserDetailsService</span></tt> cannot find the user, it throws <tt class="docutils literal"><span class="pre">UsernameNotFoundException</span></tt>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
<div class="section" id="package-explorer-after-creating-domain-layer">
<h4><a class="toc-backref" href="#id16">6.2.4.1.5. Package Explorer after Creating Domain Layer</a><a class="headerlink" href="#package-explorer-after-creating-domain-layer" title="Permalink to this headline">¶</a></h4>
<p>Hierarchical option is being used for Package Presentation of Package Explorer.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/security_tutorial-domain-layer-package-explorer.png"><img alt="security tutorial domain layer package explorer" src="../_images/security_tutorial-domain-layer-package-explorer.png" style="width: 40%;" /></a>
</div>
</div>
</div>
<div class="section" id="implementation-of-application-layer">
<h3><a class="toc-backref" href="#id17">6.2.4.2. Implementation of Application Layer</a><a class="headerlink" href="#implementation-of-application-layer" title="Permalink to this headline">¶</a></h3>
<div class="section" id="spring-security-settings">
<h4><a class="toc-backref" href="#id18">6.2.4.2.1. Spring Security settings</a><a class="headerlink" href="#spring-security-settings" title="Permalink to this headline">¶</a></h4>
<p>Perform authentication/authorization settings using Spring Security in spring-security.xml.</p>
<p>Settings for URL are as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Setting name</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Setting value</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">URL of login form</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">/login.jsp</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Destination URL when authentication fails</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">/login.jsp?error=true</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">URL for authentication</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">/authenticate</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Logout URL</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">/logout</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Destination URL after logout</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">/</div>
</div>
</td>
</tr>
</tbody>
</table>
<p id="tutorial-setting-spring-security">Only the differences with the blank project are given below.</p>
<ul>
<li><p class="first">src/main/resources/META-INF/spring/spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre> <span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
 <span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.springframework.org/schema/beans&quot;</span>
     <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="na">xmlns:sec=</span><span class="s">&quot;http://www.springframework.org/schema/security&quot;</span>
     <span class="na">xmlns:context=</span><span class="s">&quot;http://www.springframework.org/schema/context&quot;</span>
     <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd</span>
<span class="s">         http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span>
<span class="s">         http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span><span class="nt">&gt;</span>

     <span class="nt">&lt;sec:http</span> <span class="na">pattern=</span><span class="s">&quot;/resources/**&quot;</span> <span class="na">security=</span><span class="s">&quot;none&quot;</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;sec:http</span> <span class="na">auto-config=</span><span class="s">&quot;true&quot;</span> <span class="na">use-expressions=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<span class="hll">         <span class="nt">&lt;sec:form-login</span> <span class="na">login-page=</span><span class="s">&quot;/login.jsp&quot;</span>
</span><span class="hll">             <span class="na">authentication-failure-url=</span><span class="s">&quot;/login.jsp?error=true&quot;</span>
</span><span class="hll">             <span class="na">login-processing-url=</span><span class="s">&quot;/authenticate&quot;</span> <span class="nt">/&gt;</span><span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="hll">         <span class="nt">&lt;sec:logout</span> <span class="na">logout-url=</span><span class="s">&quot;/logout&quot;</span> <span class="na">logout-success-url=</span><span class="s">&quot;/&quot;</span>
</span><span class="hll">             <span class="na">delete-cookies=</span><span class="s">&quot;JSESSIONID&quot;</span> <span class="nt">/&gt;</span><span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">
</span><span class="hll">         <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/login.jsp&quot;</span>
</span><span class="hll">             <span class="na">access=</span><span class="s">&quot;permitAll&quot;</span> <span class="nt">/&gt;</span><span class="c">&lt;!-- (3) --&gt;</span>
</span><span class="hll">         <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/**&quot;</span> <span class="na">access=</span><span class="s">&quot;isAuthenticated()&quot;</span> <span class="nt">/&gt;</span><span class="c">&lt;!-- (4) --&gt;</span>
</span>
         <span class="nt">&lt;sec:custom-filter</span> <span class="na">ref=</span><span class="s">&quot;csrfFilter&quot;</span> <span class="na">before=</span><span class="s">&quot;LOGOUT_FILTER&quot;</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;sec:custom-filter</span> <span class="na">ref=</span><span class="s">&quot;userIdMDCPutFilter&quot;</span>
             <span class="na">after=</span><span class="s">&quot;ANONYMOUS_FILTER&quot;</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;sec:session-management</span>
             <span class="na">session-authentication-strategy-ref=</span><span class="s">&quot;sessionAuthenticationStrategy&quot;</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;/sec:http&gt;</span>


     <span class="nt">&lt;sec:authentication-manager&gt;</span>
         <span class="c">&lt;!-- com.example.security.domain.service.userdetails.SampleUserDetails</span>
<span class="c">             is scaned by component scan with @Service --&gt;</span>
<span class="hll">         <span class="nt">&lt;sec:authentication-provider</span>
</span><span class="hll">             <span class="na">user-service-ref=</span><span class="s">&quot;sampleUserDetailsService&quot;</span><span class="nt">&gt;</span><span class="c">&lt;!-- (5) --&gt;</span>
</span><span class="hll">             <span class="nt">&lt;sec:password-encoder</span> <span class="na">ref=</span><span class="s">&quot;passwordEncoder&quot;</span> <span class="nt">/&gt;</span><span class="c">&lt;!-- (6) --&gt;</span>
</span><span class="hll">         <span class="nt">&lt;/sec:authentication-provider&gt;</span>
</span>     <span class="nt">&lt;/sec:authentication-manager&gt;</span>

     <span class="c">&lt;!-- CSRF Protection --&gt;</span>
     <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;csrfTokenRepository&quot;</span>
         <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.csrf.HttpSessionCsrfTokenRepository&quot;</span> <span class="nt">/&gt;</span>

     <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;csrfFilter&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.csrf.CsrfFilter&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;0&quot;</span> <span class="na">ref=</span><span class="s">&quot;csrfTokenRepository&quot;</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;accessDeniedHandler&quot;</span><span class="nt">&gt;</span>
             <span class="nt">&lt;bean</span>
                 <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.access.AccessDeniedHandlerImpl&quot;</span><span class="nt">&gt;</span>
                 <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;errorPage&quot;</span>
                     <span class="na">value=</span><span class="s">&quot;/WEB-INF/views/common/error/csrfTokenError.jsp&quot;</span> <span class="nt">/&gt;</span>
             <span class="nt">&lt;/bean&gt;</span>
         <span class="nt">&lt;/property&gt;</span>
     <span class="nt">&lt;/bean&gt;</span>

     <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;sessionAuthenticationStrategy&quot;</span>
         <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.authentication.session.CompositeSessionAuthenticationStrategy&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;0&quot;</span><span class="nt">&gt;</span>
             <span class="nt">&lt;list&gt;</span>
                 <span class="nt">&lt;bean</span>
                     <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.authentication.session.SessionFixationProtectionStrategy&quot;</span> <span class="nt">/&gt;</span>
                 <span class="nt">&lt;bean</span>
                     <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.csrf.CsrfAuthenticationStrategy&quot;</span><span class="nt">&gt;</span>
                     <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;0&quot;</span>
                         <span class="na">ref=</span><span class="s">&quot;csrfTokenRepository&quot;</span> <span class="nt">/&gt;</span>
                 <span class="nt">&lt;/bean&gt;</span>
             <span class="nt">&lt;/list&gt;</span>
         <span class="nt">&lt;/constructor-arg&gt;</span>
     <span class="nt">&lt;/bean&gt;</span>

     <span class="c">&lt;!-- Put UserID into MDC --&gt;</span>
     <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;userIdMDCPutFilter&quot;</span>
         <span class="na">class=</span><span class="s">&quot;org.terasoluna.gfw.security.web.logging.UserIdMDCPutFilter&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;removeValue&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;/bean&gt;</span>

 <span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><p class="first last">Sr. No.</p>
</th>
<th class="head"><p class="first last">Description</p>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Perform settings for login form using <tt class="docutils literal"><span class="pre">&lt;sec:form-login&gt;</span></tt> tag.</div>
<div class="line">Set login form URL in <tt class="docutils literal"><span class="pre">login-page</span></tt> attribute, destination URL when authentication fails in <tt class="docutils literal"><span class="pre">authentication-failure-url</span></tt> attribute and URL for authentication in <tt class="docutils literal"><span class="pre">login-processing-url</span></tt> attribute.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Perform settings for logout using <tt class="docutils literal"><span class="pre">&lt;sec:logout&gt;</span></tt> tag. Set URL for logout in <tt class="docutils literal"><span class="pre">logout-url</span></tt> attribute and destination URL after logout in <tt class="docutils literal"><span class="pre">logout-success-url</span></tt> attribute.</div>
<div class="line">You can specify a Cookie name to be deleted at the time of logout in <tt class="docutils literal"><span class="pre">delete-cookies</span></tt> attribute.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Perform authorization settings at URL level using <tt class="docutils literal"><span class="pre">&lt;sec:intercept-url&gt;</span></tt> tag. Specify <tt class="docutils literal"><span class="pre">permitAll</span></tt> allowing all the users to access the login form.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Using this setting, specify <tt class="docutils literal"><span class="pre">isAuthenticated()</span></tt>that allows access only to authenticated users for all URLs except for <tt class="docutils literal"><span class="pre">/resources/**</span></tt> and <tt class="docutils literal"><span class="pre">/login.jsp</span></tt> which are being set above.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Perform <tt class="docutils literal"><span class="pre">org.springframework.security.authentication.AuthenticationProvider</span></tt> settings implementing authentication using <tt class="docutils literal"><span class="pre">&lt;sec:authentication-provider&gt;</span></tt>tag.</div>
<div class="line">As per default settings, <tt class="docutils literal"><span class="pre">org.springframework.security.authentication.dao.DaoAuthenticationProvider</span></tt> is used. It fetches <tt class="docutils literal"><span class="pre">UserDetails</span></tt> using <tt class="docutils literal"><span class="pre">UserDetailsService</span></tt>. Then it authenticates the user by comparing the hashed password from <tt class="docutils literal"><span class="pre">UserDetails</span></tt>and the user-input password which is hashed using <tt class="docutils literal"><span class="pre">org.springframework.security.crypto.password.PasswordEncoder</span></tt>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Perform <tt class="docutils literal"><span class="pre">PasswordEncoder</span></tt> settings. Refer to <tt class="docutils literal"><span class="pre">org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder</span></tt> defined in applicationContext.xml.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
<div class="section" id="settings-of-sql-scripts-to-be-executed-at-the-time-of-starting-the-application">
<h4><a class="toc-backref" href="#id19">6.2.4.2.2. Settings of SQL scripts to be executed at the time of starting the application</a><a class="headerlink" href="#settings-of-sql-scripts-to-be-executed-at-the-time-of-starting-the-application" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">src/main/resources/META-INF/spring/first-springsecurity-env.xml</p>
<p>Add settings of SQL scripts.</p>
<div class="highlight-xml"><div class="highlight"><pre> <span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
 <span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.springframework.org/schema/beans&quot;</span>
<span class="hll">     <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="na">xmlns:jdbc=</span><span class="s">&quot;http://www.springframework.org/schema/jdbc&quot;</span>
</span><span class="hll">     <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc.xsd</span>
</span><span class="s">         http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span><span class="nt">&gt;</span>

     <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;dateFactory&quot;</span> <span class="na">class=</span><span class="s">&quot;org.terasoluna.gfw.common.date.jodatime.DefaultJodaTimeDateFactory&quot;</span> <span class="nt">/&gt;</span>

     <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;realDataSource&quot;</span> <span class="na">class=</span><span class="s">&quot;org.apache.commons.dbcp2.BasicDataSource&quot;</span>
         <span class="na">destroy-method=</span><span class="s">&quot;close&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;driverClassName&quot;</span> <span class="na">value=</span><span class="s">&quot;${database.driverClassName}&quot;</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;url&quot;</span> <span class="na">value=</span><span class="s">&quot;${database.url}&quot;</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;username&quot;</span> <span class="na">value=</span><span class="s">&quot;${database.username}&quot;</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;password&quot;</span> <span class="na">value=</span><span class="s">&quot;${database.password}&quot;</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;defaultAutoCommit&quot;</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;maxTotal&quot;</span> <span class="na">value=</span><span class="s">&quot;${cp.maxActive}&quot;</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;maxIdle&quot;</span> <span class="na">value=</span><span class="s">&quot;${cp.maxIdle}&quot;</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;minIdle&quot;</span> <span class="na">value=</span><span class="s">&quot;${cp.minIdle}&quot;</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;maxWaitMillis&quot;</span> <span class="na">value=</span><span class="s">&quot;${cp.maxWait}&quot;</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;/bean&gt;</span>

     <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;dataSource&quot;</span> <span class="na">class=</span><span class="s">&quot;net.sf.log4jdbc.Log4jdbcProxyDataSource&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;0&quot;</span> <span class="na">ref=</span><span class="s">&quot;realDataSource&quot;</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;/bean&gt;</span>

     <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;transactionManager&quot;</span>
         <span class="na">class=</span><span class="s">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;dataSource&quot;</span> <span class="na">ref=</span><span class="s">&quot;dataSource&quot;</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;/bean&gt;</span>

<span class="hll">     <span class="nt">&lt;jdbc:initialize-database</span> <span class="na">data-source=</span><span class="s">&quot;dataSource&quot;</span>
</span><span class="hll">         <span class="na">ignore-failures=</span><span class="s">&quot;ALL&quot;</span><span class="nt">&gt;</span><span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="hll">         <span class="nt">&lt;jdbc:script</span> <span class="na">location=</span><span class="s">&quot;classpath:/database/${database}-schema.sql&quot;</span> <span class="nt">/&gt;</span><span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">         <span class="nt">&lt;jdbc:script</span> <span class="na">location=</span><span class="s">&quot;classpath:/database/${database}-dataload.sql&quot;</span> <span class="nt">/&gt;</span><span class="c">&lt;!-- (3) --&gt;</span>
</span><span class="hll">     <span class="nt">&lt;/jdbc:initialize-database&gt;</span>
</span> <span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><p class="first last">Sr. No.</p>
</th>
<th class="head"><p class="first last">Description</p>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Perform settings of Initialization SQL Scripts using <tt class="docutils literal"><span class="pre">&lt;jdbc:initialize-database&gt;</span></tt>tag.</div>
<div class="line">These settings are normally used only during development; hence define in xxx-env.xml.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set DDL. In template settings, it is defined as <tt class="docutils literal"><span class="pre">database=H2</span></tt> in xxx-infra.properties; hence H2-schema.sql is executed.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set DML. In template settings, it is defined as <tt class="docutils literal"><span class="pre">database=H2</span></tt> in xxx-infra.properties; hence H2-dataload.sql is executed.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>Currently the in-memory H2 database is to be used. DDL and DML are to be created as follows:</p>
<ul>
<li><p class="first">src/main/resources/database/H2-schema.sql</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">account</span><span class="p">(</span>
    <span class="n">username</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span>
    <span class="n">password</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span>
    <span class="n">first_name</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span>
    <span class="n">last_name</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span>
    <span class="k">constraint</span> <span class="n">pk_tbl_account</span> <span class="k">primary</span> <span class="k">key</span> <span class="p">(</span><span class="n">username</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
</li>
<li><p class="first">src/main/resources/database/H2-dataload.sql</p>
<blockquote>
<div><p>Add a test user who can log in to the system using username=demo and password=demo.</p>
</div></blockquote>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">account</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">,</span> <span class="s1">&#39;$2a$10$oxSJl.keBwxmsMLkcT9lPeAIxfNTPNQxpeywMrF7A3kVszwUTqfTK&#39;</span><span class="p">,</span> <span class="s1">&#39;Taro&#39;</span><span class="p">,</span> <span class="s1">&#39;Yamada&#39;</span><span class="p">);</span> <span class="c1">-- (1)</span>
<span class="k">COMMIT</span><span class="p">;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><p class="first last">Sr. No.</p>
</th>
<th class="head"><p class="first last">Description</p>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In template settings, <tt class="docutils literal"><span class="pre">org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder</span></tt> is being set for password hashing in applicationContext.xml.</div>
<div class="line">Insert a string “demo” which is hashed using BCrypt algorithm, as test data.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
<div class="section" id="creating-login-screen">
<h4><a class="toc-backref" href="#id20">6.2.4.2.3. Creating Login Screen</a><a class="headerlink" href="#creating-login-screen" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">src/main/webapp/login.jsp</p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;title&gt;</span>Login Page<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span>
    <span class="na">href=</span><span class="s">&quot;${pageContext.request.contextPath}/resources/app/css/styles.css&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;wrapper&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;h3&gt;</span>Login with Username and Password<span class="nt">&lt;/h3&gt;</span>

        <span class="nt">&lt;c:if</span> <span class="na">test=</span><span class="s">&quot;${param.error}&quot;</span><span class="nt">&gt;</span><span class="c">&lt;!-- (1) --&gt;</span>
            <span class="nt">&lt;t:messagesPanel</span> <span class="na">messagesType=</span><span class="s">&quot;error&quot;</span>
                <span class="na">messagesAttributeName=</span><span class="s">&quot;SPRING_SECURITY_LAST_EXCEPTION&quot;</span> <span class="nt">/&gt;</span><span class="c">&lt;!-- (2) --&gt;</span>
        <span class="nt">&lt;/c:if&gt;</span>

        <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/authenticate&quot;</span>
            <span class="na">method=</span><span class="s">&quot;POST&quot;</span><span class="nt">&gt;</span><span class="c">&lt;!-- (3) --&gt;</span>
            <span class="nt">&lt;table&gt;</span>
                <span class="nt">&lt;tr&gt;</span>
                    <span class="nt">&lt;td&gt;&lt;label</span> <span class="na">for=</span><span class="s">&quot;j_username&quot;</span><span class="nt">&gt;</span>User:<span class="nt">&lt;/label&gt;&lt;/td&gt;</span>
                    <span class="nt">&lt;td&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;j_username&quot;</span>
                        <span class="na">name=</span><span class="s">&quot;j_username&quot;</span> <span class="na">value=</span><span class="s">&#39;demo&#39;</span><span class="nt">&gt;</span>(demo)<span class="nt">&lt;/td&gt;</span><span class="c">&lt;!-- (4) --&gt;</span>
                <span class="nt">&lt;/tr&gt;</span>
                <span class="nt">&lt;tr&gt;</span>
                    <span class="nt">&lt;td&gt;&lt;label</span> <span class="na">for=</span><span class="s">&quot;j_password&quot;</span><span class="nt">&gt;</span>Password:<span class="nt">&lt;/label&gt;&lt;/td&gt;</span>
                    <span class="nt">&lt;td&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;password&quot;</span> <span class="na">id=</span><span class="s">&quot;j_password&quot;</span>
                        <span class="na">name=</span><span class="s">&quot;j_password&quot;</span> <span class="na">value=</span><span class="s">&quot;demo&quot;</span> <span class="nt">/&gt;</span>(demo)<span class="nt">&lt;/td&gt;</span><span class="c">&lt;!-- (5) --&gt;</span>
                <span class="nt">&lt;/tr&gt;</span>
                <span class="nt">&lt;tr&gt;</span>
                    <span class="nt">&lt;td&gt;</span><span class="ni">&amp;nbsp;</span><span class="nt">&lt;/td&gt;</span>
                    <span class="nt">&lt;td&gt;&lt;input</span> <span class="na">type=</span><span class="s">&quot;hidden&quot;</span>
                        <span class="na">name=</span><span class="s">&quot;${f:h(_csrf.parameterName)}&quot;</span>
                        <span class="na">value=</span><span class="s">&quot;${f:h(_csrf.token)}&quot;</span> <span class="nt">/&gt;</span> <span class="nt">&lt;input</span>
                        <span class="na">name=</span><span class="s">&quot;submit&quot;</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Login&quot;</span> <span class="nt">/&gt;&lt;/td&gt;</span><span class="c">&lt;!-- (6) --&gt;</span>
                <span class="nt">&lt;/tr&gt;</span>
            <span class="nt">&lt;/table&gt;</span>
        <span class="nt">&lt;/form&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><p class="first last">Sr. No.</p>
</th>
<th class="head"><p class="first last">Description</p>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When authentication fails, settings are performed to call &#8220;/login.jsp?error=true&#8221;. In this case, to display only the error message, <tt class="docutils literal"><span class="pre">&lt;c:if&gt;</span></tt> tag should be used.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When authentication fails, exception object is stored with attribute name <tt class="docutils literal"><span class="pre">&quot;SPRING_SECURITY_LAST_EXCEPTION&quot;</span></tt> in session scope.</div>
<div class="line">Here, error message should be displayed using <tt class="docutils literal"><span class="pre">&lt;t:messagesPanel&gt;</span></tt>tag.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">URL for authentication is set as &#8220;/authenticate&#8221;. User name and password should be posted using this URL for authentication.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Request parameter name of user name is <tt class="docutils literal"><span class="pre">j_username</span></tt> by default.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Request parameter name of password is <tt class="docutils literal"><span class="pre">j_password</span></tt> by default.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>When an attempt is made to display the login screen by entering <a class="reference external" href="http://localhost:8080/first-springsecurity/">http://localhost:8080/first-springsecurity/</a> in the address bar of the browser, since the user is not logged-in, <a class="reference external" href="http://localhost:8080/first-springsecurity/login.jsp">http://localhost:8080/first-springsecurity/login.jsp</a> is accessed as per &lt;Tutorial_setting-spring-security&gt;` (1) definition of :ref:<a href="#id1"><span class="problematic" id="id2">`</span></a>Spring Security settings, and the screen below is displayed.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/security_tutorial_login_page.png"><img alt="../_images/security_tutorial_login_page.png" src="../_images/security_tutorial_login_page.png" style="width: 80%;" /></a>
</div>
</div>
<div class="section" id="accessing-login-account-information-from-jsp">
<h4><a class="toc-backref" href="#id21">6.2.4.2.4. Accessing Login account information from JSP</a><a class="headerlink" href="#accessing-login-account-information-from-jsp" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">src/main/webapp/WEB-INF/views/welcome/home.jsp</p>
<p>Add the following code.</p>
<div class="highlight-xml"><div class="highlight"><pre> <span class="cp">&lt;!DOCTYPE html&gt;</span>
 <span class="nt">&lt;html&gt;</span>
 <span class="nt">&lt;head&gt;</span>
 <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
 <span class="nt">&lt;title&gt;</span>Home<span class="nt">&lt;/title&gt;</span>
 <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span>
     <span class="na">href=</span><span class="s">&quot;${pageContext.request.contextPath}/resources/app/css/styles.css&quot;</span><span class="nt">&gt;</span>
 <span class="nt">&lt;/head&gt;</span>
 <span class="nt">&lt;body&gt;</span>
     <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;wrapper&quot;</span><span class="nt">&gt;</span>
<span class="hll">         <span class="nt">&lt;sec:authentication</span> <span class="na">property=</span><span class="s">&quot;principal.account&quot;</span> <span class="na">var=</span><span class="s">&quot;account&quot;</span> <span class="nt">/&gt;</span><span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="hll">         <span class="nt">&lt;h1&gt;</span>Hello world!<span class="nt">&lt;/h1&gt;</span>
</span><span class="hll">         <span class="nt">&lt;p&gt;</span>Welcome ${f:h(account.firstName)} ${f:h(account.lastName)}<span class="nt">&lt;/p&gt;</span><span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">
</span><span class="hll">         <span class="nt">&lt;ul&gt;</span>
</span><span class="hll">             <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;${pageContext.request.contextPath}/account&quot;</span><span class="nt">&gt;</span>view account<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
</span><span class="hll">             <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;${pageContext.request.contextPath}/logout&quot;</span><span class="nt">&gt;</span>logout<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
</span><span class="hll">         <span class="nt">&lt;/ul&gt;</span>
</span>     <span class="nt">&lt;/div&gt;</span>
 <span class="nt">&lt;/body&gt;</span>
 <span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><p class="first last">Sr. No.</p>
</th>
<th class="head"><p class="first last">Description</p>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is possible to access logged in <tt class="docutils literal"><span class="pre">org.springframework.security.core.Authentication</span></tt> object using <tt class="docutils literal"><span class="pre">&lt;sec:authentication&gt;</span></tt> tag.</div>
<div class="line">Any property of <tt class="docutils literal"><span class="pre">.Authentication</span></tt> object can be accessed using <tt class="docutils literal"><span class="pre">property</span></tt> attribute and can be set in any scope using <tt class="docutils literal"><span class="pre">var</span></tt> attribute. Page scope is set by default to enable the user to browse only in this JSP.</div>
<div class="line">Store logged in <tt class="docutils literal"><span class="pre">Account</span></tt> object in variable name <tt class="docutils literal"><span class="pre">account</span></tt>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Access logged in <tt class="docutils literal"><span class="pre">Account</span></tt> object to display <tt class="docutils literal"><span class="pre">firstName</span></tt> and <tt class="docutils literal"><span class="pre">lastName</span></tt>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Welcome page is displayed on clicking Login button on Login page.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/security_tutorial_welcome_page.png"><img alt="../_images/security_tutorial_welcome_page.png" src="../_images/security_tutorial_welcome_page.png" style="width: 80%;" /></a>
</div>
</div>
<div class="section" id="creation-of-login-account-information-display-page">
<h4><a class="toc-backref" href="#id22">6.2.4.2.5. Creation of Login Account Information Display Page</a><a class="headerlink" href="#creation-of-login-account-information-display-page" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">src/main/java/com/example/security/app/account/AccountController.java</p>
<p>The logged in <tt class="docutils literal"><span class="pre">UserDetails</span></tt> object is stored in <tt class="docutils literal"><span class="pre">java.security.Principal</span></tt> object. By receiving <tt class="docutils literal"><span class="pre">Principal</span></tt> object in the processing method argument of Controller, it is possible to access the logged-in <tt class="docutils literal"><span class="pre">UserDetails</span></tt> in the Controller.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">app</span><span class="o">.</span><span class="na">account</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.security.Principal</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.security.core.Authentication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ui.Model</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.example.security.domain.model.Account</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.example.security.domain.service.userdetails.SampleUserDetails</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;account&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AccountController</span> <span class="o">{</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">view</span><span class="o">(</span><span class="cm">/* (1) */</span> <span class="n">Principal</span> <span class="n">principal</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// get login user information</span>
        <span class="n">Authentication</span> <span class="n">authentication</span> <span class="o">=</span> <span class="o">(</span><span class="n">Authentication</span><span class="o">)</span> <span class="n">principal</span><span class="o">;</span> <span class="c1">// (2)</span>
        <span class="c1">// get UserDetails</span>
        <span class="n">SampleUserDetails</span> <span class="n">userDetails</span> <span class="o">=</span> <span class="o">(</span><span class="n">SampleUserDetails</span><span class="o">)</span> <span class="n">authentication</span>
                <span class="o">.</span><span class="na">getPrincipal</span><span class="o">();</span> <span class="c1">// (3)</span>
        <span class="c1">// get account object</span>
        <span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="n">userDetails</span><span class="o">.</span><span class="na">getAccount</span><span class="o">();</span> <span class="c1">// (4)</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
        <span class="k">return</span> <span class="s">&quot;account/view&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><p class="first last">Sr. No.</p>
</th>
<th class="head"><p class="first last">Description</p>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Receive <tt class="docutils literal"><span class="pre">Principal</span></tt>object that stores logged in <tt class="docutils literal"><span class="pre">UserDetails</span></tt> object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">org.springframework.security.core.Authentication</span></tt> also has <tt class="docutils literal"><span class="pre">Principal</span></tt> interface and <tt class="docutils literal"><span class="pre">Principal</span></tt> object passed to the controller is actually <tt class="docutils literal"><span class="pre">Authentication</span></tt> object.</div>
<div class="line">In order to access the <tt class="docutils literal"><span class="pre">UserDetails</span></tt> object, perform casting in <tt class="docutils literal"><span class="pre">Authentication</span></tt> class.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is possible to fetch the logged in <tt class="docutils literal"><span class="pre">UserDetails</span></tt> object using <tt class="docutils literal"><span class="pre">Authentication.getPrincipal()</span></tt> method. Perform casting in project specific <tt class="docutils literal"><span class="pre">SampleUserDetails</span></tt> class.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Fetch logged in <tt class="docutils literal"><span class="pre">Account</span></tt> object from <tt class="docutils literal"><span class="pre">SampleUserDetails</span></tt> object.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="first">src/main/webapp/WEB-INF/views/account/view.jsp</p>
<p>Description is omitted since only property of <tt class="docutils literal"><span class="pre">Account</span></tt> object set in Model is output.</p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;title&gt;</span>Home<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span>
    <span class="na">href=</span><span class="s">&quot;${pageContext.request.contextPath}/resources/app/css/styles.css&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;wrapper&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;h1&gt;</span>Account Information<span class="nt">&lt;/h1&gt;</span>
        <span class="nt">&lt;table&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;th&gt;</span>Username<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;td&gt;</span>${f:h(account.username)}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;th&gt;</span>First name<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;td&gt;</span>${f:h(account.firstName)}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;th&gt;</span>Last name<span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;td&gt;</span>${f:h(account.lastName)}<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/table&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Account Information page is displayed on clicking view account link on Welcome page.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/security_tutorial_account_information_page.png"><img alt="../_images/security_tutorial_account_information_page.png" src="../_images/security_tutorial_account_information_page.png" style="width: 80%;" /></a>
</div>
</div>
<div class="section" id="package-explorer-after-creating-application-layer">
<h4><a class="toc-backref" href="#id23">6.2.4.2.6. Package explorer after creating application layer</a><a class="headerlink" href="#package-explorer-after-creating-application-layer" title="Permalink to this headline">¶</a></h4>
<div class="figure">
<a class="reference internal image-reference" href="../_images/security_tutorial-application-layer-package-explorer.png"><img alt="security tutorial application layer package explorer" src="../_images/security_tutorial-application-layer-package-explorer.png" style="width: 40%;" /></a>
</div>
</div>
</div>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id24">6.2.5. Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>The tutorial covered the following topics:</p>
<ul class="simple">
<li>Basic authentication/authorization using Spring Security</li>
<li>Customization of authentication user object</li>
<li>Authentication settings using Repository and Service class</li>
<li>Accessing logged in account information from JSP</li>
<li>Accessing logged in account information from Controller</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Authentication.html" title="6.3. Authentication"
             >next</a> |</li>
        <li class="right" >
          <a href="SpringSecurity.html" title="6.1. Spring Security Overview"
             >previous</a> |</li>
        <li><a href="../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.1.0-SNAPSHOT documentation</a> &raquo;</li>
          <li><a href="index.html" >6. Security for TERASOLUNA Server Framework for Java (5.x)</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013-2015, NTT DATA.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.Theme by <a href="http://github.com/vkvn">vkvn</a>
    </div>
    
    <script>
    
    $(function() {
    	var $sidebar	= $('.sphinxsidebar'),
    		$window		= $(window),
    		offset		= $sidebar.offset(),
    		topPadding	= 3,
    		$scroll		= $('#scroll');
    	
    	$window.scroll(function() {
    		if ($scroll.is(':checked')) {
				if ($window.scrollTop() > offset.top) {
					$sidebar.stop().animate({
						marginTop:$window.scrollTop() - offset.top + topPadding
					});
				} else {
					$sidebar.stop().animate({
						marginTop:0
					});
				}
			}
		});
    	
    	var $navList = $('ul:first', $sidebar);
    	$('li:first', $navList).addClass('open');
    	
    	$navList.treeview({
    		persist: "location",
    		collapsed: true,
    		unique: false
    	});
    	
	});
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-46550814-1', 'terasolunaorg.github.io');
    ga('send', 'pageview');
    </script>
  </body>
</html>