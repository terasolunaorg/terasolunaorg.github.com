<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4.1. Webアプリケーション向け開発プロジェクトの作成 &mdash; TERASOLUNA Global Framework Development Guideline 5.0.0-SNAPSHOT documentation</title>
    
    <link rel="stylesheet" href="../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.0.0-SNAPSHOT',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="TERASOLUNA Global Framework Development Guideline 5.0.0-SNAPSHOT documentation" href="../index.html" />
    <link rel="up" title="4. TERASOLUNA Global Frameworkによるアプリケーション開発" href="index.html" />
    <link rel="next" title="4.2. ドメイン層の実装" href="DomainLayer.html" />
    <link rel="prev" title="4. TERASOLUNA Global Frameworkによるアプリケーション開発" href="index.html" /><script src="../_static/jquery.treeview.js" type="text/javascript"></script>
<!-- <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'> -->
<link href="../_static/solarized-dark.css" rel="stylesheet">
<link href="../_static/jquery.treeview.css" rel="stylesheet">
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="DomainLayer.html" title="4.2. ドメイン層の実装"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="4. TERASOLUNA Global Frameworkによるアプリケーション開発"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">TERASOLUNA Global Framework Development Guideline 5.0.0-SNAPSHOT documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">4. TERASOLUNA Global Frameworkによるアプリケーション開発</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><label><input id="scroll" type="checkbox" checked> scroll sidebar</label>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">4.1. Webアプリケーション向け開発プロジェクトの作成</a><ul>
<li><a class="reference internal" href="#id2">4.1.1. 開発プロジェクトの作成</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomize">4.1.2. 開発プロジェクトのカスタマイズ</a><ul>
<li><a class="reference internal" href="#pom">4.1.2.1. POMファイルのプロジェクト情報</a></li>
<li><a class="reference internal" href="#x-xx-fw-9999id">4.1.2.2. x.xx.fw.9999形式のメッセージID</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizemessagewording">4.1.2.3. メッセージ文言</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizeerrorscreen">4.1.2.4. エラー画面</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizecopyrightonscreenfooter">4.1.2.5. 画面フッターの著作権</a></li>
<li><a class="reference internal" href="#h2-database">4.1.2.6. インメモリデータベース(H2 Database)</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizedatasource">4.1.2.7. データソース設定</a></li>
</ul>
</li>
<li><a class="reference internal" href="#createwebapplicationprojectconfiguration">4.1.3. 開発プロジェクトの構成</a><ul>
<li><a class="reference internal" href="#createwebapplicationprojectconfigurationmulti">4.1.3.1. マルチプロジェクトの構成</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectconfigurationweb">4.1.3.2. webモジュールの構成</a></li>
<li><a class="reference internal" href="#domain">4.1.3.3. domainモジュールの構成</a></li>
<li><a class="reference internal" href="#env">4.1.3.4. envモジュールの構成</a></li>
<li><a class="reference internal" href="#initdb">4.1.3.5. initdbモジュールの構成</a></li>
<li><a class="reference internal" href="#selenium">4.1.3.6. seleniumモジュールの構成</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix">4.1.4. Appendix</a><ul>
<li><a class="reference internal" href="#createwebapplicationprojectappendixprojecthierarchicalstructure">4.1.4.1. プロジェクトの階層構造</a></li>
<li><a class="reference internal" href="#bean">4.1.4.2. アプリケーションコンテキストの構成とBean定義ファイルの関係</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectappendixdescribeconfigurationfile">4.1.4.3. 設定ファイルの解説</a></li>
</ul>
</li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">4. TERASOLUNA Global Frameworkによるアプリケーション開発</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="DomainLayer.html"
                        title="next chapter">4.2. ドメイン層の実装</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/ImplementationAtEachLayer/CreateWebApplicationProject.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="web">
<h1>4.1. Webアプリケーション向け開発プロジェクトの作成<a class="headerlink" href="#web" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="id1">
<p class="topic-title first">目次</p>
<ul class="simple">
<li><a class="reference internal" href="#id2" id="id18">開発プロジェクトの作成</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomize" id="id19">開発プロジェクトのカスタマイズ</a><ul>
<li><a class="reference internal" href="#pom" id="id20">POMファイルのプロジェクト情報</a></li>
<li><a class="reference internal" href="#x-xx-fw-9999id" id="id21">x.xx.fw.9999形式のメッセージID</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizemessagewording" id="id22">メッセージ文言</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizeerrorscreen" id="id23">エラー画面</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizecopyrightonscreenfooter" id="id24">画面フッターの著作権</a></li>
<li><a class="reference internal" href="#h2-database" id="id25">インメモリデータベース(H2 Database)</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizedatasource" id="id26">データソース設定</a></li>
</ul>
</li>
<li><a class="reference internal" href="#createwebapplicationprojectconfiguration" id="id27">開発プロジェクトの構成</a><ul>
<li><a class="reference internal" href="#createwebapplicationprojectconfigurationmulti" id="id28">マルチプロジェクトの構成</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectconfigurationweb" id="id29">webモジュールの構成</a></li>
<li><a class="reference internal" href="#domain" id="id30">domainモジュールの構成</a></li>
<li><a class="reference internal" href="#env" id="id31">envモジュールの構成</a></li>
<li><a class="reference internal" href="#initdb" id="id32">initdbモジュールの構成</a></li>
<li><a class="reference internal" href="#selenium" id="id33">seleniumモジュールの構成</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix" id="id34">Appendix</a><ul>
<li><a class="reference internal" href="#createwebapplicationprojectappendixprojecthierarchicalstructure" id="id35">プロジェクトの階層構造</a></li>
<li><a class="reference internal" href="#bean" id="id36">アプリケーションコンテキストの構成とBean定義ファイルの関係</a></li>
<li><a class="reference internal" href="#createwebapplicationprojectappendixdescribeconfigurationfile" id="id37">設定ファイルの解説</a></li>
</ul>
</li>
</ul>
</div>
<p>本節では、Webアプリケーション向けの開発プロジェクトを作成する方法について説明する。</p>
<p>本ガイドラインでは、マルチプロジェクト構成を採用することを推奨している。
推奨するマルチプロジェクト構成の説明については、「<a class="reference internal" href="../Overview/ApplicationLayering.html#application-layering-project-structure"><em>プロジェクト構成</em></a>」を参照されたい。</p>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id18">4.1.1. 開発プロジェクトの作成</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>マルチプロジェクト構成の開発プロジェクトを、
<a class="reference external" href="http://maven.apache.org/archetype/maven-archetype-plugin/">Maven Archetype Plugin</a> の <a class="reference external" href="http://maven.apache.org/archetype/maven-archetype-plugin/generate-mojo.html">archetype:generate</a> を使用して作成する。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>前提条件</strong></p>
<p>以降の説明では、</p>
<ul class="simple">
<li><a class="reference external" href="http://maven.apache.org/">Maven</a> (<tt class="docutils literal"><span class="pre">mvn</span></tt>コマンド)が使用可能であること</li>
<li>インターネットに繋がっていること</li>
<li>インターネットにプロキシ経由で繋ぐ場合は、<a class="reference external" href="http://maven.apache.org/guides/mini/guide-proxies.html">Mavenのプロキシ設定</a>  が行われていること</li>
</ul>
<p>を前提としている。</p>
<p class="last">前提条件が整っていない場合は、まずこれらのセットアップを行ってほしい。</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>マルチプロジェクトを作成するためのArchetypeとして、以下の3種類を用意している。</p>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="30%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">項番</th>
<th class="head">Archetype(ArtifactId)</th>
<th class="head">説明</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>terasoluna-gfw-multi-web-blank-mybatis3-archetype</td>
<td>O/R MapperとしてMyBatis3を使用するためのプロジェクトを生成するためのArchetype。</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>terasoluna-gfw-multi-web-blank-mybatis2-archetype</td>
<td>O/R MapperとしてMyBatis2(with TERASOLUNA DAO)を使用するためのプロジェクトを生成するためのArchetype。</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>terasoluna-gfw-multi-web-blank-jpa-archetype</td>
<td>O/R MapperとしてJPA(with Spring Data JPA and Hibernate)を使用するためのプロジェクトを生成するためのArchetype。</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>プロジェクトを作成するフォルダに移動する。</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">cd C:\work</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><a class="reference external" href="http://maven.apache.org/archetype/maven-archetype-plugin/">Maven Archetype Plugin</a> の <a class="reference external" href="http://maven.apache.org/archetype/maven-archetype-plugin/generate-mojo.html">archetype:generate</a> を使用して、プロジェクトを作成する。</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">mvn archetype:generate -B^</span>
<span class="go"> -DarchetypeCatalog=http://repo.terasoluna.org/nexus/content/repositories/terasoluna-gfw-releases^</span>
<span class="go"> -DarchetypeGroupId=org.terasoluna.gfw.blank^</span>
<span class="go"> -DarchetypeArtifactId=terasoluna-gfw-multi-web-blank-mybatis3-archetype^</span>
<span class="go"> -DarchetypeVersion=5.0.0.RELEASE^</span>
<span class="go"> -DgroupId=com.example.todo^</span>
<span class="go"> -DartifactId=todo^</span>
<span class="go"> -Dversion=1.0.0-SNAPSHOT</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">パラメータ</th>
<th class="head">説明</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">-B</div>
</div>
</td>
<td>batch mode (対話を省略)</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">-DarchetypeCatalog</div>
</div>
</td>
<td>TERASOLUNA Global Frameworkのレポジトリを指定する。(固定)</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">-DarchetypeGroupId</div>
</div>
</td>
<td>ブランクプロジェクトのgroupIdを指定する。(固定)</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">-DarchetypeArtifactId</div>
</div>
</td>
<td><p class="first">ブランクプロジェクトのarchetypeId(雛形を特定するためのID)を指定する。<strong>(カスタマイズが必要)</strong></p>
<p>以下の何れかのarchetypeIdを指定する。</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">terasoluna-gfw-multi-web-blank-mybatis3-archetype</span></tt></li>
<li><tt class="docutils literal"><span class="pre">terasoluna-gfw-multi-web-blank-jpa-archetype</span></tt></li>
<li><tt class="docutils literal"><span class="pre">terasoluna-gfw-multi-web-blank-mybatis2-archetype</span></tt></li>
</ul>
<p class="last">上記例では、<tt class="docutils literal"><span class="pre">terasoluna-gfw-multi-web-blank-mybatis3-archetype</span></tt>を指定している。</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">-DarchetypeVersion</div>
</div>
</td>
<td>ブランクプロジェクトのバージョンを指定する。(固定)</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">-DgroupId</div>
</div>
</td>
<td><p class="first">作成するプロジェクトのgroupIdを指定する。<strong>(カスタマイズが必要)</strong></p>
<p class="last">上記例では、<tt class="docutils literal"><span class="pre">&quot;com.example.todo&quot;</span></tt>を指定している。</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">-DartifactId</div>
</div>
</td>
<td><p class="first">作成するプロジェクトのartifactIdを指定する。<strong>(カスタマイズが必要)</strong></p>
<p class="last">上記例では、<tt class="docutils literal"><span class="pre">&quot;todo&quot;</span></tt>を指定している。</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">-Dversion</div>
</div>
</td>
<td><p class="first">作成するプロジェクトのバージョンを指定する。<strong>(カスタマイズが必要)</strong></p>
<p class="last">上記例では、<tt class="docutils literal"><span class="pre">&quot;1.0.0-SNAPSHOT&quot;</span></tt>を指定している。</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>プロジェクトの作成が成功した場合、以下のようなログが出力される。
(以下は、MyBatis3用のArchetypeを使用して作成した場合の出力例)</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">(... omit)</span>
<span class="go">[INFO] ----------------------------------------------------------------------------</span>
<span class="go">[INFO] Using following parameters for creating project from Archetype: terasoluna-gfw-multi-web-blank-mybatis3-archetype:5.0.0.RELEASE</span>
<span class="go">[INFO] ----------------------------------------------------------------------------</span>
<span class="go">[INFO] Parameter: groupId, Value: com.example.todo</span>
<span class="go">[INFO] Parameter: artifactId, Value: todo</span>
<span class="go">[INFO] Parameter: version, Value: 1.0.0-SNAPSHOT</span>
<span class="go">[INFO] Parameter: package, Value: com.example.todo</span>
<span class="go">[INFO] Parameter: packageInPathFormat, Value: com/example/todo</span>
<span class="go">[INFO] Parameter: package, Value: com.example.todo</span>
<span class="go">[INFO] Parameter: version, Value: 1.0.0-SNAPSHOT</span>
<span class="go">[INFO] Parameter: groupId, Value: com.example.todo</span>
<span class="go">[INFO] Parameter: artifactId, Value: todo</span>
<span class="go">[INFO] Parent element not overwritten in C:\work\todo\todo-env\pom.xml</span>
<span class="go">[INFO] Parent element not overwritten in C:\work\todo\todo-domain\pom.xml</span>
<span class="go">[INFO] Parent element not overwritten in C:\work\todo\todo-web\pom.xml</span>
<span class="go">[INFO] Parent element not overwritten in C:\work\todo\todo-initdb\pom.xml</span>
<span class="go">[INFO] Parent element not overwritten in C:\work\todo\todo-selenium\pom.xml</span>
<span class="go">[INFO] project created from Archetype in dir: C:\work\todo</span>
<span class="go">[INFO] ------------------------------------------------------------------------</span>
<span class="go">[INFO] BUILD SUCCESS</span>
<span class="go">[INFO] ------------------------------------------------------------------------</span>
<span class="go">[INFO] Total time: 9.929 s</span>
<span class="go">[INFO] Finished at: 2015-01-20T12:03:21+00:00</span>
<span class="go">[INFO] Final Memory: 10M/26M</span>
<span class="go">[INFO] ------------------------------------------------------------------------</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>プロジェクトの作成が成功した場合、Mavenのマルチプロジェクトが作成される。
Maven Archetypeで作成したプロジェクトの詳細な説明については、「<a class="reference internal" href="#createwebapplicationprojectconfiguration"><em>開発プロジェクトの構成</em></a>」を参照されたい。</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">todo</span>
<span class="go">├── pom.xml</span>
<span class="go">├── todo-domain</span>
<span class="go">├── todo-env</span>
<span class="go">├── todo-initdb</span>
<span class="go">├── todo-selenium</span>
<span class="go">└── todo-web</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="createwebapplicationprojectcustomize">
<span id="id6"></span><h2><a class="toc-backref" href="#id19">4.1.2. 開発プロジェクトのカスタマイズ</a><a class="headerlink" href="#createwebapplicationprojectcustomize" title="Permalink to this headline">¶</a></h2>
<p>Maven Archetypeで作成したプロジェクトには、アプリケーション毎にカスタマイズが必要な箇所がいくつか存在する。</p>
<p>カスタマイズが必要な箇所を以下に示す。</p>
<ul class="simple">
<li><a class="reference internal" href="#createwebapplicationprojectcustomizeprojectinformation"><em>POMファイルのプロジェクト情報</em></a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizemessageid"><em>x.xx.fw.9999形式のメッセージID</em></a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizemessagewording"><em>メッセージ文言</em></a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizeerrorscreen"><em>エラー画面</em></a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizecopyrightonscreenfooter"><em>画面フッターの著作権</em></a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizeinmemorydatabase"><em>インメモリデータベース(H2 Database)</em></a></li>
<li><a class="reference internal" href="#createwebapplicationprojectcustomizedatasource"><em>データソース設定</em></a></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>上記以外のカスタマイズポイントとしては、</p>
<ul class="simple">
<li><a class="reference internal" href="../Security/Authentication.html"><em>認証</em></a>・<a class="reference internal" href="../Security/Authorization.html"><em>認可</em></a> の設定</li>
<li><a class="reference internal" href="../ArchitectureInDetail/FileUpload.html"><em>ファイルアップロード</em></a> を有効化するための設定</li>
<li><a class="reference internal" href="../ArchitectureInDetail/Internationalization.html"><em>国際化</em></a> を有効化するための設定</li>
<li><a class="reference internal" href="../ArchitectureInDetail/Logging.html"><em>ロギング</em></a> の定義</li>
<li><a class="reference internal" href="../ArchitectureInDetail/ExceptionHandling.html"><em>例外ハンドリング</em></a> の定義</li>
<li><a class="reference internal" href="../ArchitectureInDetail/REST.html"><em>RESTful Web Service</em></a> 向けの設定の適用</li>
</ul>
<p>などがある。</p>
<p class="last">これらのカスタマイズについては、各節のHow to useを参照し、必要に応じてカスタマイズしてほしい。</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">以降の説明で<tt class="docutils literal"><span class="pre">artifactId</span></tt>と表現している部分は、
プロジェクト作成時に指定した<tt class="docutils literal"><span class="pre">artifactId</span></tt>に置き換えて読み進めてほしい。</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="pom">
<span id="createwebapplicationprojectcustomizeprojectinformation"></span><h3><a class="toc-backref" href="#id20">4.1.2.1. POMファイルのプロジェクト情報</a><a class="headerlink" href="#pom" title="Permalink to this headline">¶</a></h3>
<p>Maven Archetypeで作成したプロジェクトのPOMファイルでは、</p>
<ul class="simple">
<li>プロジェクト名(<tt class="docutils literal"><span class="pre">name</span></tt>要素)</li>
<li>プロジェクト説明(<tt class="docutils literal"><span class="pre">description</span></tt>要素)</li>
<li>プロジェクトURL(<tt class="docutils literal"><span class="pre">url</span></tt>要素)</li>
<li>プロジェクト創設年(<tt class="docutils literal"><span class="pre">inceptionYear</span></tt>要素)</li>
<li>プロジェクトライセンス(<tt class="docutils literal"><span class="pre">licenses</span></tt>要素)</li>
<li>プロジェクト組織(<tt class="docutils literal"><span class="pre">organization</span></tt>要素)</li>
</ul>
<p>といったプロジェクト情報が、Archetype自身のプロジェクト情報が設定されている状態となっている。
実際の設定内容を以下に示す。</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- ... --&gt;</span>

<span class="nt">&lt;name&gt;</span>TERASOLUNA Global Framework Web Blank Multi Project<span class="nt">&lt;/name&gt;</span>
<span class="nt">&lt;description&gt;</span>Web Blank Multi Project using TERASOLUNA Global Framework<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;url&gt;</span>http://terasoluna.org<span class="nt">&lt;/url&gt;</span>
<span class="nt">&lt;inceptionYear&gt;</span>2014<span class="nt">&lt;/inceptionYear&gt;</span>
<span class="nt">&lt;licenses&gt;</span>
    <span class="nt">&lt;license&gt;</span>
        <span class="nt">&lt;name&gt;</span>Apache License, Version 2.0<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;url&gt;</span>http://www.apache.org/licenses/LICENSE-2.0.txt<span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;distribution&gt;</span>manual<span class="nt">&lt;/distribution&gt;</span>
    <span class="nt">&lt;/license&gt;</span>
<span class="nt">&lt;/licenses&gt;</span>
<span class="nt">&lt;organization&gt;</span>
    <span class="nt">&lt;name&gt;</span>TERASOLUNA Framework Team<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;url&gt;</span>http://terasoluna.org<span class="nt">&lt;/url&gt;</span>
<span class="nt">&lt;/organization&gt;</span>

<span class="c">&lt;!-- ... --&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>プロジェクト情報には、適切な値を設定すること。</strong></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>カスタマイズ対象のファイルとカスタマイズ方法を以下に示す。</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="45%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">項番</th>
<th class="head">対象ファイル</th>
<th class="head">カスタマイズ方法</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td><p class="first">マルチプロジェクト全体の構成を定義するPOM(Project Object Model)ファイル</p>
<p class="last"><tt class="docutils literal"><span class="pre">artifactId/pom.xml</span></tt></p>
</td>
<td>プロジェクト情報に適切な値を指定する。</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="x-xx-fw-9999id">
<span id="createwebapplicationprojectcustomizemessageid"></span><h3><a class="toc-backref" href="#id21">4.1.2.2. x.xx.fw.9999形式のメッセージID</a><a class="headerlink" href="#x-xx-fw-9999id" title="Permalink to this headline">¶</a></h3>
<p>Maven Archetypeで作成したプロジェクトでは、<tt class="docutils literal"><span class="pre">x.xx.fw.9999</span></tt>形式のメッセージIDを、</p>
<ul class="simple">
<li>エラー画面に表示するメッセージ</li>
<li>例外発生時に出力するエラーログ</li>
</ul>
<p>を生成する際に使用している。実際の使用箇所(サンプリング)を以下に示す。</p>
<p><strong>[application-messages.properties]</strong></p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">e.xx.fw.5001</span> <span class="o">=</span> <span class="s">Resource not found.</span>
</pre></div>
</div>
<p><strong>[JSP]</strong></p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;error&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;c:if</span> <span class="na">test=</span><span class="s">&quot;${!empty exceptionCode}&quot;</span><span class="nt">&gt;</span>[${f:h(exceptionCode)}]<span class="nt">&lt;/c:if&gt;</span>
    <span class="nt">&lt;spring:message</span> <span class="na">code=</span><span class="s">&quot;e.xx.fw.5001&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p><strong>[applicationContext.xml]</strong></p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;exceptionCodeResolver&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.terasoluna.gfw.common.exception.SimpleMappingExceptionCodeResolver&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
            <span class="nt">&lt;entry</span> <span class="na">key=</span><span class="s">&quot;ResourceNotFoundException&quot;</span> <span class="na">value=</span><span class="s">&quot;e.xx.fw.5001&quot;</span> <span class="nt">/&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><tt class="docutils literal"><span class="pre">x.xx.fw.9999</span></tt>形式のメッセージIDは、
本ガイドラインの「<a class="reference internal" href="../ArchitectureInDetail/MessageManagement.html"><em>メッセージ管理</em></a>」で紹介しているメッセージID体系であるが、
プロジェクト区分の値が暫定値「<tt class="docutils literal"><span class="pre">xx</span></tt>」の状態になっている。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><strong>本ガイドラインで紹介しているメッセージID体系を利用する場合は、プロジェクト区分に適切な値を指定すること。</strong> 本ガイドラインで紹介しているメッセージID体系については、「<a class="reference internal" href="../ArchitectureInDetail/MessageManagement.html#message-management-result-rule"><em>結果メッセージ</em></a>」を参照されたい。</li>
<li>本ガイドラインで紹介しているメッセージID体系を利用しない場合は、以下に示す修正対象ファイル内で使用しているメッセージIDを全て置き換える必要がある。</li>
</ul>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>カスタマイズ対象のファイルとカスタマイズ方法を以下に示す。</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="45%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">項番</th>
<th class="head">対象ファイル</th>
<th class="head">カスタマイズ方法</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td><p class="first">メッセージ定義ファイル</p>
<p class="last"><tt class="docutils literal"><span class="pre">artifactId/artifactId-web/src/main/resources/i18n/application-messages.properties</span></tt></p>
</td>
<td>プロパティキーに指定しているメッセージIDのプロジェクト区分の暫定値「<tt class="docutils literal"><span class="pre">xx</span></tt>」を、適切な値に修正する。</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td><p class="first">エラー画面用のJSP</p>
<p class="last"><tt class="docutils literal"><span class="pre">artifactId/artifactId-web/src/main/webapp/WEB-INF/views/common/error/*.jsp</span></tt></p>
</td>
<td><tt class="docutils literal"><span class="pre">&lt;spring:message&gt;</span></tt>要素の<tt class="docutils literal"><span class="pre">code</span></tt>属性に指定しているメッセージIDのプロジェクト区分の暫定値「<tt class="docutils literal"><span class="pre">xx</span></tt>」を、適切な値に修正する。</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td><p class="first">Webアプリケーション用のアプリケーションコンテキストを作成するためのBean定義ファイル</p>
<p class="last"><tt class="docutils literal"><span class="pre">artifactId/artifactId-web/src/main/resources/META-INF/spring/applicationContext.xml</span></tt></p>
</td>
<td>BeanIDが<tt class="docutils literal"><span class="pre">&quot;exceptionCodeResolver&quot;</span></tt>のBean定義内で指定している例外コード(メッセージID)のプロジェクト区分の暫定値「<tt class="docutils literal"><span class="pre">xx</span></tt>」を、適切な値に修正する。</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="createwebapplicationprojectcustomizemessagewording">
<span id="id7"></span><h3><a class="toc-backref" href="#id22">4.1.2.3. メッセージ文言</a><a class="headerlink" href="#createwebapplicationprojectcustomizemessagewording" title="Permalink to this headline">¶</a></h3>
<p>Maven Archetypeで作成したプロジェクトでは、いくつかのメッセージ定義を提供しているが、
メッセージ文言は簡易的なメッセージになっている。
実際のメッセージ(サンプリング)を以下に示す。</p>
<p><strong>[application-messages.properties]</strong></p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">e.xx.fw.5001</span> <span class="o">=</span> <span class="s">Resource not found.</span>

<span class="c"># ...</span>

<span class="c"># typemismatch</span>
<span class="na">typeMismatch</span><span class="o">=</span><span class="s">&quot;{0}&quot; is invalid.</span>

<span class="c"># ...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>メッセージ文言については、アプリケーション要件(メッセージ規約など)に合わせて修正すること。</strong></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>カスタマイズ対象のファイルとカスタマイズ方法を以下に示す。</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="45%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">項番</th>
<th class="head">対象ファイル</th>
<th class="head">カスタマイズ方法</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td><p class="first">メッセージ定義ファイル</p>
<p class="last"><tt class="docutils literal"><span class="pre">artifactId/artifactId-web/src/main/resources/i18n/application-messages.properties</span></tt></p>
</td>
<td><p class="first">アプリケーション要件に応じたメッセージに修正する。</p>
<p class="last">入力チェックでエラーとなった際に表示するメッセージ(Bean Validationのメッセージ)についても、
アプリケーション要件に応じて修正(デフォルトメッセージの上書き)が必要になる。
デフォルトメッセージの上書き方法については、「<a class="reference internal" href="../ArchitectureInDetail/Validation.html#validation-message-def"><em>エラーメッセージの定義</em></a>」を参照されたい。</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="createwebapplicationprojectcustomizeerrorscreen">
<span id="id8"></span><h3><a class="toc-backref" href="#id23">4.1.2.4. エラー画面</a><a class="headerlink" href="#createwebapplicationprojectcustomizeerrorscreen" title="Permalink to this headline">¶</a></h3>
<p>Maven Archetypeで作成したプロジェクトでは、エラーの種類毎にエラー画面を表示するためのJSP及びHTMLを提供しているが、</p>
<ul class="simple">
<li>画面レイアウト</li>
<li>画面タイトル</li>
<li>メッセージの文言</li>
</ul>
<p>などが簡易的な実装になっている。実際のJSPの実装(サンプリング)を以下に示す。</p>
<p><strong>[JSP]</strong></p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;utf-8&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;title&gt;</span>Resource Not Found Error!<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span>
    <span class="na">href=</span><span class="s">&quot;${pageContext.request.contextPath}/resources/app/css/styles.css&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;wrapper&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;h1&gt;</span>Resource Not Found Error!<span class="nt">&lt;/h1&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;error&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;c:if</span> <span class="na">test=</span><span class="s">&quot;${!empty exceptionCode}&quot;</span><span class="nt">&gt;</span>[${f:h(exceptionCode)}]<span class="nt">&lt;/c:if&gt;</span>
            <span class="nt">&lt;spring:message</span> <span class="na">code=</span><span class="s">&quot;e.xx.fw.5001&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;t:messagesPanel</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>エラー画面を表示するためのJSPとHTMLについては、アプリケーション要件(UI規約など)に合わせて修正すること。</strong></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>カスタマイズ対象のファイルとカスタマイズ方法を以下に示す。</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="45%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">項番</th>
<th class="head">対象ファイル</th>
<th class="head">カスタマイズ方法</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td><p class="first">エラー画面用のJSP</p>
<p class="last"><tt class="docutils literal"><span class="pre">artifactId/artifactId-web/src/main/webapp/WEB-INF/views/common/error/*.jsp</span></tt></p>
</td>
<td><p class="first">アプリケーション要件(UI規約など)に合わせて修正する。</p>
<p class="last">エラー画面を表示するJSPをカスタマイズする際は、「<a class="reference internal" href="../ArchitectureInDetail/ExceptionHandling.html"><em>例外ハンドリング</em></a> の <a class="reference internal" href="../ArchitectureInDetail/ExceptionHandling.html#exception-handling-how-to-use-codingpoint-jsp-label"><em>コーディングポイント（JSP編）</em></a>」を参照されたい。</p>
</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td><p class="first">エラー画面用のHTML</p>
<p class="last"><tt class="docutils literal"><span class="pre">artifactId/artifactId-web/src/main/webapp/WEB-INF/views/common/error/unhandledSystemError.html</span></tt></p>
</td>
<td>アプリケーション要件(UI規約など)に合わせて修正する。</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="createwebapplicationprojectcustomizecopyrightonscreenfooter">
<span id="id9"></span><h3><a class="toc-backref" href="#id24">4.1.2.5. 画面フッターの著作権</a><a class="headerlink" href="#createwebapplicationprojectcustomizecopyrightonscreenfooter" title="Permalink to this headline">¶</a></h3>
<p>Maven Archetypeで作成したプロジェクトでは、Tilesを使用して画面レイアウトを構成しているが、
画面フッター部の著作権が暫定値「<tt class="docutils literal"><span class="pre">Copyright</span> <span class="pre">&amp;copy;</span> <span class="pre">20XX</span> <span class="pre">CompanyName</span></tt>」の状態になっている。
実際のJSPの実装(サンプリング)を以下に示す。</p>
<p><strong>[template.jsp]</strong></p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;container&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;tiles:insertAttribute</span> <span class="na">name=</span><span class="s">&quot;header&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;tiles:insertAttribute</span> <span class="na">name=</span><span class="s">&quot;body&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;hr&gt;</span>
  <span class="nt">&lt;p</span> <span class="na">style=</span><span class="s">&quot;text-align: center; background: #e5eCf9;&quot;</span><span class="nt">&gt;</span>Copyright
    <span class="ni">&amp;copy;</span> 20XX CompanyName<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>Tilesを使用して画面レイアウトを構成する場合は、著作権に適切な値を指定すること。</strong></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>カスタマイズ対象のファイルとカスタマイズ方法を以下に示す。</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="45%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">項番</th>
<th class="head">対象ファイル</th>
<th class="head">カスタマイズ方法</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td><p class="first">Tiles用のテンプレートJSP</p>
<p class="last"><tt class="docutils literal"><span class="pre">artifactId/artifactId-web/src/main/webapp/WEB-INF/views/layout/template.jsp</span></tt></p>
</td>
<td>著作権の暫定値「<tt class="docutils literal"><span class="pre">Copyright</span> <span class="pre">&amp;copy;</span> <span class="pre">20XX</span> <span class="pre">CompanyName</span></tt>」を適切な値に修正する。</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="h2-database">
<span id="createwebapplicationprojectcustomizeinmemorydatabase"></span><h3><a class="toc-backref" href="#id25">4.1.2.6. インメモリデータベース(H2 Database)</a><a class="headerlink" href="#h2-database" title="Permalink to this headline">¶</a></h3>
<p>Maven Archetypeで作成したプロジェクトには、インメモリデータベース(H2 Database)をセットアップするための設定が行われているが、
これはちょっとした動作検証(プロトタイプ作成やPOC(Proof Of Concept))を行うための設定である。
そのため、本格的なアプリケーション開発を行う場合は、不要な設定になる。</p>
<p><strong>[artifactId-env.xml]</strong></p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;jdbc:initialize-database</span> <span class="na">data-source=</span><span class="s">&quot;dataSource&quot;</span>
    <span class="na">ignore-failures=</span><span class="s">&quot;ALL&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;jdbc:script</span> <span class="na">location=</span><span class="s">&quot;classpath:/database/${database}-schema.sql&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;jdbc:script</span> <span class="na">location=</span><span class="s">&quot;classpath:/database/${database}-dataload.sql&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/jdbc:initialize-database&gt;</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span class="go">└── src</span>
<span class="go">    └── main</span>
<span class="go">        └── resources</span>
<span class="go">            ├── META-INF</span>
<span class="go">          (...)</span>
<span class="go">            ├── database</span>
<span class="go">            │   ├── H2-dataload.sql</span>
<span class="go">            │   └── H2-schema.sql</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>本格的なアプリケーション開発を行う場合は、インメモリデータベース(H2 Database)をセットアップするための定義とSQLを管理するためのディレクトリを削除すること。</strong></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>カスタマイズ対象のファイルとカスタマイズ方法を以下に示す。</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="45%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">項番</th>
<th class="head">対象ファイル</th>
<th class="head">カスタマイズ方法</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td><p class="first">環境依存するコンポーネントを定義するBean定義ファイル</p>
<p class="last"><tt class="docutils literal"><span class="pre">artifactId-env/src/main/resources/META-INF/spring/artifactId-env.xml</span></tt></p>
</td>
<td><tt class="docutils literal"><span class="pre">&lt;jdbc:initialize-database&gt;</span></tt>要素を削除する。</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td><p class="first">インメモリデータベース(H2 Database)をセットアップするためのSQLを格納するディレクトリ</p>
<p class="last"><tt class="docutils literal"><span class="pre">artifactId/artifactId-env/src/main/resources/database/</span></tt></p>
</td>
<td>ディレクトリを削除する。</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="createwebapplicationprojectcustomizedatasource">
<span id="id10"></span><h3><a class="toc-backref" href="#id26">4.1.2.7. データソース設定</a><a class="headerlink" href="#createwebapplicationprojectcustomizedatasource" title="Permalink to this headline">¶</a></h3>
<p>Maven Archetypeで作成したプロジェクトでは、インメモリデータベース(H2 Database)にアクセスするためのデータソース設定が行われているが、
これはちょっとした動作検証(プロトタイプ作成やPOC(Proof Of Concept))を行うための設定である。
そのため、本格的なアプリケーション開発を行う場合は、
アプリケーション稼働時に利用するデータベースにアクセスするためのデータソース設定に変更する必要がある。</p>
<p><strong>[artifactId/artifactId-domain/pom.xml]</strong></p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.h2database<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>h2<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
<p><strong>[artifactId-infra.properties]</strong></p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">database</span><span class="o">=</span><span class="s">H2</span>
<span class="na">database.url</span><span class="o">=</span><span class="s">jdbc:h2:mem:todo;DB_CLOSE_DELAY=-1</span>
<span class="na">database.username</span><span class="o">=</span><span class="s">sa</span>
<span class="na">database.password</span><span class="o">=</span>
<span class="na">database.driverClassName</span><span class="o">=</span><span class="s">org.h2.Driver</span>
<span class="c"># connection pool</span>
<span class="na">cp.maxActive</span><span class="o">=</span><span class="s">96</span>
<span class="na">cp.maxIdle</span><span class="o">=</span><span class="s">16</span>
<span class="na">cp.minIdle</span><span class="o">=</span><span class="s">0</span>
<span class="na">cp.maxWait</span><span class="o">=</span><span class="s">60000</span>
</pre></div>
</div>
<p><strong>[artifactId-env.xml]</strong></p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;realDataSource&quot;</span> <span class="na">class=</span><span class="s">&quot;org.apache.commons.dbcp2.BasicDataSource&quot;</span>
    <span class="na">destroy-method=</span><span class="s">&quot;close&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;driverClassName&quot;</span> <span class="na">value=</span><span class="s">&quot;${database.driverClassName}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;url&quot;</span> <span class="na">value=</span><span class="s">&quot;${database.url}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;username&quot;</span> <span class="na">value=</span><span class="s">&quot;${database.username}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;password&quot;</span> <span class="na">value=</span><span class="s">&quot;${database.password}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;defaultAutoCommit&quot;</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;maxTotal&quot;</span> <span class="na">value=</span><span class="s">&quot;${cp.maxActive}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;maxIdle&quot;</span> <span class="na">value=</span><span class="s">&quot;${cp.maxIdle}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;minIdle&quot;</span> <span class="na">value=</span><span class="s">&quot;${cp.minIdle}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;maxWaitMillis&quot;</span> <span class="na">value=</span><span class="s">&quot;${cp.maxWait}&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>本格的なアプリケーション開発を行う場合は、アプリケーション稼働時に利用するデータベースにアクセスするためのデータソース設定に変更すること。</strong></p>
<p>Maven Archetypeで作成したプロジェクトでは、Apache Commons DBCPを使用する設定となっているが、
アプリケーションサーバから提供されているデータソースを使用して、
JNDI(Java Naming and Directory Interface)経由でデータソースにアクセスする方法を採用するケースも多い。</p>
<p>開発環境ではApache Commons DBCPのデータソースを使用して、
テスト環境及び商用環境ではアプリケーションサーバから提供されているデータソースを使用するといった使い分けを行うケースもある。</p>
<p class="last">データソースの設定方法については、「<a class="reference internal" href="../ArchitectureInDetail/DataAccessCommon.html"><em>データベースアクセス（共通編）</em></a> の <a class="reference internal" href="../ArchitectureInDetail/DataAccessCommon.html#data-access-common-howtouse-datasource"><em>データソースの設定</em></a>」を参照されたい。</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>カスタマイズ対象のファイルとカスタマイズ方法を以下に示す。</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="45%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">項番</th>
<th class="head">対象ファイル</th>
<th class="head">カスタマイズ方法</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td><p class="first">POMファイル</p>
<ul class="last simple">
<li><tt class="docutils literal"><span class="pre">artifactId/pom.xml</span></tt></li>
<li><tt class="docutils literal"><span class="pre">artifactId/artifactId-domain/pom.xml</span></tt></li>
</ul>
</td>
<td><p class="first">インメモリデータベース(H2 Database)のJDBCドライバを依存ライブラリから削除する。</p>
<p class="last">アプリケーション稼働時に利用するデータベースにアクセスするためのJDBCドライバを依存ライブラリに追加する。</p>
</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td><p class="first">環境依存する設定値を定義するプロパティファイル</p>
<p class="last"><tt class="docutils literal"><span class="pre">artifactId/artifactId-env/src/main/resources/META-INF/spring/artifactId-infra.properties</span></tt></p>
</td>
<td><p class="first">データソースとしてApache Commons DBCPを使用する場合は、以下のプロパティにアプリケーション稼働時に利用するデータベースにアクセスするための接続情報を指定する。</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">database</span></tt></li>
<li><tt class="docutils literal"><span class="pre">database.url</span></tt></li>
<li><tt class="docutils literal"><span class="pre">database.username</span></tt></li>
<li><tt class="docutils literal"><span class="pre">database.password</span></tt></li>
<li><tt class="docutils literal"><span class="pre">database.driverClassName</span></tt></li>
</ul>
<p>アプリケーションサーバから提供されているデータソースを使用する場合は、以下のプロパティ以外は不要なプロパティになるので削除する。</p>
<ul class="last simple">
<li><tt class="docutils literal"><span class="pre">database</span></tt></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td><p class="first">環境依存するコンポーネントを定義するBean定義ファイル</p>
<p class="last"><tt class="docutils literal"><span class="pre">artifactId/artifactId-env/src/main/resources/META-INF/spring/artifactId-env.xml</span></tt></p>
</td>
<td><p class="first">アプリケーションサーバから提供されているデータソースを使用する場合は、JNDI経由で取得したデータソースを使用するように設定を変更する。</p>
<p class="last">データソースの設定方法については、「<a class="reference internal" href="../ArchitectureInDetail/DataAccessCommon.html"><em>データベースアクセス（共通編）</em></a> の <a class="reference internal" href="../ArchitectureInDetail/DataAccessCommon.html#data-access-common-howtouse-datasource"><em>データソースの設定</em></a>」を参照されたい。</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>環境依存する設定値を定義するプロパティファイルのdatabaseプロパティについて</strong></p>
<p class="last">O/R MapperとしてMyBatisを使用する場合は、<tt class="docutils literal"><span class="pre">database</span></tt>プロパティは不要なプロパティである。
削除してもよいが、使用しているデータベースを明示するために設定を残しておいてもよい。</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>JDBCドライバの追加方法について</strong></p>
<p>使用するデータベースがPostgreSQLとOracleの場合は、POMファイル内のコメントアウトを外せばよい。
JDBCドライバのバージョンについては、使用するデータベースのバージョンに対応するバージョンに修正すること。</p>
<p>ただしOracleを使用する場合は、コメントを外す前に、
MavenのローカルリポジトリにOracleのJDBCドライバをインストールしておく必要がある。</p>
<p>以下は、PostgreSQLを使用する場合の設定例である。</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">artifactId/pom.xml</span></tt></li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre>                 <span class="nt">&lt;dependency&gt;</span>
                     <span class="nt">&lt;groupId&gt;</span>org.postgresql<span class="nt">&lt;/groupId&gt;</span>
                     <span class="nt">&lt;artifactId&gt;</span>postgresql<span class="nt">&lt;/artifactId&gt;</span>
                     <span class="nt">&lt;version&gt;</span>${postgresql.version}<span class="nt">&lt;/version&gt;</span>
                     <span class="nt">&lt;scope&gt;</span>provided<span class="nt">&lt;/scope&gt;</span>
                 <span class="nt">&lt;/dependency&gt;</span>
<span class="c">&lt;!--             &lt;dependency&gt; --&gt;</span>
<span class="c">&lt;!--                 &lt;groupId&gt;com.oracle&lt;/groupId&gt; --&gt;</span>
<span class="c">&lt;!--                 &lt;artifactId&gt;ojdbc7&lt;/artifactId&gt; --&gt;</span>
<span class="c">&lt;!--                 &lt;version&gt;${ojdbc.version}&lt;/version&gt; --&gt;</span>
<span class="c">&lt;!--                 &lt;scope&gt;provided&lt;/scope&gt; --&gt;</span>
<span class="c">&lt;!--             &lt;/dependency&gt; --&gt;</span>

    <span class="c">&lt;!-- ... --&gt;</span>

    <span class="nt">&lt;postgresql.version&gt;</span>9.3-1102-jdbc41<span class="nt">&lt;/postgresql.version&gt;</span>
    <span class="nt">&lt;ojdbc.version&gt;</span>12.1.0.2<span class="nt">&lt;/ojdbc.version&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">artifactId/artifactId-domain/pom.xml</span></tt></li>
</ul>
<blockquote class="last">
<div><div class="highlight-xml"><div class="highlight"><pre>             <span class="nt">&lt;dependency&gt;</span>
                 <span class="nt">&lt;groupId&gt;</span>org.postgresql<span class="nt">&lt;/groupId&gt;</span>
                 <span class="nt">&lt;artifactId&gt;</span>postgresql<span class="nt">&lt;/artifactId&gt;</span>
                 <span class="nt">&lt;scope&gt;</span>provided<span class="nt">&lt;/scope&gt;</span> --&gt;
             <span class="nt">&lt;/dependency&gt;</span> --&gt;
<span class="c">&lt;!--         &lt;dependency&gt; --&gt;</span>
<span class="c">&lt;!--             &lt;groupId&gt;com.oracle&lt;/groupId&gt; --&gt;</span>
<span class="c">&lt;!--             &lt;artifactId&gt;ojdbc7&lt;/artifactId&gt; --&gt;</span>
<span class="c">&lt;!--             &lt;scope&gt;provided&lt;/scope&gt; --&gt;</span>
<span class="c">&lt;!--         &lt;/dependency&gt; --&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="createwebapplicationprojectconfiguration">
<span id="id11"></span><h2><a class="toc-backref" href="#id27">4.1.3. 開発プロジェクトの構成</a><a class="headerlink" href="#createwebapplicationprojectconfiguration" title="Permalink to this headline">¶</a></h2>
<p>Maven Archetypeで作成したプロジェクトの構成について説明する。</p>
<p>Maven Archetypeで作成したプロジェクトは、以下の構成になっている。</p>
<ul class="simple">
<li>本ガイドラインで推奨しているレイヤ毎のプロジェクト構成</li>
<li>本ガイドラインで紹介している環境依存性の排除を考慮したプロジェクト構成</li>
<li>CI(Continuous Integration)を意識したプロジェクト構成</li>
</ul>
<p>また、本ガイドラインで推奨している各種設定が盛り込まれた、</p>
<ul class="simple">
<li>Webアプリケーションの構成定義ファイル(web.xml)</li>
<li>Spring FrameworkのBean定義ファイル</li>
<li>Spring MVC用のBean定義ファイル</li>
<li>Spring Security用のBean定義ファイル</li>
<li>O/R Mapperの設定ファイル</li>
<li>Tiles用の設定ファイル</li>
<li>プロパティファイル(メッセージ定義ファイルなど)</li>
</ul>
<p>と、アプリケーション要件との依存度が低い(=どんなアプリケーションでも作成する必要がある)コンポーネントの簡易実装として、</p>
<ul class="simple">
<li>Welcomeページを表示するためのControllerとJSP</li>
<li>エラー画面を表示するためのJSP(HTML)</li>
<li>Tiles用のテンプレートJSP</li>
<li>JSPタグライブラリの読み込み設定などが定義されているインクルード用JSP</li>
<li>アプリケーション全体の画面スタイルを定義するCSSファイル</li>
</ul>
<p>などが提供されている。</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>簡易実装として提供しているコンポーネントの扱いについて</strong></p>
<p>簡易実装として提供しているコンポーネントは、以下のいずれかの対応を行うこと。</p>
<ul class="last simple">
<li>アプリケーション要件にあわせて修正</li>
<li>不要なコンポーネントは削除</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>REST API用のプロジェクトを作成する場合の手順について</strong></p>
<p>Maven Archetypeで作成したプロジェクトは、
伝統的なWebアプリケーション(リクエストパラメータを受け取ってHTMLを応答するアプリケーション)を構築する際に必要となる推奨設定が行われている。</p>
<p class="last">そのため、JSONやXMLを扱うREST APIを構築する際には不要な設定が存在する。
REST APIを構築するためのプロジェクトを作成する場合は、「<a class="reference internal" href="../ArchitectureInDetail/REST.html"><em>RESTful Web Service</em></a> の <a class="reference internal" href="../ArchitectureInDetail/REST.html#resthowtouseapplicationsettings"><em>アプリケーションの設定</em></a>」を参照し、
REST API向けの設定を適用してほしい。</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">以降の説明で<tt class="docutils literal"><span class="pre">artifactId</span></tt>と表現している部分は、
プロジェクト作成時に指定した<tt class="docutils literal"><span class="pre">artifactId</span></tt>に置き換えて読み進めてほしい。</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="createwebapplicationprojectconfigurationmulti">
<span id="id12"></span><h3><a class="toc-backref" href="#id28">4.1.3.1. マルチプロジェクトの構成</a><a class="headerlink" href="#createwebapplicationprojectconfigurationmulti" title="Permalink to this headline">¶</a></h3>
<p>まず、マルチプロジェクト全体の構成について説明する。</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">artifactId</span>
<span class="go">    ├── pom.xml  ... (1)</span>
<span class="go">    ├── artifactId-web  ... (2)</span>
<span class="go">    ├── artifactId-domain  ... (3)</span>
<span class="go">    ├── artifactId-env  ... (4)</span>
<span class="go">    ├── artifactId-initdb  ... (5)</span>
<span class="go">    └── artifactId-selenium  ... (6)</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">マルチプロジェクト全体の構成を定義するPOM(Project Object Model)ファイル。</p>
<p>このファイルでは、主に以下の定義を行う。</p>
<ul class="simple">
<li>依存ライブラリのバージョン</li>
<li>ビルド用のプラグインの設定(ビルド方法の設定)</li>
</ul>
<p class="last">マルチプロジェクトの階層関係については、「<a class="reference internal" href="#createwebapplicationprojectappendixprojecthierarchicalstructure"><em>プロジェクトの階層構造</em></a>」を参照されたい。</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><p class="first">アプリケーション層(Web層)のコンポーネントを管理するモジュール。</p>
<p>このモジュールでは、主に以下のコンポーネントやファイルを管理する。</p>
<ul class="last simple">
<li>Controllerクラス</li>
<li>相関チェック用のValidatorクラス</li>
<li>Formクラス(REST APIの場合はResourceクラス)</li>
<li>View(JSP)</li>
<li>CSSファイル</li>
<li>JavaScriptファイル</li>
<li>アプリケーション層のコンポーネント用のJUnit</li>
<li>アプリケーション層のコンポーネントを定義するためのBean定義ファイル</li>
<li>Webアプリケーションの構成定義ファイル(web.xml)</li>
<li>メッセージ定義ファイル</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><p class="first">ドメイン層のコンポーネントを管理するモジュール。</p>
<p>このモジュールでは、主に以下のコンポーネントやファイルを管理する。</p>
<ul class="last simple">
<li>Entityなどのドメインオブジェクト</li>
<li>Repository</li>
<li>Service</li>
<li>DTO</li>
<li>ドメイン層のコンポーネント用のJUnit</li>
<li>ドメイン層のコンポーネントを定義するためのBean定義ファイル</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><p class="first">環境依存性をもつ設定ファイルを管理するモジュール。</p>
<p>このモジュールでは、主に以下のファイルを管理する。</p>
<ul class="last simple">
<li>環境依存するコンポーネントを定義するためのBean定義ファイル</li>
<li>環境依存するプロパティ値を定義するプロパティファイル</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><p class="first">データベースを初期化するためのSQLファイルを管理するモジュール</p>
<p>このモジュールでは、主に以下のファイルを管理する。</p>
<ul class="last simple">
<li>テーブルなどのデータベースオブジェクトを作成するためのSQLファイル</li>
<li>マスタデータなどの初期データを投入するためのSQLファイル</li>
<li>E2E(End To End)テストで使用するテストデータを投入するためのSQLファイル</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><p class="first">Seleniumを使用したE2Eテスト用のコンポーネントを管理するモジュール。</p>
<p>このモジュールでは、主に以下のファイルを管理する。</p>
<ul class="last simple">
<li>Seleniumを操作してテストを行うJUnit</li>
<li>Assert時に使用する期待値ファイル(必要に応じて)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>本ガイドラインにおける「マルチプロジェクト」の用語定義について</strong></p>
<p>Maven Archetypeで作成したプロジェクトは、正確にはマルチモジュール構成のプロジェクトとなる。</p>
<p class="last">本ガイドラインでは、マルチモジュールとマルチプロジェクトを同じ意味で使用していることを補足しておく。</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="createwebapplicationprojectconfigurationweb">
<span id="id13"></span><h3><a class="toc-backref" href="#id29">4.1.3.2. webモジュールの構成</a><a class="headerlink" href="#createwebapplicationprojectconfigurationweb" title="Permalink to this headline">¶</a></h3>
<p>アプリケーション層(Web層)のコンポーネントを管理するモジュールの構成について説明する。</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">artifactId-web</span>
<span class="go">    ├── pom.xml  ... (1)</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">webモジュールの構成を定義するPOM(Project Object Model)ファイル。
このファイルでは、以下の定義を行う。</p>
<ul class="last simple">
<li>依存ライブラリとビルド用プラグインの定義</li>
<li>warファイルを作成するための定義</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>REST API用のプロジェクトを作成する際のwebモジュールのモジュール名について</strong></p>
<p class="last">REST APIを構築する場合は、モジュール名を<tt class="docutils literal"><span class="pre">artifactId-api</span></tt>といった感じの名前にしておくと、
アプリケーションの種類が識別しやすくなる。</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span class="go">└── src</span>
<span class="go">    ├── main</span>
<span class="go">    │   ├── java</span>
<span class="go">    │   │   └── com</span>
<span class="go">    │   │       └── example</span>
<span class="go">    │   │           └── project</span>
<span class="go">    │   │               └── app  ... (2)</span>
<span class="go">    │   │                   └── welcome</span>
<span class="go">    │   │                       └── HelloController.java  ... (3)</span>
<span class="go">    │   ├── resources</span>
<span class="go">    │   │   ├── META-INF</span>
<span class="go">    │   │   │   ├── dozer  ... (4)</span>
<span class="go">    │   │   │   └── spring  ... (5)</span>
<span class="go">    │   │   │       ├── application.properties  ... (6)</span>
<span class="go">    │   │   │       ├── applicationContext.xml  ... (7)</span>
<span class="go">    │   │   │       ├── spring-mvc.xml  ... (8)</span>
<span class="go">    │   │   │       └── spring-security.xml  ... (9)</span>
<span class="go">    │   │   └── i18n  ... (10)</span>
<span class="go">    │   │       └── application-messages.properties  ... (11)</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><p class="first">アプリケーション層のクラスを格納するためのパッケージ。</p>
<p class="last">REST APIを構築する場合は、パッケージ名を<tt class="docutils literal"><span class="pre">api</span></tt>といった感じの名前にしておくと、
コンポーネントの種類が識別しやすくなる。</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Welcomeページを表示するためのリクエストを受け取るためのControllerクラス。</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><p class="first">Dozer(Bean Mapper)のマッピング定義ファイルを格納するディレクトリ。
Dozerについては、「<a class="reference internal" href="../ArchitectureInDetail/Utilities/Dozer.html"><em>Beanマッピング(Dozer)</em></a>」を参照されたい。</p>
<p>作成時点では空のディレクトリである。
マッピングファイルが必要になった場合(高度なマッピングが必要になった場合)は、
このディレクトリ配下に格納すると、自動的にマッピングファイルが読み込まれる。</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p>このディレクトリには、以下のファイルを格納する。</p>
<ul class="simple">
<li>アプリケーション層のJavaBeanとドメイン層のJavaBeanをマッピングするための定義ファイル</li>
<li>アプリケーション層のJavaBean同士をマッピングするための定義ファイル</li>
</ul>
<p class="last">ドメイン層のJavaBean同士のマッピングはドメイン層のディレクトリに格納することを推奨している。</p>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td>Spring FrameworkのBean定義ファイルとプロパティファイルを格納するディレクトリ。</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><p class="first">アプリケーション層で使用する設定値を定義するプロパティファイル。</p>
<p class="last">作成時点では、空のファイルである。</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><p class="first">Webアプリケーション用のアプリケーションコンテキストを作成するためのBean定義ファイル。</p>
<p>このファイルには、以下のBeanを定義する。</p>
<ul class="last simple">
<li>Webアプリケーション全体で使用するコンポーネント</li>
<li>ドメイン層のコンポーネント(ドメイン層のコンポーネントが定義されているBean定義ファイルをimportする)</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(8)</div>
</div>
</td>
<td><p class="first"><tt class="docutils literal"><span class="pre">DispatcherServlet</span></tt>用のアプリケーションコンテキストを作成するためのBean定義ファイル。</p>
<p>このファイルには、以下のBeanを定義する。</p>
<ul class="simple">
<li>Spring MVCのコンポーネント</li>
<li>アプリケーション層のコンポーネント</li>
</ul>
<p class="last">REST APIを構築する場合は、ファイル名を<tt class="docutils literal"><span class="pre">spring-mvc-api.xml</span></tt>といった感じの名前にしておくと、 アプリケーションの種類が識別しやすくなる。</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(9)</div>
</div>
</td>
<td><p class="first">Spring Securityのコンポーネントを定義するためのBean定義ファイル。</p>
<p class="last">このファイルは、Webアプリケーション用のアプリケーションコンテキストを作成する際に読み込む。</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(10)</div>
</div>
</td>
<td>アプリケーション層で使用するメッセージ定義ファイルを格納するディレクトリ。</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(11)</div>
</div>
</td>
<td><p class="first">アプリケーション層で使用するメッセージを定義するプロパティファイル。</p>
<p>作成時点では、いくつかの汎用的なメッセージが定義されている。</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>メッセージについては、アプリケーションの要件(メッセージ規約など)にあわせて必ず修正すること。</strong>
メッセージ定義については、「<a class="reference internal" href="../ArchitectureInDetail/MessageManagement.html"><em>メッセージ管理</em></a>」を参照されたい。</p>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">アプリケーションコンテキストとBean定義ファイルの関連については、
「<a class="reference internal" href="#createwebapplicationprojectappendixapplicationcontext"><em>アプリケーションコンテキストの構成とBean定義ファイルの関係</em></a>」を参照されたい。</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span class="go">│   └── webapp</span>
<span class="go">│       ├── WEB-INF</span>
<span class="go">│       │   ├── tiles  ... (12)</span>
<span class="go">│       │   │   └── tiles-definitions.xml</span>
<span class="go">│       │   ├── views  ... (13)</span>
<span class="go">│       │   │   ├── common</span>
<span class="go">│       │   │   │   ├── error  ... (14)</span>
<span class="go">│       │   │   │   │   ├── accessDeniedError.jsp</span>
<span class="go">│       │   │   │   │   ├── businessError.jsp</span>
<span class="go">│       │   │   │   │   ├── dataAccessError.jsp</span>
<span class="go">│       │   │   │   │   ├── invalidCsrfTokenError.jsp</span>
<span class="go">│       │   │   │   │   ├── missingCsrfTokenError.jsp</span>
<span class="go">│       │   │   │   │   ├── resourceNotFoundError.jsp</span>
<span class="go">│       │   │   │   │   ├── systemError.jsp</span>
<span class="go">│       │   │   │   │   ├── transactionTokenError.jsp</span>
<span class="go">│       │   │   │   │   └── unhandledSystemError.html</span>
<span class="go">│       │   │   │   └── include.jsp  ... (15)</span>
<span class="go">│       │   │   ├── layout  ... (16)</span>
<span class="go">│       │   │   │   ├── header.jsp</span>
<span class="go">│       │   │   │   └── template.jsp</span>
<span class="go">│       │   │   └── welcome</span>
<span class="go">│       │   │       └── home.jsp  ... (17)</span>
<span class="go">│       │   └── web.xml  ... (18)</span>
<span class="go">│       └── resources  ... (19)</span>
<span class="go">│           └── app</span>
<span class="go">│               └── css</span>
<span class="go">│                   └── styles.css  ... (20)</span>
<span class="go">└── test</span>
<span class="go">    ├── java</span>
<span class="go">    └── resources</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(12)</div>
</div>
</td>
<td>Tilesの設定ファイルを格納するディレクトリ。
Tilesの設定ファイルについては、「<a class="reference internal" href="../ArchitectureInDetail/TilesLayout.html"><em>Tilesによる画面レイアウト</em></a>」を参照されたい。</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(13)</div>
</div>
</td>
<td>Viewを構築するテンプレートファイル(JSPなど)を格納するディレクトリ。</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(14)</div>
</div>
</td>
<td><p class="first">エラー画面を表示するためのJSP及びHTMLを格納するディレクトリ。</p>
<p>作成時点では、アプリケーション実行時に発生する可能性があるエラーに対応するJSP(HTML)が格納されている。</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>エラー画面用のJSP及びHTMLについては、アプリケーションの要件(UI規約など)にあわせて必ず修正すること。</strong></p>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(15)</div>
</div>
</td>
<td><p class="first">インクルード用の共通JSPファイル。</p>
<p class="last">このファイルは、全てのJSPファイルの先頭にインクルードされる。
インクルード用の共通JSPファイルについては、「<a class="reference internal" href="ApplicationLayer.html#view-jsp-include-label"><em>インクルード用の共通JSPの作成</em></a>」を参照されたい。</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(16)</div>
</div>
</td>
<td>Tilesのレイアウト用のJSPファイルを格納するディレクトリ。
Tilesのレイアウト用のJSPファイルについては、「<a class="reference internal" href="../ArchitectureInDetail/TilesLayout.html"><em>Tilesによる画面レイアウト</em></a>」を参照されたい。</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(17)</div>
</div>
</td>
<td>Welcomeページを表示するJSPファイル。</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(18)</div>
</div>
</td>
<td>Webアプリケーションの構成定義ファイル。</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(19)</div>
</div>
</td>
<td><p class="first">静的なリソースファイルを格納するディレクトリ。</p>
<p>このディレクトリは、リクエストの内容によって応答する内容がかわらないファイルを格納する。
具体的には以下のファイルを格納する。</p>
<ul class="simple">
<li>JavaScriptファイル</li>
<li>CSSファイル</li>
<li>画像ファイル</li>
<li>HTMLファイル</li>
</ul>
<p class="last">Spring MVCが提供する静的リソースの管理メカニズムを適用しやすくするために、
専用のディレクトリを設ける構成を採用している。</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(20)</div>
</div>
</td>
<td>アプリケーション全体に適用する画面スタイルを定義するCSSファイル。</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="domain">
<span id="createwebapplicationprojectconfigurationdomain"></span><h3><a class="toc-backref" href="#id30">4.1.3.3. domainモジュールの構成</a><a class="headerlink" href="#domain" title="Permalink to this headline">¶</a></h3>
<p>ドメイン層のコンポーネントを管理するモジュールの構成について説明する。</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">artifactId-domain</span>
<span class="go">    ├── pom.xml  ... (1)</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">domainモジュールの構成を定義するPOM(Project Object Model)ファイル。
このファイルでは、以下の定義を行う。</p>
<ul class="last simple">
<li>依存ライブラリとビルド用プラグインの定義</li>
<li>jarファイルを作成するための定義</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span class="go">└── src</span>
<span class="go">    ├── main</span>
<span class="go">    │   ├── java</span>
<span class="go">    │   │   └── com</span>
<span class="go">    │   │       └── example</span>
<span class="go">    │   │           └── project</span>
<span class="go">    │   │               └── domain  ... (2)</span>
<span class="go">    │   │                   ├── model</span>
<span class="go">    │   │                   ├── repository</span>
<span class="go">    │   │                   └── service</span>
<span class="go">    │   └── resources</span>
<span class="go">    │       └── META-INF</span>
<span class="go">    │           ├── dozer  ... (3)</span>
<span class="go">    │           └── spring  ... (4)</span>
<span class="go">    │               ├── artifactId-codelist.xml  ... (5)</span>
<span class="go">    │               ├── artifactId-domain.xml  ... (6)</span>
<span class="go">    │               └── artifactId-infra.xml  ... (7)</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>ドメイン層のクラスを格納するためのパッケージ。</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><p class="first">Dozer(Bean Mapper)のマッピング定義ファイルを格納するディレクトリ。
Dozerについては、「<a class="reference internal" href="../ArchitectureInDetail/Utilities/Dozer.html"><em>Beanマッピング(Dozer)</em></a>」を参照されたい。</p>
<p>作成時点では空のディレクトリである。
マッピングファイルが必要になった場合(高度なマッピングが必要になった場合)は、
このディレクトリ配下に格納すると、自動的にマッピングファイルが読み込まれる。</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p>このディレクトリには、以下のファイルを格納する。</p>
<ul class="last simple">
<li>ドメイン層のJavaBean同士をマッピングするための定義ファイル</li>
</ul>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td>Spring FrameworkのBean定義ファイルとプロパティファイルを格納するディレクトリ。</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td>コードリストを定義するためのBean定義ファイル。</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><p class="first">ドメイン層のコンポーネントを定義するためのBean定義ファイル。</p>
<p>このファイルには、以下のBeanを定義する。</p>
<ul class="last simple">
<li>ドメイン層のコンポーネント(Service, Repositoryなど)</li>
<li>インフラストラクチャ層のコンポーネント(インフラストラクチャ層のコンポーネントが定義されているBean定義ファイルをimportする)</li>
<li>Spring Frameworkから提供されているトランザクション管理用のコンポーネント</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><p class="first">インフラストラクチャ層のコンポーネントを定義するためのBean定義ファイル。</p>
<p class="last">このファイルには、O/R MapperなどのBean定義を行う。</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span class="go">└── test</span>
<span class="go">    ├── java</span>
<span class="go">    │   └── com</span>
<span class="go">    │       └── example</span>
<span class="go">    │           └── project</span>
<span class="go">    │               └── domain</span>
<span class="go">    │                   ├── repository</span>
<span class="go">    │                   └── service</span>
<span class="go">    └── resources</span>
<span class="go">        └── test-context.xml  ... (8)</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(8)</div>
</div>
</td>
<td>ドメイン層のユニットテスト用のコンポーネントを定義するためのBean定義ファイル。</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>MyBatis3用のプロジェクトを作成した場合</strong></p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">└── src</span>
<span class="go">    ├── main</span>
<span class="go">    │   ├── java</span>
<span class="go">   (...)</span>
<span class="go">    │   └── resources</span>
<span class="go">    │       ├── META-INF</span>
<span class="go">    │       │   ├── dozer</span>
<span class="go">    │       │   ├── mybatis  ... (9)</span>
<span class="go">    │       │   │   └── mybatis-config.xml  ... (10)</span>
<span class="go">    │       │   └── spring</span>
<span class="go">   (...)</span>
<span class="go">    │       └── com</span>
<span class="go">    │           └── example</span>
<span class="go">    │               └── project</span>
<span class="go">    │                   └── domain</span>
<span class="go">    │                       └── repository  ... (11)</span>
<span class="go">    │                           └── sample</span>
<span class="go">    │                               └── SampleRepository.xml  ... (12)</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(9)</div>
</div>
</td>
<td>MyBatis3の設定ファイルを格納するディレクトリ。</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(10)</div>
</div>
</td>
<td><p class="first">MyBatis3の設定ファイル。</p>
<p class="last">作成時点では、いくつかの推奨設定が定義されている。</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(11)</div>
</div>
</td>
<td>MyBatis3のMapperファイルを格納するディレクトリ。</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(12)</div>
</div>
</td>
<td><p class="first">MyBatis3のMapperファイルのサンプルファイル。</p>
<p class="last">作成時点では、サンプル実装がコメントアウトされた状態になっている。
<strong>このファイルは最終的には不要なファイルである。</strong></p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>MyBatis2用のプロジェクトを作成した場合</strong></p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">└── src</span>
<span class="go">    ├── main</span>
<span class="go">    │   ├── java</span>
<span class="go">   (...)</span>
<span class="go">    │   └── resources</span>
<span class="go">    │       └── META-INF</span>
<span class="go">    │           ├── dozer</span>
<span class="go">    │           ├── mybatis  ... (13)</span>
<span class="go">    │           │   ├── config  ... (14)</span>
<span class="go">    │           │   │   └── sqlMapConfig.xml  ... (15)</span>
<span class="go">    │           │   └── sql  ... (16)</span>
<span class="go">    │           │       └── sample-sqlmap.xml  ... (17)</span>
<span class="go">    │           └── spring</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(13)</div>
</div>
</td>
<td>MyBatis2の設定ファイルとSqlMapファイルを格納するディレクトリ。</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(14)</div>
</div>
</td>
<td>MyBatis2の設定ファイルを格納するディレクトリ。</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(15)</div>
</div>
</td>
<td><p class="first">MyBatis2の設定ファイル。</p>
<p class="last">作成時点では、ネームスペースを有効にするための設定が定義されている。</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(16)</div>
</div>
</td>
<td>MyBatis2のSqlMapファイルを格納するディレクトリ。</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(17)</div>
</div>
</td>
<td><p class="first">MyBatis2のSqlMapファイルのサンプルファイル。</p>
<p class="last">作成時点では、サンプル実装がコメントアウトされた状態になっている。
<strong>このファイルは最終的には不要なファイルである。</strong></p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="env">
<span id="createwebapplicationprojectconfigurationenv"></span><h3><a class="toc-backref" href="#id31">4.1.3.4. envモジュールの構成</a><a class="headerlink" href="#env" title="Permalink to this headline">¶</a></h3>
<p>環境依存性をもつ設定ファイルを管理するモジュールの構成について説明する。</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">artifactId-env</span>
<span class="go">    ├── configs  ... (1)</span>
<span class="go">    │   ├── production-server  ... (2)</span>
<span class="go">    │   │   └── resources</span>
<span class="go">    │   └── test-server</span>
<span class="go">    │       └── resources</span>
<span class="go">    ├── pom.xml  ... (3)</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">環境依存する設定ファイルを管理するためのディレクトリ。</p>
<p class="last">環境毎にサブディレクトリを作成し、環境依存する設定ファイルを管理する。</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><p class="first">環境毎の設定ファイルを管理するためのディレクトリ。</p>
<p>作成時点では、最もシンプルな構成として、以下のディレクトリ(雛形のディレクトリ)が用意されている。</p>
<ul class="last simple">
<li>production-server (商用環境向けの設定ファイルを格納するディレクトリ)</li>
<li>test-server (テスト環境向けの設定ファイルを格納するディレクトリ)</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><p class="first">envモジュールの構成を定義するPOM(Project Object Model)ファイル。
このファイルでは、以下の定義を行う。</p>
<ul class="last simple">
<li>依存ライブラリとビルド用プラグインの定義</li>
<li>環境毎のjarファイルを作成するためのProfileの定義</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span class="go">└── src</span>
<span class="go">    └── main</span>
<span class="go">        └── resources  ... (4)</span>
<span class="go">            ├── META-INF</span>
<span class="go">            │   └── spring</span>
<span class="go">            │       ├── artifactId-env.xml  ... (5)</span>
<span class="go">            │       └── artifactId-infra.properties  ... (6)</span>
<span class="go">            ├── database  ... (7)</span>
<span class="go">            │   ├── H2-dataload.sql</span>
<span class="go">            │   └── H2-schema.sql</span>
<span class="go">            ├── dozer.properties  ... (8)</span>
<span class="go">            ├── log4jdbc.properties  ... (9)</span>
<span class="go">            └── logback.xml  ... (10)</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td>開発用の設定ファイルを管理するためのディレクトリ。</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><p class="first">環境依存するコンポーネントを定義するBean定義ファイル。</p>
<p>このファイルには、以下のBeanを定義する。</p>
<ul class="last simple">
<li>データソース</li>
<li>共通ライブラリから提供している<tt class="docutils literal"><span class="pre">JodaTimeDateFactory</span></tt>(環境によって異なる実装を使用する場合)</li>
<li>Spring Frameworkから提供されているトランザクション管理用のコンポーネント (環境によって異なる実装を使用する場合)</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><p class="first">環境依存する設定値を定義するプロパティファイル。</p>
<p class="last">作成時点では、データソースの設定値(接続情報とコネクションプールの設定値)が定義されている。</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><p class="first">インメモリデータベース(H2 Database)をセットアップするためのSQLを格納するディレクトリ。</p>
<p class="last">このディレクトリは、ちょっとした動作検証を行う時のために用意しているディレクトリである。
<strong>実際のアプリケーション開発で使用することは想定していないので、基本的にはこのディレクトリは削除すること。</strong></p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(8)</div>
</div>
</td>
<td><p class="first">Dozer(Bean Mapper)のグローバル設定を行うためのプロパティファイル。
Dozerについては、「<a class="reference internal" href="../ArchitectureInDetail/Utilities/Dozer.html"><em>Beanマッピング(Dozer)</em></a>」を参照されたい。</p>
<p class="last">作成時点では、空のファイルである。(ファイルがないと起動時に警告ログが出力されるため、これを防ぐために空のファイルを用意している)</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(9)</div>
</div>
</td>
<td><p class="first">Log4jdbc-remix(JDBC関連のログ出力を行うライブラリ)のグローバル設定を行うためのプロパティファイル。
Log4jdbc-remixについては、「<a class="reference internal" href="../ArchitectureInDetail/DataAccessCommon.html#dataaccesscommondatasourcedebug"><em>JDBCのDebug用ログの設定</em></a>」を参照されたい。</p>
<p class="last">作成時点では、ログに出力するSQLの改行に関する設定のみ指定されている。</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(10)</div>
</div>
</td>
<td>Logback(ログ出力)の設定ファイル。
ログ出力については、「<a class="reference internal" href="../ArchitectureInDetail/Logging.html"><em>ロギング</em></a>」を参照されたい。</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="initdb">
<span id="createwebapplicationprojectconfigurationinitdb"></span><h3><a class="toc-backref" href="#id32">4.1.3.5. initdbモジュールの構成</a><a class="headerlink" href="#initdb" title="Permalink to this headline">¶</a></h3>
<p>データベースを初期化するためのSQLファイルを管理するモジュールの構成について説明する。</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">artifactId-initdb</span>
<span class="go">    ├── pom.xml  ... (1)</span>
<span class="go">    └── src</span>
<span class="go">        └── main</span>
<span class="go">            └── sqls  ... (2)</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">initdbモジュールの構成を定義するPOM(Project Object Model)ファイル。
このファイルでは、以下の定義を行う。</p>
<ul class="simple">
<li>ビルド用プラグイン(<a class="reference external" href="http://mojo.codehaus.org/sql-maven-plugin/index.html">SQL Maven Plugin</a>)の定義</li>
</ul>
<p class="last">作成時点では、PostgreSQL用の雛形設定が定義されている。</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><p class="first">データベースを初期化するためのSQLファイルを格納するためのディレクトリ。</p>
<p class="last">作成時点では、空のディレクトリである。
作成例については、<a class="reference external" href="https://github.com/terasolunaorg/terasoluna-tourreservation-mybatis3/tree/master/terasoluna-tourreservation-initdb/src/sqls">サンプルアプリケーションのinitdbプロジェクト</a> を参照されたい。</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="selenium">
<span id="createwebapplicationprojectconfigurationselenium"></span><h3><a class="toc-backref" href="#id33">4.1.3.6. seleniumモジュールの構成</a><a class="headerlink" href="#selenium" title="Permalink to this headline">¶</a></h3>
<p>Seleniumを使用したE2E(End To End)テスト用のコンポーネントを管理するモジュールの構成について説明する。</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">artifactId-selenium</span>
<span class="go">    ├── pom.xml  ... (1)</span>
<span class="go">    └── src</span>
<span class="go">        └── test  ... (2)</span>
<span class="go">            ├── java</span>
<span class="go">            └── resources</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">seleniumモジュールの構成を定義するPOM(Project Object Model)ファイル。</p>
<p>このファイルでは、以下の定義を行う。</p>
<ul class="last simple">
<li>依存ライブラリとビルド用プラグインの定義</li>
<li>jarファイルを作成するための定義</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><p class="first">テスト用のコンポーネントと設定ファイルを格納するディレクトリ。</p>
<p class="last">作成例については、<a class="reference external" href="https://github.com/terasolunaorg/terasoluna-tourreservation-mybatis3/tree/master/terasoluna-tourreservation-selenium">サンプルアプリケーションのseleniumプロジェクト</a> を参照されたい。</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="appendix">
<span id="createwebapplicationprojectappendix"></span><h2><a class="toc-backref" href="#id34">4.1.4. Appendix</a><a class="headerlink" href="#appendix" title="Permalink to this headline">¶</a></h2>
<div class="section" id="createwebapplicationprojectappendixprojecthierarchicalstructure">
<span id="id16"></span><h3><a class="toc-backref" href="#id35">4.1.4.1. プロジェクトの階層構造</a><a class="headerlink" href="#createwebapplicationprojectappendixprojecthierarchicalstructure" title="Permalink to this headline">¶</a></h3>
<p>Maven Archetypeで作成したプロジェクトのプロジェクト階層の構造を以下に示す。</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/CreateWebApplicationProjectHierarchicalStructure.png"><img alt="../_images/CreateWebApplicationProjectHierarchicalStructure.png" src="../_images/CreateWebApplicationProjectHierarchicalStructure.png" style="width: 100%;" /></a>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">Maven Archetypeで作成したプロジェクト。</p>
<p>Maven Archetypeで作成したプロジェクトはマルチモジュール構成となっており、
親プロジェクトと各サブモジュールは相互参照の関係になっている。</p>
<p class="last">version 5.0.0.RELEASE用のMaven Archetypeで作成したプロジェクトでは、
親プロジェクトとして「org.terasoluna.gfw:terasoluna-gfw-parent:5.0.0.RELEASE」を指定している。</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><p class="first">TERASOLUNA Global Framework Parentプロジェクト。</p>
<p>TERASOLUNA Global Framework Parentプロジェクトでは、</p>
<ul class="simple">
<li>ビルド用のプラグインの設定</li>
<li>Spring IO Platform経由で管理されているライブラリのカスタマイズ(バージョンとスコープの調整)</li>
<li>Spring IO Platformで管理されていない推奨ライブラリのバージョン管理</li>
</ul>
<p>を行っている。</p>
<p class="last">親プロジェクトとして「io.spring.platform:platform-bom:1.1.1.RELEASE」を指定している。</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><p class="first">Spring IO Platformプロジェクト。</p>
<p class="last">親プロジェクトとして「org.springframework.boot:spring-boot-starter-parent:1.2.1.RELEASE」を指定している。</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><p class="first">Spring Boot Starter Parentプロジェクト。</p>
<p class="last">親プロジェクトとして「org.springframework.boot:spring-boot-dependencies:1.2.1.RELEASE」を指定している。</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td>Spring Boot Dependenciesプロジェクト。</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">version 5.0.0.RELEASEより、Spring IO Platformを親プロジェクトに指定する構成に変更しており、
推奨ライブラリのバージョン管理をSpring IO Platformに委譲するスタイルを採用している。</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>version 5.0.0.RELEASEより、Spring IO Platformを親プロジェクトに指定する構成に変更したため、
依存ライブラリのバージョンを管理するためのプロパティの名前が大幅に変更されている。</p>
<p class="last">そのため、プロジェクト側でプロパティ値を上書きしている場合は、version 1.0.xからバージョンアップする際は注意が必要である。</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="bean">
<span id="createwebapplicationprojectappendixapplicationcontext"></span><h3><a class="toc-backref" href="#id36">4.1.4.2. アプリケーションコンテキストの構成とBean定義ファイルの関係</a><a class="headerlink" href="#bean" title="Permalink to this headline">¶</a></h3>
<p>Spring Frameworkのアプリケーションコンテキスト(DIコンテナ)の構成とBean定義ファイルの関係を以下に示す。</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/CreateWebApplicationProjectApplicationContext.png"><img alt="../_images/CreateWebApplicationProjectApplicationContext.png" src="../_images/CreateWebApplicationProjectApplicationContext.png" style="width: 100%;" /></a>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">Webアプリケーション用のアプリケーションコンテキスト。</p>
<p>上記図で示す通り、</p>
<ul class="simple">
<li>artifactId-web/src/main/resource/META-INF/spring/applicationContext.xml</li>
<li>artifactId-domain/src/main/resource/META-INF/spring/artifactId-domain.xml</li>
<li>artifactId-domain/src/main/resource/META-INF/spring/artifactId-infra.xml</li>
<li>artifactId-env/src/main/resource/META-INF/spring/artifactId-env.xml</li>
<li>artifactId-domain/src/main/resource/META-INF/spring/artifactId-codelist.xml</li>
<li>artifactId-web/src/main/resource/META-INF/spring/spring-security.xml</li>
</ul>
<p>で定義したコンポーネントがWebアプリケーション用のアプリケーションコンテキスト(DIコンテナ)に登録される。</p>
<p class="last">Webアプリケーション用のアプリケーションコンテキストに登録されているコンポーネントは、
各<tt class="docutils literal"><span class="pre">DispatcherServlet</span></tt>用のアプリケーションコンテキストから参照する事ができる仕組みとなっている。</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><p class="first"><tt class="docutils literal"><span class="pre">DispatcherServlet</span></tt>用のアプリケーションコンテキスト。</p>
<p>上記図で示す通り、</p>
<ul class="simple">
<li>artifactId-web/src/main/resource/META-INF/spring/spring-mvc.xml</li>
</ul>
<p>で定義したコンポーネントが<tt class="docutils literal"><span class="pre">DispatcherServlet</span></tt>用のアプリケーションコンテキスト(DIコンテナ)に登録される。</p>
<p class="last"><tt class="docutils literal"><span class="pre">DispatcherServlet</span></tt>用のアプリケーションコンテキストに存在しないコンポーネントは、
Webアプリケーション用のアプリケーションコンテキスト(親コンテキスト)を参照して取得する仕組みになっているため、
ドメイン層のコンポーネントをアプリケーション層のコンポーネントに対してインジェクションする事ができる。</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>同じコンポーネントを両方のアプリケーションコンテキストに登録した時の動作について</strong></p>
<p>Webアプリケーション用のアプリケーションコンテキストと<tt class="docutils literal"><span class="pre">DispatcherServlet</span></tt>用のアプリケーションコンテキストの両方に同じコンポーネントが登録されている場合は、
同じアプリケーションコンテキスト(<tt class="docutils literal"><span class="pre">DispatcherServlet</span></tt>用のアプリケーションコンテキスト)内に登録されているコンポーネントがインジェクションされる点を補足しておく。</p>
<p>特に、ドメイン層のコンポーネント(ServiceやRepositoryなど)を<tt class="docutils literal"><span class="pre">DispatcherServlet</span></tt>用のアプリケーションコンテキストに登録しないように注意する必要である。</p>
<p>ドメイン層のコンポーネントを<tt class="docutils literal"><span class="pre">DispatcherServlet</span></tt>用のアプリケーションコンテキストに登録してしまうと、
トランザクション制御を行うコンポーネント(AOP)が有効にならないため、データベースへの操作がコミットされない不具合が発生してしまう。</p>
<p class="last">なお、Maven Archetypeで作成したプロジェクトでは、上記のような現象は発生しないように設定が行われている。
設定の追加又は変更を行う場合は、注意してほしい。</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="createwebapplicationprojectappendixdescribeconfigurationfile">
<span id="id17"></span><h3><a class="toc-backref" href="#id37">4.1.4.3. 設定ファイルの解説</a><a class="headerlink" href="#createwebapplicationprojectappendixdescribeconfigurationfile" title="Permalink to this headline">¶</a></h3>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p>各種設定が意味することの理解度を高めるために、設定ファイルの解説を追加する予定である。</p>
<ul class="simple">
<li>機能詳細に説明があるものについては、機能詳細への参照を記載する。</li>
<li>機能詳細に記載がないものについては、ここに説明を記載する。</li>
</ul>
<p class="last">具体的な対応時期は未定。</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="DomainLayer.html" title="4.2. ドメイン層の実装"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="4. TERASOLUNA Global Frameworkによるアプリケーション開発"
             >previous</a> |</li>
        <li><a href="../index.html">TERASOLUNA Global Framework Development Guideline 5.0.0-SNAPSHOT documentation</a> &raquo;</li>
          <li><a href="index.html" >4. TERASOLUNA Global Frameworkによるアプリケーション開発</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013-2015, NTT DATA.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.Theme by <a href="http://github.com/vkvn">vkvn</a>
    </div>
    
    <script>
    
    $(function() {
    	var $sidebar	= $('.sphinxsidebar'),
    		$window		= $(window),
    		offset		= $sidebar.offset(),
    		topPadding	= 3,
    		$scroll		= $('#scroll');
    	
    	$window.scroll(function() {
    		if ($scroll.is(':checked')) {
				if ($window.scrollTop() > offset.top) {
					$sidebar.stop().animate({
						marginTop:$window.scrollTop() - offset.top + topPadding
					});
				} else {
					$sidebar.stop().animate({
						marginTop:0
					});
				}
			}
		});
    	
    	var $navList = $('ul:first', $sidebar);
    	$('li:first', $navList).addClass('open');
    	
    	$navList.treeview({
    		persist: "location",
    		collapsed: true,
    		unique: false
    	});
    	
	});
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-46550814-1', 'terasolunaorg.github.io');
    ga('send', 'pageview');
    </script>
  </body>
</html>