<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5.5. Input Validation &mdash; TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.0.2.RELEASE documentation</title>
    
    <link rel="stylesheet" href="../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.0.2.RELEASE',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.0.2.RELEASE documentation" href="../index.html" />
    <link rel="up" title="5. Architecture in Detail - TERASOLUNA Server Framework for Java (5.x)" href="index.html" />
    <link rel="next" title="5.6. Logging" href="Logging.html" />
    <link rel="prev" title="5.4. Exclusive Control" href="ExclusionControl.html" /><script src="../_static/jquery.treeview.js" type="text/javascript"></script>
<!-- <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'> -->
<link href="../_static/solarized-dark.css" rel="stylesheet">
<link href="../_static/jquery.treeview.css" rel="stylesheet">
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Logging.html" title="5.6. Logging"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ExclusionControl.html" title="5.4. Exclusive Control"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.0.2.RELEASE documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">5. Architecture in Detail - TERASOLUNA Server Framework for Java (5.x)</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><label><input id="scroll" type="checkbox" checked> scroll sidebar</label>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5.5. Input Validation</a><ul>
<li><a class="reference internal" href="#overview">5.5.1. Overview</a><ul>
<li><a class="reference internal" href="#classification-of-input-validation">5.5.1.1. Classification of input validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use">5.5.2. How to use</a><ul>
<li><a class="reference internal" href="#adding-dependent-libraries">5.5.2.1. Adding dependent libraries</a></li>
<li><a class="reference internal" href="#single-item-check">5.5.2.2. Single item check</a><ul>
<li><a class="reference internal" href="#basic-single-item-check">5.5.2.2.1. Basic single item check</a></li>
<li><a class="reference internal" href="#single-item-check-of-nested-bean">5.5.2.2.2. Single item check of nested Bean</a></li>
<li><a class="reference internal" href="#grouped-validation">5.5.2.2.3. Grouped validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#correlation-item-check">5.5.2.3. Correlation item check</a><ul>
<li><a class="reference internal" href="#correlation-item-check-implementation-using-spring-validator">5.5.2.3.1. Correlation item check implementation using Spring Validator</a></li>
<li><a class="reference internal" href="#implementation-of-input-check-of-correlated-items-using-bean-validation">5.5.2.3.2. Implementation of input check of correlated items using Bean Validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#definition-of-error-messages">5.5.2.4. Definition of error messages</a><ul>
<li><a class="reference internal" href="#messages-to-be-defined-in-validationmessages-properties">5.5.2.4.1. Messages to be defined in ValidationMessages.properties</a></li>
<li><a class="reference internal" href="#messages-to-be-defined-in-application-messages-properties">5.5.2.4.2. Messages to be defined in application-messages.properties</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-extend">5.5.3. How to extend</a><ul>
<li><a class="reference internal" href="#creation-of-bean-validation-annotation-by-combining-existing-rules">5.5.3.1. Creation of Bean Validation annotation by combining existing rules</a></li>
<li><a class="reference internal" href="#creation-of-bean-validation-annotation-by-implementing-new-rules">5.5.3.2. Creation of Bean Validation annotation by implementing new rules</a><ul>
<li><a class="reference internal" href="#rules-that-cannot-be-implemented-by-combining-the-existing-rules">5.5.3.2.1. Rules that cannot be implemented by combining the existing rules</a></li>
<li><a class="reference internal" href="#check-rules-for-correlated-items">5.5.3.2.2. Check rules for correlated items</a></li>
<li><a class="reference internal" href="#business-logic-check">5.5.3.2.3. Business logic check</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#appendix">5.5.4. Appendix</a><ul>
<li><a class="reference internal" href="#input-validation-rules-provided-by-hibernate-validator">5.5.4.1. Input validation rules provided by Hibernate Validator</a><ul>
<li><a class="reference internal" href="#bean-validation-check-rules">5.5.4.1.1. Bean Validation check rules</a></li>
<li><a class="reference internal" href="#hibernate-validator-check-rules">5.5.4.1.2. Hibernate Validator check rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#default-messages-provided-by-hibernate-validator">5.5.4.2. Default messages provided by Hibernate Validator</a></li>
<li><a class="reference internal" href="#type-mismatch">5.5.4.3. Type mismatch</a></li>
<li><a class="reference internal" href="#binding-null-to-blank-string-field">5.5.4.4. Binding null to blank string field</a></li>
</ul>
</li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="ExclusionControl.html"
                        title="previous chapter">5.4. Exclusive Control</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Logging.html"
                        title="next chapter">5.6. Logging</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/ArchitectureInDetail/Validation.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="input-validation">
<h1><a class="toc-backref" href="#id2">5.5. Input Validation</a><a class="headerlink" href="#input-validation" title="Permalink to this headline">Â¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#input-validation" id="id2">Input Validation</a><ul>
<li><a class="reference internal" href="#overview" id="id3">Overview</a><ul>
<li><a class="reference internal" href="#classification-of-input-validation" id="id4">Classification of input validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use" id="id5">How to use</a><ul>
<li><a class="reference internal" href="#adding-dependent-libraries" id="id6">Adding dependent libraries</a></li>
<li><a class="reference internal" href="#single-item-check" id="id7">Single item check</a><ul>
<li><a class="reference internal" href="#basic-single-item-check" id="id8">Basic single item check</a></li>
<li><a class="reference internal" href="#single-item-check-of-nested-bean" id="id9">Single item check of nested Bean</a></li>
<li><a class="reference internal" href="#grouped-validation" id="id10">Grouped validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#correlation-item-check" id="id11">Correlation item check</a><ul>
<li><a class="reference internal" href="#correlation-item-check-implementation-using-spring-validator" id="id12">Correlation item check implementation using Spring Validator</a></li>
<li><a class="reference internal" href="#implementation-of-input-check-of-correlated-items-using-bean-validation" id="id13">Implementation of input check of correlated items using Bean Validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#definition-of-error-messages" id="id14">Definition of error messages</a><ul>
<li><a class="reference internal" href="#messages-to-be-defined-in-validationmessages-properties" id="id15">Messages to be defined in ValidationMessages.properties</a></li>
<li><a class="reference internal" href="#messages-to-be-defined-in-application-messages-properties" id="id16">Messages to be defined in application-messages.properties</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-extend" id="id17">How to extend</a><ul>
<li><a class="reference internal" href="#creation-of-bean-validation-annotation-by-combining-existing-rules" id="id18">Creation of Bean Validation annotation by combining existing rules</a></li>
<li><a class="reference internal" href="#creation-of-bean-validation-annotation-by-implementing-new-rules" id="id19">Creation of Bean Validation annotation by implementing new rules</a><ul>
<li><a class="reference internal" href="#rules-that-cannot-be-implemented-by-combining-the-existing-rules" id="id20">Rules that cannot be implemented by combining the existing rules</a></li>
<li><a class="reference internal" href="#check-rules-for-correlated-items" id="id21">Check rules for correlated items</a></li>
<li><a class="reference internal" href="#business-logic-check" id="id22">Business logic check</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#appendix" id="id23">Appendix</a><ul>
<li><a class="reference internal" href="#input-validation-rules-provided-by-hibernate-validator" id="id24">Input validation rules provided by Hibernate Validator</a><ul>
<li><a class="reference internal" href="#bean-validation-check-rules" id="id25">Bean Validation check rules</a></li>
<li><a class="reference internal" href="#hibernate-validator-check-rules" id="id26">Hibernate Validator check rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#default-messages-provided-by-hibernate-validator" id="id27">Default messages provided by Hibernate Validator</a></li>
<li><a class="reference internal" href="#type-mismatch" id="id28">Type mismatch</a></li>
<li><a class="reference internal" href="#binding-null-to-blank-string-field" id="id29">Binding null to blank string field</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id3">5.5.1. Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">Â¶</a></h2>
<p>It is mandatory to check whether the value entered by the user is correct.
Validation of input value is broadly classified into</p>
<ol class="arabic simple">
<li>Validation to determine whether the input value is valid by just looking at it irrespective of the context such as size and format.</li>
<li>Validation of whether the changes in input value are valid depending on the system status.</li>
</ol>
<p>1. is an example of mandatory check and number of digits check and 2. is an example of check of whether EMail is registered and
whether order count is within the count of the available stock.</p>
<p>In this section, 1. is explained and this check is called &#8220;Input validation&#8221;.
2. is called &#8220;Business logic check&#8221;. For business logic check,
refer to <a class="reference internal" href="../ImplementationAtEachLayer/DomainLayer.html"><em>Domain Layer Implementation</em></a>.</p>
<p>In this guideline, validation check should be performed in application layer
whereas business logic check should be performed in domain layer.</p>
<p>Input validation of Web application is performed at server side and client side (JavaScript).
It is mandatory to check at the Server Side. However, if the same check is performed at the client side also,
usability improves since validation results can be analyzed without communicating with the server.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Input validation should be performed at the server side as the process at client side may be altered using JavaScript.
If the validation is performed only at the client side without performing at the server side, the system may be exposed to danger.</p>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Input validation at client side will be explained later. Only input validation at the server side is mentioned in the first version.</p>
</div>
<div class="section" id="classification-of-input-validation">
<h3><a class="toc-backref" href="#id4">5.5.1.1. Classification of input validation</a><a class="headerlink" href="#classification-of-input-validation" title="Permalink to this headline">Â¶</a></h3>
<p>Input validation is classified into single item check and correlation item check.</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="30%" />
<col width="25%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Description</th>
<th class="head">Example</th>
<th class="head">Implementation method</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Single item check</td>
<td><div class="first last line-block">
<div class="line">Check completed in single field</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Input mandatory check</div>
<div class="line">Digit check</div>
<div class="line">Type check</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Bean Validation (Hibernate Validator is used as implementation library)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>Correlation item check</td>
<td><div class="first last line-block">
<div class="line">Check comparing multiple fields</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Password and confirm password check</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Bean Validation or Validation class implementing <a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/validation.html#validator">org.springframework.validation.Validator</a></div>
<div class="line">interface</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Spring supports Bean Validation which is a Java standard.
This Bean Validation is used for single item check.
Bean Validation or <code class="docutils literal"><span class="pre">org.springframework.validation.Validator</span></code> interface provided by Spring is used for correlation item check.</p>
</div>
</div>
<div class="section" id="how-to-use">
<span id="validation-how-to-use"></span><h2><a class="toc-backref" href="#id5">5.5.2. How to use</a><a class="headerlink" href="#how-to-use" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="adding-dependent-libraries">
<h3><a class="toc-backref" href="#id6">5.5.2.1. Adding dependent libraries</a><a class="headerlink" href="#adding-dependent-libraries" title="Permalink to this headline">Â¶</a></h3>
<p>When Bean validation 1.1 (Hibernate Validator 5.x) or higher version is to be used,
in addition to jar file of Hibernate Validator and jar file storing API specifications class (<code class="docutils literal"><span class="pre">javax.validation</span></code> package class) of Bean Validation,
libraries that store the following classes are required.</p>
<ul class="simple">
<li>API specifications class of Expression Language 2.2 or higher version (<code class="docutils literal"><span class="pre">javax.el</span></code> package class)</li>
<li>Reference implementation class of Expression Language 2.2 or higher version</li>
</ul>
<p>If the file is run by deploying on application server,
dependent libraries need not be added;
since these libraries are provided by application server.
However, when it is run in standalone environment (JUnit etc.), these libraries need to be added as dependent libraries.</p>
<p>An example of adding libraries which are required when running Bean Validation 1.1 or higher version in standalone environment is given below.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.tomcat.embed<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>tomcat-embed-el<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">Add a library wherein a class for Expression Language is stored,
in <code class="file docutils literal"><span class="pre">pom.xml</span></code> file of the project to be run in standalone environment.</p>
<p class="last">In the above example, libraries provided for Apache Tomcat to be embedded are specified.
API specifications classes of Expression Language and reference implementation classes are both stored in jar file of <code class="docutils literal"><span class="pre">tomcat-embed-el</span></code>.</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>When dependent libraries are required to execute JUnit, an appropriate scope is <code class="docutils literal"><span class="pre">test</span></code>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the above example of settings, it is a prerequisite that version of dependent libraries should be stored in the parent project.
Therefore, <code class="docutils literal"><span class="pre">&lt;version&gt;</span></code> element is not specified.</p>
</div>
</div>
<div class="section" id="single-item-check">
<span id="validation-single-check"></span><h3><a class="toc-backref" href="#id7">5.5.2.2. Single item check</a><a class="headerlink" href="#single-item-check" title="Permalink to this headline">Â¶</a></h3>
<p>For the implementation of single item check,</p>
<ul class="simple">
<li>Bean Validation annotation should be assigned to the field of form class</li>
<li><code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation should be assigned in Controller for validation</li>
<li>Tag for displaying validation error message should be added to JSP</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">&lt;mvc:annotation-driven&gt;</span></code> settings are carried out in spring-mvc.xml, Bean Validation is enabled.</p>
</div>
<div class="section" id="basic-single-item-check">
<span id="validation-basic-validation"></span><h4><a class="toc-backref" href="#id8">5.5.2.2.1. Basic single item check</a><a class="headerlink" href="#basic-single-item-check" title="Permalink to this headline">Â¶</a></h4>
<p>Implementation method is explained using &#8220;New user registration&#8221; process as an example. Rules for checking &#8220;New user registration&#8221; form are provided below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field name</th>
<th class="head">Type</th>
<th class="head">Rules</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">name</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">20 characters</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">email</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">50 characters</div>
<div class="line">Email format</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">age</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.Integer</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">200</div>
</div>
</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Form class</p>
<p>Assign Bean Validation annotation to each field of form class.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.Max</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Min</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.hibernate.validator.constraints.Email</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

  <span class="nd">@NotNull</span> <span class="c1">// (1)</span>
  <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="o">)</span> <span class="c1">// (2)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

  <span class="nd">@NotNull</span>
  <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="o">)</span>
  <span class="nd">@Email</span> <span class="c1">// (3)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="o">;</span>

  <span class="nd">@NotNull</span> <span class="c1">// (4)</span>
  <span class="nd">@Min</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="c1">// (5)</span>
  <span class="nd">@Max</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span> <span class="c1">// (6)</span>
  <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>

  <span class="c1">// omitted setter/getter</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">javax.validation.constraints.NotNull</span></code> indicating that the target field is not <code class="docutils literal"><span class="pre">null</span></code>.</div>
<div class="line"><br /></div>
<div class="line">In Spring MVC, when form is sent with input fields left blank,</div>
<div class="line"><strong>empty string instead of null binds</strong>to form object by default.</div>
<div class="line">This <code class="docutils literal"><span class="pre">&#64;NotNull</span></code> checks that <code class="docutils literal"><span class="pre">name</span></code> exists as request parameter.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">javax.validation.constraints.Size</span></code> indicating that the string length (or collection size) of the target field is within the specified size range.</div>
<div class="line"><br /></div>
<div class="line">Since empty string binds to the field where string is left blank by default in Spring MVC,</div>
<div class="line">&#8216;1 or more character&#8217; rule indicates Mandatory input.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">org.hibernate.validator.constraints.Email</span></code> indicating that the target field is in RFC2822-compliant E-mail format.</div>
<div class="line">When E-mail format requirements are flexible than RFC2822-compliant constraints, regular expression should be specified using  <code class="docutils literal"><span class="pre">javax.validation.constraints.Pattern</span></code> instead of <code class="docutils literal"><span class="pre">&#64;Email</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When form is sent without entering any number in input field, <code class="docutils literal"><span class="pre">null</span></code> binds to form object so <code class="docutils literal"><span class="pre">&#64;NotNull</span></code> indicates mandatory input of <code class="docutils literal"><span class="pre">age</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">javax.validation.constraints.Min</span></code> indicating that the target field value must be greater than the specified value.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">javax.validation.constraints.Max</span></code> indicating that the target field value must be less than the specified value.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Refer to <a class="reference internal" href="#validation-jsr303-doc"><span>Bean Validation check rules</span></a> and <a class="reference internal" href="#validation-validator-list"><span>Hibernate Validator check rules</span></a> for standard annotations of Bean Validation and annotations provided by Hibernate.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Refer to <a class="reference internal" href="#validation-string-trimmer-editor"><span>Binding null to blank string field</span></a> for the method of binding <code class="docutils literal"><span class="pre">null</span></code> when input field is left blank.</p>
</div>
</li>
<li><p class="first">Controller class</p>
<p>Assign <code class="docutils literal"><span class="pre">&#64;Validated</span></code> to form class for input validation.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;user&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>

  <span class="nd">@ModelAttribute</span>
  <span class="kd">public</span> <span class="n">UserForm</span> <span class="nf">setupForm</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">UserForm</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">createForm</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="o">;</span> <span class="c1">// (1)</span>
  <span class="o">}</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirm</span><span class="o">(</span><span class="nd">@Validated</span> <span class="cm">/* (2) */</span> <span class="n">UserForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="cm">/* (3) */</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span> <span class="c1">// (4)</span>
      <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="s">&quot;user/createConfirm&quot;</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">create</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">UserForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (5)</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// omitted business logic</span>
    <span class="k">return</span> <span class="s">&quot;redirect:/user/create?complete&quot;</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;complete&quot;</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">createComplete</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&quot;user/createComplete&quot;</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Display &#8220;New user registration&#8221; form screen.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">org.springframework.validation.annotation.Validated</span></code> to the form class argument to perform input validation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add <code class="docutils literal"><span class="pre">org.springframework.validation.BindingResult</span></code> that stores check result of input validation performed in step (2).</div>
<div class="line">This <code class="docutils literal"><span class="pre">BindingResult</span></code> must be specified immediately after the form argument.</div>
<div class="line"><br /></div>
<div class="line">When not specified immediately, <code class="docutils literal"><span class="pre">org.springframework.validation.BindException</span></code> is thrown.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Use <code class="docutils literal"><span class="pre">BindingResult.hasErrors()</span></code> method to determine the check result of step (2).</div>
<div class="line">When the result of  <code class="docutils literal"><span class="pre">hasErrors()</span></code> is <code class="docutils literal"><span class="pre">true</span></code>, return to form display screen as there is an error in input value.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><strong>Input validation should be executed again</strong>even at the time of submission on the confirmation screen.</div>
<div class="line">There is a possibility of data tempering and hence Input validation must be performed just before entering business logic.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">&#64;Validated</span></code> is not a standard Bean Validation annotation. It is an independent annotation provided by Spring.
Bean Validation standard <code class="docutils literal"><span class="pre">javax.validation.Valid</span></code> annotation can also be used. However, <code class="docutils literal"><span class="pre">&#64;Validated</span></code> is better as compared to <code class="docutils literal"><span class="pre">&#64;Valid</span></code> annotation.
Validation group can be specified in case of <code class="docutils literal"><span class="pre">&#64;Validated</span></code> and hence <code class="docutils literal"><span class="pre">&#64;Validated</span></code> is recommended in this guideline.</p>
</div>
</li>
</ul>
<ul class="simple" id="validation-jsp-impl-sample">
<li>JSP</li>
</ul>
<blockquote>
<div><p>When there is input error, it can be displayed in <code class="docutils literal"><span class="pre">&lt;form:errors&gt;</span></code> tag.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="k">&lt;%-</span><span class="o">-</span> <span class="n">WEB</span><span class="o">-</span><span class="n">INF</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">createForm</span><span class="o">.</span><span class="na">jsp</span> <span class="o">--</span><span class="k">%&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;userForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
        <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/user/create&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;</span><span class="k">&lt;%-</span><span class="o">-(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span><span class="nt">&gt;</span>Email:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span><span class="nt">&gt;</span>Age:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
    <span class="nt">&lt;/form:form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify target field name in <code class="docutils literal"><span class="pre">path</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;form:errors&gt;</span></code> tag.</div>
<div class="line">Error message is displayed next to input field of each field.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>Form is displayed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-first-sample1.png"><img alt="../_images/validations-first-sample1.png" src="../_images/validations-first-sample1.png" style="width: 60%;" /></a>
</div>
<p>Error message is displayed as follows if this form is sent with all the input fields left blank.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-first-sample2.png"><img alt="../_images/validations-first-sample2.png" src="../_images/validations-first-sample2.png" style="width: 60%;" /></a>
</div>
<p>Error messages state that Name and Email are blank and Age is <code class="docutils literal"><span class="pre">null</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In Bean Validation, <code class="docutils literal"><span class="pre">null</span></code> is a valid input value except the following annotations.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">javax.validation.constraints.NotNull</span></code></li>
<li><code class="docutils literal"><span class="pre">org.hibernate.validator.constraints.NotEmpty</span></code></li>
<li><code class="docutils literal"><span class="pre">org.hibernate.validator.constraints.NotBlank</span></code></li>
</ul>
<p class="last">In the above example, error messages related to <code class="docutils literal"><span class="pre">&#64;Min</span></code> and <code class="docutils literal"><span class="pre">&#64;Max</span></code> annotations are not displayed. This is because <code class="docutils literal"><span class="pre">null</span></code> is a valid value for <code class="docutils literal"><span class="pre">&#64;Min</span></code> and <code class="docutils literal"><span class="pre">&#64;Max</span></code> annotations.</p>
</div>
<p>Next, send the form by entering any value in the field.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-first-sample3.png"><img alt="../_images/validations-first-sample3.png" src="../_images/validations-first-sample3.png" style="width: 60%;" /></a>
</div>
<div class="line-block">
<div class="line">Error message is not displayed since input value of Name fulfills validation conditions.</div>
<div class="line">Error message is displayed since input value of Email is not in Email format though it fulfills the conditions related to string length.</div>
<div class="line">Error message is displayed since input value of Age exceeds maximum value.</div>
</div>
<p>Change the form as follows to change the style at the time of error.</p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;userForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
    <span class="na">class=</span><span class="s">&quot;form-horizontal&quot;</span>
    <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/user/create&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Email:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Age:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
<span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify class name for <code class="docutils literal"><span class="pre">&lt;label&gt;</span></code> tag in <code class="docutils literal"><span class="pre">cssErrorClass</span></code> attribute at the time of error.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify class name for <code class="docutils literal"><span class="pre">&lt;input&gt;</span></code> tag in <code class="docutils literal"><span class="pre">cssErrorClass</span></code> attribute at the time of error.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify class name for  error messages in <code class="docutils literal"><span class="pre">cssClass</span></code> attribute.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>For example, if the following CSS is applied to this JSP, error screen is displayed as follows.</p>
<div class="highlight-css"><div class="highlight"><pre><span class="nc">.form-horizontal</span> <span class="nt">input</span> <span class="p">{</span>
    <span class="k">display</span><span class="o">:</span> <span class="k">block</span><span class="p">;</span>
    <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.form-horizontal</span> <span class="nt">label</span> <span class="p">{</span>
    <span class="k">display</span><span class="o">:</span> <span class="k">block</span><span class="p">;</span>
    <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
    <span class="k">text-align</span><span class="o">:</span> <span class="k">right</span><span class="p">;</span>
    <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.form-horizontal</span> <span class="nt">br</span> <span class="p">{</span>
    <span class="k">clear</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.error-label</span> <span class="p">{</span>
    <span class="k">color</span><span class="o">:</span> <span class="m">#b94a48</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.error-input</span> <span class="p">{</span>
    <span class="k">border-color</span><span class="o">:</span> <span class="m">#b94a48</span><span class="p">;</span>
    <span class="k">margin-left</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.error-messages</span> <span class="p">{</span>
    <span class="k">color</span><span class="o">:</span> <span class="m">#b94a48</span><span class="p">;</span>
    <span class="k">display</span><span class="o">:</span> <span class="k">block</span><span class="p">;</span>
    <span class="k">padding-left</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="k">overflow-x</span><span class="o">:</span> <span class="k">auto</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-has-errors1.png"><img alt="../_images/validations-has-errors1.png" src="../_images/validations-has-errors1.png" style="width: 60%;" /></a>
</div>
<p>CSS can be customized as per the requirements of screen.</p>
<p>Instead of displaying the error messages next to each input field,
output them collectively.</p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;userForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
    <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/user/create&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;*&quot;</span> <span class="na">element=</span><span class="s">&quot;div&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-message-list&quot;</span> <span class="nt">/&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>

    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Email:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Age:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
<span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">By specifying <code class="docutils literal"><span class="pre">*</span></code> in <code class="docutils literal"><span class="pre">path</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;form:errors&gt;</span></code> in <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> tag,</div>
<div class="line">all error messages related to Model specified in <code class="docutils literal"><span class="pre">modelAttribute</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> can be output.</div>
<div class="line">Tag name including these error messages can be specified in <code class="docutils literal"><span class="pre">element</span></code> attribute. By default, it is <code class="docutils literal"><span class="pre">span</span></code>. However,</div>
<div class="line">specify <code class="docutils literal"><span class="pre">div</span></code> to output error message list as block element.</div>
<div class="line">Specify CSS class in <code class="docutils literal"><span class="pre">cssClass</span></code> attribute.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>An example of error message is shown when the following CSS class is applied.</p>
<div class="highlight-css"><div class="highlight"><pre><span class="nc">.form-horizontal</span> <span class="nt">input</span> <span class="p">{</span>
    <span class="k">display</span><span class="o">:</span> <span class="k">block</span><span class="p">;</span>
    <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.form-horizontal</span> <span class="nt">label</span> <span class="p">{</span>
    <span class="k">display</span><span class="o">:</span> <span class="k">block</span><span class="p">;</span>
    <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
    <span class="k">text-align</span><span class="o">:</span> <span class="k">right</span><span class="p">;</span>
    <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.form-horizontal</span> <span class="nt">br</span> <span class="p">{</span>
    <span class="k">clear</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.error-label</span> <span class="p">{</span>
    <span class="k">color</span><span class="o">:</span> <span class="m">#b94a48</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.error-input</span> <span class="p">{</span>
    <span class="k">border-color</span><span class="o">:</span> <span class="m">#b94a48</span><span class="p">;</span>
    <span class="k">margin-left</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.error-message-list</span> <span class="p">{</span>
    <span class="k">color</span><span class="o">:</span> <span class="m">#b94a48</span><span class="p">;</span>
    <span class="k">padding</span><span class="o">:</span><span class="m">5px</span> <span class="m">10px</span><span class="p">;</span>
    <span class="k">background-color</span><span class="o">:</span> <span class="m">#fde9f3</span><span class="p">;</span>
    <span class="k">border</span><span class="o">:</span><span class="m">1px</span> <span class="k">solid</span> <span class="m">#c98186</span><span class="p">;</span>
    <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span><span class="m">5px</span><span class="p">;</span>
    <span class="k">margin-bottom</span><span class="o">:</span> <span class="m">10px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-has-errors2.png"><img alt="../_images/validations-has-errors2.png" src="../_images/validations-has-errors2.png" style="width: 60%;" /></a>
</div>
<div class="line-block">
<div class="line">By default, field name is not included in error message, hence it is difficult to understand which error message corresponds to which field.</div>
<div class="line">Therefore, when an error message is to be displayed in a list, it is necessary to define the message such that field name is included in the error message.</div>
<div class="line">For method of defining error messages, refer to &#8220;<a class="reference internal" href="#validation-message-def"><span>Definition of error messages</span></a>&#8221;.</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Points to be noted when displaying error messages in a list</strong></p>
<p>Error messages are output in a random order and the output order cannot be controlled by standard function.
Therefore, when an output order needs to be controlled (to be kept constant), an extended implementation such as sorting the error information, etc. is required.</p>
<p>In the method of &#8220;Displaying error messages in a list&#8221;,</p>
<ul class="simple">
<li>Error message definition in feed unit</li>
<li>Extended implementation to control the output order of error messages</li>
</ul>
<p>are required. Therefore, the cost is higher as compared to &#8220;displaying error messages next to input field&#8221;.
<strong>This guideline recommends the method of &#8220;displaying error messages next to input field&#8221; when there are no constraints due to screen requirements.</strong></p>
<p class="last">Further, following method can be considered as extended methods to control output order of error message.
Creating inherited class of <code class="docutils literal"><span class="pre">org.springframework.validation.beanvalidation.LocalValidatorFactoryBean</span></code> provided by Spring Framework,
and sorting error information by overriding <code class="docutils literal"><span class="pre">processConstraintViolations</span></code> method, etc.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>About &#64;GroupSequence annotation</strong></p>
<p>A mechanism of <a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.1/reference/en-US/html/chapter-groups.html#section-default-group-class">&#64;GroupSequence annotation</a> is provided to control the check sequence;
however, add a note that this mechanism is not to control the output order of error message as operations given below are performed.</p>
<ul class="last simple">
<li>When an error occurs, checking for subsequent groups is not executed.</li>
<li>If multiple errors (errors in multiple fields) occur in the check of identical groups, then the output order of error messages would be random.</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Use <code class="docutils literal"><span class="pre">&lt;spring:nestedPath&gt;</span></code> tag to display error messages collectively outside the <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> tag.</p>
<blockquote class="last">
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;spring:nestedPath</span> <span class="na">path=</span><span class="s">&quot;userForm&quot;</span><span class="nt">&gt;</span>
</span>    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;*&quot;</span> <span class="na">element=</span><span class="s">&quot;div&quot;</span>
        <span class="na">cssClass=</span><span class="s">&quot;error-message-list&quot;</span> <span class="nt">/&gt;</span>
<span class="hll"><span class="nt">&lt;/spring:nestedPath&gt;</span>
</span><span class="nt">&lt;hr&gt;</span>
<span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;userForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
    <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/user/create&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Email:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Age:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
<span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="single-item-check-of-nested-bean">
<h4><a class="toc-backref" href="#id9">5.5.2.2.2. Single item check of nested Bean</a><a class="headerlink" href="#single-item-check-of-nested-bean" title="Permalink to this headline">Â¶</a></h4>
<p>The method to validate nested Bean using Bean Validation is explained below.</p>
<p>&#8220;Ordering&#8221; process of an EC site is considered as an example. Rules for checking &#8220;Order&#8221; form are provided below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="30%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field name</th>
<th class="head">Type</th>
<th class="head">Rules</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">coupon</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">5 or less characters</div>
<div class="line">Single byte alphanumeric characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Coupon code</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">receiverAddress.name</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">50 characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Receiver name</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">receiverAddress.postcode</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">10 characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Receiver postal code</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">receiverAddress.address</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">100 characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Receiver address</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">senderAddress.name</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">50 characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Sender name</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">senderAddress.postcode</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">10 characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Sender postal code</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">senderAddress.address</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">Between 1 and</div>
<div class="line">100 characters</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Sender address</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Use the same form class since <code class="docutils literal"><span class="pre">receiverAddress</span></code> and <code class="docutils literal"><span class="pre">senderAddress</span></code> are objects of the same class.</p>
<ul>
<li><p class="first">Form class</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.Valid</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Pattern</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="nd">@Size</span><span class="o">(</span><span class="n">max</span> <span class="o">=</span> <span class="mi">5</span><span class="o">)</span>
    <span class="nd">@Pattern</span><span class="o">(</span><span class="n">regexp</span> <span class="o">=</span> <span class="s">&quot;[a-zA-Z0-9]*&quot;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">coupon</span><span class="o">;</span>

    <span class="nd">@NotNull</span> <span class="c1">// (1)</span>
    <span class="nd">@Valid</span> <span class="c1">// (2)</span>
    <span class="kd">private</span> <span class="n">AddressForm</span> <span class="n">receiverAddress</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Valid</span>
    <span class="kd">private</span> <span class="n">AddressForm</span> <span class="n">senderAddress</span><span class="o">;</span>

    <span class="c1">// omitted setter/getter</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AddressForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">postcode</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">100</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">address</span><span class="o">;</span>

    <span class="c1">// omitted setter/getter</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">This indicates that the child form is mandatory.</div>
<div class="line">When not set, it will be considered as valid even if <code class="docutils literal"><span class="pre">null</span></code> is set in <code class="docutils literal"><span class="pre">receiverAddress</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">javax.validation.Valid</span></code> annotation to enable Bean Validation of the nested Bean.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Controller class</p>
<p>It is not different from the Controller described earlier.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="o">;</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;order&quot;</span><span class="o">)</span>
<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderController</span> <span class="o">{</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">OrderForm</span> <span class="nf">setupForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">OrderForm</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;order&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">orderForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;order/orderForm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;order&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">orderConfirm</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">OrderForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">&quot;order/orderForm&quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;order/orderConfirm&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
<li><p class="first">JSP</p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="k">&lt;%-</span><span class="o">-</span> <span class="n">WEB</span><span class="o">-</span><span class="n">INF</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">order</span><span class="o">/</span><span class="n">orderForm</span><span class="o">.</span><span class="na">jsp</span> <span class="o">--</span><span class="k">%&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;style</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">&gt;</span>
  /* omitted (same as previous sample) */
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;orderForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
        <span class="na">class=</span><span class="s">&quot;form-horizontal&quot;</span>
        <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/order/order&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;coupon&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Coupon Code:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;coupon&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;coupon&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;fieldset&gt;</span>
        <span class="nt">&lt;legend&gt;</span>Receiver<span class="nt">&lt;/legend&gt;</span>
        <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;receiverAddress&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.name&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.name&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.name&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.postcode&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Postcode:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.postcode&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.postcode&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.address&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Address:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.address&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;receiverAddress.address&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/fieldset&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;fieldset&gt;</span>
        <span class="nt">&lt;legend&gt;</span>Sender<span class="nt">&lt;/legend&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;senderAddress&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;senderAddress.name&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;senderAddress.name&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;senderAddress.name&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;senderAddress.postcode&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Postcode:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;senderAddress.postcode&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;senderAddress.postcode&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;senderAddress.address&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Address:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;senderAddress.address&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;senderAddress.address&quot;</span>
            <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/fieldset&gt;</span>

        <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
    <span class="nt">&lt;/form:form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When <code class="docutils literal"><span class="pre">receiverAddress.name</span></code>, <code class="docutils literal"><span class="pre">receiverAddress.postcode</span></code>, <code class="docutils literal"><span class="pre">receiverAddress.address</span></code> are not sent as</div>
<div class="line">request parameters due to invalid operation, <code class="docutils literal"><span class="pre">receiverAddress</span></code> is considered as <code class="docutils literal"><span class="pre">null</span></code> and error message is displayed.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Fields of nested bean are specified as <code class="docutils literal"><span class="pre">[parent</span> <span class="pre">field</span> <span class="pre">name].[child</span> <span class="pre">field</span> <span class="pre">name]</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>Form is displayed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-nested1.png"><img alt="../_images/validations-nested1.png" src="../_images/validations-nested1.png" style="width: 60%;" /></a>
</div>
<p>Error message is displayed as follows if this form is sent with all the input fields left blank.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-nested2.png"><img alt="../_images/validations-nested2.png" src="../_images/validations-nested2.png" style="width: 60%;" /></a>
</div>
<p>Validation of nested bean is enabled for collections also.</p>
<p>Add a field such that up to 3 addresses can be registered in &#8220;user registration&#8221; form explained at the beginning.</p>
<ul>
<li><p class="first">Add list of <code class="docutils literal"><span class="pre">AddressForm</span></code> as a field in the form class.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.Valid</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Max</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Min</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.hibernate.validator.constraints.Email</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="o">)</span>
    <span class="nd">@Email</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Min</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
    <span class="nd">@Max</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>

<span class="hll">    <span class="nd">@NotNull</span>
</span><span class="hll">    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">3</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="hll">    <span class="nd">@Valid</span>
</span><span class="hll">    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">AddressForm</span><span class="o">&gt;</span> <span class="n">addresses</span><span class="o">;</span>
</span>
    <span class="c1">// omitted setter/getter</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is possible to use <code class="docutils literal"><span class="pre">&#64;Size</span></code> annotation for checking size of collection as well.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">JSP</p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="k">&lt;%-</span><span class="o">-</span> <span class="n">WEB</span><span class="o">-</span><span class="n">INF</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">createForm</span><span class="o">.</span><span class="na">jsp</span> <span class="o">--</span><span class="k">%&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;style</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">&gt;</span>
  /* omitted (same as previous sample) */
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>

    <span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;userForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
        <span class="na">class=</span><span class="s">&quot;form-horizontal&quot;</span>
        <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/user/create&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Email:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Age:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
<span class="hll">        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;addresses&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">        <span class="nt">&lt;c:forEach</span> <span class="na">items=</span><span class="s">&quot;${userForm.addresses}&quot;</span> <span class="na">varStatus=</span><span class="s">&quot;status&quot;</span><span class="nt">&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">            <span class="nt">&lt;fieldset</span> <span class="na">class=</span><span class="s">&quot;address&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;legend&gt;</span>Address${f:h(status.index + 1)}<span class="nt">&lt;/legend&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].name&quot;</span>
</span><span class="hll">                    <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].name&quot;</span>
</span><span class="hll">                    <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].name&quot;</span>
</span><span class="hll">                    <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;br&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].postcode&quot;</span>
</span><span class="hll">                    <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Postcode:<span class="nt">&lt;/form:label&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].postcode&quot;</span>
</span><span class="hll">                    <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].postcode&quot;</span>
</span><span class="hll">                    <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;br&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].address&quot;</span>
</span><span class="hll">                    <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Address:<span class="nt">&lt;/form:label&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].address&quot;</span>
</span><span class="hll">                    <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;addresses[${status.index}].address&quot;</span>
</span><span class="hll">                    <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;c:if</span> <span class="na">test=</span><span class="s">&quot;${status.index &gt; 0}&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;br&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">&quot;remove-address-button&quot;</span><span class="nt">&gt;</span>Remove<span class="nt">&lt;/button&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/c:if&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/fieldset&gt;</span>
</span><span class="hll">            <span class="nt">&lt;br&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/c:forEach&gt;</span>
</span><span class="hll">        <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">&quot;add-address-button&quot;</span><span class="nt">&gt;</span>Add address<span class="nt">&lt;/button&gt;</span>
</span><span class="hll">        <span class="nt">&lt;br&gt;</span>
</span>        <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
    <span class="nt">&lt;/form:form&gt;</span>
    <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span>
        <span class="na">src=</span><span class="s">&quot;${pageContext.request.contextPath}/resources/vendor/js/jquery-1.10.2.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span>
        <span class="na">src=</span><span class="s">&quot;${pageContext.request.contextPath}/resources/app/js/AddressesView.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Display error message related to <code class="docutils literal"><span class="pre">address</span></code> field.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Process the collection of child forms in a loop using <code class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></code> tag.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inside the loop, Specify the field of child form using <code class="docutils literal"><span class="pre">[parent</span> <span class="pre">field</span> <span class="pre">name][Index].[child</span> <span class="pre">field</span> <span class="pre">name]</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Controller class</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;user&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">UserForm</span> <span class="nf">setupForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">UserForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UserForm</span><span class="o">();</span>
<span class="hll">        <span class="n">List</span><span class="o">&lt;</span><span class="n">AddressForm</span><span class="o">&gt;</span> <span class="n">addresses</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">AddressForm</span><span class="o">&gt;();</span>
</span><span class="hll">        <span class="n">addresses</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">AddressForm</span><span class="o">());</span>
</span><span class="hll">        <span class="n">form</span><span class="o">.</span><span class="na">setAddresses</span><span class="o">(</span><span class="n">addresses</span><span class="o">);</span> <span class="c1">// (1)</span>
</span>        <span class="k">return</span> <span class="n">form</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirm</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">UserForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;user/createConfirm&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Edit the form object to display a single address form at the time of initial display of &#8220;user registration&#8221; form.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">JavaScript</p>
<p>Below is the JavaScript to dynamically add address input field. However, the explanation of this code is omitted as it is not required.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// webapp/resources/app/js/AddressesView.js</span>

<span class="kd">function</span> <span class="nx">AddressesView</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">addressSize</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;fieldset.address&#39;</span><span class="p">).</span><span class="nx">size</span><span class="p">();</span>
<span class="p">};</span>

<span class="nx">AddressesView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">addAddress</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">$address</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;fieldset.address&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">newHtml</span> <span class="o">=</span> <span class="nx">addressTemplate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">addressSize</span><span class="o">++</span><span class="p">);</span>
  <span class="nx">$address</span><span class="p">.</span><span class="nx">last</span><span class="p">().</span><span class="nx">next</span><span class="p">().</span><span class="nx">after</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">newHtml</span><span class="p">));</span>
<span class="p">};</span>

<span class="nx">AddressesView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">removeAddress</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$fieldset</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$fieldset</span><span class="p">.</span><span class="nx">next</span><span class="p">().</span><span class="nx">remove</span><span class="p">();</span> <span class="c1">// remove &lt;br&gt;</span>
  <span class="nx">$fieldset</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span> <span class="c1">// remove &lt;fieldset&gt;</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">addressTemplate</span><span class="p">(</span><span class="nx">number</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s1">&#39;\</span>
<span class="s1">&lt;fieldset class=&quot;address&quot;&gt;\</span>
<span class="s1">    &lt;legend&gt;Address&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&lt;/legend&gt;\</span>
<span class="s1">    &lt;label for=&quot;addresses&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;.name&quot;&gt;Name:&lt;/label&gt;\</span>
<span class="s1">    &lt;input id=&quot;addresses&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;.name&quot; name=&quot;addresses[&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;].name&quot; type=&quot;text&quot; value=&quot;&quot;/&gt;&lt;br&gt;\</span>
<span class="s1">    &lt;label for=&quot;addresses&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;.postcode&quot;&gt;Postcode:&lt;/label&gt;\</span>
<span class="s1">    &lt;input id=&quot;addresses&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;.postcode&quot; name=&quot;addresses[&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;].postcode&quot; type=&quot;text&quot; value=&quot;&quot;/&gt;&lt;br&gt;\</span>
<span class="s1">    &lt;label for=&quot;addresses&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;.address&quot;&gt;Address:&lt;/label&gt;\</span>
<span class="s1">    &lt;input id=&quot;addresses&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;.address&quot; name=&quot;addresses[&#39;</span> <span class="o">+</span> <span class="nx">number</span> <span class="o">+</span> <span class="s1">&#39;].address&quot; type=&quot;text&quot; value=&quot;&quot;/&gt;&lt;br&gt;\</span>
<span class="s1">    &lt;button class=&quot;remove-address-button&quot;&gt;Remove&lt;/button&gt;\</span>
<span class="s1">&lt;/fieldset&gt;\</span>
<span class="s1">&lt;br&gt;\</span>
<span class="s1">&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">addressesView</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AddressesView</span><span class="p">();</span>

  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#add-address-button&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="nx">addressesView</span><span class="p">.</span><span class="nx">addAddress</span><span class="p">();</span>
  <span class="p">});</span>

  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;.remove-address-button&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="o">===</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
      <span class="kd">var</span> <span class="nx">$this</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// this button</span>
      <span class="kd">var</span> <span class="nx">$fieldset</span> <span class="o">=</span> <span class="nx">$this</span><span class="p">.</span><span class="nx">parent</span><span class="p">();</span> <span class="c1">// fieldset</span>
      <span class="nx">addressesView</span><span class="p">.</span><span class="nx">removeAddress</span><span class="p">(</span><span class="nx">$fieldset</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>

<span class="p">});</span>
</pre></div>
</div>
</li>
</ul>
<p>Form is displayed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-nested-collection1.png"><img alt="../_images/validations-nested-collection1.png" src="../_images/validations-nested-collection1.png" style="width: 60%;" /></a>
</div>
<p>Add 2 address forms by clicking &#8220;Add address&#8221; button twice.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-nested-collection2.png"><img alt="../_images/validations-nested-collection2.png" src="../_images/validations-nested-collection2.png" style="width: 60%;" /></a>
</div>
<p>Error message is displayed as follows if this form is sent with all the input fields left blank.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-nested-collection3.png"><img alt="../_images/validations-nested-collection3.png" src="../_images/validations-nested-collection3.png" style="width: 60%;" /></a>
</div>
</div>
<div class="section" id="grouped-validation">
<h4><a class="toc-backref" href="#id10">5.5.2.2.3. Grouped validation</a><a class="headerlink" href="#grouped-validation" title="Permalink to this headline">Â¶</a></h4>
<p>By creating validation group, input validation rules for a field can be specified for each group.</p>
<p>In the &#8220;new user registration&#8221; example, add &#8220;Must be an adult&#8221; rule for the <code class="docutils literal"><span class="pre">age</span></code> field.
Add <code class="docutils literal"><span class="pre">country</span></code> field also as &#8220;Adult&#8221; rules differ with country.</p>
<p>To specify group in Bean Validation, set any <code class="docutils literal"><span class="pre">java.lang.Class</span></code> object representing a group in <code class="docutils literal"><span class="pre">group</span></code> attribute of the annotation.</p>
<p>Create the following 3 groups (interface) here.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Group</th>
<th class="head">Adult condition</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">Chinese</span></code></td>
<td>18 years or more</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">Japanese</span></code></td>
<td>20 years or more</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">Singaporean</span></code></td>
<td>21 years or more</td>
</tr>
</tbody>
</table>
<p>An example of executing validation using these groups is shown here.</p>
<ul>
<li><p class="first">Form class</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.Valid</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Max</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Min</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.hibernate.validator.constraints.Email</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

<span class="hll">    <span class="c1">// (1)</span>
</span><span class="hll">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Chinese</span> <span class="o">{</span>
</span><span class="hll">    <span class="o">};</span>
</span><span class="hll">
</span><span class="hll">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Japanese</span> <span class="o">{</span>
</span><span class="hll">    <span class="o">};</span>
</span><span class="hll">
</span><span class="hll">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Singaporean</span> <span class="o">{</span>
</span><span class="hll">    <span class="o">};</span>
</span>
    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="o">)</span>
    <span class="nd">@Email</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
<span class="hll">    <span class="nd">@Min.List</span><span class="o">({</span> <span class="c1">// (2)</span>
</span><span class="hll">            <span class="nd">@Min</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">18</span><span class="o">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">Chinese</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="c1">// (3)</span>
</span><span class="hll">            <span class="nd">@Min</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">20</span><span class="o">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">Japanese</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
</span><span class="hll">            <span class="nd">@Min</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">21</span><span class="o">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">Singaporean</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span><span class="hll">            <span class="o">})</span>
</span>    <span class="nd">@Max</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">2</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">country</span><span class="o">;</span> <span class="c1">// (4)</span>

    <span class="c1">// omitted setter/getter</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define each group as an interface.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&#64;Min.List</span></code> annotation is used to specify multiple <code class="docutils literal"><span class="pre">&#64;Min</span></code> rules on a single field.</div>
<div class="line">It is same even while using other annotations.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify corresponding group class in the <code class="docutils literal"><span class="pre">group</span></code> attribute, in order to define rules for each group.</div>
<div class="line">When <code class="docutils literal"><span class="pre">group</span></code> attribute is not specified, <code class="docutils literal"><span class="pre">javax.validation.groups.Default</span></code> group is used.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add a field which will be used to determine which group is to be applied.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">JSP</p>
<p>There are no major changes in JSP.</p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;userForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
    <span class="na">class=</span><span class="s">&quot;form-horizontal&quot;</span>
    <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/user/create&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Name:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Email:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;email&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Age:<span class="nt">&lt;/form:label&gt;</span>
    <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;br&gt;</span>
<span class="hll">    <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;country&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Country:<span class="nt">&lt;/form:label&gt;</span>
</span><span class="hll">    <span class="nt">&lt;form:select</span> <span class="na">path=</span><span class="s">&quot;country&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">        <span class="nt">&lt;form:option</span> <span class="na">value=</span><span class="s">&quot;cn&quot;</span><span class="nt">&gt;</span>China<span class="nt">&lt;/form:option&gt;</span>
</span><span class="hll">        <span class="nt">&lt;form:option</span> <span class="na">value=</span><span class="s">&quot;jp&quot;</span><span class="nt">&gt;</span>Japan<span class="nt">&lt;/form:option&gt;</span>
</span><span class="hll">        <span class="nt">&lt;form:option</span> <span class="na">value=</span><span class="s">&quot;sg&quot;</span><span class="nt">&gt;</span>Singapore<span class="nt">&lt;/form:option&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/form:select&gt;</span>
</span><span class="hll">    <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;country&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
</span>    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;form:button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span><span class="nt">&gt;</span>Confirm<span class="nt">&lt;/form:button&gt;</span>
<span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Controller class</p>
</li>
</ul>
<blockquote>
<div><p>By giving a group name to <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation, the rules defined for that group will be applied.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">javax.validation.groups.Default</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.example.sample.app.validation.UserForm.Chinese</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.example.sample.app.validation.UserForm.Japanese</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.example.sample.app.validation.UserForm.Singaporean</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;user&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">UserForm</span> <span class="nf">setupForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">UserForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UserForm</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">form</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">String</span> <span class="nf">createConfirm</span><span class="o">(</span><span class="n">UserForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;user/createConfirm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="o">{</span>
            <span class="s">&quot;confirm&quot;</span><span class="o">,</span>  <span class="cm">/* (1) */</span> <span class="s">&quot;country=cn&quot;</span> <span class="o">})</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirmForChinese</span><span class="o">(</span><span class="nd">@Validated</span><span class="o">({</span> <span class="cm">/* (2) */</span> <span class="n">Chinese</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
            <span class="n">Default</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span> <span class="n">UserForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">createConfirm</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
    <span class="o">}</span>

<span class="hll">    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="o">{</span>
</span><span class="hll">            <span class="s">&quot;confirm&quot;</span><span class="o">,</span> <span class="s">&quot;country=jp&quot;</span> <span class="o">})</span>
</span><span class="hll">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirmForJapanese</span><span class="o">(</span><span class="nd">@Validated</span><span class="o">({</span> <span class="n">Japanese</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
</span><span class="hll">            <span class="n">Default</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span> <span class="n">UserForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">createConfirm</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
</span><span class="hll">    <span class="o">}</span>
</span><span class="hll">
</span><span class="hll">    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="o">{</span>
</span><span class="hll">            <span class="s">&quot;confirm&quot;</span><span class="o">,</span> <span class="s">&quot;country=sg&quot;</span> <span class="o">})</span>
</span><span class="hll">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirmForSingaporean</span><span class="o">(</span><span class="nd">@Validated</span><span class="o">({</span> <span class="n">Singaporean</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
</span><span class="hll">            <span class="n">Default</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span> <span class="n">UserForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">createConfirm</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
</span><span class="hll">    <span class="o">}</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The parameter which is used as condition to dividing between the groups must be set to <code class="docutils literal"><span class="pre">param</span></code> attribute.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">All the annotations, except <code class="docutils literal"><span class="pre">&#64;Min</span></code> of <code class="docutils literal"><span class="pre">age</span></code> field, belongs to <code class="docutils literal"><span class="pre">Default</span></code> group; hence, specifying <code class="docutils literal"><span class="pre">Default</span></code> is mandatory.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>In this example, the check result of the combination of each input value is as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><code class="docutils literal"><span class="pre">age</span></code> value</th>
<th class="head"><code class="docutils literal"><span class="pre">country</span></code> value</th>
<th class="head">Input validation result</th>
<th class="head">Error message</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">17</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">cn</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">NG</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">must be greater than or equal to 18</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">jp</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">NG</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">must be greater than or equal to 20</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">sg</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">NG</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">must be greater than or equal to 21</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">18</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">cn</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">jp</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">NG</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">must be greater than or equal to 20</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">sg</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">NG</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">must be greater than or equal to 21</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">20</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">cn</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">jp</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">sg</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">NG</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">must be greater than or equal to 21</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">21</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">cn</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">jp</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">sg</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">OK</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Implementation of this Controller is inadequate; there is no handling when <code class="docutils literal"><span class="pre">country</span></code> value is neither &#8220;cn&#8221;, &#8220;jp&#8221;  nor &#8220;sg&#8221;.
400 error is returned when unexpected <code class="docutils literal"><span class="pre">country</span></code> value is encountered.</p>
</div>
<p>Next, we can think of a condition where the number of countries increase and adult condition of 18 years or more is be set as a default rule.</p>
<p>Rules are as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Group</th>
<th class="head">Adult condition</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">Japanese</span></code></td>
<td>20 years or more</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">Singaporean</span></code></td>
<td>21 years or more</td>
</tr>
<tr class="row-even"><td>Country other than the above-mentioned(<code class="docutils literal"><span class="pre">Default</span></code>)</td>
<td>18 years or more</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Form class</p>
<p>In order to specify a value to <code class="docutils literal"><span class="pre">Default</span></code> group (18 years or more), all groups should be specified explicitly in other annotations as well.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.Valid</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Max</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Min</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.groups.Default</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.hibernate.validator.constraints.Email</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Japanese</span> <span class="o">{</span>
    <span class="o">};</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Singaporean</span> <span class="o">{</span>
    <span class="o">};</span>

    <span class="nd">@NotNull</span><span class="o">(</span><span class="n">groups</span> <span class="o">=</span> <span class="o">{</span> <span class="n">Default</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Japanese</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Singaporean</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span> <span class="c1">// (1)</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="o">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="o">{</span> <span class="n">Default</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Japanese</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
            <span class="n">Singaporean</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@NotNull</span><span class="o">(</span><span class="n">groups</span> <span class="o">=</span> <span class="o">{</span> <span class="n">Default</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Japanese</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Singaporean</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="o">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="o">{</span> <span class="n">Default</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Japanese</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
            <span class="n">Singaporean</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
    <span class="nd">@Email</span><span class="o">(</span><span class="n">groups</span> <span class="o">=</span> <span class="o">{</span> <span class="n">Default</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Japanese</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Singaporean</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="o">;</span>

    <span class="nd">@NotNull</span><span class="o">(</span><span class="n">groups</span> <span class="o">=</span> <span class="o">{</span> <span class="n">Default</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Japanese</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Singaporean</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
    <span class="nd">@Min.List</span><span class="o">({</span>
            <span class="nd">@Min</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">18</span><span class="o">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">Default</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="c1">// (2)</span>
            <span class="nd">@Min</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">20</span><span class="o">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">Japanese</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
            <span class="nd">@Min</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">21</span><span class="o">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="n">Singaporean</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">})</span>
    <span class="nd">@Max</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>

    <span class="nd">@NotNull</span><span class="o">(</span><span class="n">groups</span> <span class="o">=</span> <span class="o">{</span> <span class="n">Default</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Japanese</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Singaporean</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">2</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="o">{</span> <span class="n">Default</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Japanese</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
            <span class="n">Singaporean</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">country</span><span class="o">;</span>

    <span class="c1">// omitted setter/getter</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set all groups to annotations other than <code class="docutils literal"><span class="pre">&#64;Min</span></code> of <code class="docutils literal"><span class="pre">age</span></code> field as well.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set the rule for <code class="docutils literal"><span class="pre">Default</span></code> group.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">JSP</p>
<p>No change in JSP</p>
</li>
<li><p class="first">Controller class</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.example.sample.app.validation.UserForm.Japanese</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.example.sample.app.validation.UserForm.Singaporean</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;user&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">UserForm</span> <span class="nf">setupForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">UserForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UserForm</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">form</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">String</span> <span class="nf">createConfirm</span><span class="o">(</span><span class="n">UserForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;user/createConfirm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="o">{</span> <span class="s">&quot;confirm&quot;</span> <span class="o">})</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirmForDefault</span><span class="o">(</span><span class="nd">@Validated</span> <span class="cm">/* (1) */</span> <span class="n">UserForm</span> <span class="n">form</span><span class="o">,</span>
            <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">createConfirm</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="o">{</span>
            <span class="s">&quot;confirm&quot;</span><span class="o">,</span> <span class="s">&quot;country=jp&quot;</span> <span class="o">})</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirmForJapanese</span><span class="o">(</span>
            <span class="nd">@Validated</span><span class="o">(</span><span class="n">Japanese</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>  <span class="cm">/* (2) */</span> <span class="n">UserForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">createConfirm</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="o">{</span>
            <span class="s">&quot;confirm&quot;</span><span class="o">,</span> <span class="s">&quot;country=sg&quot;</span> <span class="o">})</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirmForSingaporean</span><span class="o">(</span>
            <span class="nd">@Validated</span><span class="o">(</span><span class="n">Singaporean</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="n">UserForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">createConfirm</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When the field <code class="docutils literal"><span class="pre">country</span></code> does not have a value, the request is mapped to a method in which <code class="docutils literal"><span class="pre">Default</span></code> group is specified in <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When the field <code class="docutils literal"><span class="pre">country</span></code> has a value, the request is mapped to a method in which <code class="docutils literal"><span class="pre">Default</span></code> group is not included in <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>Till now, 2 patterns of using grouped validation have been explained.</p>
<p>In the previous pattern, <code class="docutils literal"><span class="pre">Default</span></code> group is used in Controller class and in the later one,  <code class="docutils literal"><span class="pre">Default</span></code> group is used in form class.</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Pattern</th>
<th class="head">Advantages</th>
<th class="head">Disadvantages</th>
<th class="head">Decision points</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Using <code class="docutils literal"><span class="pre">Default</span></code> group in Controller class</td>
<td><code class="docutils literal"><span class="pre">group</span></code> attribute need not be set for the rules that need not be grouped.</td>
<td>Since all patterns of group should be defined, it is difficult to define when there are many group patterns.</td>
<td>Should be used when there are only a limited number of group patterns (New create group, Update group and Delete group)</td>
</tr>
<tr class="row-odd"><td>Using <code class="docutils literal"><span class="pre">Default</span></code> group in form class</td>
<td>Since only the groups that do not belong to the default group need to be defined, it can be handled even if there are many patterns.</td>
<td><code class="docutils literal"><span class="pre">group</span></code> attribute should be set for the rules that need not be grouped making the process complicated.</td>
<td>Should be used when there are many group patterns and majority of patterns have a common value.</td>
</tr>
</tbody>
</table>
<p><strong>If none of the above decision points are applicable, then using Bean Validation itself might not be a good idea.</strong>After reviewing the design, usage of Spring Validator or implementation of validation in business logic should be considered.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In the examples explained so far, the switching of group validation is carried out using request parameter and parameter that can be specified in <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.
It is not possible to switch between groups, if switching is to be performed based on permissions in authentication object or any information which cannot be handled by <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.</p>
<p>In such a case, <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation must not be used but <code class="docutils literal"><span class="pre">org.springframework.validation.SmartValidator</span></code> must be used. Group validation can be performed inside the handler method of controller.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;user&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>

    <span class="nd">@Inject</span>
    <span class="n">SmartValidator</span> <span class="n">smartValidator</span><span class="o">;</span> <span class="c1">// (1)</span>

    <span class="c1">// omitted</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirm</span><span class="o">(</span><span class="cm">/* (2) */</span> <span class="n">UserForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// (3)</span>
        <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">validationGroup</span> <span class="o">=</span> <span class="n">Default</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
        <span class="c1">// logic to determine validation group</span>
        <span class="c1">// if (xxx) {</span>
        <span class="c1">//     validationGroup = Xxx.class;</span>
        <span class="c1">// }</span>
        <span class="n">smartValidator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">result</span><span class="o">,</span> <span class="n">validationGroup</span><span class="o">);</span> <span class="c1">// (4)</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">&quot;user/createForm&quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;user/createConfirm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inject <code class="docutils literal"><span class="pre">SmartValidator</span></code>. Since <code class="docutils literal"><span class="pre">SmartValidator</span></code> can be used if <code class="docutils literal"><span class="pre">&lt;mvc:annotation-driven&gt;</span></code> setting is carried out so there is no need to define separately.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Do not use <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Determine a validation group.</div>
<div class="line">Logic to determine a validation group recommends delegating to Helper class and keeping logic in Controller in simple state.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Execute grouped validation using <code class="docutils literal"><span class="pre">validate</span></code> method of <code class="docutils literal"><span class="pre">SmartValidator</span></code>.</div>
<div class="line">Multiple groups can be specified in <code class="docutils literal"><span class="pre">validate</span></code> method.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p class="last">Since logic should not be written in Controller, if switching is possible using request parameters in <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code>annotation, <code class="docutils literal"><span class="pre">SmartValidator</span></code> must not be used.</p>
</div>
</div>
</div>
<div class="section" id="correlation-item-check">
<span id="validation-correlation-check"></span><h3><a class="toc-backref" href="#id11">5.5.2.3. Correlation item check</a><a class="headerlink" href="#correlation-item-check" title="Permalink to this headline">Â¶</a></h3>
<p>For the validation of correlated items,
Spring Validator(<code class="docutils literal"><span class="pre">Validator</span></code> implementing <code class="docutils literal"><span class="pre">org.springframework.validation.Validator</span></code> interface)
or Bean Validation must be used.</p>
<p>Each one of above has been explained below. However, before that, their features and usage have been explained.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="40%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Format</th>
<th class="head">Features</th>
<th class="head">Usage</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Spring Validator</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is easy to create input validation for a particular class.</div>
<div class="line">It is inconvenient to use in Controller.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Input validation implementation of unique business requirements depending on specific form</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Bean Validation</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Creation of input validation is not as easy as Spring Validator.</div>
<div class="line">It is easy to use in Controller.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Common input validation implementation of development project not depending on specific form</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="section" id="correlation-item-check-implementation-using-spring-validator">
<h4><a class="toc-backref" href="#id12">5.5.2.3.1. Correlation item check implementation using Spring Validator</a><a class="headerlink" href="#correlation-item-check-implementation-using-spring-validator" title="Permalink to this headline">Â¶</a></h4>
<div class="line-block">
<div class="line">Implementation method is explained with the help of &#8220;reset password&#8221; process as an example.</div>
<div class="line">Implement the following rules. Following rules are provided in the &#8220;reset password&#8221; form.</div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="30%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field name</th>
<th class="head">Type</th>
<th class="head">Rules</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">password</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mandatory input</div>
<div class="line">8 or more characters</div>
<div class="line"><strong>Must be same as confirmPassword</strong></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Password</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">confirmPassword</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">java.lang.String</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Nothing in particular</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Confirm password</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Check rule &#8220;Must be same as confirmPassword&#8221; is validation of correlated items as <code class="docutils literal"><span class="pre">password</span></code> field and <code class="docutils literal"><span class="pre">passwordConfirm</span></code> field should have the same value.</p>
<ul>
<li><p class="first">Form class</p>
<p>other than validation of correlated items, implement using Bean Validation annotation.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordResetForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">8</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">confirmPassword</span><span class="o">;</span>

    <span class="c1">// omitted setter/getter</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Password is normally saved in database after hashing it, hence there is no need to check the maximum number of characters.</p>
</div>
</li>
<li><p class="first">Validator class</p>
<p>Implement validation of correlated items using <code class="docutils literal"><span class="pre">org.springframework.validation.Validator</span></code> interface.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.Errors</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.Validator</span><span class="o">;</span>

<span class="nd">@Component</span> <span class="c1">// (1)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordEqualsValidator</span> <span class="kd">implements</span> <span class="n">Validator</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supports</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">clazz</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">PasswordResetForm</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">clazz</span><span class="o">);</span> <span class="c1">// (2)</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">validate</span><span class="o">(</span><span class="n">Object</span> <span class="n">target</span><span class="o">,</span> <span class="n">Errors</span> <span class="n">errors</span><span class="o">)</span> <span class="o">{</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">errors</span><span class="o">.</span><span class="na">hasFieldErrors</span><span class="o">(</span><span class="s">&quot;password&quot;</span><span class="o">))</span> <span class="o">{</span> <span class="c1">// (3)</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">PasswordResetForm</span> <span class="n">form</span> <span class="o">=</span> <span class="o">(</span><span class="n">PasswordResetForm</span><span class="o">)</span> <span class="n">target</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="na">getPassword</span><span class="o">();</span>
        <span class="n">String</span> <span class="n">confirmPassword</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="na">getConfirmPassword</span><span class="o">();</span>

        <span class="k">if</span> <span class="o">(!</span><span class="n">password</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">confirmPassword</span><span class="o">))</span> <span class="o">{</span> <span class="c1">// (4)</span>
            <span class="n">errors</span><span class="o">.</span><span class="na">rejectValue</span><span class="o">(</span><span class="cm">/* (5) */</span> <span class="s">&quot;password&quot;</span><span class="o">,</span>
            <span class="cm">/* (6) */</span> <span class="s">&quot;PasswordEqualsValidator.passwordResetForm.password&quot;</span><span class="o">,</span>
            <span class="cm">/* (7) */</span> <span class="s">&quot;password and confirm password must be same.&quot;</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;Component</span></code> to make Validator the target of component scan.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Decide the argument is check target of this validator or not. Here <code class="docutils literal"><span class="pre">PasswordResetForm</span></code> class is the target to be checked.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">If an error occurs at the target fields during a single item check, do not perform correlation check in this Validator.</div>
<div class="line">If it is necessary to perform the correlation check, this determination logic is not required.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Implement check logic.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify field name where there is error.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify code name of error message. Here, code is</div>
<div class="line">&#8220;[validator name].[form attribute name].[property name]&#8221;</div>
<div class="line">Refer to <a class="reference internal" href="#validation-message-in-application-messages"><span>Messages to be defined in application-messages.properties</span></a> for mesaage definition.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set default message to be used when error message does not get resolved using code.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Spring Validator implementation class should be placed in the same package as the Controller.</p>
</div>
</li>
<li><p class="first">Controller class</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.WebDataBinder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.InitBinder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;password&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordResetController</span> <span class="o">{</span>
    <span class="nd">@Inject</span>
    <span class="n">PasswordEqualsValidator</span> <span class="n">passwordEqualsValidator</span><span class="o">;</span> <span class="c1">// (1)</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">PasswordResetForm</span> <span class="nf">setupForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">PasswordResetForm</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@InitBinder</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinder</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">binder</span><span class="o">.</span><span class="na">addValidators</span><span class="o">(</span><span class="n">passwordEqualsValidator</span><span class="o">);</span> <span class="c1">// (2)</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;reset&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">resetForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;password/resetForm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;reset&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">reset</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">PasswordResetForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (3)</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">&quot;password/resetForm&quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;redirect:/password/reset?complete&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;reset&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;complete&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">resetComplete</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;password/resetComplete&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inject Spring Validator to be used.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In the method having <code class="docutils literal"><span class="pre">&#64;InitBinder</span></code> annotation, add Validators using <code class="docutils literal"><span class="pre">WebDataBinder.addValidators</span></code> method.</div>
<div class="line">By this, the added Validator is called when validation is executed with the use of <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Implement input validation as per the process performed so far.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">JSP</p>
<p>There are no points to mention for JSP.</p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="k">&lt;%-</span><span class="o">-</span> <span class="n">WEB</span><span class="o">-</span><span class="n">INF</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">password</span><span class="o">/</span><span class="n">resetForm</span><span class="o">.</span><span class="na">jsp</span> <span class="o">--</span><span class="k">%&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;style</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">&gt;</span>
/* omitted */
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;passwordResetForm&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span>
        <span class="na">class=</span><span class="s">&quot;form-horizontal&quot;</span>
        <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/password/reset&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;password&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Password:<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:password</span> <span class="na">path=</span><span class="s">&quot;password&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;password&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;confirmPassword&quot;</span> <span class="na">cssErrorClass=</span><span class="s">&quot;error-label&quot;</span><span class="nt">&gt;</span>Password (Confirm):<span class="nt">&lt;/form:label&gt;</span>
        <span class="nt">&lt;form:password</span> <span class="na">path=</span><span class="s">&quot;confirmPassword&quot;</span>
            <span class="na">cssErrorClass=</span><span class="s">&quot;error-input&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;confirmPassword&quot;</span> <span class="na">cssClass=</span><span class="s">&quot;error-messages&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;br&gt;</span>
        <span class="nt">&lt;form:button&gt;</span>Reset<span class="nt">&lt;/form:button&gt;</span>
    <span class="nt">&lt;/form:form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
</li>
</ul>
<p>Error message as shown below is displayed when form is sent by entering different values in <code class="docutils literal"><span class="pre">password</span></code> field and <code class="docutils literal"><span class="pre">confirmPassword</span></code> fields.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-correlation-check1.png"><img alt="../_images/validations-correlation-check1.png" src="../_images/validations-correlation-check1.png" style="width: 60%;" /></a>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When <code class="docutils literal"><span class="pre">&lt;form:password&gt;</span></code> tag is used, data gets cleared at the time of redisplay.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When multiple forms are used in a single controller, model name should be specified in <code class="docutils literal"><span class="pre">&#64;InitBinder(&quot;xxx&quot;)</span></code> in order to limit the target of Validator.</p>
<blockquote class="last">
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;xxx&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">XxxController</span> <span class="o">{</span>
    <span class="c1">// omitted</span>
    <span class="nd">@ModelAttribute</span><span class="o">(</span><span class="s">&quot;aaa&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nf">AaaForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">AaaForm</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@ModelAttribute</span><span class="o">(</span><span class="s">&quot;bbb&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nf">BbbForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">BbbForm</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@InitBinder</span><span class="o">(</span><span class="s">&quot;aaa&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinderForAaa</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// add validators for AaaForm</span>
        <span class="n">binder</span><span class="o">.</span><span class="na">addValidators</span><span class="o">(</span><span class="n">aaaValidator</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@InitBinder</span><span class="o">(</span><span class="s">&quot;bbb&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinderForBbb</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// add validators for BbbForm</span>
        <span class="n">binder</span><span class="o">.</span><span class="na">addValidators</span><span class="o">(</span><span class="n">bbbValidator</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">// omitted</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To change the check contents of correlated items check rules in accordance with a validation group (for example: To implement correlated items check only when specific validation group is specified, etc.), it is better to switch the process within validate method by implementing <code class="docutils literal"><span class="pre">org.springframework.validation.SmartValidator</span></code> interface instead of implementing <code class="docutils literal"><span class="pre">org.springframework.validation.Validator</span></code> interface.</p>
<blockquote class="last">
<div><div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.commons.lang3.ArrayUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.Errors</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.SmartValidator</span><span class="o">;</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordEqualsValidator</span> <span class="kd">implements</span> <span class="n">SmartValidator</span> <span class="o">{</span> <span class="c1">// Implements SmartValidator instead of Validator interface</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supports</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">clazz</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">PasswordResetForm</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">clazz</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">validate</span><span class="o">(</span><span class="n">Object</span> <span class="n">target</span><span class="o">,</span> <span class="n">Errors</span> <span class="n">errors</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">validate</span><span class="o">(</span><span class="n">target</span><span class="o">,</span> <span class="n">errors</span><span class="o">,</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="o">{});</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">validate</span><span class="o">(</span><span class="n">Object</span> <span class="n">target</span><span class="o">,</span> <span class="n">Errors</span> <span class="n">errors</span><span class="o">,</span> <span class="n">Object</span><span class="o">...</span> <span class="n">validationHints</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Check validationHints(groups) and apply validation logic only when &#39;Update.class&#39; is specified</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">ArrayUtils</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">validationHints</span><span class="o">,</span> <span class="n">Update</span><span class="o">.</span><span class="na">class</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">PasswordResetForm</span> <span class="n">form</span> <span class="o">=</span> <span class="o">(</span><span class="n">PasswordResetForm</span><span class="o">)</span> <span class="n">target</span><span class="o">;</span>
            <span class="n">String</span> <span class="n">password</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="na">getPassword</span><span class="o">();</span>
            <span class="n">String</span> <span class="n">confirmPassword</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="na">getConfirmPassword</span><span class="o">();</span>

            <span class="c1">// omitted...</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="implementation-of-input-check-of-correlated-items-using-bean-validation">
<h4><a class="toc-backref" href="#id13">5.5.2.3.2. Implementation of input check of correlated items using Bean Validation</a><a class="headerlink" href="#implementation-of-input-check-of-correlated-items-using-bean-validation" title="Permalink to this headline">Â¶</a></h4>
<p>Independent validation rules should be added to implement validation of correlated items using Bean Validation.</p>
<p>It is explained in <a class="reference internal" href="#validation-custom-constraint"><span>How to extend</span></a>.</p>
</div>
</div>
<div class="section" id="definition-of-error-messages">
<span id="validation-message-def"></span><h3><a class="toc-backref" href="#id14">5.5.2.4. Definition of error messages</a><a class="headerlink" href="#definition-of-error-messages" title="Permalink to this headline">Â¶</a></h3>
<p>Method to change error messages of input validation is explained.</p>
<p>Error messages of Bean Validation in Spring MVC are resolved in the following order.</p>
<ol class="arabic">
<li><div class="first line-block">
<div class="line">If there is any message which matches with the rule, among the messages defined in <code class="docutils literal"><span class="pre">org.springframework.context.MessageSource</span></code>, then it is to be used as error message (Spring rule).</div>
<div class="line">For default rules of Spring, refer to &#8220;<a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/javadoc-api/org/springframework/validation/DefaultMessageCodesResolver.html">JavaDoc of DefaultMessageCodesResolver</a> of DefaultMessageCodesResolver&#8221;.</div>
</div>
</li>
<li><p class="first">If message cannot be found as mentioned in step 1, then error message is acquired from the <code class="docutils literal"><span class="pre">message</span></code> attribute of the annotation. (Bean Validation rule)</p>
</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>When the value of <code class="docutils literal"><span class="pre">message</span></code> attribute is not in &#8220;{message key}&#8221; format, use that text as error message.</li>
<li>When the value of <code class="docutils literal"><span class="pre">message</span></code> attribute is in &#8220;{message key}&#8221; format, search messages corresponding to message key from ValidationMessages.properties under classpath.</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>When message corresponding to message key is defined, use that message</li>
<li>When message corresponding to message key is not defined, use &#8220;{message key}&#8221; as error message</li>
</ol>
</div></blockquote>
</div></blockquote>
<p>Basically, it is recommended to define error messages in properties file.</p>
<p>Messages should be defined at following places.</p>
<ul class="simple">
<li>properties file read by <code class="docutils literal"><span class="pre">org.springframework.context.MessageSource</span></code></li>
<li>ValidationMessages.properties under classpath</li>
</ul>
<p>Considering that the following settings are done in applicationContext.xml, former is called as &#8220;application-messages.properties&#8221; and latter is called &#8220;ValidationMessages.properties&#8221;.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;messageSource&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.springframework.context.support.ResourceBundleMessageSource&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;basenames&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;list&gt;</span>
            <span class="nt">&lt;value&gt;</span>i18n/application-messages<span class="nt">&lt;/value&gt;</span>
        <span class="nt">&lt;/list&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-message-properties-position-image.png"><img alt="../_images/validations-message-properties-position-image.png" src="../_images/validations-message-properties-position-image.png" style="width: 40%;" /></a>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Multiple <code class="docutils literal"><span class="pre">ValidationMessages.properties</span></code> files should not exist directly under class path.</p>
<p>If multiple <code class="docutils literal"><span class="pre">ValidationMessages.properties</span></code> files exist directly under class path,
an appropriate message may not be displayed, as either one file of them is read leaving rest of the files unread.</p>
<ul class="simple">
<li>When adopting multi project structure, please take care so that <code class="docutils literal"><span class="pre">ValidationMessages.properties</span></code> file is not placed in multiple projects.</li>
<li>When distributing common parts for Bean Validation as jar file, please take care so that <code class="docutils literal"><span class="pre">ValidationMessages.properties</span></code> file is not included in jar file.</li>
</ul>
<p class="last">Further, when a project is created from <a class="reference external" href="https://github.com/terasolunaorg/terasoluna-gfw-web-multi-blank">Blank project</a>  of version 1.0.2.RELEASE or higher,
<code class="docutils literal"><span class="pre">ValidationMessages.properties</span></code> is stored directly under <code class="docutils literal"><span class="pre">xxx-web/src/main/resources</span></code>.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>This guideline classifies the definition as follows.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Properties file name</th>
<th class="head">Contents to be defined</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">ValidationMessages.properties</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Default error messages of Bean Validation specified by the system</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">application-messages.properties</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Error message of Bean Validation to be overwritten separately</div>
<div class="line">Error message of input validation implemented in Spring Validator</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>When ValidationMessages.properties is not provided, <a class="reference internal" href="#validation-default-message-in-hibernate-validator"><span>Default messages provided by Hibernate Validator</span></a> is used.</p>
<div class="section" id="messages-to-be-defined-in-validationmessages-properties">
<span id="validation-message-in-validationmessages"></span><h4><a class="toc-backref" href="#id15">5.5.2.4.1. Messages to be defined in ValidationMessages.properties</a><a class="headerlink" href="#messages-to-be-defined-in-validationmessages-properties" title="Permalink to this headline">Â¶</a></h4>
<p>Define messages for message key specified in <code class="docutils literal"><span class="pre">message</span></code> attribute of Bean Validation annotation of
ValidationMessages.properties under class path (normal src/main/resources).</p>
<p>It is explained below using the following form used at the beginning of <a class="reference internal" href="#validation-basic-validation"><span>Basic single item check</span></a>.</p>
<ul>
<li><p class="first">Form class (re-displayed)</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="o">)</span>
    <span class="nd">@Email</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Min</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
    <span class="nd">@Max</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>

    <span class="c1">// omitted getter/setter</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
<li><p class="first">ValidationMessages.properties</p>
<p>Change error messages of <code class="docutils literal"><span class="pre">&#64;NotNull</span></code>, <code class="docutils literal"><span class="pre">&#64;Size</span></code>, <code class="docutils literal"><span class="pre">&#64;Min</span></code>, <code class="docutils literal"><span class="pre">&#64;Max</span></code>, <code class="docutils literal"><span class="pre">&#64;Email</span></code>.</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">javax.validation.constraints.NotNull.message</span><span class="o">=</span><span class="s">is required.</span>
<span class="c"># (1)</span>
<span class="na">javax.validation.constraints.Size.message</span><span class="o">=</span><span class="s">size is not in the range {min} through {max}.</span>
<span class="c"># (2)</span>
<span class="na">javax.validation.constraints.Min.message</span><span class="o">=</span><span class="s">cannot be less than {value}.</span>
<span class="na">javax.validation.constraints.Max.message</span><span class="o">=</span><span class="s">cannot be greater than {value}.</span>
<span class="na">org.hibernate.validator.constraints.Email.message</span><span class="o">=</span><span class="s">is an invalid e-mail address.</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is possible to embed the value of attributes specified in the annotation using <code class="docutils literal"><span class="pre">{Attribute</span> <span class="pre">name}</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is possible to embed the invalid value using <code class="docutils literal"><span class="pre">{value}</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>When the form is sent with input fields left blank after adding the above settings, changed error messages are displayed as shown below.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-customize-message1.png"><img alt="../_images/validations-customize-message1.png" src="../_images/validations-customize-message1.png" style="width: 60%;" /></a>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Since <code class="docutils literal"><span class="pre">{FQCN</span> <span class="pre">of</span> <span class="pre">annotation.message}</span></code> is set in <code class="docutils literal"><span class="pre">message</span></code> attribute in Bean Validation standard annotations and independent Hibernate Validator annotations,
messages can be defined in properties file in the above format. However, since all annotations may not be in this format, Javadoc or source code of the target annotation should be checked.</p>
</div>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">FQCN of annotation.message</span> <span class="o">=</span> <span class="s">Message</span>
</pre></div>
</div>
<p>Add <code class="docutils literal"><span class="pre">{0}</span></code> to message as shown below when field name is to be included in error message.</p>
<ul class="simple">
<li>ValidationMessages.properties</li>
</ul>
<blockquote>
<div><p>Change error message of <code class="docutils literal"><span class="pre">&#64;NotNull</span></code>, <code class="docutils literal"><span class="pre">&#64;Size</span></code>, <code class="docutils literal"><span class="pre">&#64;Min</span></code>, <code class="docutils literal"><span class="pre">&#64;Max</span></code> and <code class="docutils literal"><span class="pre">&#64;Email</span></code>.</p>
<blockquote>
<div><div class="highlight-properties"><div class="highlight"><pre><span class="na">javax.validation.constraints.NotNull.message</span><span class="o">=</span><span class="s">&quot;{0}&quot; is required.</span>
<span class="na">javax.validation.constraints.Size.message</span><span class="o">=</span><span class="s">The size of &quot;{0}&quot; is not in the range {min} through {max}.</span>
<span class="na">javax.validation.constraints.Min.message</span><span class="o">=</span><span class="s">&quot;{0}&quot; cannot be less than {value}.</span>
<span class="na">javax.validation.constraints.Max.message</span><span class="o">=</span><span class="s">&quot;{0}&quot; cannot be greater than {value}.</span>
<span class="na">org.hibernate.validator.constraints.Email.message</span><span class="o">=</span><span class="s">&quot;{0}&quot; is an invalid e-mail address.</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<p>Error message is changed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-customize-message2.png"><img alt="../_images/validations-customize-message2.png" src="../_images/validations-customize-message2.png" style="width: 60%;" /></a>
</div>
<p>In this way, property name of form class gets displayed on the screen and so it is not user friendly.
To display an appropriate field name, it should be defined in <strong>application-messages.properties</strong> in the following format.</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">form property name</span><span class="o">=</span><span class="s">field name to be displayed</span>
</pre></div>
</div>
<p>Adding the same to our example.</p>
<ul>
<li><p class="first">application-messages.properties</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">name</span><span class="o">=</span><span class="s">Name</span>
<span class="na">email</span><span class="o">=</span><span class="s">Email</span>
<span class="na">age</span><span class="o">=</span><span class="s">Age</span>
</pre></div>
</div>
</li>
</ul>
<p>Error messages are changed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-customize-message3.png"><img alt="../_images/validations-customize-message3.png" src="../_images/validations-customize-message3.png" style="width: 60%;" /></a>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Inserting field name in place of <code class="docutils literal"><span class="pre">{0}</span></code> is the functionality of Spring and not of Bean Validation.
Therefore, the settings for changing field name should be defined in application-messages.properties(<code class="docutils literal"><span class="pre">ResourceBundleMessageSource</span></code>) which is directly under Spring management.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>In Bean Validation 1.1,
it is possible to use Expression Language (hereafter referred to as &#8220;EL expression&#8221;) in a message specified in <code class="file docutils literal"><span class="pre">ValidationMessages.properties</span></code>.
Hibernate Validator 5.x supports Expression Language 2.2 or higher version.</p>
<p>Executable EL expression version differs depending on the version of application server.
Therefore when EL expression is to be used, <strong>it should be used after confirming the version of EL expression supported by application server.</strong></p>
<p>Following is an example of using EL expression in a message which is defined in <code class="file docutils literal"><span class="pre">ValidationMessages.properties</span></code> provided by Hibernate Validator by default.</p>
<blockquote class="last">
<div><div class="highlight-properties"><div class="highlight"><pre><span class="c"># ...</span>
<span class="c"># (1)</span>
<span class="na">javax.validation.constraints.DecimalMax.message</span>  <span class="o">=</span> <span class="s">must be less than ${inclusive == true ? &#39;or equal to &#39; : &#39;&#39;}{value}</span>
<span class="c"># ...</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">An EL expression is a part of &#8220;<code class="docutils literal"><span class="pre">${inclusive</span> <span class="pre">==</span> <span class="pre">true</span> <span class="pre">?</span> <span class="pre">'or</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">'</span> <span class="pre">:</span> <span class="pre">''}</span></code> &#8221; in a message.</p>
<p>From the above mentioned definition of message, 2 patterns of messages are created as given below.</p>
<ul class="simple">
<li>must be less than or equal to {value}</li>
<li>must be less than {value}</li>
</ul>
<p>(A value specified in <code class="docutils literal"><span class="pre">value</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;DecimalMax</span></code> annotation is embedded in <code class="docutils literal"><span class="pre">{value}</span></code> part)</p>
<p>Former is created when <code class="docutils literal"><span class="pre">true</span></code> is specified (or when not specified) in <code class="docutils literal"><span class="pre">inclusive</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;DecimalMax</span></code> annotation,
Latter is created when <code class="docutils literal"><span class="pre">false</span></code> is specified in <code class="docutils literal"><span class="pre">inclusive</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;DecimalMax</span></code> annotation.</p>
<p class="last">For handling of EL expressions in Bean Validation refer to:
<a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.1/reference/en-US/html/chapter-message-interpolation.html#section-interpolation-with-message-expressions">Hibernate Validator Reference Guide(Interpolation with message expressions)</a>.</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div>
<div class="section" id="messages-to-be-defined-in-application-messages-properties">
<span id="validation-message-in-application-messages"></span><h4><a class="toc-backref" href="#id16">5.5.2.4.2. Messages to be defined in application-messages.properties</a><a class="headerlink" href="#messages-to-be-defined-in-application-messages-properties" title="Permalink to this headline">Â¶</a></h4>
<p>Default messages to be used in system are defined in ValidationMessages.properties
however, depending on the screen, they may have to be changed from the default value.</p>
<p>In this case, define messages in the following format in application-messages.properties.</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">[annotation name].[form attribute name].[property name]</span> <span class="o">=</span> <span class="s">[target message]</span>
</pre></div>
</div>
<p>Apply &#8220;<a class="reference internal" href="#validation-message-in-validationmessages"><span>Messages to be defined in ValidationMessages.properties</span></a>&#8221; and override the message for  <code class="docutils literal"><span class="pre">email</span></code> and <code class="docutils literal"><span class="pre">age</span></code> field using the below settings.</p>
<ul>
<li><p class="first">application-messages.properties</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="c"># override messages</span>
<span class="c"># for email field</span>
<span class="na">Size.userForm.email</span><span class="o">=</span><span class="s">The size of &quot;{0}&quot; must be between {2} and {1}.</span>
<span class="c"># for age field</span>
<span class="na">NotNull.userForm.age</span><span class="o">=</span><span class="s">&quot;{0}&quot; is compulsory.</span>
<span class="na">Min.userForm.age</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be greater than or equal to {1}.</span>
<span class="na">Max.userForm.age</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be less than or equal to {1}.</span>

<span class="c"># filed names</span>
<span class="na">name</span><span class="o">=</span><span class="s">Name</span>
<span class="na">email</span><span class="o">=</span><span class="s">Email</span>
<span class="na">age</span><span class="o">=</span><span class="s">Age</span>
</pre></div>
</div>
</li>
</ul>
<p>Value of attributes of the annotation gets inserted after <code class="docutils literal"><span class="pre">{1}</span></code> onwards.
Incidentally, index position of attribute values are alphabetical ordering(ascending order) of attribute names.</p>
<p>For example, index positions of <code class="docutils literal"><span class="pre">&#64;Size</span></code> are as follow:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">{0}</span></code> : property name (physical name or logical name)</li>
<li><code class="docutils literal"><span class="pre">{1}</span></code> : value of <code class="docutils literal"><span class="pre">max</span></code> attribute</li>
<li><code class="docutils literal"><span class="pre">{2}</span></code> : value of <code class="docutils literal"><span class="pre">min</span></code> attribute</li>
</ul>
<p>For specification details, refer to <a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/javadoc-api/org/springframework/validation/beanvalidation/SpringValidatorAdapter.html#getArgumentsForConstraint-java.lang.String-java.lang.String-javax.validation.metadata.ConstraintDescriptor-">JavaDoc of SpringValidatorAdapter</a>.</p>
<p>Error messages are changed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-customize-message4.png"><img alt="../_images/validations-customize-message4.png" src="../_images/validations-customize-message4.png" style="width: 60%;" /></a>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/javadoc-api/org/springframework/validation/DefaultMessageCodesResolver.html">There are other formats</a> as well for the message key format of application-messages.properties;
however, if it is used with the purpose of overwriting some default messages, it should be in <code class="docutils literal"><span class="pre">[annotation</span> <span class="pre">name].[form</span> <span class="pre">attribute</span> <span class="pre">name].[property</span> <span class="pre">name]</span></code> format.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="how-to-extend">
<span id="validation-custom-constraint"></span><h2><a class="toc-backref" href="#id17">5.5.3. How to extend</a><a class="headerlink" href="#how-to-extend" title="Permalink to this headline">Â¶</a></h2>
<p>Other than standard check rules, bean validation has a mechanism to develop annotations for independent rules .</p>
<p>The method of creating independent rules can be widely classified into the following two broader criteria.</p>
<ul class="simple">
<li>Combination of existing rules</li>
<li>Creation of new rules</li>
</ul>
<p>Basically, the below template can be used to create annotation for each rule.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">ANNOTATION_TYPE</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">CONSTRUCTOR</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">PARAMETER</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="o">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="o">{})</span>
<span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">Xxx</span> <span class="o">{</span>
    <span class="n">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.common.validation.Xxx.message}&quot;</span><span class="o">;</span>

    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
    <span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="o">{</span>
        <span class="n">Xxx</span><span class="o">[]</span> <span class="nf">value</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="section" id="creation-of-bean-validation-annotation-by-combining-existing-rules">
<h3><a class="toc-backref" href="#id18">5.5.3.1. Creation of Bean Validation annotation by combining existing rules</a><a class="headerlink" href="#creation-of-bean-validation-annotation-by-combining-existing-rules" title="Permalink to this headline">Â¶</a></h3>
<p>Consider the following restrictions at the system level and domain level respectively.</p>
<div class="line-block">
<div class="line">At the system level,</div>
</div>
<ul class="simple">
<li>String must be single byte alphanumeric characters</li>
<li>Numbers must be positive</li>
</ul>
<div class="line-block">
<div class="line">Or at the domain level,</div>
</div>
<ul class="simple">
<li>&#8220;User ID&#8221; must be between 4 and 20 single byte characters</li>
<li>&#8220;Age&#8221; must be between 1 year and 150 years</li>
</ul>
<div class="line-block">
<div class="line">These can be implemented by combining <code class="docutils literal"><span class="pre">&#64;Pattern</span></code>, <code class="docutils literal"><span class="pre">&#64;Size</span></code>, <code class="docutils literal"><span class="pre">&#64;Min</span></code>, <code class="docutils literal"><span class="pre">&#64;Max</span></code> of the existing rules.</div>
<div class="line">However, if the same rules are to be used at multiple places, settings get distributed and maintainability worsens.</div>
</div>
<p>One rule can be created by combining multiple rules.
There is an advantage to be able to have not only common regular expression pattern and maximum/minimum values but also error message when an independent annotation is created.
By this, reusability and maintainability increases. Even if multiple rules are not combined, it also proves beneficial if used only to give specific value to an attribute.</p>
<p>Implementation example is shown below.</p>
<ul>
<li><p class="first">Implementation example of <code class="docutils literal"><span class="pre">&#64;Alphanumeric</span></code> annotation which is restricted to single byte alphanumeric characters</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ReportAsSingleViolation</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Pattern</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">ANNOTATION_TYPE</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">CONSTRUCTOR</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">PARAMETER</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="o">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="o">{})</span>
<span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
<span class="hll"><span class="nd">@ReportAsSingleViolation</span> <span class="c1">// (1)</span>
</span><span class="hll"><span class="nd">@Pattern</span><span class="o">(</span><span class="n">regexp</span> <span class="o">=</span> <span class="s">&quot;[a-zA-Z0-9]*&quot;</span><span class="o">)</span> <span class="c1">// (2)</span>
</span><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">AlphaNumeric</span> <span class="o">{</span>
<span class="hll">    <span class="n">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.common.validation.AlphaNumeric.message}&quot;</span><span class="o">;</span> <span class="c1">// (3)</span>
</span>
    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
    <span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="o">{</span>
        <span class="n">AlphaNumeric</span><span class="o">[]</span> <span class="nf">value</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">This will consolidate error messages and return only the message of this annotation at the time of error.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define rules used by this annotation.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define default value of error message.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Implementation example of <code class="docutils literal"><span class="pre">&#64;NotNegative</span></code> annotation which is restricted to positive number</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ReportAsSingleViolation</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Min</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">ANNOTATION_TYPE</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">CONSTRUCTOR</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">PARAMETER</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="o">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="o">{})</span>
<span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
<span class="hll"><span class="nd">@ReportAsSingleViolation</span>
</span><span class="hll"><span class="nd">@Min</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="o">)</span>
</span><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">NotNegative</span> <span class="o">{</span>
<span class="hll">    <span class="n">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.common.validation.NotNegative.message}&quot;</span><span class="o">;</span>
</span>
    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
    <span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="o">{</span>
        <span class="n">NotNegative</span><span class="o">[]</span> <span class="nf">value</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Implementation example of <code class="docutils literal"><span class="pre">&#64;UserId</span></code> annotation which regulates the format of &#8220;User ID&#8221;.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.domain.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ReportAsSingleViolation</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Pattern</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">ANNOTATION_TYPE</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">CONSTRUCTOR</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">PARAMETER</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="o">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="o">{})</span>
<span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
<span class="hll"><span class="nd">@ReportAsSingleViolation</span>
</span><span class="hll"><span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">4</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">20</span><span class="o">)</span>
</span><span class="hll"><span class="nd">@Pattern</span><span class="o">(</span><span class="n">regexp</span> <span class="o">=</span> <span class="s">&quot;[a-z]*&quot;</span><span class="o">)</span>
</span><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">UserId</span> <span class="o">{</span>
<span class="hll">    <span class="n">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.sample.domain.validation.UserId.message}&quot;</span><span class="o">;</span>
</span>
    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
    <span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="o">{</span>
        <span class="n">UserId</span><span class="o">[]</span> <span class="nf">value</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Implementation example of <code class="docutils literal"><span class="pre">&#64;Age</span></code> annotation which regulates the constraints on &#8220;Age&#8221;</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.domain.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ReportAsSingleViolation</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Max</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Min</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">ANNOTATION_TYPE</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">CONSTRUCTOR</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">PARAMETER</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="o">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="o">{})</span>
<span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
<span class="hll"><span class="nd">@ReportAsSingleViolation</span>
</span><span class="hll"><span class="nd">@Min</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
</span><span class="hll"><span class="nd">@Max</span><span class="o">(</span><span class="mi">150</span><span class="o">)</span>
</span><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">Age</span> <span class="o">{</span>
<span class="hll">    <span class="n">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.sample.domain.validation.Age.message}&quot;</span><span class="o">;</span>
</span>
    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
    <span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="o">{</span>
        <span class="n">Age</span><span class="o">[]</span> <span class="nf">value</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If multiple rules are set in a single annotation, their AND condition forms the composite annotation.
In Hibernate Validator, <code class="docutils literal"><span class="pre">&#64;ConstraintComposition</span></code> annotation is provided to implement OR condition.
Refer to <a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.1/reference/en-US/html/validator-specifics.html#section-boolean-constraint-composition">Hibernate Validator document</a> for details.</p>
</div>
</li>
</ul>
</div>
<div class="section" id="creation-of-bean-validation-annotation-by-implementing-new-rules">
<h3><a class="toc-backref" href="#id19">5.5.3.2. Creation of Bean Validation annotation by implementing new rules</a><a class="headerlink" href="#creation-of-bean-validation-annotation-by-implementing-new-rules" title="Permalink to this headline">Â¶</a></h3>
<p>Any rule can be created by implementing <code class="docutils literal"><span class="pre">javax.validation.ConstraintValidator</span></code> interface and creating annotation that uses this Validator.</p>
<p>The method of usage is as follows.</p>
<ul class="simple">
<li>Rules that cannot be implemented by combining the existing rules</li>
<li>check rule for correlated items</li>
<li>Business logic check</li>
</ul>
<div class="section" id="rules-that-cannot-be-implemented-by-combining-the-existing-rules">
<h4><a class="toc-backref" href="#id20">5.5.3.2.1. Rules that cannot be implemented by combining the existing rules</a><a class="headerlink" href="#rules-that-cannot-be-implemented-by-combining-the-existing-rules" title="Permalink to this headline">Â¶</a></h4>
<p>For the rules that cannot be implemented by combining <code class="docutils literal"><span class="pre">&#64;Pattern</span></code>, <code class="docutils literal"><span class="pre">&#64;Size</span></code>, <code class="docutils literal"><span class="pre">&#64;Min</span></code>, <code class="docutils literal"><span class="pre">&#64;Max</span></code>, implement <code class="docutils literal"><span class="pre">javax.validation.ConstraintValidator</span></code>.</p>
<p>For example, rules that check ISBN (International Standard Book Number)-13 format are given.</p>
<ul>
<li><p class="first">Annotation</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">ANNOTATION_TYPE</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">CONSTRUCTOR</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">PARAMETER</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">;</span>

<span class="nd">@Documented</span>
<span class="hll"><span class="nd">@Constraint</span><span class="o">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="o">{</span> <span class="n">ISBN13Validator</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span> <span class="c1">// (1)</span>
</span><span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">ISBN13</span> <span class="o">{</span>
    <span class="n">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.common.validation.ISBN13.message}&quot;</span><span class="o">;</span>

    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
    <span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="o">{</span>
        <span class="n">ISBN13</span><span class="o">[]</span> <span class="nf">value</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the <code class="docutils literal"><span class="pre">ConstraintValidator</span></code> implementation class which will get executed when this annotation is used. Multiple constraints can also be specified.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Validator</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidatorContext</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ISBN13Validator</span> <span class="kd">implements</span> <span class="n">ConstraintValidator</span><span class="o">&lt;</span><span class="n">ISBN13</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span> <span class="c1">// (1)</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="n">ISBN13</span> <span class="n">constraintAnnotation</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (2)</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">,</span> <span class="n">ConstraintValidatorContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (3)</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span> <span class="c1">// (4)</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">isISBN13Valid</span><span class="o">(</span><span class="n">value</span><span class="o">);</span> <span class="c1">// (5)</span>
    <span class="o">}</span>

    <span class="c1">// This logic is written in http://en.wikipedia.org/wiki/International_Standard_Book_Number</span>
    <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">isISBN13Valid</span><span class="o">(</span><span class="n">String</span> <span class="n">isbn</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isbn</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">!=</span> <span class="mi">13</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">check</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="o">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">check</span> <span class="o">+=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">isbn</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">));</span>
            <span class="o">}</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="o">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">check</span> <span class="o">+=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">isbn</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">))</span> <span class="o">*</span> <span class="mi">3</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">check</span> <span class="o">+=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">isbn</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">12</span><span class="o">));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NumberFormatException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">check</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify target annotation and field type in generics parameter.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Implement initialization process in <code class="docutils literal"><span class="pre">initialize</span></code> method.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Implement input validation in <code class="docutils literal"><span class="pre">isValid</span></code> method.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Consider input value as correct in case of <code class="docutils literal"><span class="pre">null</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Check ISBN-13 format.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Example of <a class="reference internal" href="FileUpload.html#fileupload-validator"><span>Bean Validation of file upload</span></a> is classified in this category. Further, in common library as well, <a class="reference internal" href="Codelist.html#codelist-validate"><span>&#64;ExistInCodeList</span></a> is implemented in this way.</p>
</div>
</div>
<div class="section" id="check-rules-for-correlated-items">
<h4><a class="toc-backref" href="#id21">5.5.3.2.2. Check rules for correlated items</a><a class="headerlink" href="#check-rules-for-correlated-items" title="Permalink to this headline">Â¶</a></h4>
<div class="line-block">
<div class="line">Check of correlated items, which span over multiple fields, can be done using Bean Validation as explained in  <a class="reference internal" href="#validation-correlation-check"><span>Correlation item check</span></a>.</div>
<div class="line">It is recommended to target generalized rules, in case of deciding to use Bean Validation for check of correlated items.</div>
</div>
<p>An example of implementing the rule, &#8220;Contents of a field should match with its confirmation field&#8221; is given below.</p>
<p>Set constraint of assigning &#8220;confirm&#8221; as the prefix of confirmation field.</p>
<ul>
<li><p class="first">Annotation</p>
<p>Define such that annotation for validation of correlated items can be used at class level as well.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">ANNOTATION_TYPE</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">TYPE</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="o">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="o">{</span> <span class="n">ConfirmValidator</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
<span class="hll"><span class="nd">@Target</span><span class="o">({</span> <span class="n">TYPE</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span> <span class="o">})</span> <span class="c1">// (1)</span>
</span><span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">Confirm</span> <span class="o">{</span>
    <span class="n">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.common.validation.Confirm.message}&quot;</span><span class="o">;</span>

    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="cm">/**</span>
<span class="cm">     * Field name</span>
<span class="cm">     */</span>
<span class="hll">    <span class="n">String</span> <span class="nf">field</span><span class="o">();</span> <span class="c1">// (2)</span>
</span>
    <span class="nd">@Target</span><span class="o">({</span> <span class="n">TYPE</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span> <span class="o">})</span>
    <span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="o">{</span>
        <span class="n">Confirm</span><span class="o">[]</span> <span class="nf">value</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Narrow down the target of using this annotation, such that it can be added only to class or annotation.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define parameter to pass to annotation.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Validator</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.common.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidatorContext</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.BeanWrapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.BeanWrapperImpl</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.util.ObjectUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.util.StringUtils</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConfirmValidator</span> <span class="kd">implements</span> <span class="n">ConstraintValidator</span><span class="o">&lt;</span><span class="n">Confirm</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">field</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">confirmField</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="n">Confirm</span> <span class="n">constraintAnnotation</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">constraintAnnotation</span><span class="o">.</span><span class="na">field</span><span class="o">();</span>
        <span class="n">confirmField</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span> <span class="o">+</span> <span class="n">StringUtils</span><span class="o">.</span><span class="na">capitalize</span><span class="o">(</span><span class="n">field</span><span class="o">);</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">constraintAnnotation</span><span class="o">.</span><span class="na">message</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="n">Object</span> <span class="n">value</span><span class="o">,</span> <span class="n">ConstraintValidatorContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">BeanWrapper</span> <span class="n">beanWrapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BeanWrapperImpl</span><span class="o">(</span><span class="n">value</span><span class="o">);</span> <span class="c1">// (1)</span>
        <span class="n">Object</span> <span class="n">fieldValue</span> <span class="o">=</span> <span class="n">beanWrapper</span><span class="o">.</span><span class="na">getPropertyValue</span><span class="o">(</span><span class="n">field</span><span class="o">);</span> <span class="c1">// (2)</span>
        <span class="n">Object</span> <span class="n">confirmFieldValue</span> <span class="o">=</span> <span class="n">beanWrapper</span><span class="o">.</span><span class="na">getPropertyValue</span><span class="o">(</span><span class="n">confirmField</span><span class="o">);</span>
        <span class="kt">boolean</span> <span class="n">matched</span> <span class="o">=</span> <span class="n">ObjectUtils</span><span class="o">.</span><span class="na">nullSafeEquals</span><span class="o">(</span><span class="n">fieldValue</span><span class="o">,</span>
                <span class="n">confirmFieldValue</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">matched</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">context</span><span class="o">.</span><span class="na">disableDefaultConstraintViolation</span><span class="o">();</span> <span class="c1">// (3)</span>
            <span class="n">context</span><span class="o">.</span><span class="na">buildConstraintViolationWithTemplate</span><span class="o">(</span><span class="n">message</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">addPropertyNode</span><span class="o">(</span><span class="n">field</span><span class="o">).</span><span class="na">addConstraintViolation</span><span class="o">();</span> <span class="c1">// (4)</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Use <code class="docutils literal"><span class="pre">org.springframework.beans.BeanWrapper</span></code> which is very convenient to access JavaBean properties.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Acquire property value from the form object through <code class="docutils literal"><span class="pre">BeanWrapper</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Disable the creation of default <code class="docutils literal"><span class="pre">ConstraintViolation</span></code> object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create an independent <code class="docutils literal"><span class="pre">ConstraintViolation</span></code> object.</div>
<div class="line">Define message to be output in <code class="docutils literal"><span class="pre">ConstraintValidatorContext.buildConstraintViolationWithTemplate</span></code>.</div>
<div class="line">Specify field name to output error message in <code class="docutils literal"><span class="pre">ConstraintViolationBuilder.addPropertyNode</span></code>.</div>
<div class="line">Refer to <a class="reference external" href="http://docs.oracle.com/javaee/7/api/javax/validation/ConstraintValidatorContext.html">JavaDoc of ConstraintValidatorContext</a> for details.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<blockquote>
<div><div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><code class="docutils literal"><span class="pre">ConstraintViolationBuilder.addPropertyNode</span></code> method has been added from the Bean Validation 1.1.</p>
<p><code class="docutils literal"><span class="pre">ConstraintViolationBuilder.addNode</span></code> method had been used in Bean Validation 1.0; however, it is a deprecated API from Bean Validation 1.1.</p>
<p class="last">For deprecated API of Bean Validation, refer to <a class="reference external" href="http://docs.jboss.org/hibernate/beanvalidation/spec/1.1/api/deprecated-list.html">Bean Validation API Document (Deprecated API)</a>.</p>
</div>
</div></blockquote>
<p>Check below for the changes, if the &#8220;Reset password&#8221; is re-implemented using <code class="docutils literal"><span class="pre">&#64;Confirm</span></code> annotation.</p>
<ul>
<li><p class="first">Form class</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.validation.constraints.NotNull</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.constraints.Size</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.example.common.validation.Confirm</span><span class="o">;</span>

<span class="nd">@Confirm</span><span class="o">(</span><span class="n">field</span> <span class="o">=</span> <span class="s">&quot;password&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordResetForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">8</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">confirmPassword</span><span class="o">;</span>

    <span class="c1">// omitted getter/setter</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Assign <code class="docutils literal"><span class="pre">&#64;Confirm</span></code> annotation at class level.</div>
<div class="line">By this, form object is passed as an argument to <code class="docutils literal"><span class="pre">ConstraintValidator.isValid</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Controller class</p>
<p>There is no need to inject Validator and add Validator using <code class="docutils literal"><span class="pre">&#64;InitBinder</span></code>.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.app.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.BindingResult</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.validation.annotation.Validated</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ModelAttribute</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;password&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PasswordResetController</span> <span class="o">{</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">PasswordResetForm</span> <span class="nf">setupForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">PasswordResetForm</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;reset&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">resetForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;password/resetForm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;reset&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">reset</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">PasswordResetForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">&quot;password/resetForm&quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;redirect:/password/reset?complete&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;reset&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;complete&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">resetComplete</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;password/resetComplete&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="business-logic-check">
<h4><a class="toc-backref" href="#id22">5.5.3.2.3. Business logic check</a><a class="headerlink" href="#business-logic-check" title="Permalink to this headline">Â¶</a></h4>
<div class="line-block">
<div class="line">Business logic check should implement <a class="reference internal" href="../ImplementationAtEachLayer/DomainLayer.html#service-implementation-label"><span>Implementation in Service of domain layer</span></a> and store result message in <code class="docutils literal"><span class="pre">ResultMessages</span></code> object.</div>
<div class="line">Accordingly, it is expected that, <a class="reference internal" href="MessageManagement.html#message-display"><span>they will be normally displayed at the top of the screen</span></a>.</div>
</div>
<p>However, there are cases, where business logic error message (such as, &#8220;whether the entered user name is already registered&#8221;) of target input field is to be displayed next to the field.
In such a case, service class is injected in Validator class and business logic check is executed in <code class="docutils literal"><span class="pre">ConstraintValidator.isValid</span></code>.</p>
<p>An example of implementing, &#8220;whether the entered user name is already registered&#8221; in Bean Validation is shown below.</p>
<ul>
<li><p class="first">Service class</p>
<p>Implementation class (UserServiceImpl) is omitted.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.domain.service.user</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserService</span> <span class="o">{</span>

    <span class="kt">boolean</span> <span class="nf">isUnusedUserId</span><span class="o">(</span><span class="n">String</span> <span class="n">userId</span><span class="o">);</span>

    <span class="c1">// omitted other methods</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Annotation</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.domain.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.annotation.Documented</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Retention</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.annotation.Target</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Constraint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.Payload</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">ANNOTATION_TYPE</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">CONSTRUCTOR</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">ElementType</span><span class="o">.</span><span class="na">PARAMETER</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">annotation</span><span class="o">.</span><span class="na">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">;</span>

<span class="nd">@Documented</span>
<span class="nd">@Constraint</span><span class="o">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="o">{</span> <span class="n">UnusedUserIdValidator</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
<span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">UnusedUserId</span> <span class="o">{</span>
    <span class="n">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">&quot;{com.example.sample.domain.validation.UnusedUserId.message}&quot;</span><span class="o">;</span>

    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nd">@Target</span><span class="o">({</span> <span class="n">METHOD</span><span class="o">,</span> <span class="n">FIELD</span><span class="o">,</span> <span class="n">ANNOTATION_TYPE</span><span class="o">,</span> <span class="n">CONSTRUCTOR</span><span class="o">,</span> <span class="n">PARAMETER</span> <span class="o">})</span>
    <span class="nd">@Retention</span><span class="o">(</span><span class="n">RUNTIME</span><span class="o">)</span>
    <span class="nd">@Documented</span>
    <span class="kd">public</span> <span class="nd">@interface</span> <span class="n">List</span> <span class="o">{</span>
        <span class="n">UnusedUserId</span><span class="o">[]</span> <span class="nf">value</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Validator class</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.sample.domain.validation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.validation.ConstraintValidatorContext</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.example.sample.domain.service.user.UserService</span><span class="o">;</span>

<span class="hll"><span class="nd">@Component</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UnusedUserIdValidator</span> <span class="kd">implements</span>
                                  <span class="n">ConstraintValidator</span><span class="o">&lt;</span><span class="n">UnusedUserId</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>

<span class="hll">    <span class="nd">@Inject</span> <span class="c1">// (2)</span>
</span><span class="hll">    <span class="n">UserService</span> <span class="n">userService</span><span class="o">;</span>
</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="n">UnusedUserId</span> <span class="n">constraintAnnotation</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">,</span> <span class="n">ConstraintValidatorContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">userService</span><span class="o">.</span><span class="na">isUnusedUserId</span><span class="o">(</span><span class="n">value</span><span class="o">);</span> <span class="c1">// (3)</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Settings to enable component scan of the Validator class.</div>
<div class="line">Target package must be included in <code class="docutils literal"><span class="pre">&lt;context:component-scan</span> <span class="pre">base-package=&quot;...&quot;</span> <span class="pre">/&gt;</span></code> of Bean definition file.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inject the service class to be called.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Return the result of business logic error check. Process should be delegated to service class. Logic must not be written directly in the <code class="docutils literal"><span class="pre">isValid</span></code> method.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="appendix">
<h2><a class="toc-backref" href="#id23">5.5.4. Appendix</a><a class="headerlink" href="#appendix" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="input-validation-rules-provided-by-hibernate-validator">
<h3><a class="toc-backref" href="#id24">5.5.4.1. Input validation rules provided by Hibernate Validator</a><a class="headerlink" href="#input-validation-rules-provided-by-hibernate-validator" title="Permalink to this headline">Â¶</a></h3>
<div class="line-block">
<div class="line">Hibernate Validator provides additional validation annotations, in addition to the annotations defined in Bean Validation.</div>
<div class="line">Refer to <a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.1/reference/en-US/html/chapter-bean-constraints.html#section-builtin-constraints">Here</a>for the annotation list that can be used for validation.</div>
</div>
<div class="section" id="bean-validation-check-rules">
<span id="validation-jsr303-doc"></span><h4><a class="toc-backref" href="#id25">5.5.4.1.1. Bean Validation check rules</a><a class="headerlink" href="#bean-validation-check-rules" title="Permalink to this headline">Â¶</a></h4>
<p>Bean Validation standard annotations are shown below.</p>
<p>Refer to Chapter 7 <a class="reference external" href="http://download.oracle.com/otn-pub/jcp/bean_validation-1_1-fr-eval-spec/bean-validation-specification.pdf">Bean Validation specification</a> for details.</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Annotation(javax.validation.*)</th>
<th class="head">Target type</th>
<th class="head">Application</th>
<th class="head">Usage example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;NotNull</span></code></td>
<td>Arbitrary</td>
<td>Validates that the target field is not null.</td>
<td><div class="first last line-block">
<div class="line">&#64;NotNull</div>
<div class="line">private String id;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;Null</span></code></td>
<td>Arbitrary</td>
<td><div class="first last line-block">
<div class="line">Validates that the target field is null.</div>
<div class="line">(Example: usage in group validation)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">&#64;Nulll(groups={Update.class})</div>
<div class="line">private String id;</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;Pattern</span></code></td>
<td>String</td>
<td><div class="first last line-block">
<div class="line">Whether the target field matches with the regular expression</div>
<div class="line">(In case of Hibernate Validator implementation, it is also possible to use it with arbitrary CharSequence inherited class)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">&#64;Pattern(regexp = &#8220;[0-9]+&#8221;)</div>
<div class="line">private String tel;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;Min</span></code></td>
<td><div class="first last line-block">
<div class="line">BigDecimal, BigInteger, byte, short, int, long and wrapper</div>
<div class="line">(In case of Hibernate Validator implementation, it is also possible to use it with arbitrary CharSequence, Number inherited class. However, only in cases where string can be converted to a number.)</div>
</div>
</td>
<td>Validate whether the value is greater than the minimum value.</td>
<td>Refer &#64;Max</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;Max</span></code></td>
<td><div class="first last line-block">
<div class="line">BigDecimal, BigInteger, byte, short, int, long and wrapper</div>
<div class="line">(In case of Hibernate Validator implementation, it is also possible to use it with arbitrary CharSequence, Number inherited class. However, only in cases where string can be converted to a number.)</div>
</div>
</td>
<td>Validate whether the value is less than the maximum value.</td>
<td><div class="first last line-block">
<div class="line">&#64;Min(1)</div>
<div class="line">&#64;Max(100)</div>
<div class="line">private int quantity;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;DecimalMin</span></code></td>
<td>BigDecimal, BigInteger, String, byte, short, int, long and wrapper
(In case of Hibernate Validator implementation, it is also possible to use it with arbitrary CharSequence, Number inherited class.)</td>
<td><div class="first last line-block">
<div class="line">Validate whether the Decimal value is greater than or equal to the minimum value.</div>
<div class="line">By specifying <code class="docutils literal"><span class="pre">inclusive</span> <span class="pre">=</span> <span class="pre">false</span></code>, it is possible to change to an operation so as to validate whether the value is greater than the minimum value.</div>
</div>
</td>
<td>Refer &#64;DecimalMax</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;DecimalMax</span></code></td>
<td>BigDecimal, BigInteger, String, byte, short, int, long and wrapper
(In case of Hibernate Validator implementation, it is also possible to use it with arbitrary CharSequence, Number inherited class.)</td>
<td><div class="first last line-block">
<div class="line">Validate whether the decimal value is less than or equal to the maximum value.</div>
<div class="line">By specifying <code class="docutils literal"><span class="pre">inclusive</span> <span class="pre">=</span> <span class="pre">false</span></code>, it is possible to change to an operation so as to validate whether the value is less than the maximum value.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">&#64;DecimalMin(&#8220;0.0&#8221;)</div>
<div class="line">&#64;DecimalMax(&#8220;99999.99&#8221;)</div>
<div class="line">private BigDecimal price;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;Size</span></code></td>
<td>String(length), Collection(size), Map(size), Array(length)
(In case of Hibernate Validator implementation, it is also possible to use it with arbitrary CharSequence inherited class.)</td>
<td><div class="first last line-block">
<div class="line">Validate whether the size is between min and max length.</div>
<div class="line">It is possible to omit min and max. In that case, min=0 and max=Integer.MAX_VALUE by default.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">&#64;Size(min=4, max=64)</div>
<div class="line">private String password;</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;Digits</span></code></td>
<td>BigDecimal, BigInteger, String, byte, short, int, long and wrapper</td>
<td><div class="first last line-block">
<div class="line">Check whether the value is a numerical value within the specified range.</div>
<div class="line">Specify the maximum number of integer digits permitted in the &#8216;integer&#8217; and the maximum value of decimal digits permitted in &#8216;fraction&#8217;.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">&#64;Digits(integer=6, fraction=2)</div>
<div class="line">private BigDecimal price;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;AssertTrue</span></code></td>
<td>boolean,Boolean</td>
<td>Validate that the target field is &#8216;true&#8217;(Example: Whether it agrees to the termsï¼</td>
<td><div class="first last line-block">
<div class="line">&#64;AssertTrue</div>
<div class="line">private boolean checked;</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;AssertFalse</span></code></td>
<td>boolean,Boolean</td>
<td>Validate whether the target field is &#8216;false&#8217;</td>
<td><div class="first last line-block">
<div class="line">&#64;AssertFalse</div>
<div class="line">private boolean checked;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;Future</span></code></td>
<td>Date, Calendar
(In case of Hibernate Validator implementation, it is also applicable to Joda-Time class)</td>
<td>Validate whether it is a future date.</td>
<td><div class="first last line-block">
<div class="line">&#64;Future</div>
<div class="line">private Date eventDate;</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;Past</span></code></td>
<td>Date, Calendar
(In case of Hibernate Validator implementation, it is also applicable to Joda-Time class)</td>
<td>Validate whether it is a past date.</td>
<td><div class="first last line-block">
<div class="line">&#64;Past</div>
<div class="line">private Date eventDate;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;Valid</span></code></td>
<td>Optional non-primitive type</td>
<td>Validate recursively for related objects.</td>
<td><div class="first last line-block">
<div class="line">&#64;Valid</div>
<div class="line">private List&lt;Employer&gt; employers;</div>
<div class="line"><br /></div>
<div class="line">&#64;Valid</div>
<div class="line">private Dept dept;</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><code class="docutils literal"><span class="pre">inclusive</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;DecimalMin</span></code> and <code class="docutils literal"><span class="pre">&#64;DecimalMax</span></code> annotation is,
an attribute added from Bean Validation 1.1.</p>
<p class="last">By specifying <code class="docutils literal"><span class="pre">true</span></code> (to allow same value of specified threshold) to the default value of <code class="docutils literal"><span class="pre">inclusive</span></code> attribute,
compatibility with Bean Validation 1.0 is maintained.</p>
</div>
</div>
<div class="section" id="hibernate-validator-check-rules">
<span id="validation-validator-list"></span><h4><a class="toc-backref" href="#id26">5.5.4.1.2. Hibernate Validator check rules</a><a class="headerlink" href="#hibernate-validator-check-rules" title="Permalink to this headline">Â¶</a></h4>
<p>All the major annotations of Hibernate Validator are shown below.</p>
<p>Refer to <a class="reference external" href="http://docs.jboss.org/hibernate/validator/5.1/reference/en-US/html/chapter-bean-constraints.html#validator-defineconstraints-hv-constraints">Hibernate Validator specifications</a> for details.</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Annotation(org.hibernate.validator.constraints.*)</th>
<th class="head">Target type</th>
<th class="head">Application</th>
<th class="head">Usage example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;CreditCardNumber</span></code></td>
<td>It is applicable to any CharSequence inherited class</td>
<td><div class="first last line-block">
<div class="line">Validate whether the credit card number is valid as per Luhn algorithm. It does not necessarily check whether the credit card number is available.</div>
<div class="line">By specifying <code class="docutils literal"><span class="pre">ignoreNonDigitCharacters</span> <span class="pre">=</span> <span class="pre">true</span></code>, it is possible to validate by ignoring non-numeric characters.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">&#64;CreditCardNumber</div>
<div class="line">private String cardNumber;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;Email</span></code></td>
<td>It is applicable to any CharSequence inherited class</td>
<td>Validate whether the Email address is complaint with RFC2822.</td>
<td><div class="first last line-block">
<div class="line">&#64;Email</div>
<div class="line">private String email;</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;URL</span></code></td>
<td>It is applicable to any CharSequence inherited class</td>
<td>Validate whether it is compliant with RFC2396.</td>
<td><div class="first last line-block">
<div class="line">&#64;URL</div>
<div class="line">private String url;</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&#64;NotBlank</span></code></td>
<td>It is applicable to any CharSequence inherited class</td>
<td>Validate that it is not Null, empty string (&#8220;&#8221;) and space only.</td>
<td><div class="first last line-block">
<div class="line">&#64;NotBlank</div>
<div class="line">private String userId;</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&#64;NotEmpty</span></code></td>
<td>It is applicable to Collection, Map, arrays, and any CharSequence inherited class</td>
<td><div class="first last line-block">
<div class="line">Validate that it is not Null or empty.</div>
<div class="line">&#64;NotEmpty should be used when check is to be done in &#64;NotNull + &#64;Min(1) combination.</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">&#64;NotEmpty</div>
<div class="line">private String password;</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>When following annotations provided by Hibernate Validator are used,
if a default message is used, a bug that the message is not generated correctly <a class="reference external" href="https://hibernate.atlassian.net/browse/HV-881">HV-881</a>, <a class="reference external" href="https://hibernate.atlassian.net/browse/HV-949">HV-949</a>) occurs.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">&#64;CreditCardNumber</span></code>(message is displayed, but WARN log is output)</li>
<li><code class="docutils literal"><span class="pre">&#64;LuhnCheck</span></code></li>
<li><code class="docutils literal"><span class="pre">&#64;Mod10Check</span></code></li>
<li><code class="docutils literal"><span class="pre">&#64;Mod11Check</span></code></li>
<li><code class="docutils literal"><span class="pre">&#64;ModCheck</span></code>(deprecated API from 5.1.0.Final)</li>
</ul>
<p>This bug occurs because of the flaws in message definitions provided by default,
and it is possible to avoid them by overwriting the default messages by an appropriate message.</p>
<p>In case of overwriting the default messages,
it is advisable to define an appropriate message
by creating <code class="file docutils literal"><span class="pre">ValidationMessages.properties</span></code> directly under the class path (normal src/main/resources).</p>
<p class="last">For appropriate message definition, refer to:
<a class="reference external" href="https://github.com/hibernate/hibernate-validator/commit/5a9d7bae26bccb15229ae5612d67506a7a775b48#diff-762e02c90cfb2f00b0b2788486e3fd5e">Modifications for Hibernate Validator 5.2 version (next minor version upgrade)</a>.</p>
</div>
</div>
</div>
<div class="section" id="default-messages-provided-by-hibernate-validator">
<span id="validation-default-message-in-hibernate-validator"></span><h3><a class="toc-backref" href="#id27">5.5.4.2. Default messages provided by Hibernate Validator</a><a class="headerlink" href="#default-messages-provided-by-hibernate-validator" title="Permalink to this headline">Â¶</a></h3>
<p>In hibernate-validator-&lt;version&gt;.jar, there is a ValidationMessages.properties file at org/hibernate/validator location, which contains the default messages of all Hibernate provided annotations.</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">javax.validation.constraints.AssertFalse.message</span> <span class="o">=</span> <span class="s">must be false</span>
<span class="na">javax.validation.constraints.AssertTrue.message</span>  <span class="o">=</span> <span class="s">must be true</span>
<span class="na">javax.validation.constraints.DecimalMax.message</span>  <span class="o">=</span> <span class="s">must be less than ${inclusive == true ? &#39;or equal to &#39; : &#39;&#39;}{value}</span>
<span class="na">javax.validation.constraints.DecimalMin.message</span>  <span class="o">=</span> <span class="s">must be greater than ${inclusive == true ? &#39;or equal to &#39; : &#39;&#39;}{value}</span>
<span class="na">javax.validation.constraints.Digits.message</span>      <span class="o">=</span> <span class="s">numeric value out of bounds (&lt;{integer} digits&gt;.&lt;{fraction} digits&gt; expected)</span>
<span class="na">javax.validation.constraints.Future.message</span>      <span class="o">=</span> <span class="s">must be in the future</span>
<span class="na">javax.validation.constraints.Max.message</span>         <span class="o">=</span> <span class="s">must be less than or equal to {value}</span>
<span class="na">javax.validation.constraints.Min.message</span>         <span class="o">=</span> <span class="s">must be greater than or equal to {value}</span>
<span class="na">javax.validation.constraints.NotNull.message</span>     <span class="o">=</span> <span class="s">may not be null</span>
<span class="na">javax.validation.constraints.Null.message</span>        <span class="o">=</span> <span class="s">must be null</span>
<span class="na">javax.validation.constraints.Past.message</span>        <span class="o">=</span> <span class="s">must be in the past</span>
<span class="na">javax.validation.constraints.Pattern.message</span>     <span class="o">=</span> <span class="s">must match &quot;{regexp}&quot;</span>
<span class="na">javax.validation.constraints.Size.message</span>        <span class="o">=</span> <span class="s">size must be between {min} and {max}</span>

<span class="na">org.hibernate.validator.constraints.CreditCardNumber.message</span>        <span class="o">=</span> <span class="s">invalid credit card number</span>
<span class="na">org.hibernate.validator.constraints.EAN.message</span>                     <span class="o">=</span> <span class="s">invalid {type} barcode</span>
<span class="na">org.hibernate.validator.constraints.Email.message</span>                   <span class="o">=</span> <span class="s">not a well-formed email address</span>
<span class="na">org.hibernate.validator.constraints.Length.message</span>                  <span class="o">=</span> <span class="s">length must be between {min} and {max}</span>
<span class="na">org.hibernate.validator.constraints.LuhnCheck.message</span>               <span class="o">=</span> <span class="s">The check digit for ${validatedValue} is invalid, Luhn Modulo 10 checksum failed</span>
<span class="na">org.hibernate.validator.constraints.Mod10Check.message</span>              <span class="o">=</span> <span class="s">The check digit for ${validatedValue} is invalid, Modulo 10 checksum failed</span>
<span class="na">org.hibernate.validator.constraints.Mod11Check.message</span>              <span class="o">=</span> <span class="s">The check digit for ${validatedValue} is invalid, Modulo 11 checksum failed</span>
<span class="na">org.hibernate.validator.constraints.ModCheck.message</span>                <span class="o">=</span> <span class="s">The check digit for ${validatedValue} is invalid, ${modType} checksum failed</span>
<span class="na">org.hibernate.validator.constraints.NotBlank.message</span>                <span class="o">=</span> <span class="s">may not be empty</span>
<span class="na">org.hibernate.validator.constraints.NotEmpty.message</span>                <span class="o">=</span> <span class="s">may not be empty</span>
<span class="na">org.hibernate.validator.constraints.ParametersScriptAssert.message</span>  <span class="o">=</span> <span class="s">script expression &quot;{script}&quot; didn&#39;t evaluate to true</span>
<span class="na">org.hibernate.validator.constraints.Range.message</span>                   <span class="o">=</span> <span class="s">must be between {min} and {max}</span>
<span class="na">org.hibernate.validator.constraints.SafeHtml.message</span>                <span class="o">=</span> <span class="s">may have unsafe html content</span>
<span class="na">org.hibernate.validator.constraints.ScriptAssert.message</span>            <span class="o">=</span> <span class="s">script expression &quot;{script}&quot; didn&#39;t evaluate to true</span>
<span class="na">org.hibernate.validator.constraints.URL.message</span>                     <span class="o">=</span> <span class="s">must be a valid URL</span>

<span class="na">org.hibernate.validator.constraints.br.CNPJ.message</span>                 <span class="o">=</span> <span class="s">invalid Brazilian corporate taxpayer registry number (CNPJ)</span>
<span class="na">org.hibernate.validator.constraints.br.CPF.message</span>                  <span class="o">=</span> <span class="s">invalid Brazilian individual taxpayer registry number (CPF)</span>
<span class="na">org.hibernate.validator.constraints.br.TituloEleitoral.message</span>      <span class="o">=</span> <span class="s">invalid Brazilian Voter ID card number</span>
</pre></div>
</div>
</div>
<div class="section" id="type-mismatch">
<h3><a class="toc-backref" href="#id28">5.5.4.3. Type mismatch</a><a class="headerlink" href="#type-mismatch" title="Permalink to this headline">Â¶</a></h3>
<p>Pertaining the non-String fields of the form object, if values which cannot be converted to the corresponding data-type have been submitted, <code class="docutils literal"><span class="pre">org.springframework.beans.TypeMismatchException</span></code> is thrown.</p>
<p>In the &#8220;New user registration&#8221; example, The data-type of &#8220;Age&#8221; is <code class="docutils literal"><span class="pre">Integer</span></code>. However, if the value entered in this field cannot be converted to an integer, error message is displayed as follows.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-typemismatch1.png"><img alt="../_images/validations-typemismatch1.png" src="../_images/validations-typemismatch1.png" style="width: 60%;" /></a>
</div>
<p>Cause of exception is displayed as it is and is not appropriate as an error message.
It is possible to define the error message for type mismatch in the properties file (application-messages.properties) which is read by <code class="docutils literal"><span class="pre">org.springframework.context.MessageSource</span></code>.</p>
<p>Error messages can be defined with the following rules.</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="40%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Message key</th>
<th class="head">Message contents</th>
<th class="head">Application</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">typeMismatch</span></code></td>
<td>Default message for all type mismatch errors</td>
<td>Default value for entire system</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">typeMismatch.[target</span> <span class="pre">FQCN]</span></code></td>
<td>Default message for specific type mismatch error</td>
<td>Default value for entire system</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">typeMismatch.[form</span> <span class="pre">attribute</span> <span class="pre">name].[property</span> <span class="pre">name]</span></code></td>
<td>Type mismatch error message for specific form field</td>
<td>Customized message for each screen</td>
</tr>
</tbody>
</table>
<p>When the following messages are added to application-messages.properties,</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="c"># typemismatch</span>
<span class="na">typeMismatch</span><span class="o">=</span><span class="s">&quot;{0}&quot; is invalid.</span>
<span class="na">typeMismatch.int</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be an integer.</span>
<span class="na">typeMismatch.double</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a double.</span>
<span class="na">typeMismatch.float</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a float.</span>
<span class="na">typeMismatch.long</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a long.</span>
<span class="na">typeMismatch.short</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a short.</span>
<span class="na">typeMismatch.java.lang.Integer</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be an integer.</span>
<span class="na">typeMismatch.java.lang.Double</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a double.</span>
<span class="na">typeMismatch.java.lang.Float</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a float.</span>
<span class="na">typeMismatch.java.lang.Long</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a long.</span>
<span class="na">typeMismatch.java.lang.Short</span><span class="o">=</span><span class="s">&quot;{0}&quot; must be a short.</span>
<span class="na">typeMismatch.java.util.Date</span><span class="o">=</span><span class="s">&quot;{0}&quot; is not a date.</span>

<span class="c"># field names</span>
<span class="na">name</span><span class="o">=</span><span class="s">Name</span>
<span class="na">email</span><span class="o">=</span><span class="s">Email</span>
<span class="na">age</span><span class="o">=</span><span class="s">Age</span>
</pre></div>
</div>
<p>Error message gets changed as shown below.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/validations-typemismatch2.png"><img alt="../_images/validations-typemismatch2.png" src="../_images/validations-typemismatch2.png" style="width: 60%;" /></a>
</div>
<div class="line-block">
<div class="line">Field name can be inserted in the message by specifying <code class="docutils literal"><span class="pre">{0}</span></code> in the message; This is as per the description in <a class="reference internal" href="#validation-message-in-application-messages"><span>Messages to be defined in application-messages.properties</span></a>.</div>
<div class="line"><strong>Default messages should be defined</strong>.</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Refer to <a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/javadoc-api/org/springframework/validation/DefaultMessageCodesResolver.html">Javadoc of DefaultMessageCodesResolver</a> for the details of message key rules.</p>
</div>
</div>
<div class="section" id="binding-null-to-blank-string-field">
<span id="validation-string-trimmer-editor"></span><h3><a class="toc-backref" href="#id29">5.5.4.4. Binding null to blank string field</a><a class="headerlink" href="#binding-null-to-blank-string-field" title="Permalink to this headline">Â¶</a></h3>
<p>When the form is sent with input fields left blank in Spring MVC,
empty string instead of <code class="docutils literal"><span class="pre">null</span></code> binds to form object by default.</p>
<p>In this case, the conditions like &#8220;blank is allowed but if specified, it must have at least 6 characters&#8221; is not satisfied by the use of existing annotations.</p>
<div class="line-block">
<div class="line">To bind <code class="docutils literal"><span class="pre">null</span></code> instead of empty string to the properties without any input,</div>
<div class="line"><code class="docutils literal"><span class="pre">org.springframework.beans.propertyeditors.StringTrimmerEditor</span></code> can be used as follows.</div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;xxx&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">XxxController</span> <span class="o">{</span>

    <span class="nd">@InitBinder</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinder</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// bind empty strings as null</span>
        <span class="n">binder</span><span class="o">.</span><span class="na">registerCustomEditor</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">StringTrimmerEditor</span><span class="o">(</span><span class="kc">true</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="c1">// omitted ...</span>
<span class="o">}</span>
</pre></div>
</div>
<p>With the help of this configuration, it can be specified in the controller whether empty strings which are to be considered as <code class="docutils literal"><span class="pre">null</span></code> or not.</p>
<p><a class="reference internal" href="../ImplementationAtEachLayer/ApplicationLayer.html#application-layer-controller-advice"><span>&#64;ControllerAdvice</span></a> can be set as a configuration common to the entire project when you want to set reply empty string to <code class="docutils literal"><span class="pre">null</span></code> in the entire project.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>About attribute of &#64;ControllerAdvice annotation added from Spring Framework 4.0</strong></p>
<p class="last">By specifying attribute of <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation,
it has been improved to allow flexibility in specifying Controller to apply a method implemented in a class wherein <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> is assigned.
For details about attribute refer to <a class="reference internal" href="../ImplementationAtEachLayer/ApplicationLayer.html#application-layer-controller-advice-attribute"><span>Attribute of &#64;ControllerAdvice</span></a>.</p>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@ControllerAdvice</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">XxxControllerAdvice</span> <span class="o">{</span>

    <span class="nd">@InitBinder</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinder</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// bind empty strings as null</span>
        <span class="n">binder</span><span class="o">.</span><span class="na">registerCustomEditor</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">StringTrimmerEditor</span><span class="o">(</span><span class="kc">true</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="c1">// omitted ...</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">When this setting is made, all empty String values set to String fields of form object become <code class="docutils literal"><span class="pre">null</span></code>.</div>
<div class="line">Therefore it must be noted that, it becomes necessary to specify <code class="docutils literal"><span class="pre">&#64;NotNull</span></code> in case of mandatory check.</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Logging.html" title="5.6. Logging"
             >next</a> |</li>
        <li class="right" >
          <a href="ExclusionControl.html" title="5.4. Exclusive Control"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.0.2.RELEASE documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >5. Architecture in Detail - TERASOLUNA Server Framework for Java (5.x)</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013-2016, NTT DATA.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.4.Theme by <a href="http://github.com/vkvn">vkvn</a>
    </div>
    
    <script>
    
    $(function() {
    	var $sidebar	= $('.sphinxsidebar'),
    		$window		= $(window),
    		offset		= $sidebar.offset(),
    		topPadding	= 3,
    		$scroll		= $('#scroll');
    	
    	$window.scroll(function() {
    		if ($scroll.is(':checked')) {
				if ($window.scrollTop() > offset.top) {
					$sidebar.stop().animate({
						marginTop:$window.scrollTop() - offset.top + topPadding
					});
				} else {
					$sidebar.stop().animate({
						marginTop:0
					});
				}
			}
		});
    	
    	var $navList = $('ul:first', $sidebar);
    	$('li:first', $navList).addClass('open');
    	
    	$navList.treeview({
    		persist: "location",
    		collapsed: true,
    		unique: false
    	});
    	
	});
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-46550814-1', 'terasolunaorg.github.io');
    ga('send', 'pageview');
    </script>
  </body>
</html>