<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4.4. Implementation of Application Layer &mdash; TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.0.2.RELEASE documentation</title>
    
    <link rel="stylesheet" href="../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.0.2.RELEASE',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.0.2.RELEASE documentation" href="../index.html" />
    <link rel="up" title="4. Application Development using TERASOLUNA Server Framework for Java (5.x)" href="index.html" />
    <link rel="next" title="5. Architecture in Detail - TERASOLUNA Server Framework for Java (5.x)" href="../ArchitectureInDetail/index.html" />
    <link rel="prev" title="4.3. Implementation of Infrastructure Layer" href="InfrastructureLayer.html" /><script src="../_static/jquery.treeview.js" type="text/javascript"></script>
<!-- <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'> -->
<link href="../_static/solarized-dark.css" rel="stylesheet">
<link href="../_static/jquery.treeview.css" rel="stylesheet">
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../ArchitectureInDetail/index.html" title="5. Architecture in Detail - TERASOLUNA Server Framework for Java (5.x)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="InfrastructureLayer.html" title="4.3. Implementation of Infrastructure Layer"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.0.2.RELEASE documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">4. Application Development using TERASOLUNA Server Framework for Java (5.x)</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><label><input id="scroll" type="checkbox" checked> scroll sidebar</label>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">4.4. Implementation of Application Layer</a><ul>
<li><a class="reference internal" href="#implementing-controller">4.4.1. Implementing Controller</a><ul>
<li><a class="reference internal" href="#creating-controller-class">4.4.1.1. Creating Controller class</a></li>
<li><a class="reference internal" href="#mapping-request-and-processing-method">4.4.1.2. Mapping request and processing method</a><ul>
<li><a class="reference internal" href="#mapping-with-request-path">4.4.1.2.1. Mapping with request path</a></li>
<li><a class="reference internal" href="#mapping-by-http-method">4.4.1.2.2. Mapping by HTTP method</a></li>
<li><a class="reference internal" href="#mapping-by-request-parameter">4.4.1.2.3. Mapping by request parameter</a></li>
<li><a class="reference internal" href="#mapping-using-request-header">4.4.1.2.4. Mapping using request header</a></li>
<li><a class="reference internal" href="#mapping-using-content-type-header">4.4.1.2.5. Mapping using Content-Type header</a></li>
<li><a class="reference internal" href="#mapping-using-accept-header">4.4.1.2.6. Mapping using Accept header</a></li>
</ul>
</li>
<li><a class="reference internal" href="#controller-mapping-policy-label">4.4.1.3. Mapping request and processing method</a><ul>
<li><a class="reference internal" href="#overview-of-sample-application">4.4.1.3.1. Overview of sample application</a></li>
<li><a class="reference internal" href="#request-url">4.4.1.3.2. Request URL</a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-mapping-design-label">4.4.1.3.3. Mapping request and processing method</a></li>
<li><a class="reference internal" href="#implementing-form-display">4.4.1.3.4. Implementing form display</a></li>
<li><a class="reference internal" href="#implementing-the-display-of-user-input-confirmation-screen">4.4.1.3.5. Implementing the display of user input confirmation screen</a></li>
<li><a class="reference internal" href="#implementing-redisplay-of-form">4.4.1.3.6. Implementing &#8216;redisplay of form&#8217;</a></li>
<li><a class="reference internal" href="#implementing-create-new-user-business-logic">4.4.1.3.7. Implementing &#8216;create new user&#8217; business logic</a></li>
<li><a class="reference internal" href="#implementing-notification-of-create-new-user-process-completion">4.4.1.3.8. Implementing notification of create new user process completion</a></li>
<li><a class="reference internal" href="#placing-multiple-buttons-on-html-form">4.4.1.3.9. Placing multiple buttons on HTML form</a></li>
<li><a class="reference internal" href="#source-code-of-controller-of-sample-application">4.4.1.3.10. Source code of controller of sample application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regarding-arguments-of-processing-method">4.4.1.4. Regarding arguments of processing method</a><ul>
<li><a class="reference internal" href="#passing-data-to-screen-view">4.4.1.4.1. Passing data to screen (View)</a></li>
<li><a class="reference internal" href="#retrieving-values-from-url-path">4.4.1.4.2. Retrieving values from URL path</a></li>
<li><a class="reference internal" href="#retrieving-request-parameters-individually">4.4.1.4.3. Retrieving request parameters individually</a></li>
<li><a class="reference internal" href="#retrieving-request-parameters-collectively">4.4.1.4.4. Retrieving request parameters collectively</a></li>
<li><a class="reference internal" href="#performing-input-validation">4.4.1.4.5. Performing input validation</a></li>
<li><a class="reference internal" href="#passing-data-while-redirecting-request">4.4.1.4.6. Passing data while redirecting request</a></li>
<li><a class="reference internal" href="#passing-request-parameters-to-redirect-destination">4.4.1.4.7. Passing request parameters to redirect destination</a></li>
<li><a class="reference internal" href="#inserting-values-in-redirect-destination-url-path">4.4.1.4.8. Inserting values in redirect destination URL path</a></li>
<li><a class="reference internal" href="#acquiring-values-from-cookie">4.4.1.4.9. Acquiring values from Cookie</a></li>
<li><a class="reference internal" href="#writing-values-in-cookie">4.4.1.4.10. Writing values in Cookie</a></li>
<li><a class="reference internal" href="#retrieving-pagination-information">4.4.1.4.11. Retrieving pagination information</a></li>
<li><a class="reference internal" href="#retrieving-uploaded-file">4.4.1.4.12. Retrieving uploaded file</a></li>
<li><a class="reference internal" href="#displaying-result-message-on-the-screen">4.4.1.4.13. Displaying result message on the screen</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regarding-return-value-of-processing-method">4.4.1.5. Regarding return value of processing method</a><ul>
<li><a class="reference internal" href="#html-response">4.4.1.5.1. HTML response</a></li>
<li><a class="reference internal" href="#responding-to-downloaded-data">4.4.1.5.2. Responding to downloaded data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-the-process">4.4.1.6. Implementing the process</a><ul>
<li><a class="reference internal" href="#correlation-check-of-input-value">4.4.1.6.1. Correlation check of input value</a></li>
<li><a class="reference internal" href="#calling-business-logic">4.4.1.6.2. Calling business logic</a></li>
<li><a class="reference internal" href="#reflecting-values-to-domain-object">4.4.1.6.3. Reflecting values to domain object</a></li>
<li><a class="reference internal" href="#reflecting-values-to-form-object">4.4.1.6.4. Reflecting values to form object</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-form-object">4.4.2. Implementing form object</a><ul>
<li><a class="reference internal" href="#creating-form-object">4.4.2.1. Creating form object</a><ul>
<li><a class="reference internal" href="#number-format-conversion-of-fields">4.4.2.1.1. Number format conversion of fields</a></li>
<li><a class="reference internal" href="#date-and-time-format-conversion-of-fields">4.4.2.1.2. Date and time format conversion of fields</a></li>
<li><a class="reference internal" href="#datatype-conversion-in-controller">4.4.2.1.3. DataType conversion in controller</a></li>
<li><a class="reference internal" href="#specifying-annotation-for-input-validation">4.4.2.1.4. Specifying annotation for input validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#initializing-form-object">4.4.2.2. Initializing form object</a></li>
<li><a class="reference internal" href="#binding-to-html-form">4.4.2.3. Binding to HTML form</a></li>
<li><a class="reference internal" href="#binding-request-parameters">4.4.2.4. Binding request parameters</a><ul>
<li><a class="reference internal" href="#determining-binding-result">4.4.2.4.1. Determining binding result</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-view">4.4.3. Implementing View</a><ul>
<li><a class="reference internal" href="#implementing-jsp">4.4.3.1. Implementing JSP</a><ul>
<li><a class="reference internal" href="#creating-common-jsp-for-include">4.4.3.1.1. Creating common JSP for include</a></li>
<li><a class="reference internal" href="#displaying-value-stored-in-model">4.4.3.1.2. Displaying value stored in model</a></li>
<li><a class="reference internal" href="#displaying-numbers-stored-in-model">4.4.3.1.3. Displaying numbers stored in model</a></li>
<li><a class="reference internal" href="#displaying-date-and-time-stored-in-model">4.4.3.1.4. Displaying date and time stored in model</a></li>
<li><a class="reference internal" href="#binding-form-object-to-html-form">4.4.3.1.5. Binding form object to HTML form</a></li>
<li><a class="reference internal" href="#displaying-input-validation-errors">4.4.3.1.6. Displaying input validation errors</a></li>
<li><a class="reference internal" href="#displaying-message-of-processing-result">4.4.3.1.7. Displaying message of processing result</a></li>
<li><a class="reference internal" href="#displaying-codelist">4.4.3.1.8. Displaying codelist</a></li>
<li><a class="reference internal" href="#displaying-fixed-text-content">4.4.3.1.9. Displaying fixed text content</a></li>
<li><a class="reference internal" href="#switching-display-according-to-conditions">4.4.3.1.10. Switching display according to conditions</a></li>
<li><a class="reference internal" href="#repeated-display-of-collection-elements">4.4.3.1.11. Repeated display of collection elements</a></li>
<li><a class="reference internal" href="#displaying-link-for-pagination">4.4.3.1.12. Displaying link for pagination</a></li>
<li><a class="reference internal" href="#switching-display-according-to-authority">4.4.3.1.13. Switching display according to authority</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-javascript">4.4.3.2. Implementing JavaScript</a></li>
<li><a class="reference internal" href="#implementing-style-sheet">4.4.3.3. Implementing style sheet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-common-logic">4.4.4. Implementing common logic</a><ul>
<li><a class="reference internal" href="#implementing-common-logic-to-be-executed-before-and-after-calling-controller">4.4.4.1. Implementing common logic to be executed before and after calling controller</a><ul>
<li><a class="reference internal" href="#implementing-servlet-filter">4.4.4.1.1. Implementing Servlet Filter</a></li>
<li><a class="reference internal" href="#implementing-handlerinterceptor">4.4.4.1.2. Implementing HandlerInterceptor</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-common-processes-of-controller">4.4.4.2. Implementing common processes of controller</a><ul>
<li><a class="reference internal" href="#implementing-handlermethodargumentresolver">4.4.4.2.1. Implementing HandlerMethodArgumentResolver</a></li>
<li><a class="reference internal" href="#implementing-controlleradvice">4.4.4.2.2. Implementing &#8220;&#64;ControllerAdvice&#8221;</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#prevention-of-double-submission">4.4.5. Prevention of double submission</a></li>
<li><a class="reference internal" href="#usage-of-session">4.4.6. Usage of session</a></li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="InfrastructureLayer.html"
                        title="previous chapter">4.3. Implementation of Infrastructure Layer</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../ArchitectureInDetail/index.html"
                        title="next chapter">5. Architecture in Detail - TERASOLUNA Server Framework for Java (5.x)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/ImplementationAtEachLayer/ApplicationLayer.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="implementation-of-application-layer">
<h1>4.4. Implementation of Application Layer<a class="headerlink" href="#implementation-of-application-layer" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="index">
<p class="topic-title first">Index</p>
<ul class="simple">
<li><a class="reference internal" href="#implementing-controller" id="id15">Implementing Controller</a><ul>
<li><a class="reference internal" href="#creating-controller-class" id="id16">Creating Controller class</a></li>
<li><a class="reference internal" href="#mapping-request-and-processing-method" id="id17">Mapping request and processing method</a><ul>
<li><a class="reference internal" href="#mapping-with-request-path" id="id18">Mapping with request path</a></li>
<li><a class="reference internal" href="#mapping-by-http-method" id="id19">Mapping by HTTP method</a></li>
<li><a class="reference internal" href="#mapping-by-request-parameter" id="id20">Mapping by request parameter</a></li>
<li><a class="reference internal" href="#mapping-using-request-header" id="id21">Mapping using request header</a></li>
<li><a class="reference internal" href="#mapping-using-content-type-header" id="id22">Mapping using Content-Type header</a></li>
<li><a class="reference internal" href="#mapping-using-accept-header" id="id23">Mapping using Accept header</a></li>
</ul>
</li>
<li><a class="reference internal" href="#controller-mapping-policy-label" id="id24">Mapping request and processing method</a><ul>
<li><a class="reference internal" href="#overview-of-sample-application" id="id25">Overview of sample application</a></li>
<li><a class="reference internal" href="#request-url" id="id26">Request URL</a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-mapping-design-label" id="id27">Mapping request and processing method</a></li>
<li><a class="reference internal" href="#implementing-form-display" id="id28">Implementing form display</a></li>
<li><a class="reference internal" href="#implementing-the-display-of-user-input-confirmation-screen" id="id29">Implementing the display of user input confirmation screen</a></li>
<li><a class="reference internal" href="#implementing-redisplay-of-form" id="id30">Implementing &#8216;redisplay of form&#8217;</a></li>
<li><a class="reference internal" href="#implementing-create-new-user-business-logic" id="id31">Implementing &#8216;create new user&#8217; business logic</a></li>
<li><a class="reference internal" href="#implementing-notification-of-create-new-user-process-completion" id="id32">Implementing notification of create new user process completion</a></li>
<li><a class="reference internal" href="#placing-multiple-buttons-on-html-form" id="id33">Placing multiple buttons on HTML form</a></li>
<li><a class="reference internal" href="#source-code-of-controller-of-sample-application" id="id34">Source code of controller of sample application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regarding-arguments-of-processing-method" id="id35">Regarding arguments of processing method</a><ul>
<li><a class="reference internal" href="#passing-data-to-screen-view" id="id36">Passing data to screen (View)</a></li>
<li><a class="reference internal" href="#retrieving-values-from-url-path" id="id37">Retrieving values from URL path</a></li>
<li><a class="reference internal" href="#retrieving-request-parameters-individually" id="id38">Retrieving request parameters individually</a></li>
<li><a class="reference internal" href="#retrieving-request-parameters-collectively" id="id39">Retrieving request parameters collectively</a></li>
<li><a class="reference internal" href="#performing-input-validation" id="id40">Performing input validation</a></li>
<li><a class="reference internal" href="#passing-data-while-redirecting-request" id="id41">Passing data while redirecting request</a></li>
<li><a class="reference internal" href="#passing-request-parameters-to-redirect-destination" id="id42">Passing request parameters to redirect destination</a></li>
<li><a class="reference internal" href="#inserting-values-in-redirect-destination-url-path" id="id43">Inserting values in redirect destination URL path</a></li>
<li><a class="reference internal" href="#acquiring-values-from-cookie" id="id44">Acquiring values from Cookie</a></li>
<li><a class="reference internal" href="#writing-values-in-cookie" id="id45">Writing values in Cookie</a></li>
<li><a class="reference internal" href="#retrieving-pagination-information" id="id46">Retrieving pagination information</a></li>
<li><a class="reference internal" href="#retrieving-uploaded-file" id="id47">Retrieving uploaded file</a></li>
<li><a class="reference internal" href="#displaying-result-message-on-the-screen" id="id48">Displaying result message on the screen</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regarding-return-value-of-processing-method" id="id49">Regarding return value of processing method</a><ul>
<li><a class="reference internal" href="#html-response" id="id50">HTML response</a></li>
<li><a class="reference internal" href="#responding-to-downloaded-data" id="id51">Responding to downloaded data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-the-process" id="id52">Implementing the process</a><ul>
<li><a class="reference internal" href="#correlation-check-of-input-value" id="id53">Correlation check of input value</a></li>
<li><a class="reference internal" href="#calling-business-logic" id="id54">Calling business logic</a></li>
<li><a class="reference internal" href="#reflecting-values-to-domain-object" id="id55">Reflecting values to domain object</a></li>
<li><a class="reference internal" href="#reflecting-values-to-form-object" id="id56">Reflecting values to form object</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-form-object" id="id57">Implementing form object</a><ul>
<li><a class="reference internal" href="#creating-form-object" id="id58">Creating form object</a><ul>
<li><a class="reference internal" href="#number-format-conversion-of-fields" id="id59">Number format conversion of fields</a></li>
<li><a class="reference internal" href="#date-and-time-format-conversion-of-fields" id="id60">Date and time format conversion of fields</a></li>
<li><a class="reference internal" href="#datatype-conversion-in-controller" id="id61">DataType conversion in controller</a></li>
<li><a class="reference internal" href="#specifying-annotation-for-input-validation" id="id62">Specifying annotation for input validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#initializing-form-object" id="id63">Initializing form object</a></li>
<li><a class="reference internal" href="#binding-to-html-form" id="id64">Binding to HTML form</a></li>
<li><a class="reference internal" href="#binding-request-parameters" id="id65">Binding request parameters</a><ul>
<li><a class="reference internal" href="#determining-binding-result" id="id66">Determining binding result</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-view" id="id67">Implementing View</a><ul>
<li><a class="reference internal" href="#implementing-jsp" id="id68">Implementing JSP</a><ul>
<li><a class="reference internal" href="#creating-common-jsp-for-include" id="id69">Creating common JSP for include</a></li>
<li><a class="reference internal" href="#displaying-value-stored-in-model" id="id70">Displaying value stored in model</a></li>
<li><a class="reference internal" href="#displaying-numbers-stored-in-model" id="id71">Displaying numbers stored in model</a></li>
<li><a class="reference internal" href="#displaying-date-and-time-stored-in-model" id="id72">Displaying date and time stored in model</a></li>
<li><a class="reference internal" href="#binding-form-object-to-html-form" id="id73">Binding form object to HTML form</a></li>
<li><a class="reference internal" href="#displaying-input-validation-errors" id="id74">Displaying input validation errors</a></li>
<li><a class="reference internal" href="#displaying-message-of-processing-result" id="id75">Displaying message of processing result</a></li>
<li><a class="reference internal" href="#displaying-codelist" id="id76">Displaying codelist</a></li>
<li><a class="reference internal" href="#displaying-fixed-text-content" id="id77">Displaying fixed text content</a></li>
<li><a class="reference internal" href="#switching-display-according-to-conditions" id="id78">Switching display according to conditions</a></li>
<li><a class="reference internal" href="#repeated-display-of-collection-elements" id="id79">Repeated display of collection elements</a></li>
<li><a class="reference internal" href="#displaying-link-for-pagination" id="id80">Displaying link for pagination</a></li>
<li><a class="reference internal" href="#switching-display-according-to-authority" id="id81">Switching display according to authority</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-javascript" id="id82">Implementing JavaScript</a></li>
<li><a class="reference internal" href="#implementing-style-sheet" id="id83">Implementing style sheet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-common-logic" id="id84">Implementing common logic</a><ul>
<li><a class="reference internal" href="#implementing-common-logic-to-be-executed-before-and-after-calling-controller" id="id85">Implementing common logic to be executed before and after calling controller</a><ul>
<li><a class="reference internal" href="#implementing-servlet-filter" id="id86">Implementing Servlet Filter</a></li>
<li><a class="reference internal" href="#implementing-handlerinterceptor" id="id87">Implementing HandlerInterceptor</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-common-processes-of-controller" id="id88">Implementing common processes of controller</a><ul>
<li><a class="reference internal" href="#implementing-handlermethodargumentresolver" id="id89">Implementing HandlerMethodArgumentResolver</a></li>
<li><a class="reference internal" href="#implementing-controlleradvice" id="id90">Implementing &#8220;&#64;ControllerAdvice&#8221;</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#prevention-of-double-submission" id="id91">Prevention of double submission</a></li>
<li><a class="reference internal" href="#usage-of-session" id="id92">Usage of session</a></li>
</ul>
</div>
<p>This chapter explains implementation of application layer of a web application that uses HTML forms.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Refer to the following page for the implementation required for Ajax development and REST API.</p>
<ul class="last simple">
<li><a class="reference internal" href="../ArchitectureInDetail/Ajax.html"><em>Ajax</em></a></li>
</ul>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Implementation of application layer is given in the following 3 steps.</p>
<ol class="arabic">
<li><div class="first line-block">
<div class="line"><a class="reference internal" href="#controller-label"><span>Implementing Controller</span></a></div>
<div class="line">Controller receives the request, calls business logic, updates model, decides View. Thereby, controls one complete round of operations after receiving the request.</div>
<div class="line">It is the most important part in the implementation of application layer.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><a class="reference internal" href="#formobject"><span>Implementing form object</span></a></div>
<div class="line">Form object transfers the values between HTML form and application.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><a class="reference internal" href="#view"><span>Implementing View</span></a></div>
<div class="line">View (JSP) acquires the data from model (form object, domain object etc.) and generates screen (HTML).</div>
</div>
</li>
</ol>
<div class="section" id="implementing-controller">
<span id="controller-label"></span><h2><a class="toc-backref" href="#id15">4.4.1. Implementing Controller</a><a class="headerlink" href="#implementing-controller" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">Implementation of Controller is explained below.</div>
<div class="line">The Controller performs the following roles.</div>
</div>
<ol class="arabic">
<li><div class="first line-block">
<div class="line"><strong>Provides a method to receive the request.</strong></div>
<div class="line">Receives requests by implementing methods to which <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation is assigned.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>Performs input validation of request parameter.</strong></div>
<div class="line">For request which requires input validation of request parameters, it can be  performed by specifying <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation to form object argument of method which receives the request.</div>
<div class="line">Perform single item check using Bean Validation and correlation check using Spring Validator or Bean Validation.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>Calls business logic.</strong></div>
<div class="line">Controller does not implement business logic but delegates by calling Service method.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>Reflects the output of business logic to Model.</strong></div>
<div class="line">The output can be referred in View by reflecting domain object returned from Service method to <code class="docutils literal"><span class="pre">Model</span></code>.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>Returns View name corresponding to business logic output.</strong></div>
<div class="line">Controller does not implement the logic of rendering the view. Rendering is done in View technologies like JSP etc.</div>
<div class="line">Controller only returns the name of the view in which the rendering logic is implemented.</div>
<div class="line">The View corresponding to view name is resolved by <code class="docutils literal"><span class="pre">ViewResolver</span></code> provided by Spring Framework.</div>
</div>
</li>
</ol>
<div class="figure align-center" id="id9">
<a class="reference internal image-reference" href="../_images/application_logic-of-controller.png"><img alt="responsibility of logic" src="../_images/application_logic-of-controller.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text"><strong>Picture - Logic of controller</strong></span></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>It is recommended that controller implements only the routing logic</strong> such as calling business logic, reflecting output of the business logic to <code class="docutils literal"><span class="pre">Model</span></code>, deciding the View name is implemented in the Controller.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The implementation of Controller is explained by focusing on the following points.</p>
<ul class="simple">
<li><a class="reference internal" href="#controller-new-label"><span>Creating Controller class</span></a></li>
<li><a class="reference internal" href="#controller-mapping-label"><span>Mapping request and processing method</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-label"><span>Regarding arguments of processing method</span></a></li>
<li><a class="reference internal" href="#controller-method-return-label"><span>Regarding return value of processing method</span></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="creating-controller-class">
<span id="controller-new-label"></span><h3><a class="toc-backref" href="#id16">4.4.1.1. Creating Controller class</a><a class="headerlink" href="#creating-controller-class" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><strong>Controller class is created with &#64;Controller annotation added to POJO class (Annotation-based Controller).</strong></div>
<div class="line">Controller in Spring MVC can also be created by implementing <code class="docutils literal"><span class="pre">org.springframework.web.servlet.mvc.Controller</span></code> interface (Interface-based Controller). However, it is preferred to avoid using it as it is Deprecated from Spring 3 onwards.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleController</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="mapping-request-and-processing-method">
<span id="controller-mapping-label"></span><h3><a class="toc-backref" href="#id17">4.4.1.2. Mapping request and processing method</a><a class="headerlink" href="#mapping-request-and-processing-method" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation is assigned to the method that receives request.</div>
<div class="line">In this document, the method to which <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> is added, is called as &#8220;processing method&#8221;.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The rules for mapping the incoming request with a processing method can be specifying as attributes of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Attribute name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>value</td>
<td><div class="first last line-block">
<div class="line">Specify request path which needs to be mapped (multiple values allowed).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>method</td>
<td><div class="first last line-block">
<div class="line">Specify HTTP method (<code class="docutils literal"><span class="pre">RequestMethod</span></code> type) which needs to be mapped (multiple methods allowed).</div>
<div class="line">GET/POST are mainly used for mapping requests from HTML form, while other HTTP methods (such as PUT/DELETE) are used for mapping requests from REST APIs as well.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>params</td>
<td><div class="first last line-block">
<div class="line">Specify request parameters which need to be mapped (multiple parameters allowed).</div>
<div class="line">Request parameters are mainly used for mapping request from HTML form. If this mapping method is used, the case of mapping multiple buttons on HTML page can be implemented easily.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="4">
<li></li>
</ol>
</td>
<td>headers</td>
<td><div class="first last line-block">
<div class="line">Specify request headers which need to be mapped (multiple headers allowed).</div>
<div class="line">Mainly used while mapping REST API and Ajax requests.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="5">
<li></li>
</ol>
</td>
<td>consumes</td>
<td><div class="first last line-block">
<div class="line">Mapping can be performed using Content-Type header of request. Specify media type which needs to be mapped (multiple types allowed).</div>
<div class="line">Mainly used while mapping REST API and Ajax requests.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="6">
<li></li>
</ol>
</td>
<td>produces</td>
<td><div class="first last line-block">
<div class="line">Mapping can be performed using Accept header of request. Specify media type which needs to be mapped (multiple types allowed).</div>
<div class="line">Mainly used while mapping REST API and Ajax requests.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Combination of mapping</strong></p>
<p class="last">Complex mapping can be performed by combining multiple attributes, but considering maintainability, mapping should be defined and designed in the simplest way possible .
It is recommended to consider combining 2 attributes (value attribute and any other 1 attribute).</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">6 examples of mapping are shown below.</div>
</div>
<ul class="simple">
<li><a class="reference internal" href="#controller-mapping-path-label"><span>Mapping with request path</span></a></li>
<li><a class="reference internal" href="#controller-mapping-method-label"><span>Mapping by HTTP method</span></a></li>
<li><a class="reference internal" href="#controller-mapping-params-label"><span>Mapping by request parameter</span></a></li>
<li><a class="reference internal" href="#controller-mapping-headers-label"><span>Mapping using request header</span></a></li>
<li><a class="reference internal" href="#controller-mapping-contenttype-label"><span>Mapping using Content-Type header</span></a></li>
<li><a class="reference internal" href="#controller-mapping-accept-label"><span>Mapping using Accept header</span></a></li>
</ul>
<div class="line-block">
<div class="line">In the following explanation, it is prerequisite to define the processing method in the Controller class.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@Controller</span> <span class="c1">// (1)</span>
</span><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;sample&quot;</span><span class="o">)</span> <span class="c1">// (2)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleController</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>With <code class="docutils literal"><span class="pre">&#64;Controller</span></code>, it is recognized as Annotation-based controller class and becomes the target of component scan.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>All the processing methods in this class are mapped to URLs with &#8220;sample&#8221; by adding <code class="docutils literal"><span class="pre">&#64;RequestMapping(&quot;sample&quot;)</span></code> annotation at class level.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="mapping-with-request-path">
<span id="controller-mapping-path-label"></span><h4><a class="toc-backref" href="#id18">4.4.1.2.1. Mapping with request path</a><a class="headerlink" href="#mapping-with-request-path" title="Permalink to this headline">¶</a></h4>
<p>In case of the following definition, if the URL <code class="docutils literal"><span class="pre">&quot;sample/hello&quot;</span></code> is accessed, then <code class="docutils literal"><span class="pre">hello()</span></code> method is executed.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">When multiple values are specified, it is handled by &#8216;OR&#8217; condition.</div>
<div class="line">In case of following definition, if <code class="docutils literal"><span class="pre">&quot;sample/hello&quot;</span></code> or <code class="docutils literal"><span class="pre">&quot;sample/bonjour&quot;</span></code> is accessed, then <code class="docutils literal"><span class="pre">hello()</span></code> method is executed.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="o">{</span><span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="s">&quot;bonjour&quot;</span><span class="o">})</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
</pre></div>
</div>
</div></blockquote>
<p>Pattern can be specified instead of a specific value for request path. For details of specifying patterns, refer to reference documentation of Spring Framework.</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-uri-templates">URI Template Patterns</a></li>
<li><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-uri-templates-regex">URI Template Patterns with Regular Expressions</a></li>
<li><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-patterns">Path Patterns</a></li>
<li><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-placeholders">Patterns with Placeholders</a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="mapping-by-http-method">
<span id="controller-mapping-method-label"></span><h4><a class="toc-backref" href="#id19">4.4.1.2.2. Mapping by HTTP method</a><a class="headerlink" href="#mapping-by-http-method" title="Permalink to this headline">¶</a></h4>
<p>In case of the following definition, if the URL <code class="docutils literal"><span class="pre">&quot;sample/hello&quot;</span></code> is accessed with POST method, then  <code class="docutils literal"><span class="pre">hello()</span></code> method is executed.
For the list of supported HTTP methods, refer to <a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/javadoc-api/org/springframework/web/bind/annotation/RequestMethod.html">Javadoc of RequestMethod</a>.
When not specified, all supported HTTP methods are mapped.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">When multiple values are specified, it is handled by &#8216;OR&#8217; condition.</div>
<div class="line">In case of following definition, if <code class="docutils literal"><span class="pre">&quot;sample/hello&quot;</span></code> is accessed with GET or HEAD method, then <code class="docutils literal"><span class="pre">hello()</span></code> method is executed.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="o">{</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">HEAD</span><span class="o">})</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="mapping-by-request-parameter">
<span id="controller-mapping-params-label"></span><h4><a class="toc-backref" href="#id20">4.4.1.2.3. Mapping by request parameter</a><a class="headerlink" href="#mapping-by-request-parameter" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">In case of following definition, if the URL <code class="docutils literal"><span class="pre">sample/hello?form</span></code> is accessed, then <code class="docutils literal"><span class="pre">hello()</span></code> method is executed.</div>
<div class="line">When request is sent as a POST request, request parameters may exist in request body even if they do not exist in URL.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">When multiple values are specified, it is handled by &#8216;AND&#8217; condition.</div>
<div class="line">In case of following definition, if the URL <code class="docutils literal"><span class="pre">&quot;sample/hello?form&amp;formType=foo&quot;</span></code> is accessed, then <code class="docutils literal"><span class="pre">hello()</span></code> method is executed.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="o">{</span><span class="s">&quot;form&quot;</span><span class="o">,</span> <span class="s">&quot;formType=foo&quot;</span><span class="o">})</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&quot;formType&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">formType</span><span class="o">)</span> <span class="o">{</span>
</pre></div>
</div>
</div></blockquote>
<p>Supported formats are as follows.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="25%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Format</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>paramName</td>
<td>Mapping is performed when request parameter of the specified parameName exists.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>!paramName</td>
<td>Mapping is performed when request parameter of the specified parameName does not exist.</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>paramName=paramValue</td>
<td>Mapping is performed when value of the specified parameName is paramValue.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="4">
<li></li>
</ol>
</td>
<td>paramName!=paramValue</td>
<td>Mapping is performed when value of the specified parameName is not paramValue.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="mapping-using-request-header">
<span id="controller-mapping-headers-label"></span><h4><a class="toc-backref" href="#id21">4.4.1.2.4. Mapping using request header</a><a class="headerlink" href="#mapping-using-request-header" title="Permalink to this headline">¶</a></h4>
<p>Refer to the details on the following page to mainly use the controller to map REST API and Ajax requests.</p>
<ul class="simple">
<li><a class="reference internal" href="../ArchitectureInDetail/Ajax.html"><em>Ajax</em></a></li>
</ul>
</div>
<div class="section" id="mapping-using-content-type-header">
<span id="controller-mapping-contenttype-label"></span><h4><a class="toc-backref" href="#id22">4.4.1.2.5. Mapping using Content-Type header</a><a class="headerlink" href="#mapping-using-content-type-header" title="Permalink to this headline">¶</a></h4>
<p>Refer to the details on the following page to mainly use the controller to map REST API and Ajax requests.</p>
<ul class="simple">
<li><a class="reference internal" href="../ArchitectureInDetail/Ajax.html"><em>Ajax</em></a></li>
</ul>
</div>
<div class="section" id="mapping-using-accept-header">
<span id="controller-mapping-accept-label"></span><h4><a class="toc-backref" href="#id23">4.4.1.2.6. Mapping using Accept header</a><a class="headerlink" href="#mapping-using-accept-header" title="Permalink to this headline">¶</a></h4>
<p>Refer to the details on the following page to mainly use the controller to map REST API and Ajax requests.</p>
<ul class="simple">
<li><a class="reference internal" href="../ArchitectureInDetail/Ajax.html"><em>Ajax</em></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="controller-mapping-policy-label">
<span id="id1"></span><h3><a class="toc-backref" href="#id24">4.4.1.3. Mapping request and processing method</a><a class="headerlink" href="#controller-mapping-policy-label" title="Permalink to this headline">¶</a></h3>
<p>Mapping by the following method is recommended.</p>
<ul>
<li><div class="first line-block">
<div class="line"><strong>Grouping of URL of request is done for each unit of business flow or functional flow.</strong></div>
<div class="line">URL grouping means defining <code class="docutils literal"><span class="pre">&#64;RequestMapping(value</span> <span class="pre">=</span> <span class="pre">&quot;xxx&quot;)</span></code> as class level annotation.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>Use the same URL for requests for screen transitions within same functional flow</strong></div>
<div class="line">The same URL means the value of &#8216;value&#8217; attribute of <code class="docutils literal"><span class="pre">&#64;RequestMapping(value</span> <span class="pre">=</span> <span class="pre">&quot;xxx&quot;)</span></code> must be same.</div>
<div class="line">Determining which processing method is used for a particular request with same functional flow is performed using HTTP method and HTTP parameters.</div>
</div>
</li>
</ul>
<p>The following is an example of mapping between incoming request and processing method by a sample application with basic screen flow.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-overview-label"><span>Overview of sample application</span></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-url-design-label"><span>Request URL</span></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-mapping-design-label"><span>Mapping request and processing method</span></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-form-impl-label"><span>Implementing form display</span></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-confirm-impl-label"><span>Implementing the display of user input confirmation screen</span></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-redo-impl-label"><span>Implementing &#8216;redisplay of form&#8217;</span></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-create-impl-label"><span>Implementing &#8216;create new user&#8217; business logic</span></a></li>
</ul>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="overview-of-sample-application">
<span id="controller-mapping-policy-sampleapp-overview-label"></span><h4><a class="toc-backref" href="#id25">4.4.1.3.1. Overview of sample application</a><a class="headerlink" href="#overview-of-sample-application" title="Permalink to this headline">¶</a></h4>
<p>Functional overview of sample application is as follows.</p>
<ul>
<li><div class="first line-block">
<div class="line">Provides functionality of performing CRUD operations of Entity.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">Following 5 operations are provided.</div>
</div>
</li>
</ul>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Operation name</th>
<th class="head">Overview</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>Fetching list of Entities</td>
<td>Fetch list of all the created Entities to be displayed on the list screen.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>Create Entity</td>
<td>Create a new Entity with the specified contents. Screen flow (form screen, confirmation screen, completion screen) exists for this process.</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>Fetching details of Entity</td>
<td>Fetch Entity of specified ID to be displayed on the details screen.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="4">
<li></li>
</ol>
</td>
<td>Entity update</td>
<td>Update Entity of specified ID. Screen flow (form screen, confirmation screen, completion screen) exists for this process.</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="5">
<li></li>
</ol>
</td>
<td>Entity delete</td>
<td>Delete Entity of specified ID.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<ul>
<li><div class="first line-block">
<div class="line">Screen flow of all functions is as follows.</div>
<div class="line">It is not mentioned in screen flow diagram however, when input validation error occurs, form screen is displayed again.</div>
</div>
</li>
</ul>
<div class="figure align-center" id="id10">
<a class="reference internal image-reference" href="../_images/application_sample-screen-flow.png"><img alt="Screen flow of entity management function" src="../_images/application_sample-screen-flow.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text"><strong>Picture - Screen flow of entity management function</strong></span></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="request-url">
<span id="controller-mapping-policy-sampleapp-url-design-label"></span><h4><a class="toc-backref" href="#id26">4.4.1.3.2. Request URL</a><a class="headerlink" href="#request-url" title="Permalink to this headline">¶</a></h4>
<p>Design the URL of the required requests.</p>
<ul>
<li><div class="first line-block">
<div class="line">Request URLs of all the requests required by the process flow are grouped.</div>
<div class="line">This functionality performs CRUD operations of Entity called ABC, therefore URL that starts with <code class="docutils literal"><span class="pre">&quot;/abc/&quot;</span></code> is considered.</div>
</div>
</li>
<li><p class="first">Design request URL for each operation of the functionality.</p>
</li>
</ul>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="30%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Operation name</th>
<th class="head">URL for each operation (pattern)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>Fetching list of Entities</td>
<td>/abc/list</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>Create Entity</td>
<td>/abc/create</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>Fetching details of Entity</td>
<td>/abc/{id}</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="4">
<li></li>
</ol>
</td>
<td>Entity update</td>
<td>/abc/{id}/update</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="5">
<li></li>
</ol>
</td>
<td>Entity delete</td>
<td>/abc/{id}/delete</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">&quot;{id}&quot;</span></code> specified in URL of &#8216;Fetching details of Entity&#8217;, &#8216;Entity update&#8217;, &#8216;Entity delete&#8217; operations is called as, <a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-uri-templates">URI Template Pattern</a> and any value can be specified.
In this sample application, Entity ID is specified.</p>
</div>
<p>Assigned URL of each operation of screen flow diagram is mapped as shown below:</p>
</div></blockquote>
<div class="figure align-center" id="id11">
<a class="reference internal image-reference" href="../_images/application_sample-screen-flow-assigned-url.png"><img alt="Screen flow of entity management function and corresponding assigned URL" src="../_images/application_sample-screen-flow-assigned-url.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text"><strong>Picture - Screen flow of entity management function and corresponding assigned URL</strong></span></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="controller-mapping-policy-sampleapp-mapping-design-label">
<span id="id2"></span><h4><a class="toc-backref" href="#id27">4.4.1.3.3. Mapping request and processing method</a><a class="headerlink" href="#controller-mapping-policy-sampleapp-mapping-design-label" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Design the mapping between incoming request and processing method.</div>
<div class="line">The following is the mapping design which is designed according to mapping policy.</div>
</div>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="20%" />
<col width="15%" />
<col width="22%" />
<col width="10%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Operation name</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">URL</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Request name</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">HTTP</div>
<div class="line">Method</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">HTTP</div>
<div class="line">Parameter</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Processing method</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>Fetching list of Entities</td>
<td>/abc/list</td>
<td>List display</td>
<td>GET</td>
<td>-</td>
<td>list</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>Create New Entity</td>
<td>/abc/create</td>
<td>Form display</td>
<td>-</td>
<td>form</td>
<td>createForm</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Displaying input confirmation</td>
<td>POST</td>
<td>confirm</td>
<td>createConfirm</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="4">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Form re-display</td>
<td>POST</td>
<td>redo</td>
<td>createRedo</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="5">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Entity Creation</td>
<td>POST</td>
<td>-</td>
<td>create</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="6">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Displaying completion of Entity Creation</td>
<td>GET</td>
<td>complete</td>
<td>createComplete</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="7">
<li></li>
</ol>
</td>
<td>Fetching details of Entity</td>
<td>/abc/{id}</td>
<td>Display details of Entity</td>
<td>GET</td>
<td>-</td>
<td>read</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="8">
<li></li>
</ol>
</td>
<td>Entity update</td>
<td>/abc/{id}/update</td>
<td>Displaying Form</td>
<td>-</td>
<td>form</td>
<td>updateForm</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="9">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Displaying confirmation of user input</td>
<td>POST</td>
<td>confirm</td>
<td>updateConfirm</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="10">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Form re-display</td>
<td>POST</td>
<td>redo</td>
<td>updateRedo</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="11">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Update</td>
<td>POST</td>
<td>-</td>
<td>update</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="12">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Displaying completion of update process</td>
<td>GET</td>
<td>complete</td>
<td>updateComplete</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="13">
<li></li>
</ol>
</td>
<td>Entity delete</td>
<td>/abc/{id}/delete</td>
<td>Delete</td>
<td>POST</td>
<td>-</td>
<td>delete</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="14">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Displaying completion of delete process</td>
<td>GET</td>
<td>complete</td>
<td>deleteComplete</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line">Multiple requests exist for each of Create Entity, Entity Update and Entity Delete functions. Therefore switching of processing methods is done using HTTP method and HTTP parameters.</div>
<div class="line">The following is the flow of requests in case of multiple requests in a function like &#8220;Create New Entity&#8221;.</div>
<div class="line">All URLs are <code class="docutils literal"><span class="pre">&quot;/abc/create&quot;</span></code> and determining the processing method is done based on combination of HTTP method and HTTP parameters.</div>
</div>
<div class="figure align-center" id="id12">
<a class="reference internal image-reference" href="../_images/applicationScreenflow.png"><img alt="Request flow of entity create processing" src="../_images/applicationScreenflow.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text"><strong>Picture - Request flow of entity create processing</strong></span></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Implementation of processing method for &#8220;Create New Entity&#8221; is shown below.</div>
<div class="line">Here, the purpose is to understand mapping between request and processing method and therefore focus must on <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code>.</div>
<div class="line">The details of argument and return value (view name and view) of processing method are explained in the next chapter.</div>
</div>
<ul class="simple">
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-form-impl-label"><span>Implementing form display</span></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-confirm-impl-label"><span>Implementing the display of user input confirmation screen</span></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-redo-impl-label"><span>Implementing &#8216;redisplay of form&#8217;</span></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-create-impl-label"><span>Implementing &#8216;create new user&#8217; business logic</span></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-complete-impl-label"><span>Implementing notification of create new user process completion</span></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-multi-impl-label"><span>Placing multiple buttons on HTML form</span></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-form-display">
<span id="controller-mapping-policy-sampleapp-form-impl-label"></span><h4><a class="toc-backref" href="#id28">4.4.1.3.4. Implementing form display</a><a class="headerlink" href="#implementing-form-display" title="Permalink to this headline">¶</a></h4>
<p>In order to display the form, <code class="docutils literal"><span class="pre">form</span></code> is specified as HTTP parameter.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">createForm</span><span class="o">(</span><span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// omitted</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;abc/createForm&quot;</span><span class="o">;</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify <code class="docutils literal"><span class="pre">&quot;form&quot;</span></code> as value of <code class="docutils literal"><span class="pre">params</span></code> attribute.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Return view name of JSP to render form screen.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this processing method, <code class="docutils literal"><span class="pre">method</span></code> attribute is not specified since it is not required for HTTP GET method.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Example of implementation of sections other than processing method is explained below.</p>
<p>Besides implementing the processing method for form display, points mentioned below are required:</p>
<ul class="simple">
<li>Implement generation process of form object. Refer to <a class="reference internal" href="#formobject"><span>Implementing form object</span></a> for the details of form object.</li>
<li>Implement View of form screen. Refer to <a class="reference internal" href="#view"><span>Implementing View</span></a> for the details of View.</li>
</ul>
<p>Use the following form object.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AbcForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="nd">@NotEmpty</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">input1</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Min</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="nd">@Max</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">input2</span><span class="o">;</span>

    <span class="c1">// omitted setter&amp;getter</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Creating an object of AbcForm.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@ModelAttribute</span>
<span class="kd">public</span> <span class="n">AbcForm</span> <span class="nf">setUpAbcForm</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">AbcForm</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Create view(JSP) of form screen.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>Abc Create Form<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;abcForm&quot;</span>
  <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/abc/create&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;input1&quot;</span><span class="nt">&gt;</span>Input1<span class="nt">&lt;/form:label&gt;</span>
  <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;input1&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;input1&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;br&gt;</span>
  <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;input2&quot;</span><span class="nt">&gt;</span>Input2<span class="nt">&lt;/form:label&gt;</span>
  <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;input2&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;input2&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;br&gt;</span>
<span class="hll">  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span> <span class="na">value=</span><span class="s">&quot;Confirm&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify  <code class="docutils literal"><span class="pre">name=&quot;confirm&quot;</span></code> parameter for submit button to transit to confirmation screen.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The operations are explained below.</p>
<div class="line-block">
<div class="line">Sending the request for form display.</div>
<div class="line">Access <code class="docutils literal"><span class="pre">&quot;abc/create?form&quot;</span></code> URL.</div>
<div class="line">Since <code class="docutils literal"><span class="pre">form</span></code> is specified in the URL as an HTTP parameter, <code class="docutils literal"><span class="pre">createForm</span></code> method of controller is called and form screen is displayed.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateFormDisplay.png"><img alt="../_images/applicationCreateFormDisplay.png" src="../_images/applicationCreateFormDisplay.png" style="width: 90%;" /></a>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-the-display-of-user-input-confirmation-screen">
<span id="controller-mapping-policy-sampleapp-confirm-impl-label"></span><h4><a class="toc-backref" href="#id29">4.4.1.3.5. Implementing the display of user input confirmation screen</a><a class="headerlink" href="#implementing-the-display-of-user-input-confirmation-screen" title="Permalink to this headline">¶</a></h4>
<p>To check user input in the form, data is sent by POST method and <code class="docutils literal"><span class="pre">confirm</span></code> is specified as HTTP parameter.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirm</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span>
        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
<span class="hll">        <span class="k">return</span> <span class="n">createRedo</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">model</span><span class="o">);</span> <span class="c1">// return &quot;abc/createForm&quot;; (2)</span>
</span>    <span class="o">}</span>
    <span class="c1">// omitted</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;abc/createConfirm&quot;</span><span class="o">;</span> <span class="c1">// (3)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify &#8220;RequestMethod.POST&#8221; in <code class="docutils literal"><span class="pre">method</span></code> attribute and &#8220;confirm&#8221; in <code class="docutils literal"><span class="pre">params</span></code> attribute.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>In case of input validation errors, it is recommended to call the processing method of form re-display.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Return view-name of JSP to render the screen for user input confirmation.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">POST method is specified to prevent displaying confidential information such as password and other personal information etc. in the address bar.
(Needless to say that these security measures not sufficient and needs more secure measures such as SSL etc.)</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Example of implementation of sections other than processing method is explained below.</p>
<p>Besides implementing processing method for user input confirmation screen, points mentioned below are required.</p>
<ul class="simple">
<li>Implement view of user-input confirmation screen. Refer to <a class="reference internal" href="#view"><span>Implementing View</span></a> for the details of view.</li>
</ul>
<p>Create  the view (JSP) for user input confirmation screen.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>Abc Create Form<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;abcForm&quot;</span>
  <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/abc/create&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;input1&quot;</span><span class="nt">&gt;</span>Input1<span class="nt">&lt;/form:label&gt;</span>
  ${f:h(abcForm.input1)}
<span class="hll">  <span class="nt">&lt;form:hidden</span> <span class="na">path=</span><span class="s">&quot;input1&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span>  <span class="nt">&lt;br&gt;</span>
  <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;input2&quot;</span><span class="nt">&gt;</span>Input2<span class="nt">&lt;/form:label&gt;</span>
  ${f:h(abcForm.input2)}
<span class="hll">  <span class="nt">&lt;form:hidden</span> <span class="na">path=</span><span class="s">&quot;input2&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span>  <span class="nt">&lt;br&gt;</span>
<span class="hll">  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">name=</span><span class="s">&quot;redo&quot;</span> <span class="na">value=</span><span class="s">&quot;Back&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Create&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
</span><span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>The values entered on form screen is set as the hidden fields of HTML form since they must be sent back to the server when Create or Back buttons are clicked.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Specify <code class="docutils literal"><span class="pre">name=&quot;redo&quot;</span></code> parameter for submit button to return to form screen.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Parameter name need not be specified for submit button. Submit button will do the actual create operation.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the above example, HTML escaping is performed as an XSS countermeasure using <code class="docutils literal"><span class="pre">f:h()</span></code> function while displaying the user input values.
For details, refer to <a class="reference internal" href="../Security/XSS.html"><em>Cross Site Scripting</em></a>.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The operations are explained below.</p>
<div class="line-block">
<div class="line">Send the request for displaying user input confirmation.</div>
<div class="line">Enter <code class="docutils literal"><span class="pre">&quot;aa&quot;</span></code> in Input1 and <code class="docutils literal"><span class="pre">&quot;5&quot;</span></code> in Input2 and click Confirm button on form screen.</div>
<div class="line">After clicking Confirm button, <code class="docutils literal"><span class="pre">&quot;abc/create?confirm&quot;</span></code> URI gets accessed using POST method.</div>
<div class="line">Since HTTP parameter <code class="docutils literal"><span class="pre">confirm</span></code> is present in the URI, <code class="docutils literal"><span class="pre">createConfirm</span></code> method of controller is called and user input confirmation screen is displayed.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateConfirmDisplay.png"><img alt="../_images/applicationCreateConfirmDisplay.png" src="../_images/applicationCreateConfirmDisplay.png" style="width: 90%;" /></a>
</div>
</div></blockquote>
<p>Since HTTP parameters are sent across through HTTP POST method after clicking the Confirm button, it does not appear in URI. However, &#8220;confirm&#8221; is included as HTTP parameter.</p>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateConfirmNetwork.png"><img alt="../_images/applicationCreateConfirmNetwork.png" src="../_images/applicationCreateConfirmNetwork.png" style="width: 90%;" /></a>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-redisplay-of-form">
<span id="controller-mapping-policy-sampleapp-redo-impl-label"></span><h4><a class="toc-backref" href="#id30">4.4.1.3.6. Implementing &#8216;redisplay of form&#8217;</a><a class="headerlink" href="#implementing-redisplay-of-form" title="Permalink to this headline">¶</a></h4>
<p>&#8220;redo&#8221; is specified as HTTP parameter to indicate that form needs to be redisplayed.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;redo&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">createRedo</span><span class="o">(</span><span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// omitted</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;abc/createForm&quot;</span><span class="o">;</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify &#8220;RequestMethod.POST&#8221; in <code class="docutils literal"><span class="pre">method</span></code> attribute and &#8220;redo&#8221; in <code class="docutils literal"><span class="pre">params</span></code> attribute.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Return view name of JSP to render the form screen.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Operation is described below.</p>
<div class="line-block">
<div class="line">Send the request to redisplay the form screen.</div>
<div class="line">Click Back button on user input confirmation screen.</div>
<div class="line">When Back button is clicked, &#8220;abc/create?redo&#8221; URI gets accessed through HTTP POST method.</div>
<div class="line">Since &#8220;redo&#8221; HTTP parameter is present in the URI, <code class="docutils literal"><span class="pre">createRedo</span></code> method of controller is invoked and form screen is redisplayed.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateConfirmDisplay.png"><img alt="../_images/applicationCreateConfirmDisplay.png" src="../_images/applicationCreateConfirmDisplay.png" style="width: 90%;" /></a>
</div>
</div></blockquote>
<p>Since HTTP parameters are sent across through HTTP POST method after clicking the Back button, it does not appear in URI. However, &#8220;redo&#8221; is included as HTTP parameter.
Moreover, since input values of form had been sent as hidden fields, input values can be restored on redisplayed form screen.</p>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationBackToCreateFormDisplay.png"><img alt="../_images/applicationBackToCreateFormDisplay.png" src="../_images/applicationBackToCreateFormDisplay.png" style="width: 90%;" /></a>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../_images/applicationBackToCreateFormNetwork.png"><img alt="../_images/applicationBackToCreateFormNetwork.png" src="../_images/applicationBackToCreateFormNetwork.png" style="width: 90%;" /></a>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In order to implement back button functionality, setting <code class="docutils literal"><span class="pre">onclick=&quot;javascript:history.back()&quot;</span></code> is also one of the ways.
Both the methods differ in the following ways. Appropriate method must be selected as per requirement.</p>
<ul class="last simple">
<li>Behavior when &#8220;Back button on browser&#8221; is clicked.</li>
<li>Behavior when page having Back button is accessed and Back button is clicked.</li>
<li>History of browser</li>
</ul>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-create-new-user-business-logic">
<span id="controller-mapping-policy-sampleapp-create-impl-label"></span><h4><a class="toc-backref" href="#id31">4.4.1.3.7. Implementing &#8216;create new user&#8217; business logic</a><a class="headerlink" href="#implementing-create-new-user-business-logic" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">To register input contents of form, the data (hidden parameters) to be registered is sent with HTTP POST method.</div>
<div class="line">Sorting is not carried out using HTTP parameters since new request will be the main request of this operation.</div>
<div class="line">Since the state of database changes in this process, it should not be executed multiple times due to double submission.</div>
<div class="line">Therefore, it is &#8216;redirected&#8217; to the next screen (create complete screen) instead of directly displaying View (screen) after</div>
<div class="line">completing this process. This pattern is called as POST-Redirect-GET(PRG) pattern. For the details of <abbr title="Post-Redirect-Get">PRG</abbr> pattern</div>
<div class="line">refer to <a class="reference internal" href="../ArchitectureInDetail/DoubleSubmitProtection.html"><em>Double Submit Protection</em></a> .</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">create</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">createRedo</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">model</span><span class="o">);</span> <span class="c1">// return &quot;abc/createForm&quot;;</span>
    <span class="o">}</span>
    <span class="c1">// omitted</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;redirect:/abc/create?complete&quot;</span><span class="o">;</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify <code class="docutils literal"><span class="pre">RequestMethod.POST</span></code> in <code class="docutils literal"><span class="pre">method</span></code> attribute. Do not specify <code class="docutils literal"><span class="pre">params</span></code> attribute.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Return URL to the request needs to be redirected as view name in order to use <abbr title="Post-Redirect-Get">PRG</abbr>  pattern.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It can be redirected to &#8220;/xxx&#8221; by returning &#8220;redirect:/xxx&#8221; as view name.</p>
</div>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">PRG pattern is used to avoid double submission when the browser gets reloaded by clicking F5 button. However, as a countermeasure for double submission,
it is necessary to use TransactionTokenCheck functionality.
For details of TransactionTokenCheck, refer to <a class="reference internal" href="../ArchitectureInDetail/DoubleSubmitProtection.html"><em>Double Submit Protection</em></a> .</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Operation is described below.</p>
<div class="line-block">
<div class="line">Click &#8216;Create&#8217; button on input confirmation screen.</div>
<div class="line">After clicking &#8216;Create&#8217; button,  <code class="docutils literal"><span class="pre">&quot;abc/create&quot;</span></code> URL is accessed through POST method.</div>
<div class="line">Since HTTP parameters are not sent for identifying a button, it is considered as main request of Entity create process and &#8216;create&#8217; method of Controller is invoked.</div>
</div>
<div class="line-block">
<div class="line">&#8216;Create&#8217; request does not return to the screen directly, but it is redirected to create complete display (<code class="docutils literal"><span class="pre">&quot;/abc/create?complete&quot;</span></code>). Hence HTTP status is changed to 302.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateNetwork.png"><img alt="../_images/applicationCreateNetwork.png" src="../_images/applicationCreateNetwork.png" style="width: 90%;" /></a>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-notification-of-create-new-user-process-completion">
<span id="controller-mapping-policy-sampleapp-complete-impl-label"></span><h4><a class="toc-backref" href="#id32">4.4.1.3.8. Implementing notification of create new user process completion</a><a class="headerlink" href="#implementing-notification-of-create-new-user-process-completion" title="Permalink to this headline">¶</a></h4>
<p>In order to notify the completion of create process, <code class="docutils literal"><span class="pre">complete</span></code> must be present in the request as HTTP parameter.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;complete&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">createComplete</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// omitted</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;abc/createComplete&quot;</span><span class="o">;</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify <code class="docutils literal"><span class="pre">&quot;complete&quot;</span></code> in <code class="docutils literal"><span class="pre">params</span></code> attribute.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Return View name of JSP to render the create completion screen.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this processing method, <code class="docutils literal"><span class="pre">method</span></code> attribute is not specified since it is not required for HTTP GET method.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Operation is described below.</p>
<div class="line-block">
<div class="line">After completing creation of user, access URI (<code class="docutils literal"><span class="pre">&quot;/abc/create?complete&quot;</span></code>) is specified as redirect destination.</div>
<div class="line">Since HTTP parameter is <code class="docutils literal"><span class="pre">complete</span></code>, createComplete() method of controller is called and create completion screen is displayed.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateCompleteDisplay.png"><img alt="../_images/applicationCreateCompleteDisplay.png" src="../_images/applicationCreateCompleteDisplay.png" style="width: 90%;" /></a>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateCompleteNetwork.png"><img alt="../_images/applicationCreateCompleteNetwork.png" src="../_images/applicationCreateCompleteNetwork.png" style="width: 90%;" /></a>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since PRG pattern is used, even if browser is reloaded, create completion screen is only re-displayed without re-executing create process.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="placing-multiple-buttons-on-html-form">
<span id="controller-mapping-policy-sampleapp-multi-impl-label"></span><h4><a class="toc-backref" href="#id33">4.4.1.3.9. Placing multiple buttons on HTML form</a><a class="headerlink" href="#placing-multiple-buttons-on-html-form" title="Permalink to this headline">¶</a></h4>
<p>To place multiple buttons on a single form, send HTTP parameter to identify the corresponding button and so that the processing method of controller can be switched.
An example of Create button and Back button on input confirmation screen of sample application is explained here.</p>
<p>&#8216;Create&#8217; button to perform &#8216;user creation&#8217; and &#8216;Back&#8217; button to redisplay &#8216;create form&#8217; exists on the form of input confirmation screen as shown below.</p>
<div class="figure align-center" id="id13">
<a class="reference internal image-reference" href="../_images/applicationControllerBackToForm.png"><img alt="Multiple button in the HTML form" src="../_images/applicationControllerBackToForm.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text"><strong>Picture - Multiple button in the HTML form</strong></span></p>
</div>
<p>To redisplay &#8216;create form&#8217; using request ( <code class="docutils literal"><span class="pre">&quot;/abc/create?redo&quot;</span></code> ) when Back button is clicked,
the following code is required in HTML form.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">name=</span><span class="s">&quot;redo&quot;</span> <span class="na">value=</span><span class="s">&quot;Back&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Create&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>In input confirmation screen ( <code class="docutils literal"><span class="pre">&quot;abc/createConfirm.jsp&quot;</span></code> ), specify <code class="docutils literal"><span class="pre">name=&quot;redo&quot;</span></code> parameter for Back button.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>For the operations when Back button is clicked, refer to <a class="reference internal" href="#controller-mapping-policy-sampleapp-redo-impl-label"><span>Implementing &#8216;redisplay of form&#8217;</span></a>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="source-code-of-controller-of-sample-application">
<span id="controller-mapping-policy-sampleapp-all-impl-label"></span><h4><a class="toc-backref" href="#id34">4.4.1.3.10. Source code of controller of sample application</a><a class="headerlink" href="#source-code-of-controller-of-sample-application" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Source-code of controller after implementing create process of sample application are shown below.</div>
<div class="line">Fetching list of Entities, Fetching detail of Entity, Entity update, Entity delete are implemented using the same guidelines.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;abc&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AbcController</span> <span class="o">{</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">AbcForm</span> <span class="nf">setUpAbcForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">AbcForm</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">// Handling request of &quot;/abc/create?form&quot;</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createForm</span><span class="o">(</span><span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// omitted</span>
        <span class="k">return</span> <span class="s">&quot;abc/createForm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// Handling request of &quot;POST /abc/create?confirm&quot;</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirm</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span>
            <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">createRedo</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">model</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// omitted</span>
        <span class="k">return</span> <span class="s">&quot;abc/createConfirm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// Handling request of &quot;POST /abc/create?redo&quot;</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;redo&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createRedo</span><span class="o">(</span><span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// omitted</span>
        <span class="k">return</span> <span class="s">&quot;abc/createForm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// Handling request of &quot;POST /abc/create&quot;</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">create</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">createRedo</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">model</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// omitted</span>
        <span class="k">return</span> <span class="s">&quot;redirect:/abc/create?complete&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// Handling request of &quot;/abc/create?complete&quot;</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;complete&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createComplete</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// omitted</span>
        <span class="k">return</span> <span class="s">&quot;abc/createComplete&quot;</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="regarding-arguments-of-processing-method">
<span id="controller-method-argument-label"></span><h3><a class="toc-backref" href="#id35">4.4.1.4. Regarding arguments of processing method</a><a class="headerlink" href="#regarding-arguments-of-processing-method" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/mvc.html#mvc-ann-arguments">The arguments of processing method can be used to fetch various values</a>;
however, as a principle rule, the following should not be fetched using arguments of processing method of controller.</p>
<ul class="simple">
<li>ServletRequest</li>
<li>HttpServletRequest</li>
<li>org.springframework.web.context.request.WebRequest</li>
<li>org.springframework.web.context.request.NativeWebRequest</li>
<li>java.io.InputStream</li>
<li>java.io.Reader</li>
<li>java.io.OutputStream</li>
<li>java.io.Writer</li>
<li>java.util.Map</li>
<li>org.springframework.ui.ModelMap</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When generalized values like HttpServletRequest, getAttribute/setAttribute of HttpSession and get/put of Map are allowed, liberal use of these can degrade the maintainability of
the project with an increase in project size.</p>
<p class="last">When common parameters (request parameters) need to be stored in JavaBean and passed as an argument to a method of controller,
it can be implemented using <a class="reference internal" href="#methodargumentresolver"><span>Implementing HandlerMethodArgumentResolver</span></a> as described later.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Arguments depending on the purpose of usage are described below.</p>
<ul class="simple">
<li><a class="reference internal" href="#controller-method-argument-model-label"><span>Passing data to screen (View)</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-pathvariable-label"><span>Retrieving values from URL path</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-requestparam-label"><span>Retrieving request parameters individually</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-form-label"><span>Retrieving request parameters collectively</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-validation-label"><span>Performing input validation</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-redirectattributes-label"><span>Passing data while redirecting request</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-redirectattributes-param-label"><span>Passing request parameters to redirect destination</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-redirectattributes-path-label"><span>Inserting values in redirect destination URL path</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-cookievalue-label"><span>Acquiring values from Cookie</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-cookiewrite-label"><span>Writing values in Cookie</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-pagination-label"><span>Retrieving pagination information</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-upload-label"><span>Retrieving uploaded file</span></a></li>
<li><a class="reference internal" href="#controller-method-argument-message-label"><span>Displaying result message on the screen</span></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="passing-data-to-screen-view">
<span id="controller-method-argument-model-label"></span><h4><a class="toc-backref" href="#id36">4.4.1.4.1. Passing data to screen (View)</a><a class="headerlink" href="#passing-data-to-screen-view" title="Permalink to this headline">¶</a></h4>
<p>To pass data to be displayed on screen (View), fetch <code class="docutils literal"><span class="pre">org.springframework.ui.Model</span></code> (Hereafter called as <code class="docutils literal"><span class="pre">Model</span></code>) as argument of processing method and
add the data (Object) to <code class="docutils literal"><span class="pre">Model</span></code> object.</p>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span><span class="hll">    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="s">&quot;Hello World!&quot;</span><span class="o">);</span> <span class="c1">// (2)</span>
</span><span class="hll">    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">HelloBean</span><span class="o">(</span><span class="s">&quot;Bean Hello World!&quot;</span><span class="o">));</span> <span class="c1">// (3)</span>
</span>    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>hello.jsp</li>
</ul>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll">Message : ${f:h(hello)}<span class="nt">&lt;br&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">4</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">Message : ${f:h(helloBean.message)}<span class="nt">&lt;br&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">5</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>HTML of created by View(hello.jsp)</li>
</ul>
<blockquote>
<div><div class="highlight-html"><div class="highlight"><pre><span class="hll">Message : Hello World!<span class="nt">&lt;br&gt;</span> <span class="c">&lt;!-- (6) --&gt;</span>
</span><span class="hll">Message : Bean Hello World!<span class="nt">&lt;br&gt;</span> <span class="c">&lt;!-- (6) --&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Fetch <code class="docutils literal"><span class="pre">Model</span></code> object as argument.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call <code class="docutils literal"><span class="pre">addAttribute</span></code> method of <code class="docutils literal"><span class="pre">Model</span></code> object received as argument, and add the data to <code class="docutils literal"><span class="pre">Model</span></code> object.</div>
<div class="line">For example, <code class="docutils literal"><span class="pre">&quot;HelloWorld!&quot;</span></code> string is added to the attribute name <code class="docutils literal"><span class="pre">&quot;hello&quot;</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">If first argument of <code class="docutils literal"><span class="pre">addAttribute</span></code> method is omitted, the class name beginning with lower case letter will become the attribute name.</div>
<div class="line">For example, the result of <code class="docutils literal"><span class="pre">model.addAttribute(&quot;helloBean&quot;,</span> <span class="pre">new</span> <span class="pre">HelloBean());</span></code> is same as the result of <code class="docutils literal"><span class="pre">model.addAttribute(new</span> <span class="pre">HelloBean());</span></code></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In View (JSP), it is possible to acquire the data added to <code class="docutils literal"><span class="pre">Model</span></code> object by specifying &#8220;${Attribute name}&#8221;.</div>
<div class="line">For example, HTML escaping is performed using  &#8220;${f:h(Attribute name)}&#8221; function of EL expression.</div>
<div class="line">For details of functions of EL expression that perform HTML escaping, refer to <a class="reference internal" href="../Security/XSS.html"><em>Cross Site Scripting</em></a>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The values of JavaBean stored in <code class="docutils literal"><span class="pre">Model</span></code> can be acquired by specifying &#8220;${Attribute name.property name}&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JSP is output in HTML format.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Even though the <code class="docutils literal"><span class="pre">Model</span></code> is not used, it can be specified as an argument. Even if it is not required at the initial stage of implementation,
it can be used later (so that the signature of methods need not be changed in future).</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The value can also be referred from the module which is not managed under Spring MVC (for example, ServletFilter, etc.) since
<code class="docutils literal"><span class="pre">addAttribute</span></code> in  <code class="docutils literal"><span class="pre">Model</span></code> performs a <code class="docutils literal"><span class="pre">setAttribute</span></code> in <code class="docutils literal"><span class="pre">HttpServletRequest</span></code>.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="retrieving-values-from-url-path">
<span id="controller-method-argument-pathvariable-label"></span><h4><a class="toc-backref" href="#id37">4.4.1.4.2. Retrieving values from URL path</a><a class="headerlink" href="#retrieving-values-from-url-path" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">To retrieve values from URL path, add <code class="docutils literal"><span class="pre">&#64;PathVariable</span></code> annotation to argument of processing method of controller.</div>
<div class="line">In order to retrieve values from the path using <code class="docutils literal"><span class="pre">&#64;PathVariable</span></code> annotation, value of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation must contain those values in the form of variables (for example, {id}).</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello/{id}/{version}&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span>
<span class="hll">        <span class="nd">@PathVariable</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">id</span><span class="o">,</span> <span class="c1">// (2)</span>
</span><span class="hll">        <span class="nd">@PathVariable</span> <span class="n">Integer</span> <span class="n">version</span><span class="o">,</span> <span class="c1">// (3)</span>
</span>        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the portion to be extracted as path variable in the value of <code class="docutils literal"><span class="pre">&#64;RequestMapping</span></code> annotation. Specify path variable in &#8220;{variable name}&#8221; format.</div>
<div class="line">For example, 2 path variables such as  <code class="docutils literal"><span class="pre">&quot;id&quot;</span></code> and <code class="docutils literal"><span class="pre">&quot;version&quot;</span></code> are specified.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify variable name of path variable in <code class="docutils literal"><span class="pre">&#64;PathVariable</span></code> annotation.</div>
<div class="line">For example, when the URL <code class="docutils literal"><span class="pre">&quot;sample/hello/aaaa/1&quot;</span></code> is accessed, the string <code class="docutils literal"><span class="pre">&quot;aaaa&quot;</span></code> is passed to argument &#8220;id&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">Value attribute of <code class="docutils literal"><span class="pre">&#64;PathVariable</span></code> annotation can be omitted. When it is omitted, the argument name is considered as the request parameter name.</div>
<div class="line">In the above example, when the URL <code class="docutils literal"><span class="pre">&quot;sample/hello/aaaa/1&quot;</span></code> is accessed, value <code class="docutils literal"><span class="pre">&quot;1&quot;</span></code> is passed to argument &#8220;version&#8221;.</div>
<div class="line">However, in this method compilation needs to be done by specifying either of:</div>
</div>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">-g</span></code> option (mode to output debug information)</li>
<li><code class="docutils literal"><span class="pre">-parameters</span></code> option added from Java8 (mode to generate metadata for reflection in the method parameters)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Binding argument can be of any data type other than string. In case of different data type, <code class="docutils literal"><span class="pre">org.springframework.beans.TypeMismatchException</span></code> is thrown and default response is 400 (Bad Request).
For example, when the URL <code class="docutils literal"><span class="pre">&quot;sample/hello/aaaa/v1&quot;</span></code> is accessed, an exception is thrown since <code class="docutils literal"><span class="pre">&quot;v1&quot;</span></code> cannot be converted into Integer type.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When omitting the value attribute of <code class="docutils literal"><span class="pre">&#64;PathVariable</span></code> annotation, the application to be deployed needs to be compiled by specifying <code class="docutils literal"><span class="pre">-g</span></code> option or <code class="docutils literal"><span class="pre">-parameters</span></code> option which is added from Java8.
When these options are specified, there is a likely impact on memory and processing performance since information or processing required for debugging gets appended to the class after compilation.
Basically, it is recommended to explicitly specify the value attribute.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="retrieving-request-parameters-individually">
<span id="controller-method-argument-requestparam-label"></span><h4><a class="toc-backref" href="#id38">4.4.1.4.3. Retrieving request parameters individually</a><a class="headerlink" href="#retrieving-request-parameters-individually" title="Permalink to this headline">¶</a></h4>
<p>To retrieve request parameters individually, add <code class="docutils literal"><span class="pre">&#64;RequestParam</span></code> annotation to argument.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;bindRequestParams&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">bindRequestParams</span><span class="o">(</span>
<span class="hll">        <span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">id</span><span class="o">,</span> <span class="c1">// (1)</span>
</span><span class="hll">        <span class="nd">@RequestParam</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="c1">// (2)</span>
</span><span class="hll">        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;age&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">,</span> <span class="c1">// (3)</span>
</span><span class="hll">        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;genderCode&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">&quot;unknown&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">genderCode</span><span class="o">,</span> <span class="c1">// (4)</span>
</span>        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify request parameter name in the value attribute of <code class="docutils literal"><span class="pre">&#64;RequestParam</span></code> annotation.</div>
<div class="line">For example, when the URL <code class="docutils literal"><span class="pre">&quot;sample/hello?id=aaaa&quot;</span></code> is accessed, the string <code class="docutils literal"><span class="pre">&quot;aaaa&quot;</span></code> is passed to argument &#8220;id&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">value attribute of <code class="docutils literal"><span class="pre">&#64;RequestParam</span></code> annotation can be omitted. When it is omitted, the argument name becomes the request parameter name.</div>
<div class="line">For example, when the URL <code class="docutils literal"><span class="pre">&quot;sample/hello?name=bbbb&amp;....&quot;</span></code> is accessed, string <code class="docutils literal"><span class="pre">&quot;bbbb&quot;</span></code> is passed to argument &#8220;name&#8221;.</div>
<div class="line">However, in this method compilation needs to be done by specifying either of:</div>
</div>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">-g</span></code> option (mode to output debug information)</li>
<li><code class="docutils literal"><span class="pre">-parameters</span></code> option added from Java8 (mode to generate metadata for reflection in the method parameters)</li>
</ul>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">By default, an error occurs if the specified request parameter does not exist. When request parameter is not required, specify <code class="docutils literal"><span class="pre">false</span></code> in the <code class="docutils literal"><span class="pre">required</span></code> attribute.</div>
<div class="line">For example, when it is accessed where request parameter <code class="docutils literal"><span class="pre">age</span></code> does not exist, <code class="docutils literal"><span class="pre">null</span></code> is passed to argument &#8220;age&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When default value is to be used if the specified request parameter does not exist, specify the default value in defaultValue attribute.</div>
<div class="line">For example, when it is accessed where request parameter <code class="docutils literal"><span class="pre">genderCode</span></code> does not exist, <code class="docutils literal"><span class="pre">&quot;unknown&quot;</span></code> is passed to argument &#8220;genderCode&#8221;.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When it is accessed without specifying mandatory parameters, <code class="docutils literal"><span class="pre">org.springframework.web.bind.MissingServletRequestParameterException</span></code> is thrown and default operation is responded with 400 (Bad Request).
However, when defaultValue attribute is specified, the value specified in defaultValue attribute is passed without throwing exception.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Binding argument can be of any data type. In case the data type do not match, <code class="docutils literal"><span class="pre">org.springframework.beans.TypeMismatchException</span></code> is thrown and default response is 400 (Bad Request).
For example, when <code class="docutils literal"><span class="pre">&quot;sample/hello?age=aaaa&amp;...&quot;</span></code> URL is accessed, exception is thrown since <code class="docutils literal"><span class="pre">aaaa</span></code> cannot be converted into Integer.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Binding to form object must be done only when any of the following conditions are met.</strong></p>
<ul class="simple">
<li>If request parameter is an item in the HTML form.</li>
<li>If request parameter is not an item in HTML form, however, input validation other than mandatory check needs to be performed.</li>
<li>If error details of input validation error needs to be output for each parameter.</li>
<li>If there are 3 or more request parameters. (maintenance and readability point of view)</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="retrieving-request-parameters-collectively">
<span id="controller-method-argument-form-label"></span><h4><a class="toc-backref" href="#id39">4.4.1.4.4. Retrieving request parameters collectively</a><a class="headerlink" href="#retrieving-request-parameters-collectively" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Use form object to collectively fetch all the request parameters.</div>
<div class="line">Form object is JavaBean representing HTML form. For the details of form object, refer to <a class="reference internal" href="#formobject"><span>Implementing form object</span></a>.</div>
</div>
<p>Following is an example that shows the difference between processing method that fetches each request parameter using <code class="docutils literal"><span class="pre">&#64;RequestParam</span></code> and the same processing method when fetching request parameters in a form object</p>
<p>Processing method that receives request parameter separately using <code class="docutils literal"><span class="pre">&#64;RequestParam</span></code> is as shown below.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;bindRequestParams&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">bindRequestParams</span><span class="o">(</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">id</span><span class="o">,</span>
        <span class="nd">@RequestParam</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;age&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">,</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;genderCode&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">&quot;unknown&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">genderCode</span><span class="o">,</span>
        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">Create form object class</div>
<div class="line">For jsp of HTML form corresponding to this form object, refer to <a class="reference internal" href="#formobjectjsp"><span>Binding to HTML form</span></a>.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleForm</span> <span class="kd">implements</span> <span class="n">Serializable</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1477614498217715937L</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">genderCode</span><span class="o">;</span>

    <span class="c1">// omit setters and getters</span>

<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Request parameter name should match with form object property name.</strong></p>
<dl class="docutils">
<dt>When parameters <code class="docutils literal"><span class="pre">&quot;id=aaa&amp;name=bbbb&amp;age=19&amp;genderCode=men?tel=01234567&quot;</span></code> are sent to the above form object,</dt>
<dd>the values of <code class="docutils literal"><span class="pre">id</span></code> , <code class="docutils literal"><span class="pre">name</span></code> , <code class="docutils literal"><span class="pre">age</span></code> , <code class="docutils literal"><span class="pre">genderCode</span></code> matching with the property name, are stored, however <code class="docutils literal"><span class="pre">tel</span></code> is not included in form object, as it does not have matching property name.</dd>
</dl>
<p class="last">Make changes such that request parameters which were being fetched individually using <code class="docutils literal"><span class="pre">&#64;RequestParam</span></code> now get fetched as form object.</p>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;bindRequestParams&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">bindRequestParams</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="c1">// (1)</span>
</span>        <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span>
        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Receive <code class="docutils literal"><span class="pre">SampleForm</span></code> object as argument.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When form object is used as argument, unlike <code class="docutils literal"><span class="pre">&#64;RequestParam</span></code>,
mandatory check is not performed. <strong>When using form object,</strong> <a class="reference internal" href="#controller-method-argument-validation-label"><span>Performing input validation</span></a> <strong>should be performed as described below</strong>.</p>
</div>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Domain objects such as Entity, etc. can also be used as form object without any changes required.
However, the parameters such as password for confirmation, agreement confirmation checkbox, etc. should exist only on WEB screen.
Since the fields depending on such screen items should not be added to domain objects, it is recommended to create class for form object separate from domain object.
When a domain object needs to be created from request parameters, values must first be received in form object and then copied to domain object from form object.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="performing-input-validation">
<span id="controller-method-argument-validation-label"></span><h4><a class="toc-backref" href="#id40">4.4.1.4.5. Performing input validation</a><a class="headerlink" href="#performing-input-validation" title="Permalink to this headline">¶</a></h4>
<p>When performing input validation for the form object, add <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation to form object argument, and specify <code class="docutils literal"><span class="pre">org.springframework.validation.BindingResult</span></code> (Hereafter
called as <code class="docutils literal"><span class="pre">BindingResult</span></code>) to argument immediately after form object argument.</p>
<p>Refer to <a class="reference internal" href="../ArchitectureInDetail/Validation.html"><em>Input Validation</em></a>  for the details of input validation.</p>
<p>Add annotations required in input validation to the fields of form object class.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1477614498217715937L</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">10</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@Min</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="nd">@Max</span><span class="o">(</span><span class="mi">100</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>

    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">genderCode</span><span class="o">;</span>

    <span class="c1">// omit setters and getters</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">Add <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation to form object argument.</div>
<div class="line">Input validation is performed for the argument with <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation before the processing method of controller is executed. The check result is stored in the argument <code class="docutils literal"><span class="pre">BindingResult</span></code> which immediately follows form object argument.</div>
<div class="line">The type conversion error that occurs when a data-type other than String is specified in form object, is also stored in <code class="docutils literal"><span class="pre">BindingResult</span></code>.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;bindRequestParams&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">bindRequestParams</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="c1">// (1)</span>
</span><span class="hll">        <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span> <span class="c1">// (2)</span>
</span>        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
<span class="hll">    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span> <span class="c1">// (3)</span>
</span>        <span class="k">return</span> <span class="s">&quot;sample/input&quot;</span><span class="o">;</span> <span class="c1">// back to the input view</span>
    <span class="o">}</span>
    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Add <code class="docutils literal"><span class="pre">&#64;Validated</span></code> annotation to <code class="docutils literal"><span class="pre">SampleForm</span></code> argument, and mark it as target for input validation.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Specify <code class="docutils literal"><span class="pre">BindingResult</span></code> in the argument where input validation result is stored.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Check if input validation error exists. If there is an error, <code class="docutils literal"><span class="pre">true</span></code> is returned.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="passing-data-while-redirecting-request">
<span id="controller-method-argument-redirectattributes-label"></span><h4><a class="toc-backref" href="#id41">4.4.1.4.6. Passing data while redirecting request</a><a class="headerlink" href="#passing-data-while-redirecting-request" title="Permalink to this headline">¶</a></h4>
<p>To redirect after executing a processing method ofcontroller and to pass data along with it, fetch <code class="docutils literal"><span class="pre">org.springframework.web.servlet.mvc.support.RedirectAttributes</span></code> (Henceforth called as <code class="docutils literal"><span class="pre">RedirectAttributes</span></code>) as an argument of processing method,
and add the data to <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> object.</p>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">RedirectAttributes</span> <span class="n">redirectAttrs</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span><span class="hll">    <span class="n">redirectAttrs</span><span class="o">.</span><span class="na">addFlashAttribute</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="s">&quot;Hello World!&quot;</span><span class="o">);</span> <span class="c1">// (2)</span>
</span><span class="hll">    <span class="n">redirectAttrs</span><span class="o">.</span><span class="na">addFlashAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">HelloBean</span><span class="o">(</span><span class="s">&quot;Bean Hello World!&quot;</span><span class="o">));</span> <span class="c1">// (3)</span>
</span><span class="hll">    <span class="k">return</span> <span class="s">&quot;redirect:/sample/hello?complete&quot;</span><span class="o">;</span> <span class="c1">// (4)</span>
</span><span class="o">}</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;complete&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">helloComplete</span><span class="o">()</span> <span class="o">{</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;sample/complete&quot;</span><span class="o">;</span> <span class="c1">// (5)</span>
</span><span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>complete.jsp</li>
</ul>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll">Message : ${f:h(hello)}<span class="nt">&lt;br&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">6</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">Message : ${f:h(helloBean.message)}<span class="nt">&lt;br&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">7</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>HTML of created by View(complete.jsp)</li>
</ul>
<blockquote>
<div><div class="highlight-html"><div class="highlight"><pre><span class="hll">Message : Hello World!<span class="nt">&lt;br&gt;</span> <span class="c">&lt;!-- (8) --&gt;</span>
</span><span class="hll">Message : Bean Hello World!<span class="nt">&lt;br&gt;</span> <span class="c">&lt;!-- (8) --&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Fetch <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> object as argument of the processing method of controller.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call <code class="docutils literal"><span class="pre">addFlashAttribute</span></code> method of <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> and add the data to <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> object.</div>
<div class="line">For example, the string data <code class="docutils literal"><span class="pre">&quot;HelloWorld!&quot;</span></code> is added to attribute name <code class="docutils literal"><span class="pre">&quot;hello&quot;</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">If first argument of <code class="docutils literal"><span class="pre">addFlashAttribute</span></code> method is omitted, the class name beginning with lower case letter becomes the attribute name.</div>
<div class="line">For example, the result of <code class="docutils literal"><span class="pre">model.addFlashAttribute(&quot;helloBean&quot;,</span> <span class="pre">new</span> <span class="pre">HelloBean());</span></code> is same as <code class="docutils literal"><span class="pre">model.addFlashAttribute(new</span> <span class="pre">HelloBean());</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Send a redirect request to another URL which will display the next screen instead of displaying screen (View) directly.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In the processing method after redirection, return view name of the screen that displays the data added in (2) and (3).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In the View (JSP) side, the data added to <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> object can be obtained by specifying &#8220;${attribute name}&#8221;.</div>
<div class="line">For example, HTML escaping is performed using &#8220;${f:h(attribute name)}&#8221; function of EL expression.</div>
<div class="line">For the details of functions of EL expression that performs HTML escaping, refer to <a class="reference internal" href="../Security/XSS.html"><em>Cross Site Scripting</em></a>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The value stored in <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> can be obtained from JavaBean by using &#8220;${Attribute name.Property name}&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(8)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HTML output.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The data cannot be passed to redirect destination even though it is added to <code class="docutils literal"><span class="pre">Model</span></code>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is similar to the <code class="docutils literal"><span class="pre">addAttribute</span></code> method of <code class="docutils literal"><span class="pre">Model</span></code>. However survival time of data differs.
In <code class="docutils literal"><span class="pre">addFlashAttribute</span></code> of <code class="docutils literal"><span class="pre">RedirectAttributes</span></code>, the data is stored in a scope called flash scope.
Data of only 1 request (G in PRG pattern) can be referred after redirect. The data from the second request onwards is deleted.</p>
</div>
<div class="figure align-center" id="id14">
<a class="reference internal image-reference" href="../_images/applicationFlashscope.png"><img alt="Survival time of flush scope" src="../_images/applicationFlashscope.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text"><strong>Picture - Survival time of flush scope</strong></span></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="passing-request-parameters-to-redirect-destination">
<span id="controller-method-argument-redirectattributes-param-label"></span><h4><a class="toc-backref" href="#id42">4.4.1.4.7. Passing request parameters to redirect destination</a><a class="headerlink" href="#passing-request-parameters-to-redirect-destination" title="Permalink to this headline">¶</a></h4>
<p>When request parameters are to be set dynamically to redirect destination, add the values to be passed to <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> object of argument.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">RedirectAttributes</span> <span class="n">redirectAttrs</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">id</span> <span class="o">=</span> <span class="s">&quot;aaaa&quot;</span><span class="o">;</span>
<span class="hll">    <span class="n">redirectAttrs</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span> <span class="c1">// (1)</span>
</span>    <span class="c1">// must not return &quot;redirect:/sample/hello?complete&amp;id=&quot; + id;</span>
    <span class="k">return</span> <span class="s">&quot;redirect:/sample/hello?complete&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify request parameter name in argument <code class="docutils literal"><span class="pre">name</span> <span class="pre">and</span> <span class="pre">request</span> <span class="pre">parameter</span> <span class="pre">value</span> <span class="pre">in</span> <span class="pre">argument</span> <span class="pre">``value</span></code> and call <code class="docutils literal"><span class="pre">addAttribute</span></code> method of <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> object.</div>
<div class="line">In the above example, it is redirected to <code class="docutils literal"><span class="pre">&quot;/sample/hello?complete&amp;id=aaaa&quot;</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In the above example, the result is the same as of <code class="docutils literal"><span class="pre">return</span> <span class="pre">&quot;redirect:/sample/hello?complete&amp;id=&quot;</span> <span class="pre">+</span> <span class="pre">id;</span></code> (as shown in the commented out line in the above example).
However, since URL encoding is also performed if <code class="docutils literal"><span class="pre">addAttribute</span></code> method of <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> object is used,
the request parameters that needs to be inserted dynamically <strong>should be set to the request parameter using addAttribute method and should not be set to redirect URL specified as return value.</strong>
The request parameters which are not to be inserted dynamically (&#8220;complete&#8221; as in the above example), can be directly specified in the redirect URL specified as the return value.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="inserting-values-in-redirect-destination-url-path">
<span id="controller-method-argument-redirectattributes-path-label"></span><h4><a class="toc-backref" href="#id43">4.4.1.4.8. Inserting values in redirect destination URL path</a><a class="headerlink" href="#inserting-values-in-redirect-destination-url-path" title="Permalink to this headline">¶</a></h4>
<p>To insert values in redirect destination URL path dynamically, add the value to be inserted in <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> object of argument as shown in the example to set request parameters.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">RedirectAttributes</span> <span class="n">redirectAttrs</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">id</span> <span class="o">=</span> <span class="s">&quot;aaaa&quot;</span><span class="o">;</span>
<span class="hll">    <span class="n">redirectAttrs</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span> <span class="c1">// (1)</span>
</span>    <span class="c1">// must not return &quot;redirect:/sample/hello/&quot; + id + &quot;?complete&quot;;</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;redirect:/sample/hello/{id}?complete&quot;</span><span class="o">;</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify attribute name and the value using <code class="docutils literal"><span class="pre">addAttribute</span></code> method of <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the path of the variable &#8220;{Attribute name}&#8221;  to be inserted in the redirect URL.</div>
<div class="line">In the above example, it is redirected to <code class="docutils literal"><span class="pre">&quot;/sample/hello/aaaa?complete&quot;</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In the above example, the result is same as of <code class="docutils literal"><span class="pre">&quot;redirect:/sample/hello/&quot;</span> <span class="pre">+</span> <span class="pre">id</span> <span class="pre">+</span> <span class="pre">&quot;?complete&quot;;</span></code> (as shown in the commented out line in the above example).
However, since URL encoding is also performed when using <code class="docutils literal"><span class="pre">addAttribute</span></code> method of <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> object,
the path values to be inserted dynamically <strong>should be inserted using addAttribute method and path variable and should not be set to redirect URL specified as return value.</strong></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="acquiring-values-from-cookie">
<span id="controller-method-argument-cookievalue-label"></span><h4><a class="toc-backref" href="#id44">4.4.1.4.9. Acquiring values from Cookie</a><a class="headerlink" href="#acquiring-values-from-cookie" title="Permalink to this headline">¶</a></h4>
<p>Add <code class="docutils literal"><span class="pre">&#64;CookieValue</span></code> annotation to the argument of processing method to acquire the values from a cookie.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;readCookie&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">readCookie</span><span class="o">(</span><span class="nd">@CookieValue</span><span class="o">(</span><span class="s">&quot;JSESSIONID&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">sessionId</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span>    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/readCookie&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify name of the cookie in the <code class="docutils literal"><span class="pre">value</span></code> attribute of <code class="docutils literal"><span class="pre">&#64;CookieValue</span></code> annotation.</div>
<div class="line">In the above example, &#8220;JSESSIONID&#8221; value is passed from cookie to sessionId argument.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>As in the case of <code class="docutils literal"><span class="pre">&#64;RequestParam</span></code> , it has <code class="docutils literal"><span class="pre">required</span></code> attribute and <code class="docutils literal"><span class="pre">defaultValue</span></code> attribute. Also, the data type of the argument need not be String.</dt>
<dd>Refer to <a class="reference internal" href="#controller-method-argument-requestparam-label"><span>Retrieving request parameters individually</span></a> for details.</dd>
</dl>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="writing-values-in-cookie">
<span id="controller-method-argument-cookiewrite-label"></span><h4><a class="toc-backref" href="#id45">4.4.1.4.10. Writing values in Cookie</a><a class="headerlink" href="#writing-values-in-cookie" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">To write values in cookie, call <code class="docutils literal"><span class="pre">addCookie</span></code> method of <code class="docutils literal"><span class="pre">HttpServletResponse</span></code> object directly and add the value to cookie.</div>
<div class="line">Since there is no way to write to cookie in Spring MVC  (3.2.3 version), ** Only in this case, HttpServletResponse can fetched as an argument of processing method of controller.**</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;writeCookie&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">writeCookie</span><span class="o">(</span><span class="n">Model</span> <span class="n">model</span><span class="o">,</span>
<span class="hll">        <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span>    <span class="n">Cookie</span> <span class="n">cookie</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cookie</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="s">&quot;hello world!&quot;</span><span class="o">);</span>
<span class="hll">    <span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">cookie</span><span class="o">);</span> <span class="c1">// (2)</span>
</span>    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/writeCookie&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify <code class="docutils literal"><span class="pre">HttpServletResponse</span></code> object as argument to write to cookie.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Generate <code class="docutils literal"><span class="pre">Cookie</span></code> object and add to <code class="docutils literal"><span class="pre">HttpServletResponse</span></code> object.</div>
<div class="line">For example, <code class="docutils literal"><span class="pre">&quot;hello</span> <span class="pre">world!&quot;</span></code>  value is assigned to Cookie name <code class="docutils literal"><span class="pre">&quot;foo&quot;</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">No difference compared to use of <code class="docutils literal"><span class="pre">HttpServletResponse</span></code> which fetched as an argument of processing method, however,  <code class="docutils literal"><span class="pre">org.springframework.web.util.CookieGenerator</span></code> class is provided by Spring
as a class to write values in cookie. It should be used if required.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="retrieving-pagination-information">
<span id="controller-method-argument-pagination-label"></span><h4><a class="toc-backref" href="#id46">4.4.1.4.11. Retrieving pagination information</a><a class="headerlink" href="#retrieving-pagination-information" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Pagination related information is required for the requests performing list search.</div>
<div class="line">Fetching <code class="docutils literal"><span class="pre">org.springframework.data.domain.Pageable</span></code> (henceforth called as <code class="docutils literal"><span class="pre">Pageable</span></code>) object as an argument of processing method enables to handle pagination related information (page count, fetch record count) easily.</div>
</div>
<blockquote>
<div>Refer to <a class="reference internal" href="../ArchitectureInDetail/Pagination.html"><em>Pagination</em></a>  for details.</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="retrieving-uploaded-file">
<span id="controller-method-argument-upload-label"></span><h4><a class="toc-backref" href="#id47">4.4.1.4.12. Retrieving uploaded file</a><a class="headerlink" href="#retrieving-uploaded-file" title="Permalink to this headline">¶</a></h4>
<p>Uploaded file can be obtained in 2 ways.</p>
<ul class="simple">
<li>Provide <code class="docutils literal"><span class="pre">MultipartFile</span></code> property in form object.</li>
<li>Use <code class="docutils literal"><span class="pre">org.springframework.web.multipart.MultipartFile</span></code> as an argument of processing method having <code class="docutils literal"><span class="pre">&#64;RequestParam</span></code> annotation.</li>
</ul>
<p>Refer to <a class="reference internal" href="../ArchitectureInDetail/FileUpload.html"><em>File Upload</em></a>  for details.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-result-message-on-the-screen">
<span id="controller-method-argument-message-label"></span><h4><a class="toc-backref" href="#id48">4.4.1.4.13. Displaying result message on the screen</a><a class="headerlink" href="#displaying-result-message-on-the-screen" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">Model</span></code> object or <code class="docutils literal"><span class="pre">RedirectAttributes</span></code> object can be obtained as an argument of processing method and
result message of business logic execution can be displayed by adding <code class="docutils literal"><span class="pre">ResultMessages</span></code> object to Model or RedirectAttributes.</p>
<p>Refer to <a class="reference internal" href="../ArchitectureInDetail/MessageManagement.html"><em>Message Management</em></a>  for details.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="regarding-return-value-of-processing-method">
<span id="controller-method-return-label"></span><h3><a class="toc-backref" href="#id49">4.4.1.5. Regarding return value of processing method</a><a class="headerlink" href="#regarding-return-value-of-processing-method" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/mvc.html#mvc-ann-return-types">For return values of processing methods, various values can be fetched</a> ; however,
only the following values should be used.</p>
<ul class="simple">
<li>String (for logical name of view)</li>
</ul>
<p>Return types depending on the purpose of usage are described below:</p>
<ul class="simple">
<li><a class="reference internal" href="#controller-method-return-html-label"><span>HTML response</span></a></li>
<li><a class="reference internal" href="#controller-method-return-download-label"><span>Responding to downloaded data</span></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="html-response">
<span id="controller-method-return-html-label"></span><h4><a class="toc-backref" href="#id50">4.4.1.5.1. HTML response</a><a class="headerlink" href="#html-response" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">To get HTML response to display the output of processing method, it has to return view name of JSP.</div>
<div class="line"><code class="docutils literal"><span class="pre">ViewResolver</span></code> when generating HTML using JSP will be an inherited class of <code class="docutils literal"><span class="pre">UrlBasedViewResolver</span></code> (<code class="docutils literal"><span class="pre">InternalViewResolver</span></code> and``TilesViewResolver``, etc).</div>
</div>
<div class="line-block">
<div class="line">An example using <code class="docutils literal"><span class="pre">InternalViewResolver</span></code> for JSP is given below; however, it is recommended to use <code class="docutils literal"><span class="pre">TilesViewResolver</span></code> when the screen layout is in a templated format.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/TilesLayout.html"><em>Screen Layout using Tiles</em></a>  for the usage of <code class="docutils literal"><span class="pre">TilesViewResolver</span></code>.</div>
</div>
<ul class="simple">
<li>spring-mvc.xml</li>
</ul>
<p>Example of definition when <code class="docutils literal"><span class="pre">&lt;bean&gt;</span></code> element is to be used</p>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;prefix&quot;</span> <span class="na">value=</span><span class="s">&quot;/WEB-INF/views/&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;suffix&quot;</span> <span class="na">value=</span><span class="s">&quot;.jsp&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;order&quot;</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (4) --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<p>Example of definition when using <code class="docutils literal"><span class="pre">&lt;mvc:view-resolvers&gt;</span></code> element added from Spring Framework 4.1</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;mvc:view-resolvers&gt;</span>
    <span class="nt">&lt;mvc:jsp</span> <span class="na">prefix=</span><span class="s">&quot;/WEB-INF/views/&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (5) --&gt;</span>
<span class="nt">&lt;/mvc:view-resolvers&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// omitted</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// (6)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Define <code class="docutils literal"><span class="pre">InternalViewResolver</span></code> for JSP.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><p class="first">Specify base directory (prefix of file path) where JSP files are stored.</p>
<p class="last">By specifying prefix, there is no need to specify physical storage location of JSP files at the time of returning View name in Controller.</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><p class="first">Specify extension (suffix of file path) of JSP file.</p>
<p class="last">By specifying suffix, specifying extension of JSP files at the time of returning View name in Controller is no longer needed.</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><p class="first">Specify execution order when multiple <code class="docutils literal"><span class="pre">ViewResolver</span></code> are specified.</p>
<p class="last">It can be specified in the range of <code class="docutils literal"><span class="pre">Integer</span></code> and executed sequentially from smallest value.</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><p class="first">Define <code class="docutils literal"><span class="pre">InternalViewResolver</span></code> for JSP using <code class="docutils literal"><span class="pre">&lt;mvc:jsp&gt;</span></code> element added from Spring Framework 4.1.</p>
<ul class="simple">
<li>In <code class="docutils literal"><span class="pre">prefix</span></code> attribute, specify base directory (prefix of file path) where JSP file is stored.</li>
<li>It need  not be explicitly specified in <code class="docutils literal"><span class="pre">suffix</span></code> attribute as <code class="docutils literal"><span class="pre">&quot;.jsp&quot;</span></code> is used as default value.</li>
</ul>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When <code class="docutils literal"><span class="pre">&lt;mvc:view-resolvers&gt;</span></code> element is used, it is possible to define <code class="docutils literal"><span class="pre">ViewResolver</span></code> in simple way.
Hence this guideline recommends to use <code class="docutils literal"><span class="pre">&lt;mvc:view-resolvers&gt;</span></code>.</p>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td>When View name <code class="docutils literal"><span class="pre">&quot;sample/hello&quot;</span></code> is the return value of processing method, <code class="docutils literal"><span class="pre">&quot;/WEB-INF/views/sample/hello.jsp&quot;</span></code> is called and HTML is sent as response.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">HTML output is generated using JSP in the above example, however, even if HTML is generated using other template engine such as Velocity, FreeMarker, return value of processing method will be <code class="docutils literal"><span class="pre">&quot;sample/hello</span></code>.
<code class="docutils literal"><span class="pre">ViewResolver</span></code> takes care of task to determine which template engine is to be used.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="responding-to-downloaded-data">
<span id="controller-method-return-download-label"></span><h4><a class="toc-backref" href="#id51">4.4.1.5.2. Responding to downloaded data</a><a class="headerlink" href="#responding-to-downloaded-data" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">In order to return the data stored in db as download data (<code class="docutils literal"><span class="pre">&quot;application/octet-stream&quot;</span></code>), it is recommended to create a view</div>
<div class="line">for generating response data (download process).The processing method adds the data to be downloaded to <code class="docutils literal"><span class="pre">Model</span></code> and returns</div>
<div class="line">name of the view which performs the actual download process.</div>
</div>
<div class="line-block">
<div class="line">The solution to create a separate ViewResolver to resolve a view using its view name, however, <code class="docutils literal"><span class="pre">BeanNameViewResolver</span></code> provided by Spring Framework is recommended.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/FileDownload.html"><em>File Download</em></a>  for the details of download processing.</div>
</div>
<ul class="simple">
<li>spring-mvc.xml</li>
</ul>
<blockquote>
<div><p>Example of definition when <code class="docutils literal"><span class="pre">&lt;bean&gt;</span></code> element is to be used</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="hll"><span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="hll"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.web.servlet.view.BeanNameViewResolver&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;order&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll"><span class="nt">&lt;/bean&gt;</span>
</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;prefix&quot;</span> <span class="na">value=</span><span class="s">&quot;/WEB-INF/views/&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;suffix&quot;</span> <span class="na">value=</span><span class="s">&quot;.jsp&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;order&quot;</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<p>Example of definition when using <code class="docutils literal"><span class="pre">&lt;mvc:view-resolvers&gt;</span></code> element added from Spring Framework 4.1</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;mvc:view-resolvers&gt;</span>
<span class="hll">    <span class="nt">&lt;mvc:bean-name</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
</span>    <span class="nt">&lt;mvc:jsp</span> <span class="na">prefix=</span><span class="s">&quot;/WEB-INF/views/&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/mvc:view-resolvers&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;report&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">report</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// omitted</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;sample/report&quot;</span><span class="o">;</span> <span class="c1">// (4)</span>
</span><span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>XxxExcelView.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@Component</span><span class="o">(</span><span class="s">&quot;sample/report&quot;</span><span class="o">)</span> <span class="c1">// (5)</span>
</span><span class="hll"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">XxxExcelView</span> <span class="kd">extends</span> <span class="n">AbstractExcelView</span> <span class="o">{</span> <span class="c1">// (6)</span>
</span>    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">buildExcelDocument</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">model</span><span class="o">,</span>
            <span class="n">HSSFWorkbook</span> <span class="n">workbook</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span>
            <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">HSSFSheet</span> <span class="n">sheet</span><span class="o">;</span>
        <span class="n">HSSFCell</span> <span class="n">cell</span><span class="o">;</span>

        <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">&quot;Spring&quot;</span><span class="o">);</span>
        <span class="n">sheet</span><span class="o">.</span><span class="na">setDefaultColumnWidth</span><span class="o">(</span><span class="mi">12</span><span class="o">);</span>

        <span class="c1">// write a text at A1</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">getCell</span><span class="o">(</span><span class="n">sheet</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
        <span class="n">setText</span><span class="o">(</span><span class="n">cell</span><span class="o">,</span> <span class="s">&quot;Spring-Excel test&quot;</span><span class="o">);</span>

        <span class="n">cell</span> <span class="o">=</span> <span class="n">getCell</span><span class="o">(</span><span class="n">sheet</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
        <span class="n">setText</span><span class="o">(</span><span class="n">cell</span><span class="o">,</span> <span class="o">(</span><span class="n">Date</span><span class="o">)</span> <span class="n">model</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;serverTime&quot;</span><span class="o">)).</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><p class="first">Define <code class="docutils literal"><span class="pre">BeanNameViewResolver</span></code>.</p>
<p class="last"><code class="docutils literal"><span class="pre">BeanNameViewResolver</span></code> is a class that resolves View by searching for the bean which matches with the returned View name, from application context.</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>When <code class="docutils literal"><span class="pre">InternalViewResolver</span></code> for JSP and <code class="docutils literal"><span class="pre">TilesViewResolver</span></code> are to be used together, it is recommended to give it a higher priority compared to these <code class="docutils literal"><span class="pre">ViewResolver</span></code>.
In the above example, by specifying <code class="docutils literal"><span class="pre">&quot;0&quot;</span></code>, View is resolved by <code class="docutils literal"><span class="pre">BeanNameViewResolver</span></code> prior to <code class="docutils literal"><span class="pre">InternalViewResolver</span></code>.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><p class="first">Define <code class="docutils literal"><span class="pre">BeanNameViewResolver</span></code> using <code class="docutils literal"><span class="pre">&lt;mvc:bean-name&gt;</span></code> element added from Spring Framework 4.1.</p>
<p>When defining <code class="docutils literal"><span class="pre">ViewResolver</span></code> using <code class="docutils literal"><span class="pre">&lt;mvc:view-resolvers&gt;</span></code> element, definition order of <code class="docutils literal"><span class="pre">ViewResolver</span></code> specified in child element will be the priority order.
In the above example, by defining it above (<code class="docutils literal"><span class="pre">&lt;mvc:jsp&gt;</span></code>) element in order to define <code class="docutils literal"><span class="pre">InternalViewResolver</span></code> for JSP, View is resolved by <code class="docutils literal"><span class="pre">BeanNameViewResolver</span></code> prior to <code class="docutils literal"><span class="pre">InternalViewResolver</span></code> for JSP.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When <code class="docutils literal"><span class="pre">&lt;mvc:view-resolvers&gt;</span></code> element is used, it is possible to define <code class="docutils literal"><span class="pre">ViewResolver</span></code> in a simple way.
Hence, this guideline recommends to use <code class="docutils literal"><span class="pre">&lt;mvc:view-resolvers&gt;</span></code>.</p>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td>When View name <code class="docutils literal"><span class="pre">&quot;sample/report&quot;</span></code> is the return value of processing method, the data generated by View instance which is registered in step (5), is responded as download data.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><p class="first">Register View object as Bean by specifying View name to the name of component.</p>
<p class="last">In above example, <code class="docutils literal"><span class="pre">x.y.z.app.views.XxxExcelView</span></code> instance is registered as a bean with bean name (view name) as <code class="docutils literal"><span class="pre">&quot;sample/report&quot;</span></code> .</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><p class="first">Example of View implementation.</p>
<p class="last">Implementation of View class that inherits <code class="docutils literal"><span class="pre">org.springframework.web.servlet.view.document.AbstractExcelView</span></code> and generates Excel data.</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="implementing-the-process">
<h3><a class="toc-backref" href="#id52">4.4.1.6. Implementing the process</a><a class="headerlink" href="#implementing-the-process" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">The point here is that <strong>do not implement business logic in controller</strong> .</div>
<div class="line">Business logic must be implemented in Service. Controller must call the service methods in which the business logic is implemented.</div>
<div class="line">Refer to <a class="reference internal" href="DomainLayer.html"><em>Domain Layer Implementation</em></a>  for the details of implementation of business logic.</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Controller should be used only for routing purposes (mapping requests to corresponding business logic) and deciding the screen transition for each request as well as setting model data. Thereby, controller should be simple as much as possible.
By consistently following this policy, the contents of controller become clear which ensures maintainability of controller even if the size of development is large.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Operations to be performed in controller are shown below:</p>
<ul class="simple">
<li><a class="reference internal" href="#controller-logic-correlationcheck-label"><span>Correlation check of input value</span></a></li>
<li><a class="reference internal" href="#controller-logic-businesslogic-label"><span>Calling business logic</span></a></li>
<li><a class="reference internal" href="#controller-logic-domainobject-label"><span>Reflecting values to domain object</span></a></li>
<li><a class="reference internal" href="#controller-logic-formobject-label"><span>Reflecting values to form object</span></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="correlation-check-of-input-value">
<span id="controller-logic-correlationcheck-label"></span><h4><a class="toc-backref" href="#id53">4.4.1.6.1. Correlation check of input value</a><a class="headerlink" href="#correlation-check-of-input-value" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Correlation check of input values should be done using <code class="docutils literal"><span class="pre">Validation</span></code> class which implements <code class="docutils literal"><span class="pre">org.springframework.validation.Validator</span></code> interface.</div>
<div class="line">Bean Validation can also be used for correlation check of input values.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/Validation.html"><em>Input Validation</em></a>  for the details of implementation of correlation check.</div>
</div>
<div class="line-block">
<div class="line">The implementation of correlation check itself should not be written in the processing method of controller. However, it is necessary to add the  <code class="docutils literal"><span class="pre">Validator</span></code> to <code class="docutils literal"><span class="pre">org.springframework.web.bind.WebDataBinder</span></code>.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@Inject</span>
<span class="hll"><span class="n">PasswordEqualsValidator</span> <span class="n">passwordEqualsValidator</span><span class="o">;</span> <span class="c1">// (1)</span>
</span>
<span class="nd">@InitBinder</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">initBinder</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">){</span>
<span class="hll">    <span class="n">binder</span><span class="o">.</span><span class="na">addValidators</span><span class="o">(</span><span class="n">passwordEqualsValidator</span><span class="o">);</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Inject <code class="docutils literal"><span class="pre">Validator</span></code> that performs correlation check.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add the injected <code class="docutils literal"><span class="pre">Validator</span></code> to <code class="docutils literal"><span class="pre">WebDataBinder</span></code>.</div>
<div class="line">Adding the above to <code class="docutils literal"><span class="pre">WebDataBinder</span></code> enables correlation check by executing <code class="docutils literal"><span class="pre">Validator</span></code> before the processing method gets called.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="calling-business-logic">
<span id="controller-logic-businesslogic-label"></span><h4><a class="toc-backref" href="#id54">4.4.1.6.2. Calling business logic</a><a class="headerlink" href="#calling-business-logic" title="Permalink to this headline">¶</a></h4>
<p>Execute business logic by injecting the Service in which business logic is implemented and calling the injected Service method.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@Inject</span>
<span class="hll"><span class="n">SampleService</span> <span class="n">sampleService</span><span class="o">;</span> <span class="c1">// (1)</span>
</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
<span class="hll">    <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">sampleService</span><span class="o">.</span><span class="na">hello</span><span class="o">();</span> <span class="c1">// (2)</span>
</span>    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;message&quot;</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inject the <code class="docutils literal"><span class="pre">Service</span></code> in which business logic is implemented.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Call the injected <code class="docutils literal"><span class="pre">Service</span></code> method to execute business logic.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="reflecting-values-to-domain-object">
<span id="controller-logic-domainobject-label"></span><h4><a class="toc-backref" href="#id55">4.4.1.6.3. Reflecting values to domain object</a><a class="headerlink" href="#reflecting-values-to-domain-object" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">In this guideline, it is recommended to bind the data sent by HTML form to form object instead of the domain object.</div>
<div class="line">Therefore, the controller should perform the process of reflecting the values of form object to domain object which is then passed to the method of service class.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
    <span class="c1">// omitted</span>
<span class="hll">    <span class="n">Sample</span> <span class="n">sample</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Sample</span><span class="o">();</span> <span class="c1">// (1)</span>
</span>    <span class="n">sample</span><span class="o">.</span><span class="na">setField1</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getField1</span><span class="o">());</span>
    <span class="n">sample</span><span class="o">.</span><span class="na">setField2</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getField2</span><span class="o">());</span>
    <span class="n">sample</span><span class="o">.</span><span class="na">setField3</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getField3</span><span class="o">());</span>
    <span class="c1">// ...</span>
    <span class="c1">// and more ...</span>
    <span class="c1">// ...</span>
<span class="hll">    <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">sampleService</span><span class="o">.</span><span class="na">hello</span><span class="o">(</span><span class="n">sample</span><span class="o">);</span> <span class="c1">// (2)</span>
</span><span class="hll">    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;message&quot;</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span> <span class="c1">// (3)</span>
</span>    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create domain object and reflect the values bound to form object in the domain object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call the method of service class to execute business logic.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add the data returned from business logic to <code class="docutils literal"><span class="pre">Model</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line">The process of reflecting values to domain object should be implemented by the processing method of controller. However considering the readability of processing</div>
<div class="line">method in case of large amount of code, it is recommended to delegate the process to Helper class.</div>
<div class="line">Example of delegating the process to Helper class is shown below:</div>
</div>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@Inject</span>
<span class="hll"><span class="n">SampleHelper</span> <span class="n">sampleHelper</span><span class="o">;</span> <span class="c1">// (1)</span>
</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">){</span>
    <span class="c1">// omitted</span>
<span class="hll">    <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">sampleHelper</span><span class="o">.</span><span class="na">hello</span><span class="o">(</span><span class="n">form</span><span class="o">);</span> <span class="c1">// (2)</span>
</span>    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;message&quot;</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>SampleHelper.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleHelper</span> <span class="o">{</span>

    <span class="nd">@Inject</span>
    <span class="n">SampleService</span> <span class="n">sampleService</span><span class="o">;</span>

<span class="hll">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">SampleForm</span> <span class="n">form</span><span class="o">){</span> <span class="c1">// (3)</span>
</span>        <span class="n">Sample</span> <span class="n">sample</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Sample</span><span class="o">();</span>
        <span class="n">sample</span><span class="o">.</span><span class="na">setField1</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getField1</span><span class="o">());</span>
        <span class="n">sample</span><span class="o">.</span><span class="na">setField2</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getField2</span><span class="o">());</span>
        <span class="n">sample</span><span class="o">.</span><span class="na">setField3</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getField3</span><span class="o">());</span>
        <span class="c1">// ...</span>
        <span class="c1">// and more ...</span>
        <span class="c1">// ...</span>
        <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">sampleService</span><span class="o">.</span><span class="na">hello</span><span class="o">(</span><span class="n">sample</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Inject object of Helper class in controller.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Value is reflected to the domain object by calling the method of the injected Helper class.
Delegating the process to Helper class enables to keep the implementation of controller simple.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Call the Service class method to execute the business logic after creating domain object.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Bean conversion functionality can be used as an alternative way to delegate the process of reflecting form object values, to Helper class.
Refer to <a class="reference internal" href="../ArchitectureInDetail/Utilities/Dozer.html"><em>Bean Mapping (Dozer)</em></a>  for the details of Bean conversion functionality.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="reflecting-values-to-form-object">
<span id="controller-logic-formobject-label"></span><h4><a class="toc-backref" href="#id56">4.4.1.6.4. Reflecting values to form object</a><a class="headerlink" href="#reflecting-values-to-form-object" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">In this guideline, it is recommended that form object (and not domain object) must be used to for that data which is to be bound to HTML form.</div>
<div class="line">For this, it is necessary to reflect the values of domain object (returned by service layer) to form object. This conversion should be performed in controller class.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
    <span class="c1">// omitted</span>
<span class="hll">    <span class="n">Sample</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">sampleService</span><span class="o">.</span><span class="na">getSample</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span> <span class="c1">// (1)</span>
</span><span class="hll">    <span class="n">form</span><span class="o">.</span><span class="na">setField1</span><span class="o">(</span><span class="n">sample</span><span class="o">.</span><span class="na">getField1</span><span class="o">());</span> <span class="c1">// (2)</span>
</span>    <span class="n">form</span><span class="o">.</span><span class="na">setField2</span><span class="o">(</span><span class="n">sample</span><span class="o">.</span><span class="na">getField2</span><span class="o">());</span>
    <span class="n">form</span><span class="o">.</span><span class="na">setField3</span><span class="o">(</span><span class="n">sample</span><span class="o">.</span><span class="na">getField3</span><span class="o">());</span>
    <span class="c1">// ...</span>
    <span class="c1">// and more ...</span>
    <span class="c1">// ...</span>
<span class="hll">    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="n">sample</span><span class="o">);</span> <span class="c1">// (3)</span>
</span>    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call the method of service class in which business logic is implemented and fetch domain object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Reflect values of acquired domain object to form object.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When there are fields only for display, add domain object to <code class="docutils literal"><span class="pre">Model</span></code> so that data can be referred.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In JSP, it is recommended to refer the values from domain object instead of form object for the fields to be only displayed on the screen.</p>
</div>
</div></blockquote>
<p>The process of reflecting value to form object should be implemented by the processing method of controller.
However considering the readability of processing method in case of large amount of code, it is recommended to delegate the process to Helper class method.</p>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">){</span>
    <span class="c1">// omitted</span>
    <span class="n">Sample</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">sampleService</span><span class="o">.</span><span class="na">getSample</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="hll">    <span class="n">sampleHelper</span><span class="o">.</span><span class="na">applyToForm</span><span class="o">(</span><span class="n">sample</span><span class="o">,</span> <span class="n">form</span><span class="o">);</span> <span class="c1">// (1)</span>
</span>    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="n">sample</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>SampleHelper.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">applyToForm</span><span class="o">(</span><span class="n">SampleForm</span> <span class="n">destForm</span><span class="o">,</span> <span class="n">Sample</span> <span class="n">srcSample</span><span class="o">){</span>
<span class="hll">    <span class="n">destForm</span><span class="o">.</span><span class="na">setField1</span><span class="o">(</span><span class="n">srcSample</span><span class="o">.</span><span class="na">getField1</span><span class="o">());</span> <span class="c1">// (2)</span>
</span>    <span class="n">destForm</span><span class="o">.</span><span class="na">setField2</span><span class="o">(</span><span class="n">srcSample</span><span class="o">.</span><span class="na">getField2</span><span class="o">());</span>
    <span class="n">destForm</span><span class="o">.</span><span class="na">setField3</span><span class="o">(</span><span class="n">srcSample</span><span class="o">.</span><span class="na">getField3</span><span class="o">());</span>
    <span class="c1">// ...</span>
    <span class="c1">// and more ...</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call the method to reflect the values of domain object to form object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Reflect the values of domain object to form object.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Bean conversion functionality can be used as an alternative method to delegate the process to Helper class.
Refer to <a class="reference internal" href="../ArchitectureInDetail/Utilities/Dozer.html"><em>Bean Mapping (Dozer)</em></a>  for the details of Bean conversion functionality.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="implementing-form-object">
<span id="formobject"></span><h2><a class="toc-backref" href="#id57">4.4.2. Implementing form object</a><a class="headerlink" href="#implementing-form-object" title="Permalink to this headline">¶</a></h2>
<p>Form object is the object (JavaBean) which represents HTML form and plays the following role.</p>
<ol class="arabic simple">
<li><strong>Holds business data stored in the database so that it can be referred by HTML form (JSP).</strong></li>
<li><strong>Holds request parameters sent by HTML form so that they can be referred by processing method of controller.</strong></li>
</ol>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/applicationFormobject.png"><img alt="../_images/applicationFormobject.png" src="../_images/applicationFormobject.png" style="width: 80%;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Implementation of form object can be described by focusing on the following points.</p>
<ul class="simple">
<li><a class="reference internal" href="#formobject-new-label"><span>Creating form object</span></a></li>
<li><a class="reference internal" href="#formobject-init-label"><span>Initializing form object</span></a></li>
<li><a class="reference internal" href="#formobject-bindhtmlform-label"><span>Binding to HTML form</span></a></li>
<li><a class="reference internal" href="#formobject-bindrequestparam-label"><span>Binding request parameters</span></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="creating-form-object">
<span id="formobject-new-label"></span><h3><a class="toc-backref" href="#id58">4.4.2.1. Creating form object</a><a class="headerlink" href="#creating-form-object" title="Permalink to this headline">¶</a></h3>
<p>Create form object as a JavaBean.
Spring Framework provides the functionality to convert and bind the request parameters (string) sent by HTML form to the format defined in form object.
Hence, the fields to be defined in form object need not only be in <code class="docutils literal"><span class="pre">java.lang.String</span></code> format.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">genderCode</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">birthDate</span><span class="o">;</span>
    <span class="c1">// omitted getter/setter</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>Regarding the mechanism provided by Spring Framework that performs format conversion</strong></p>
<p>Spring Framework executes format conversion using the following 3 mechanisms and supports conversion to basic format as standard. Refer to linked page for the details of each conversion function.</p>
<ul class="last simple">
<li><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/validation.html#core-convert">Spring Type Conversion</a></li>
<li><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/validation.html#format">Spring Field Formatting</a></li>
<li><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/validation.html#beans-beans-conversion">java.beans.PropertyEditor implementations</a></li>
</ul>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In form object, it is recommended to maintain only the fields of HTML form and not the fields which are just displayed on the screen.
If display only fields are also maintained in form object, more memory will get consumed at the time of storing form object in HTTP session object causing memory exhaustion.
In order to display the values of display only fields on the screen, it is recommended to add objects of domain layer (such as Entity) to request scope by using (<code class="docutils literal"><span class="pre">Model.addAttribute</span></code>).</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="number-format-conversion-of-fields">
<h4><a class="toc-backref" href="#id59">4.4.2.1.1. Number format conversion of fields</a><a class="headerlink" href="#number-format-conversion-of-fields" title="Permalink to this headline">¶</a></h4>
<p>Number format can be specified for each field using <code class="docutils literal"><span class="pre">&#64;NumberFormat</span></code> annotation.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
<span class="hll">    <span class="nd">@NumberFormat</span><span class="o">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&quot;#,#&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span>    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">price</span><span class="o">;</span>
    <span class="c1">// omitted getter/setter</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the number format of request parameter sent by HTML form. For example, binding of value formatted by &#8221;,&#8221; is possible since &#8220;&#8221;#, #&#8221;&#8221; format is specified as pattern.</div>
<div class="line">When value of request parameter is &#8220;&#8221;1,050&#8221;&#8221;, Integer object of &#8220;&#8221;1050&#8221;&#8221; will bind to the property <code class="docutils literal"><span class="pre">price</span></code> of form object.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Attributes of <code class="docutils literal"><span class="pre">&#64;NumberFormat</span></code> annotation are given below.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Attribute name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>style</td>
<td>Specify number format style (NUMBER, CURRENCY, PERCENT). For details refer to <a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/javadoc-api/org/springframework/format/annotation/NumberFormat.Style.html">Javadoc of NumberFormat.Style</a>.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>pattern</td>
<td>Specify number format of Java. Refer to &#8216;Javadoc of DecimalFormat &lt;<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/text/DecimalFormat.html">http://docs.oracle.com/javase/8/docs/api/java/text/DecimalFormat.html</a>&gt;&#8217;_for details.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="date-and-time-format-conversion-of-fields">
<span id="applicationlayer-datetimeformat"></span><h4><a class="toc-backref" href="#id60">4.4.2.1.2. Date and time format conversion of fields</a><a class="headerlink" href="#date-and-time-format-conversion-of-fields" title="Permalink to this headline">¶</a></h4>
<p>Date and time format for each field can be specified using <code class="docutils literal"><span class="pre">&#64;DateTimeFormat</span></code> annotation.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
<span class="hll">    <span class="nd">@DateTimeFormat</span><span class="o">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&quot;yyyyMMdd&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span>    <span class="kd">private</span> <span class="n">Date</span> <span class="n">birthDate</span><span class="o">;</span>
    <span class="c1">// omitted getter/setter</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify the date and time format of request parameter sent by HTML form. For example, <code class="docutils literal"><span class="pre">&quot;yyyyMMdd&quot;</span></code> format is specified as pattern.
When the value of request parameter is <code class="docutils literal"><span class="pre">&quot;20131001&quot;</span></code>, Date object of 1st October, 2013 will bind to property <code class="docutils literal"><span class="pre">birthDate</span></code> of form object.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Attributes of <code class="docutils literal"><span class="pre">&#64;DateTimeFormat</span></code> annotation are given below.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Attribute name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>iso</td>
<td>Specify ISO date and time format. For details refer to <a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/javadoc-api/org/springframework/format/annotation/DateTimeFormat.ISO.html">Javadoc of DateTimeFormat.ISO</a>.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>pattern</td>
<td>Specify Java date and time format. Refer to &#8216;Javadoc of SimpleDateFormat &lt;<a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/text/SimpleDateFormat.html">http://docs.oracle.com/javase/8/docs/api/java/text/SimpleDateFormat.html</a>&gt;&#8217;_for details.</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>style</td>
<td><div class="first last line-block">
<div class="line">Specify style of date and time as two-digit string.</div>
<div class="line">First digit will be style of date and second digit will be style of time.</div>
<div class="line">Values that can be specified as style are given below.</div>
<div class="line"><br /></div>
<div class="line">S : Format same as <code class="docutils literal"><span class="pre">java.text.DateFormat.SHORT</span></code>.</div>
<div class="line">M : Format same as <code class="docutils literal"><span class="pre">java.text.DateFormat.MEDIUM</span></code>.</div>
<div class="line">L : Format same as <code class="docutils literal"><span class="pre">java.text.DateFormat.LONG</span></code>.</div>
<div class="line">F : Format same as <code class="docutils literal"><span class="pre">java.text.DateFormat.FULL</span></code>.</div>
<div class="line">- : A style meaning omissions.</div>
<div class="line"><br /></div>
<div class="line">Example of specification and conversion)</div>
<div class="line">MM : Dec 9, 2013 3:37:47 AM</div>
<div class="line">M- : Dec 9, 2013</div>
<div class="line">-M : 3:41:45 AM</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="datatype-conversion-in-controller">
<h4><a class="toc-backref" href="#id61">4.4.2.1.3. DataType conversion in controller</a><a class="headerlink" href="#datatype-conversion-in-controller" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">&#64;InitBinder</span></code> annotation can be used to define datatype conversions at controller level.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@InitBinder</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">initWebDataBinder</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">binder</span><span class="o">.</span><span class="na">registerCustomEditor</span><span class="o">(</span>
            <span class="n">Long</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
<span class="hll">            <span class="k">new</span> <span class="n">CustomNumberEditor</span><span class="o">(</span><span class="n">Long</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">DecimalFormat</span><span class="o">(</span><span class="s">&quot;#,#&quot;</span><span class="o">),</span> <span class="kc">true</span><span class="o">));</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@InitBinder</span><span class="o">(</span><span class="s">&quot;sampleForm&quot;</span><span class="o">)</span> <span class="c1">// (3)</span>
</span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">initSampleFormWebDataBinder</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">If a method with <code class="docutils literal"><span class="pre">&#64;InitBinder</span></code> annotation is provided, it is called before executing the binding process and thereby default operations can be customized.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">For example, <code class="docutils literal"><span class="pre">&quot;#.</span> <span class="pre">#&quot;</span></code> format is specified for a field of type Long. This enables binding of value formatted with &#8221;,&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Default operation for each form object can be customized by specifying it in the value attribute of <code class="docutils literal"><span class="pre">&#64;InitBinder</span></code> annotation.</div>
<div class="line">In the above example, the method is called before binding form object <code class="docutils literal"><span class="pre">&quot;sampleForm&quot;</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="specifying-annotation-for-input-validation">
<h4><a class="toc-backref" href="#id62">4.4.2.1.4. Specifying annotation for input validation</a><a class="headerlink" href="#specifying-annotation-for-input-validation" title="Permalink to this headline">¶</a></h4>
<p>Since form object is validated using Bean Validation, it is necessary to specify the annotation which indicates constraints of the field.
Refer to <a class="reference internal" href="../ArchitectureInDetail/Validation.html"><em>Input Validation</em></a>  for the details of input validation.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="initializing-form-object">
<span id="formobject-init-label"></span><h3><a class="toc-backref" href="#id63">4.4.2.2. Initializing form object</a><a class="headerlink" href="#initializing-form-object" title="Permalink to this headline">¶</a></h3>
<p>Form object can also be called as form-backing bean and binding can be performed using <code class="docutils literal"><span class="pre">&#64;ModelAttribute</span></code> annotation.
Initialize form-backing bean by the method having <code class="docutils literal"><span class="pre">&#64;ModelAttribute</span></code> annotation.
In this guideline, such methods are called as ModelAttribute methods and defined with method names like <code class="docutils literal"><span class="pre">setUpXxxForm</span></code>.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@ModelAttribute</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">SampleForm</span> <span class="nf">setUpSampleForm</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">SampleForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleForm</span><span class="o">();</span>
    <span class="c1">// populate form</span>
    <span class="k">return</span> <span class="n">form</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@ModelAttribute</span><span class="o">(</span><span class="s">&quot;xxx&quot;</span><span class="o">)</span> <span class="c1">// (2)</span>
</span><span class="kd">public</span> <span class="n">SampleForm</span> <span class="nf">setUpSampleForm</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">SampleForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleForm</span><span class="o">();</span>
    <span class="c1">// populate form</span>
    <span class="k">return</span> <span class="n">form</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@ModelAttribute</span>
<span class="kd">public</span> <span class="n">SampleForm</span> <span class="nf">setUpSampleForm</span><span class="o">(</span>
<span class="hll">        <span class="nd">@CookieValue</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="c1">// (3)</span>
</span>        <span class="nd">@CookieValue</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;age&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">,</span>
        <span class="nd">@CookieValue</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;birthDate&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="n">Date</span> <span class="n">birthDate</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">SampleForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleForm</span><span class="o">();</span>
    <span class="n">form</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
    <span class="n">form</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="n">age</span><span class="o">);</span>
    <span class="n">form</span><span class="o">.</span><span class="na">setBirthDate</span><span class="o">(</span><span class="n">birthDate</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">form</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Class name beginning with lower case letter will become the attribute name to add to <code class="docutils literal"><span class="pre">Model</span></code>. In the above example, <code class="docutils literal"><span class="pre">&quot;sampleForm&quot;</span></code> is the attribute name.</div>
<div class="line">The returned object is added to <code class="docutils literal"><span class="pre">Model</span></code> and an appropriate process <code class="docutils literal"><span class="pre">model.addAttribute(form)</span></code> is executed.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When attribute name is to be specified to add to <code class="docutils literal"><span class="pre">Model</span></code>, specify it in the value attribute of <code class="docutils literal"><span class="pre">&#64;ModelAttribute</span></code> annotation. In the above example, <code class="docutils literal"><span class="pre">&quot;xxx&quot;</span></code> is the attribute name.</div>
<div class="line">For returned object, appropriate process &#8220;model.addAttribute(&#8220;xxx&#8221;, form)&#8221;is executed and it is returned to <code class="docutils literal"><span class="pre">Model</span></code>.</div>
<div class="line">When attribute name other than default value is specified, it is necessary to specify <code class="docutils literal"><span class="pre">&#64;ModelAttribute(&quot;xxx&quot;)</span></code> at the time of specifying form object as an argument of processing method.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">ModelAttribute method can pass the parameters required for initialization as with the case of processing method. In the above example, value of cookie is specified using <code class="docutils literal"><span class="pre">&#64;CookieValue</span></code> annotation.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When form object is to be initialized with default values, it should be done using ModelAttribute method.
In point (3) in above example , value is fetched from cookie, However, fixed value defined in constant class can be set directly.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Multiple ModelAttribute methods can be defined in the controller. Each method is executed before calling processing method of controller.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If ModelAttribute method is executed for each request, initialization needs to be repeated for each request and unnecessary objects will get created.
So, for form objects which are required only for specific requests, should be created inside processing method of controller and not through the use of ModelAttribute method.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="binding-to-html-form">
<span id="formobject-bindhtmlform-label"></span><span id="formobjectjsp"></span><h3><a class="toc-backref" href="#id64">4.4.2.3. Binding to HTML form</a><a class="headerlink" href="#binding-to-html-form" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">It is possible to bind form object added to the <code class="docutils literal"><span class="pre">Model</span></code> to HTML form(JSP) using <code class="docutils literal"><span class="pre">&lt;form:xxx&gt;</span></code> tag.</div>
<div class="line">For the details of <code class="docutils literal"><span class="pre">&lt;form:xxx&gt;</span></code> tag, refer to <a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/view.html#view-jsp-formtaglib">Using Spring&#8217;s form tag library</a>.</div>
</div>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll"><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;form&quot;</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://www.springframework.org/tags/form&quot;</span> <span class="k">%&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span></pre></div>
</div>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;sampleForm&quot;</span>
<span class="hll">           <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/sample/hello&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">    Id         : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;id&quot;</span> <span class="nt">/&gt;&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;id&quot;</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
</span>    Name       : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span>
    Age        : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="nt">/&gt;&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span>
    Gender     : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;genderCode&quot;</span> <span class="nt">/&gt;&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;genderCode&quot;</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span>
    Birth Date : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;birthDate&quot;</span> <span class="nt">/&gt;&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;birthDate&quot;</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Define taglib to use <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> tag.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Specify form object stored in <code class="docutils literal"><span class="pre">Model</span></code> in the <code class="docutils literal"><span class="pre">modelAttribute</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> tag.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Specify property name of form object in path attribute of <code class="docutils literal"><span class="pre">&lt;form:input&gt;</span></code> tag.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="binding-request-parameters">
<span id="formobject-bindrequestparam-label"></span><h3><a class="toc-backref" href="#id65">4.4.2.4. Binding request parameters</a><a class="headerlink" href="#binding-request-parameters" title="Permalink to this headline">¶</a></h3>
<p>It is possible to bind the request parameters sent by HTML form to form object and pass it as an argument to the processing method of controller.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span>
<span class="hll">        <span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="c1">// (1)</span>
</span>        <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span>
        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;sample/input&quot;</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// process form...</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@ModelAttribute</span><span class="o">(</span><span class="s">&quot;xxx&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">SampleForm</span> <span class="nf">setUpSampleForm</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">SampleForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleForm</span><span class="o">();</span>
    <span class="c1">// populate form</span>
    <span class="k">return</span> <span class="n">form</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span>
<span class="hll">        <span class="nd">@ModelAttribute</span><span class="o">(</span><span class="s">&quot;xxx&quot;</span><span class="o">)</span> <span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="c1">// (2)</span>
</span>        <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span>
        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Form object is passed as an argument to the processing method of controller after reflecting request parameters to the form object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When the attribute name is specified in ModelAttribute method, it is necessary to explicitly specify attribute name of form object as <code class="docutils literal"><span class="pre">&#64;ModelAttribute(&quot;xxx&quot;)</span></code>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When attribute name specified by ModelAttribute method and attribute name specified in the <code class="docutils literal"><span class="pre">&#64;ModelAttribute(&quot;xxx&quot;)</span></code> in the argument of processing method are different,
it should be noted that a new instance is created other than the instance created by ModelAttribute method.
When attribute name is not specified with <code class="docutils literal"><span class="pre">&#64;ModelAttribute</span></code> in the argument to processing method, the attribute name is deduced as the class name with first letter in lower case.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="determining-binding-result">
<h4><a class="toc-backref" href="#id66">4.4.2.4.1. Determining binding result</a><a class="headerlink" href="#determining-binding-result" title="Permalink to this headline">¶</a></h4>
<p>Error (including input validation error) that occurs while binding request parameter sent by HTML form to form object, is stored in <code class="docutils literal"><span class="pre">org.springframework.validation.BindingResult</span></code>.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span>
        <span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span>
<span class="hll">        <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span> <span class="c1">// (1)</span>
</span>        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
<span class="hll">    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span> <span class="c1">// (2)</span>
</span>        <span class="k">return</span> <span class="s">&quot;sample/input&quot;</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>When <code class="docutils literal"><span class="pre">BindingResult</span></code> is declared immediately after form object, it is possible to refer to the error inside the processing method of controller.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Calling <code class="docutils literal"><span class="pre">BindingResult.hasErrors()</span></code> can determine whether any error occurred in the input values of form object.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>It is also possible to determine field errors, global errors (correlated check errors at class level) separately. These can be used separately if required.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="40%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Method</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td><code class="docutils literal"><span class="pre">hasGlobalErrors()</span></code></td>
<td>Method to determine the existence of global errors.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td><code class="docutils literal"><span class="pre">hasFieldErrors()</span></code></td>
<td>Method to determine the existence of field errors.</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td><code class="docutils literal"><span class="pre">hasFieldErrors(String</span> <span class="pre">field)</span></code></td>
<td>Method to determine the existence of errors related to specified field.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="implementing-view">
<span id="view"></span><h2><a class="toc-backref" href="#id67">4.4.3. Implementing View</a><a class="headerlink" href="#implementing-view" title="Permalink to this headline">¶</a></h2>
<p>View plays the following role.</p>
<ol class="arabic">
<li><div class="first line-block">
<div class="line"><strong>View generates response (HTML) as per the requirements of the client.</strong></div>
<div class="line">View retrieves the required data from model (form object or domain object) and generates response in the format which is required by the client for rendering.</div>
</div>
</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="implementing-jsp">
<h3><a class="toc-backref" href="#id68">4.4.3.1. Implementing JSP</a><a class="headerlink" href="#implementing-jsp" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Implement View using JSP to generate response(HTML) as per the requirement of the client.</div>
<div class="line">Use the class provided by Spring Framework as the <code class="docutils literal"><span class="pre">ViewResolver</span></code> for calling JSP. Refer to <a class="reference internal" href="#controller-method-return-html-label"><span>HTML response</span></a> for settings of <code class="docutils literal"><span class="pre">ViewResolver</span></code>.</div>
</div>
<p>Basic implementation method of JSP is described below.</p>
<ul class="simple">
<li><a class="reference internal" href="#view-jsp-include-label"><span>Creating common JSP for include</span></a></li>
<li><a class="reference internal" href="#view-jsp-out-label"><span>Displaying value stored in model</span></a></li>
<li><a class="reference internal" href="#view-jsp-outnumber-label"><span>Displaying numbers stored in model</span></a></li>
<li><a class="reference internal" href="#view-jsp-outdate-label"><span>Displaying date and time stored in model</span></a></li>
<li><a class="reference internal" href="#view-jsp-form-label"><span>Binding form object to HTML form</span></a></li>
<li><a class="reference internal" href="#view-jsp-errors-label"><span>Displaying input validation errors</span></a></li>
<li><a class="reference internal" href="#view-jsp-resultmessages-label"><span>Displaying message of processing result</span></a></li>
<li><a class="reference internal" href="#view-jsp-codelist-label"><span>Displaying codelist</span></a></li>
<li><a class="reference internal" href="#view-jsp-message-label"><span>Displaying fixed text content</span></a></li>
<li><a class="reference internal" href="#view-jsp-if-label"><span>Switching display according to conditions</span></a></li>
<li><a class="reference internal" href="#view-jsp-foreach-label"><span>Repeated display of collection elements</span></a></li>
<li><a class="reference internal" href="#view-jsp-pagination-label"><span>Displaying link for pagination</span></a></li>
<li><a class="reference internal" href="#view-jsp-authorization-label"><span>Switching display according to authority</span></a></li>
</ul>
<p>In this chapter, usage of main JSP tag libraries are described. However, refer to respective documents for the detailed usage since all JSP tag libraries are not described here.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="30%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">JSP tag library name</th>
<th class="head">Document</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>Spring&#8217;s form tag library</td>
<td><ul class="first last simple">
<li><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/view.html#view-jsp-formtaglib">http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/view.html#view-jsp-formtaglib</a></li>
<li><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/spring-form.tld.html">http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/spring-form.tld.html</a></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>Spring&#8217;s tag library</td>
<td><ul class="first last simple">
<li><a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/spring.tld.html">http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/spring.tld.html</a></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>JSTL</td>
<td><ul class="first last simple">
<li><a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/</a></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="4">
<li></li>
</ol>
</td>
<td>Common library&#8217;s tags &amp; el functions</td>
<td><ul class="first last simple">
<li>[<a class="reference internal" href="../Appendix/TagLibAndELFunctions.html"><em>JSP Tag Libraries and EL Functions offered by common library</em></a>] of this guideline</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>If terasoluna-gfw-web 1.0.0.RELEASE is being used, <code class="docutils literal"><span class="pre">action</span></code> tag must be always be specified while using <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> tag of Spring&#8217;s form tag library.</p>
<p>terasoluna-gfw-web 1.0.0.RELEASE has a dependency on Spring MVC(3.2.4.RELEASE). In this version of Spring MVC, if <code class="docutils literal"><span class="pre">action</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> tag is not specified, it will
expose a vulnerability of XSS(Cross-site scripting).
For further details regarding the vulnerability, refer to <a class="reference external" href="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-1904">CVE-2014-1904 of National Vulnerability Database (NVD)</a>.</p>
<p class="last">Also, terasoluna-gfw-web 1.0.1.RELEASE have been upgraded to Spring MVC(3.2.10.RELEASE and above); hence this vulnerability is not present.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="creating-common-jsp-for-include">
<span id="view-jsp-include-label"></span><h4><a class="toc-backref" href="#id69">4.4.3.1.1. Creating common JSP for include</a><a class="headerlink" href="#creating-common-jsp-for-include" title="Permalink to this headline">¶</a></h4>
<p>Create a JSP that contains directive declaration which are required by all the JSP files of the project.
By specifying this JSP in <code class="docutils literal"><span class="pre">&lt;jsp-config&gt;/&lt;jsp-property-group&gt;/&lt;include-prelude&gt;</span></code> element of <code class="docutils literal"><span class="pre">web.xml</span></code>, eliminates the need to declare these directives and each and every JSP file of the project.
Further, this file is provided in blank project also.</p>
<ul class="simple">
<li>include.jsp</li>
</ul>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll"><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;c&quot;</span><span class="k">%&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://java.sun.com/jsp/jstl/fmt&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;fmt&quot;</span><span class="k">%&gt;</span>

<span class="hll"><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://www.springframework.org/tags&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;spring&quot;</span><span class="k">%&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://www.springframework.org/tags/form&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;form&quot;</span><span class="k">%&gt;</span>
<span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://www.springframework.org/security/tags&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;sec&quot;</span><span class="k">%&gt;</span>

<span class="hll"><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://terasoluna.org/functions&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;f&quot;</span><span class="k">%&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://terasoluna.org/tags&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;t&quot;</span><span class="k">%&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>web.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;jsp-config&gt;</span>
    <span class="nt">&lt;jsp-property-group&gt;</span>
        <span class="nt">&lt;url-pattern&gt;</span>*.jsp<span class="nt">&lt;/url-pattern&gt;</span>
        <span class="nt">&lt;el-ignored&gt;</span>false<span class="nt">&lt;/el-ignored&gt;</span>
        <span class="nt">&lt;page-encoding&gt;</span>UTF-8<span class="nt">&lt;/page-encoding&gt;</span>
        <span class="nt">&lt;scripting-invalid&gt;</span>false<span class="nt">&lt;/scripting-invalid&gt;</span>
<span class="hll">        <span class="nt">&lt;include-prelude&gt;</span>/WEB-INF/views/common/include.jsp<span class="nt">&lt;/include-prelude&gt;</span> <span class="c">&lt;!-- (4) --&gt;</span>
</span>    <span class="nt">&lt;/jsp-property-group&gt;</span>
<span class="nt">&lt;/jsp-config&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JSP tag libraries of JSTL are declared. In this example, <code class="docutils literal"><span class="pre">core</span></code> and <code class="docutils literal"><span class="pre">fmt</span></code> are used.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JSP tag libraries of Spring Framework are declared. In this example, <code class="docutils literal"><span class="pre">spring</span></code>, <code class="docutils literal"><span class="pre">form</span></code> and <code class="docutils literal"><span class="pre">sec</span></code> are used.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JSP tag libraries provided by common library are declared.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The contents specified in JSP to be included (<code class="docutils literal"><span class="pre">/WEB-INF/views/common/include.jsp</span></code>) are included at the beginning of each JSP (file specified in <code class="docutils literal"><span class="pre">&lt;url-pattern&gt;</span></code>).</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <code class="docutils literal"><span class="pre">JSP.1.10</span> <span class="pre">Directives</span></code> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jsp-2.2-mrel-eval-oth-JSpec/">JavaServer Pages Specification(Version2.2)</a>for details of directives.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <code class="docutils literal"><span class="pre">JSP.3.3</span> <span class="pre">JSP</span> <span class="pre">Property</span> <span class="pre">Groups</span></code> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jsp-2.2-mrel-eval-oth-JSpec/">JavaServer Pages Specification(Version2.2)</a>for details of &lt;jsp-property-group&gt; element.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-value-stored-in-model">
<span id="view-jsp-out-label"></span><h4><a class="toc-backref" href="#id70">4.4.3.1.2. Displaying value stored in model</a><a class="headerlink" href="#displaying-value-stored-in-model" title="Permalink to this headline">¶</a></h4>
<p>To display the value stored in <code class="docutils literal"><span class="pre">Model</span></code> (form object or domain object) in HTML, use EL expressions or JSP tag libraries provided by JSTL.</p>
<p>Display using EL expressions.</p>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
<span class="hll">    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">HelloBean</span><span class="o">(</span><span class="s">&quot;Bean Hello World!&quot;</span><span class="o">));</span> <span class="c1">// (1)</span>
</span>    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>hello.jsp</li>
</ul>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll">Message : ${f:h(helloBean.message)} <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add <code class="docutils literal"><span class="pre">HelloBean</span></code> object to <code class="docutils literal"><span class="pre">Model</span></code> object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In View(JSP), data added to the <code class="docutils literal"><span class="pre">Model</span></code> object can be retrieved by describing <code class="docutils literal"><span class="pre">${Attribute</span> <span class="pre">name.Property</span> <span class="pre">name</span> <span class="pre">of</span> <span class="pre">JavaBean}</span></code>.</div>
<div class="line">In this example, HTML escaping is performed using <code class="docutils literal"><span class="pre">${f:h(Attribute</span> <span class="pre">name.Property</span> <span class="pre">name</span> <span class="pre">of</span> <span class="pre">JavaBean)}</span></code> function of EL expression.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since HTML escaping function (<code class="docutils literal"><span class="pre">f:h</span></code>) is provided in the common components, always use it if EL expressions are used to output values in HTML.
For details of function of EL expression that perform HTML escaping, refer to <a class="reference internal" href="../Security/XSS.html"><em>Cross Site Scripting</em></a>.</p>
</div>
</div></blockquote>
<p>Display using <code class="docutils literal"><span class="pre">&lt;c:out&gt;</span></code> tag provided by JSP tag library of JSTL.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll">Message : <span class="nt">&lt;c:out</span> <span class="na">value=</span><span class="s">&quot;${helloBean.message}&quot;</span> <span class="nt">/&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the values fetched using EL expressions in <code class="docutils literal"><span class="pre">value</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;c:out&gt;</span></code> tag. HTML escaping is also performed.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <code class="docutils literal"><span class="pre">CHAPTER</span> <span class="pre">4</span> <span class="pre">General-Purpose</span> <span class="pre">Actions</span></code> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">JavaServer Pages Standard Tag Library(Version 1.2)</a>for the details of <code class="docutils literal"><span class="pre">&lt;c:out&gt;</span></code>.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-numbers-stored-in-model">
<span id="view-jsp-outnumber-label"></span><h4><a class="toc-backref" href="#id71">4.4.3.1.3. Displaying numbers stored in model</a><a class="headerlink" href="#displaying-numbers-stored-in-model" title="Permalink to this headline">¶</a></h4>
<p>Use JSP tag library provided by JSTL to output format number.</p>
<div class="line-block">
<div class="line">Display using <code class="docutils literal"><span class="pre">&lt;fmt:formatNumber&gt;</span></code> tag provided by JSP tag library of JSTL.</div>
</div>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll">Number Item : <span class="nt">&lt;fmt:formatNumber</span> <span class="na">value=</span><span class="s">&quot;${helloBean.numberItem}&quot;</span> <span class="na">pattern=</span><span class="s">&quot;0.00&quot;</span> <span class="nt">/&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the value acquired by EL expressions in  the value attribute of <code class="docutils literal"><span class="pre">&lt;fmt:formatNumber&gt;</span></code> tag. Specify the format to be displayed in pattern attribute. For example, &#8220;<code class="docutils literal"><span class="pre">0.00</span></code>&#8221; is specified .</div>
<div class="line">When the value acquired in <code class="docutils literal"><span class="pre">${helloBean.numberItem}</span></code> is &#8220;<code class="docutils literal"><span class="pre">1.2</span></code>&#8221; temporarily, &#8220;<code class="docutils literal"><span class="pre">1.20</span></code>&#8221; is displayed on the screen.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <code class="docutils literal"><span class="pre">CHAPTER</span> <span class="pre">9</span> <span class="pre">Formatting</span> <span class="pre">Actions</span></code> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">JavaServer Pages Standard Tag Library(Version 1.2)</a>for the details of <code class="docutils literal"><span class="pre">&lt;fmt:formatNumber&gt;</span></code>.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-date-and-time-stored-in-model">
<span id="view-jsp-outdate-label"></span><h4><a class="toc-backref" href="#id72">4.4.3.1.4. Displaying date and time stored in model</a><a class="headerlink" href="#displaying-date-and-time-stored-in-model" title="Permalink to this headline">¶</a></h4>
<p>Use JSP tag library provided by JSTL to output format date and time value.</p>
<p>Display using <code class="docutils literal"><span class="pre">&lt;fmt:formatDate&gt;</span></code> tag provided by JSP tag library of JSTL.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll">Date Item : <span class="nt">&lt;fmt:formatDate</span> <span class="na">value=</span><span class="s">&quot;${helloBean.dateItem}&quot;</span> <span class="na">pattern=</span><span class="s">&quot;yyyy-MM-dd&quot;</span> <span class="nt">/&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the value fetched using EL expression in <code class="docutils literal"><span class="pre">value</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;fmt:formatDate&gt;</span></code> tag. Specify the format to be displayed in <code class="docutils literal"><span class="pre">pattern</span></code> attribute. In this example, &#8220;<code class="docutils literal"><span class="pre">yyyy-MM-dd</span></code>&#8221; is specified.</div>
<div class="line">When value received for <code class="docutils literal"><span class="pre">${helloBean.dateItem}</span></code> is 2013-3-2, &#8220;<code class="docutils literal"><span class="pre">2013-03-02</span></code>&#8221; is displayed on the screen.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <code class="docutils literal"><span class="pre">CHAPTER</span> <span class="pre">9</span> <span class="pre">Formatting</span> <span class="pre">Actions</span></code> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">JavaServer Pages Standard Tag Library(Version 1.2)</a> for details of <code class="docutils literal"><span class="pre">&lt;fmt:formatDate&gt;</span></code>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">JSP tag library provided by Joda Time should be used to use <code class="docutils literal"><span class="pre">org.joda.time.DateTime</span></code> as date and time object type.
Refer to <a class="reference internal" href="../ArchitectureInDetail/Utilities/JodaTime.html"><em>Date Operations (Joda Time)</em></a>  for the details of Joda Time.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="binding-form-object-to-html-form">
<span id="view-jsp-form-label"></span><h4><a class="toc-backref" href="#id73">4.4.3.1.5. Binding form object to HTML form</a><a class="headerlink" href="#binding-form-object-to-html-form" title="Permalink to this headline">¶</a></h4>
<p>Use JSP tag library provided by Spring Framework to bind form object to HTML form and to display the values stored in form object.</p>
<p>Bind using <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> tag provided by Spring Framework.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;form:form</span> <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/sample/hello&quot;</span>
<span class="hll">           <span class="na">modelAttribute=</span><span class="s">&quot;sampleForm&quot;</span><span class="nt">&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">    Id : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;id&quot;</span> <span class="nt">/&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify attribute name of form object stored in <code class="docutils literal"><span class="pre">Model</span></code> in <code class="docutils literal"><span class="pre">modelAttribute</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> tag.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Specify name of property to bind in the <code class="docutils literal"><span class="pre">path</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;form:xxx&gt;</span></code> tag. <code class="docutils literal"><span class="pre">xxx</span></code> part changes along with each input element.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the details of <code class="docutils literal"><span class="pre">&lt;form:form&gt;</span></code> , <code class="docutils literal"><span class="pre">&lt;form:xxx&gt;</span></code> tag refer to <a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/view.html#view-jsp-formtaglib">Using Spring&#8217;s form tag library</a>.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-input-validation-errors">
<span id="view-jsp-errors-label"></span><h4><a class="toc-backref" href="#id74">4.4.3.1.6. Displaying input validation errors</a><a class="headerlink" href="#displaying-input-validation-errors" title="Permalink to this headline">¶</a></h4>
<p>To display the contents of input validation error, use JSP tag library provided by Spring Framework.</p>
<div class="line-block">
<div class="line">Display using <code class="docutils literal"><span class="pre">&lt;form:errors&gt;</span></code> tag provided by Spring Framework.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/Validation.html"><em>Input Validation</em></a> for details.</div>
</div>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;form:form</span> <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/sample/hello&quot;</span>
           <span class="na">modelAttribute=</span><span class="s">&quot;sampleForm&quot;</span><span class="nt">&gt;</span>
<span class="hll">    Id : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;id&quot;</span> <span class="nt">/&gt;&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;id&quot;</span> <span class="nt">/&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify name of the property to display the error in <code class="docutils literal"><span class="pre">path</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;form:errors&gt;</span></code> tag.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-message-of-processing-result">
<span id="view-jsp-resultmessages-label"></span><h4><a class="toc-backref" href="#id75">4.4.3.1.7. Displaying message of processing result</a><a class="headerlink" href="#displaying-message-of-processing-result" title="Permalink to this headline">¶</a></h4>
<p>To display the message notifying the output of processing the request, use JSP tag library provided in common components.</p>
<div class="line-block">
<div class="line">Use <code class="docutils literal"><span class="pre">&lt;t:messagesPanel&gt;</span></code> tag provided in common components.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/MessageManagement.html"><em>Message Management</em></a>  for details.</div>
</div>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;messages&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h2&gt;</span>Message pattern<span class="nt">&lt;/h2&gt;</span>
<span class="hll">    <span class="nt">&lt;t:messagesPanel</span> <span class="nt">/&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Messages stored with attribute name &#8220;<code class="docutils literal"><span class="pre">resultMessages</span></code>&#8221; are output.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-codelist">
<span id="view-jsp-codelist-label"></span><h4><a class="toc-backref" href="#id76">4.4.3.1.8. Displaying codelist</a><a class="headerlink" href="#displaying-codelist" title="Permalink to this headline">¶</a></h4>
<p>To display the codelist (provided in common components), use JSP tag library provided by Spring Framework.</p>
<div class="line-block">
<div class="line">Codelist can be referred from JSP in the same way as <code class="docutils literal"><span class="pre">java.util.Map</span></code> interface.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/Codelist.html"><em>Codelist</em></a>  for details.</div>
</div>
<p>Display codelist in select box.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;form:select</span> <span class="na">path=</span><span class="s">&quot;orderStatus&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form:option</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="na">label=</span><span class="s">&quot;--Select--&quot;</span> <span class="nt">/&gt;</span>
<span class="hll">    <span class="nt">&lt;form:options</span> <span class="na">items=</span><span class="s">&quot;${CL_ORDERSTATUS}&quot;</span> <span class="nt">/&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="nt">&lt;/form:select&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Codelist (<code class="docutils literal"><span class="pre">java.util.Map</span></code> interface) is stored with name (<code class="docutils literal"><span class="pre">&quot;CL_ORDERSTATUS&quot;</span></code>) as attribute name.
Therefore, in JSP, codelist (<code class="docutils literal"><span class="pre">java.util.Map</span></code> interface) can be accessed using EL expression.
Codelist can be displayed in select box by passing the object of <code class="docutils literal"><span class="pre">Map</span></code> interface to <code class="docutils literal"><span class="pre">items</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;form:options&gt;</span></code>.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Label part is displayed on the screen for the value selected in select box.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre>Order Status : ${f:h(CL_ORDERSTATUS[orderForm.orderStatus])}
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>In the same way as in case of creating select box, Codelist (<code class="docutils literal"><span class="pre">java.util.Map</span></code> interface) is stored with name (<code class="docutils literal"><span class="pre">&quot;CL_ORDERSTATUS&quot;</span></code>) as attribute name.
If value selected in select box is specified as key of the fetched <code class="docutils literal"><span class="pre">Map</span></code> interface, it is possible to display the code name.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-fixed-text-content">
<span id="view-jsp-message-label"></span><h4><a class="toc-backref" href="#id77">4.4.3.1.9. Displaying fixed text content</a><a class="headerlink" href="#displaying-fixed-text-content" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Strings for screen name, element name and guidance etc can be directly written in JSP when internationalization is not required.</div>
<div class="line">However, when internationalization is required, display the values acquired from property file using JSP tag library provided by Spring Framework.</div>
</div>
<div class="line-block">
<div class="line">Display using <code class="docutils literal"><span class="pre">&lt;spring:message&gt;</span></code> tag provided by Spring Framework.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/Internationalization.html"><em>Internationalization</em></a>  for details.</div>
</div>
<ul class="simple">
<li>properties</li>
</ul>
<blockquote>
<div><div class="highlight-properties"><div class="highlight"><pre><span class="hll"><span class="c"># (1)</span>
</span><span class="hll"><span class="na">label.orderStatus</span><span class="o">=</span><span class="s">Order status</span>
</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>jsp</li>
</ul>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;spring:message</span> <span class="na">code=</span><span class="s">&quot;label.orderStatus&quot;</span> <span class="na">text=</span><span class="s">&quot;Order Status&quot;</span> <span class="nt">/&gt;</span> : <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span>    ${f:h(CL_ORDERSTATUS[orderForm.orderStatus])}
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Define the string of label in properties file.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>If key in the properties file is specified in <code class="docutils literal"><span class="pre">code</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;spring:message&gt;</span></code>, string corresponding to the key is displayed.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The value specified in <code class="docutils literal"><span class="pre">text</span></code> attribute is displayed when property value could not be acquired.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="switching-display-according-to-conditions">
<span id="view-jsp-if-label"></span><h4><a class="toc-backref" href="#id78">4.4.3.1.10. Switching display according to conditions</a><a class="headerlink" href="#switching-display-according-to-conditions" title="Permalink to this headline">¶</a></h4>
<p>When display is to be switched according to some value in model, use JSP tag library provided by JSTL.</p>
<p>Switch display using <code class="docutils literal"><span class="pre">&lt;c:if&gt;</span></code> tag or <code class="docutils literal"><span class="pre">&lt;c:choose&gt;</span></code> provided by JSP tag library of JSTL.</p>
<p>Switching display by using <code class="docutils literal"><span class="pre">&lt;c:if&gt;</span></code>.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;c:if</span> <span class="na">test=</span><span class="s">&quot;${orderForm.orderStatus != &#39;complete&#39;}&quot;</span><span class="nt">&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span>        <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">...</span> <span class="o">--</span><span class="k">%&gt;</span>
<span class="nt">&lt;/c:if&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Put the condition for entering the branch in <code class="docutils literal"><span class="pre">test</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;c:if&gt;</span></code>. In this example, when order status is not <code class="docutils literal"><span class="pre">'complete'</span></code>, the contents of the branch will be displayed.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Switching display using <code class="docutils literal"><span class="pre">&lt;c:choose&gt;</span></code>.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;c:choose&gt;</span>
<span class="hll">    <span class="nt">&lt;c:when</span> <span class="na">test=</span><span class="s">&quot;${customer.type == &#39;premium&#39;}&quot;</span><span class="nt">&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span>        <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">...</span> <span class="o">--</span><span class="k">%&gt;</span>
    <span class="nt">&lt;/c:when&gt;</span>
    <span class="nt">&lt;c:when</span> <span class="na">test=</span><span class="s">&quot;${customer.type == &#39;general&#39;}&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">...</span> <span class="o">--</span><span class="k">%&gt;</span>
    <span class="nt">&lt;/c:when&gt;</span>
<span class="hll">    <span class="nt">&lt;c:otherwise&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span>        <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">...</span> <span class="o">--</span><span class="k">%&gt;</span>
    <span class="nt">&lt;/c:otherwise&gt;</span>
<span class="nt">&lt;/c:choose&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Put the condition for entering the branch in <code class="docutils literal"><span class="pre">test</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;c:when&gt;</span></code>. In this example, when customer type is <code class="docutils literal"><span class="pre">'premium'</span></code>, the contents of the branch will be displayed.
When condition specified in <code class="docutils literal"><span class="pre">test</span></code> attribute is <code class="docutils literal"><span class="pre">false</span></code>, next <code class="docutils literal"><span class="pre">&lt;c:when&gt;</span></code> tag is processed.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>When result of <code class="docutils literal"><span class="pre">test</span></code> attribute of all <code class="docutils literal"><span class="pre">&lt;c:when&gt;</span></code> tags is <code class="docutils literal"><span class="pre">false</span></code>, <code class="docutils literal"><span class="pre">&lt;c:otherwise&gt;</span></code> tag is evaluated.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <code class="docutils literal"><span class="pre">CHAPTER</span> <span class="pre">5</span> <span class="pre">Conditional</span> <span class="pre">Actions</span></code> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">JavaServer Pages Standard Tag Library(Version 1.2)</a>for details.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="repeated-display-of-collection-elements">
<span id="view-jsp-foreach-label"></span><h4><a class="toc-backref" href="#id79">4.4.3.1.11. Repeated display of collection elements</a><a class="headerlink" href="#repeated-display-of-collection-elements" title="Permalink to this headline">¶</a></h4>
<p>To repeat display of collection stored in model, use JSP tag library provided by JSTL.</p>
<p>Repeated display can be done using <code class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></code> provided by JSP tag library of JSTL.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;table&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;</span>No<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Name<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
<span class="hll">    <span class="nt">&lt;c:forEach</span> <span class="na">var=</span><span class="s">&quot;customer&quot;</span> <span class="na">items=</span><span class="s">&quot;${customers}&quot;</span> <span class="na">varStatus=</span><span class="s">&quot;status&quot;</span><span class="nt">&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span>        <span class="nt">&lt;tr&gt;</span>
<span class="hll">            <span class="nt">&lt;td&gt;</span>${status.count}<span class="nt">&lt;/td&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">            <span class="nt">&lt;td&gt;</span>${f:h(customer.name)}<span class="nt">&lt;/td&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span>        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/c:forEach&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>By specifying the collection object in <code class="docutils literal"><span class="pre">items</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></code> tag, <code class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></code> tag is repeatedly executed to iterate over the collection.
While iterating over the collection, if the current element is to be referred inside <code class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></code> tag, it can be done by specifying a variable name for the
current element in <code class="docutils literal"><span class="pre">var</span></code> attribute.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>By specifying a variable name in <code class="docutils literal"><span class="pre">varStatus</span></code> attribute,  current position (count) of iteration in <code class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></code>  tag can be fetched.
Refer to <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">JavaDoc</a>of <code class="docutils literal"><span class="pre">javax.servlet.jsp.jstl.core.LoopTagStatus</span></code> for attributes other than count.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>This is the value acquired from the object stored in variable specified by <code class="docutils literal"><span class="pre">var</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></code> tag.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <code class="docutils literal"><span class="pre">CHAPTER</span> <span class="pre">6</span> <span class="pre">Iterator</span> <span class="pre">Actions</span></code> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">JavaServer Pages Standard Tag Library(Version 1.2)</a>for details.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-link-for-pagination">
<span id="view-jsp-pagination-label"></span><h4><a class="toc-backref" href="#id80">4.4.3.1.12. Displaying link for pagination</a><a class="headerlink" href="#displaying-link-for-pagination" title="Permalink to this headline">¶</a></h4>
<p>To display links of pagination on the screen while displaying the list, use JSP tag library provided in common components.</p>
<p>Display the link for pagination using <code class="docutils literal"><span class="pre">&lt;t:pagination&gt;</span></code> provided in common components.
Refer to <a class="reference internal" href="../ArchitectureInDetail/Pagination.html"><em>Pagination</em></a>  for details.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="switching-display-according-to-authority">
<span id="view-jsp-authorization-label"></span><h4><a class="toc-backref" href="#id81">4.4.3.1.13. Switching display according to authority</a><a class="headerlink" href="#switching-display-according-to-authority" title="Permalink to this headline">¶</a></h4>
<p>To switch display according to authority of the user who has logged in, use JSP tag library provided by Spring Security.</p>
<p>Switch display using <code class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></code> provided by Spring Security.
Refer to <a class="reference internal" href="../Security/Authorization.html"><em>Authorization</em></a>  for details.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="implementing-javascript">
<h3><a class="toc-backref" href="#id82">4.4.3.2. Implementing JavaScript</a><a class="headerlink" href="#implementing-javascript" title="Permalink to this headline">¶</a></h3>
<p>When it is necessary to control screen items (controls of hide/display, activate/deactivate, etc.) after screen rendering, control items using JavaScript.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p><strong>TBD</strong></p>
<p class="last">Details will be included in the coming versions.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-style-sheet">
<h3><a class="toc-backref" href="#id83">4.4.3.3. Implementing style sheet</a><a class="headerlink" href="#implementing-style-sheet" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">It is recommended to specify attribute values related to screen design in style sheet (css file) and not in JSP(HTML) directly.</div>
<div class="line">In JSP(HTML), specify <code class="docutils literal"><span class="pre">id</span></code> attribute to identify the items uniquely and <code class="docutils literal"><span class="pre">class</span></code> attribute which indicates classification of elements.</div>
<div class="line">While, specify values related to actual location of elements or appearance should be specified in style sheet (css file).</div>
<div class="line">By configuring in this way, it is possible to reduce the design related aspects from the implementation of JSP.</div>
<div class="line">Simultaneously, if there is any change in design, only style sheet (css file) is modified and not JSP.</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When form is created using <code class="docutils literal"><span class="pre">&lt;form:xxx&gt;</span></code>, <code class="docutils literal"><span class="pre">id</span></code> attribute will be set automatically. Application developer should specify <code class="docutils literal"><span class="pre">class</span></code> attribute.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="implementing-common-logic">
<h2><a class="toc-backref" href="#id84">4.4.4. Implementing common logic</a><a class="headerlink" href="#implementing-common-logic" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="implementing-common-logic-to-be-executed-before-and-after-calling-controller">
<h3><a class="toc-backref" href="#id85">4.4.4.1. Implementing common logic to be executed before and after calling controller</a><a class="headerlink" href="#implementing-common-logic-to-be-executed-before-and-after-calling-controller" title="Permalink to this headline">¶</a></h3>
<p>Here, common logic indicates processes which are required to be executed before and after execution the controller.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="implementing-servlet-filter">
<h4><a class="toc-backref" href="#id86">4.4.4.1.1. Implementing Servlet Filter</a><a class="headerlink" href="#implementing-servlet-filter" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Common processes independent of Spring MVC are implemented using Servlet Filter.</div>
<div class="line">However, when common processes are to be executed only for the certain requests mapped with processing method of controller,</div>
<div class="line">then it should be implemented using Handler Interceptor and not Servlet Filter.</div>
</div>
<div class="line-block">
<div class="line">Samples of Servlet Filter are given below.</div>
<div class="line">In sample code, value is stored in <code class="docutils literal"><span class="pre">MDC</span></code> in order to output the log of IP address of client.</div>
</div>
<ul class="simple">
<li>java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClientInfoPutFilter</span> <span class="kd">extends</span> <span class="n">OncePerRequestFilter</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">ATTRIBUTE_NAME</span> <span class="o">=</span> <span class="s">&quot;X-Forwarded-For&quot;</span><span class="o">;</span>
    <span class="kd">protected</span> <span class="kd">final</span> <span class="kt">void</span> <span class="nf">doFilterInternal</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span>
            <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">FilterChain</span> <span class="n">filterChain</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">remoteIp</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getHeader</span><span class="o">(</span><span class="n">ATTRIBUTE_NAME</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">remoteIp</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">remoteIp</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRemoteAddr</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">MDC</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ATTRIBUTE_NAME</span><span class="o">,</span> <span class="n">remoteIp</span><span class="o">);</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">filterChain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">MDC</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">ATTRIBUTE_NAME</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>web.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;filter&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span>    <span class="nt">&lt;filter-name&gt;</span>clientInfoPutFilter<span class="nt">&lt;/filter-name&gt;</span>
    <span class="nt">&lt;filter-class&gt;</span>x.y.z.ClientInfoPutFilter<span class="nt">&lt;/filter-class&gt;</span>
<span class="nt">&lt;/filter&gt;</span>
<span class="hll"><span class="nt">&lt;filter-mapping&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
</span>    <span class="nt">&lt;filter-name&gt;</span>clientInfoPutFilter<span class="nt">&lt;/filter-name&gt;</span>
    <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/filter-mapping&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>In sample, it is guaranteed that it is executed only once for similar requests by creating the Servlet Filter as subclass
of <code class="docutils literal"><span class="pre">org.springframework.web.filter.OncePerRequestFilter</span></code> provided by Spring Framework.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Register the created Servlet Filter in <code class="docutils literal"><span class="pre">web.xml</span></code>.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Specify URL pattern to apply the registered Servlet Filter.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Servlet Filter can also be defined as Bean of Spring Framework.</p>
<ul class="simple">
<li>web.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;filter&gt;</span>
    <span class="nt">&lt;filter-name&gt;</span>clientInfoPutFilter<span class="nt">&lt;/filter-name&gt;</span>
<span class="hll">    <span class="nt">&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class="nt">&lt;/filter-class&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="nt">&lt;/filter&gt;</span>
<span class="nt">&lt;filter-mapping&gt;</span>
    <span class="nt">&lt;filter-name&gt;</span>clientInfoPutFilter<span class="nt">&lt;/filter-name&gt;</span>
    <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/filter-mapping&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>applicationContext.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;clientInfoPutFilter&quot;</span> <span class="na">class=</span><span class="s">&quot;x.y.z.ClientInfoPutFilter&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>In sample, process is delegated to Servlet Filter defined in step (2) by specifying <code class="docutils literal"><span class="pre">org.springframework.web.filter.DelegatingFilterProxy</span></code>
provided by Spring Framework in Servlet Filter class.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Add the Servlet Filter class to Bean definition file (<code class="docutils literal"><span class="pre">applicationContext.xml</span></code>).
At this time, <code class="docutils literal"><span class="pre">id</span></code> attribute of bean definition should be assigned with the filter name (value specified in <code class="docutils literal"><span class="pre">&lt;filter-name&gt;</span></code> tag) specified in <code class="docutils literal"><span class="pre">web.xml</span></code>.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-handlerinterceptor">
<h4><a class="toc-backref" href="#id87">4.4.4.1.2. Implementing HandlerInterceptor</a><a class="headerlink" href="#implementing-handlerinterceptor" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Common processes dependent on Spring MVC are implemented using HandlerInterceptor.</div>
<div class="line">HandlerInterceptor can execute common processes only for the requests which are allowed by the application since it is called after the determining the processing method</div>
<div class="line">to which the request is to be mapped to.</div>
</div>
<p>HandlerInterceptor can execute the process keeping in mind the following 3 points.</p>
<ul>
<li><div class="first line-block">
<div class="line">Before executing processing method of controller</div>
<div class="line">Implemented as <code class="docutils literal"><span class="pre">HandlerInterceptor#preHandle</span></code> method.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">After successfully executing processing method of controller</div>
<div class="line">Implemented as <code class="docutils literal"><span class="pre">HandlerInterceptor#postHandle</span></code> method.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">After completion of processing method of controller (executed irrespective of Normal / Abnormal)</div>
<div class="line">Implemented as <code class="docutils literal"><span class="pre">HandlerInterceptor#afterCompletion</span></code> method.</div>
</div>
</li>
</ul>
<div class="line-block">
<div class="line">Sample of HandlerInterceptor is given below.</div>
<div class="line">In sample code, log of info level is output after successfully executing controller process.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SuccessLoggingInterceptor</span> <span class="kd">extends</span> <span class="n">HandlerInterceptorAdapter</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LoggerFactory</span>
            <span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">SuccessLoggingInterceptor</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postHandle</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span>
            <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">Object</span> <span class="n">handler</span><span class="o">,</span>
            <span class="n">ModelAndView</span> <span class="n">modelAndView</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">HandlerMethod</span> <span class="n">handlerMethod</span> <span class="o">=</span> <span class="o">(</span><span class="n">HandlerMethod</span><span class="o">)</span> <span class="n">handler</span><span class="o">;</span>
        <span class="n">Method</span> <span class="n">m</span> <span class="o">=</span> <span class="n">handlerMethod</span><span class="o">.</span><span class="na">getMethod</span><span class="o">();</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&quot;[SUCCESS CONTROLLER] {}.{}&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="o">{</span>
                <span class="n">m</span><span class="o">.</span><span class="na">getDeclaringClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">(),</span> <span class="n">m</span><span class="o">.</span><span class="na">getName</span><span class="o">()});</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>spring-mvc.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;mvc:interceptors&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;mvc:interceptor&gt;</span>
<span class="hll">        <span class="nt">&lt;mvc:mapping</span> <span class="na">path=</span><span class="s">&quot;/**&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;mvc:exclude-mapping</span> <span class="na">path=</span><span class="s">&quot;/resources/**&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
</span>        <span class="nt">&lt;mvc:exclude-mapping</span> <span class="na">path=</span><span class="s">&quot;/**/*.html&quot;</span> <span class="nt">/&gt;</span>
<span class="hll">        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;x.y.z.SuccessLoggingInterceptor&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (4) --&gt;</span>
</span>    <span class="nt">&lt;/mvc:interceptor&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/mvc:interceptors&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>In sample, HandlerInterceptor is created as the subclass of <code class="docutils literal"><span class="pre">org.springframework.web.servlet.handler.HandlerInterceptorAdapter</span></code> provided by Spring Framework.
Since <code class="docutils literal"><span class="pre">HandlerInterceptorAdapter</span></code> provides blank implementation of <code class="docutils literal"><span class="pre">HandlerInterceptor</span></code> interface, it is not required to implement unnecessary methods in the subclass.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Specify the pattern of path, where the created HandlerInterceptor is to be applied.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Specify the pattern of path, where the created HandlerInterceptor need not be applied.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td>Add the created HandlerInterceptor to <code class="docutils literal"><span class="pre">&lt;mvc:interceptors&gt;</span></code> tag of <code class="docutils literal"><span class="pre">spring-mvc.xml</span></code>.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="implementing-common-processes-of-controller">
<h3><a class="toc-backref" href="#id88">4.4.4.2. Implementing common processes of controller</a><a class="headerlink" href="#implementing-common-processes-of-controller" title="Permalink to this headline">¶</a></h3>
<p>Here, common process indicates the process that should be commonly implemented in all the controllers.</p>
<div class="section" id="implementing-handlermethodargumentresolver">
<span id="methodargumentresolver"></span><h4><a class="toc-backref" href="#id89">4.4.4.2.1. Implementing HandlerMethodArgumentResolver</a><a class="headerlink" href="#implementing-handlermethodargumentresolver" title="Permalink to this headline">¶</a></h4>
<p>When an object that is not supported by default in Spring Framework is to be passed as controller argument,
HandlerMethodArgumentResolver is to be implemented in order to enable controller to be able to receive the argument.</p>
<div class="line-block">
<div class="line">Sample of HandlerMethodArgumentResolver is given below.</div>
<div class="line">In sample code, common request parameters are converted to JavaBean which are then passed to processing method of controller.</div>
</div>
<ul class="simple">
<li>JavaBean</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CommonParameters</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">param1</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">param2</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">param3</span><span class="o">;</span>

    <span class="c1">// ....</span>

<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>HandlerMethodArgumentResolver</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CommonParametersMethodArgumentResolver</span> <span class="kd">implements</span>
<span class="hll">                                                   <span class="n">HandlerMethodArgumentResolver</span> <span class="o">{</span> <span class="c1">// (2)</span>
</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supportsParameter</span><span class="o">(</span><span class="n">MethodParameter</span> <span class="n">parameter</span><span class="o">)</span> <span class="o">{</span>
<span class="hll">        <span class="k">return</span> <span class="n">CommonParameters</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">parameter</span><span class="o">.</span><span class="na">getParameterType</span><span class="o">());</span> <span class="c1">// (3)</span>
</span>    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">resolveArgument</span><span class="o">(</span><span class="n">MethodParameter</span> <span class="n">parameter</span><span class="o">,</span>
            <span class="n">ModelAndViewContainer</span> <span class="n">mavContainer</span><span class="o">,</span> <span class="n">NativeWebRequest</span> <span class="n">webRequest</span><span class="o">,</span>
            <span class="n">WebDataBinderFactory</span> <span class="n">binderFactory</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
<span class="hll">        <span class="n">CommonParameters</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CommonParameters</span><span class="o">();</span> <span class="c1">// (4)</span>
</span>        <span class="n">params</span><span class="o">.</span><span class="na">setParam1</span><span class="o">(</span><span class="n">webRequest</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;param1&quot;</span><span class="o">));</span>
        <span class="n">params</span><span class="o">.</span><span class="na">setParam2</span><span class="o">(</span><span class="n">webRequest</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;param2&quot;</span><span class="o">));</span>
        <span class="n">params</span><span class="o">.</span><span class="na">setParam3</span><span class="o">(</span><span class="n">webRequest</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;param3&quot;</span><span class="o">));</span>
        <span class="k">return</span> <span class="n">params</span><span class="o">;</span>
    <span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>Controller</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;home&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">home</span><span class="o">(</span><span class="n">CommonParameters</span> <span class="n">commonParams</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (5)</span>
</span>    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;param1 : {}&quot;</span><span class="o">,</span><span class="n">commonParams</span><span class="o">.</span><span class="na">getParam1</span><span class="o">());</span>
    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;param2 : {}&quot;</span><span class="o">,</span><span class="n">commonParams</span><span class="o">.</span><span class="na">getParam2</span><span class="o">());</span>
    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;param3 : {}&quot;</span><span class="o">,</span><span class="n">commonParams</span><span class="o">.</span><span class="na">getParam3</span><span class="o">());</span>
    <span class="c1">// ...</span>
    <span class="k">return</span> <span class="s">&quot;sample/home&quot;</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>spring-mvc.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;mvc:annotation-driven&gt;</span>
    <span class="nt">&lt;mvc:argument-resolvers&gt;</span>
        <span class="c">&lt;!-- ... --&gt;</span>
<span class="hll">        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;x.y.z.CommonParametersMethodArgumentResolver&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (6) --&gt;</span>
</span>        <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;/mvc:argument-resolvers&gt;</span>
<span class="nt">&lt;/mvc:annotation-driven&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>JavaBean that retains common parameters.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Implement <code class="docutils literal"><span class="pre">org.springframework.web.method.support.HandlerMethodArgumentResolver</span></code> interface.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Determine parameter type. For example, when type of JavaBean that retains common parameters is specified as argument of controller,
resolveArgument method of this class is called.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td>Fetch the values of request parameters, set the parameters and return the JavaBean that retains the value of common parameters.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify JavaBean that retains common parameters in the argument of processing method of controller.</div>
<div class="line">Object returned in step (4) is passed.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td>Add the created HandlerMethodArgumentResolver to <code class="docutils literal"><span class="pre">&lt;mvc:argument-resolvers&gt;</span></code> tag of <code class="docutils literal"><span class="pre">spring-mvc.xml</span></code>.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When parameters are to be passed commonly to processing methods of all controllers, it is effective to convert the parameters to JavaBean using HandlerMethodArgumentResolver.
Parameters referred here are not restricted to request parameters.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-controlleradvice">
<span id="application-layer-controller-advice"></span><h4><a class="toc-backref" href="#id90">4.4.4.2.2. Implementing &#8220;&#64;ControllerAdvice&#8221;</a><a class="headerlink" href="#implementing-controlleradvice" title="Permalink to this headline">¶</a></h4>
<p>In a class with <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation,
implement common processes which are to be executed in multiple Controllers.</p>
<p>When a class with <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation is created, processes implemented using</p>
<ul class="simple">
<li>method with <code class="docutils literal"><span class="pre">&#64;InitBinder</span></code></li>
<li>method with <code class="docutils literal"><span class="pre">&#64;ExceptionHandler</span></code></li>
<li>method with <code class="docutils literal"><span class="pre">&#64;ModelAttribute</span></code></li>
</ul>
<p>can be applied to multiple Controllers.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation is a mechanism added from Spring Framework 3.2;
however, since the processing was applied to all Controllers, it could only implement common processes of entire application.</p>
<p class="last">From Spring Framework 4.0, it has been improved in such a way that controller can be specified flexibly for applying common processes.
With this improvement, it is possible to implement a common process in various granularities.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p id="application-layer-controller-advice-attribute">Methods to specify Controller (methods to specify attributes) for applying common processes are described below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="15%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Attribute</th>
<th class="head">Description and example of specification</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><code class="docutils literal"><span class="pre">annotations</span></code></td>
<td><p class="first">Specify annotation.</p>
<p>Common processes are applied for the Controllers with specified annotations.
An example of specifications is given below.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@ControllerAdvice</span><span class="o">(</span><span class="n">annotations</span> <span class="o">=</span> <span class="n">LoginFormModelAttributeSetter</span><span class="o">.</span><span class="na">LoginFormModelAttribute</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoginFormModelAttributeSetter</span> <span class="o">{</span>
    <span class="nd">@Target</span><span class="o">(</span><span class="n">ElementType</span><span class="o">.</span><span class="na">TYPE</span><span class="o">)</span>
    <span class="nd">@Retention</span><span class="o">(</span><span class="n">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nd">@interface</span> <span class="n">LoginFormModelAttribute</span> <span class="o">{}</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@LoginFormModelAttribute</span>
<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WelcomeController</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@LoginFormModelAttribute</span>
<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoginController</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<p class="last">In the above example, <code class="docutils literal"><span class="pre">&#64;LoginFormModelAttribute</span></code> annotation is assigned to <code class="docutils literal"><span class="pre">WelcomeController</span></code> and <code class="docutils literal"><span class="pre">LoginController</span></code>,
hence, common processes are applied to <code class="docutils literal"><span class="pre">WelcomeController</span></code> and <code class="docutils literal"><span class="pre">LoginController</span></code>.</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><code class="docutils literal"><span class="pre">assignableTypes</span></code></td>
<td><p class="first">Specify a class or an instance.</p>
<p>Common processes are applied for the Controllers which can be assigned (can be casted) to the specified class or interface.
When using this attribute, it is recommended to adopt a style that specifies a marker interface to indicate that it is a Controller using common process, in attribute value.
When this style is adopted, only the marker interface for common processes to be used needs to be implemented at Controller side.
An example of specifications is given below.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@ControllerAdvice</span><span class="o">(</span><span class="n">assignableTypes</span> <span class="o">=</span> <span class="n">ISODateInitBinder</span><span class="o">.</span><span class="na">ISODateApplicable</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ISODateInitBinder</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">ISODateApplicable</span> <span class="o">{}</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleController</span> <span class="kd">implements</span> <span class="n">ISODateApplicable</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<p class="last">In the above example, <code class="docutils literal"><span class="pre">SampleController</span></code> implements <code class="docutils literal"><span class="pre">&#64;ISODateApplicable</span></code> interface (Marker interface),
hence, common processes are applied to <code class="docutils literal"><span class="pre">SampleController</span></code>.</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><code class="docutils literal"><span class="pre">basePackageClasses</span></code></td>
<td><p class="first">Specify a class or an interface.</p>
<p>Common processes are applied for the Controllers under the package of specified class or interface.</p>
<p>When using this attribute, it is recommended to adopt a style that specifies,</p>
<ul class="simple">
<li>a class with <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code></li>
<li>a marker interface to identify the package</li>
</ul>
<p>in attribute value.
An example to specify the same is given below.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.app</span>

<span class="nd">@ControllerAdvice</span><span class="o">(</span><span class="n">basePackageClasses</span> <span class="o">=</span> <span class="n">AppGlobalExceptionHandler</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppGlobalExceptionHandler</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.app.sample</span>

<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleController</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In the above example, <code class="docutils literal"><span class="pre">SampleController</span></code> is stored under the package (<code class="docutils literal"><span class="pre">com.example.app</span></code>) in which (<code class="docutils literal"><span class="pre">AppGlobalExceptionHandler</span></code>) class with <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code>is stored.
Hence, common processes are applied to <code class="docutils literal"><span class="pre">SampleController</span></code>.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.app.common</span>

<span class="nd">@ControllerAdvice</span><span class="o">(</span><span class="n">basePackageClasses</span> <span class="o">=</span> <span class="n">AppPackage</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppGlobalExceptionHandler</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="nn">com.example.app</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AppPackage</span> <span class="o">{</span>
<span class="o">}</span>
</pre></div>
</div>
<p class="last">When package level of class with <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> is different than the class where Controller is stored, or when common processes are to be applied to multiple base packages,
it is better to create a marker interface to identify the packages.</p>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><code class="docutils literal"><span class="pre">basePackages</span></code></td>
<td><p class="first">Specify the package name.</p>
<p>Common processes are applied for the Controllers under the specified package.
An example of specifying the same is given below.</p>
<div class="last highlight-java"><div class="highlight"><pre><span class="nd">@ControllerAdvice</span><span class="o">(</span><span class="n">basePackages</span> <span class="o">=</span> <span class="s">&quot;com.example.app&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppGlobalExceptionHandler</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><code class="docutils literal"><span class="pre">value</span></code></td>
<td><p class="first">Alias to <code class="docutils literal"><span class="pre">basePackages</span></code>.</p>
<p>The operation is same as when <code class="docutils literal"><span class="pre">basePackages</span></code> attribute is specified.
An example of specifying the same is given below.</p>
<div class="last highlight-java"><div class="highlight"><pre><span class="nd">@ControllerAdvice</span><span class="o">(</span><span class="s">&quot;com.example.app&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppGlobalExceptionHandler</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><code class="docutils literal"><span class="pre">basePackageClasses</span></code> attribute / <code class="docutils literal"><span class="pre">basePackages</span></code> attribute / <code class="docutils literal"><span class="pre">value</span></code> attribute are the attributes
to specify base package that stores the Controller for applying common processes. However,
when <code class="docutils literal"><span class="pre">basePackageClasses</span></code> attribute is used,</p>
<ul class="simple">
<li>It is possible to prevent specifying the package that does not exist.</li>
<li>It is possible to get linked and change the package name on IDE.</li>
</ul>
<p class="last">Therefore, it is known as Type-safe specification method.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Implementation sample of <code class="docutils literal"><span class="pre">&#64;InitBinder</span></code> method is given below.</div>
<div class="line">In sample code, date that can be specified in request parameter is set to <code class="docutils literal"><span class="pre">&quot;yyyy/MM/dd&quot;</span></code> .</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@ControllerAdvice</span> <span class="c1">// (1)</span>
</span><span class="hll"><span class="nd">@Order</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="c1">// (2)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleControllerAdvice</span> <span class="o">{</span>

<span class="hll">    <span class="c1">// (3)</span>
</span><span class="hll">    <span class="nd">@InitBinder</span>
</span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinder</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SimpleDateFormat</span> <span class="n">dateFormat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleDateFormat</span><span class="o">(</span><span class="s">&quot;yyyy/MM/dd&quot;</span><span class="o">);</span>
        <span class="n">dateFormat</span><span class="o">.</span><span class="na">setLenient</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
        <span class="n">binder</span><span class="o">.</span><span class="na">registerCustomEditor</span><span class="o">(</span><span class="n">Date</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                <span class="k">new</span> <span class="n">CustomDateEditor</span><span class="o">(</span><span class="n">dateFormat</span><span class="o">,</span> <span class="kc">true</span><span class="o">));</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>It indicates that it is Bean of ControllerAdvice by assigning the <code class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></code> annotation.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Specify priority for common processes by assigning the <code class="docutils literal"><span class="pre">&#64;Order</span></code> annotation. It should be specified when multiple ControllerAdvice have ordering for example there are dependencies between them. Otherwise it is not necessary.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Implement <code class="docutils literal"><span class="pre">&#64;InitBinder</span></code> method. <code class="docutils literal"><span class="pre">&#64;InitBinder</span></code> method is applied to all Controllers.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Implementation sample of <code class="docutils literal"><span class="pre">&#64;ExceptionHandler</span></code> method is given below.</div>
<div class="line">In sample code, View of lock error screen is returned by handling <code class="docutils literal"><span class="pre">org.springframework.dao.PessimisticLockingFailureException</span></code>.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="c1">// (1)</span>
</span><span class="hll"><span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">PessimisticLockingFailureException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">handlePessimisticLockingFailureException</span><span class="o">(</span>
        <span class="n">PessimisticLockingFailureException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&quot;error/lockError&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Implement <code class="docutils literal"><span class="pre">&#64;ExceptionHandler</span></code> method. <code class="docutils literal"><span class="pre">&#64;ExceptionHandler</span></code> method is applied to all Controllers.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Implementation sample of <code class="docutils literal"><span class="pre">&#64;ModelAttribute</span></code> method is given below.</div>
<div class="line">In sample code, common request parameters are converted to JavaBean and stored in <code class="docutils literal"><span class="pre">Model</span></code>.</div>
</div>
<ul class="simple">
<li>ControllerAdvice</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="c1">// (1)</span>
</span><span class="hll"><span class="nd">@ModelAttribute</span>
</span><span class="kd">public</span> <span class="n">CommonParameters</span> <span class="nf">setUpCommonParameters</span><span class="o">(</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;param1&quot;</span><span class="o">,</span> <span class="n">defaultValue</span><span class="o">=</span><span class="s">&quot;def1&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">param1</span><span class="o">,</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;param2&quot;</span><span class="o">,</span> <span class="n">defaultValue</span><span class="o">=</span><span class="s">&quot;def2&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">param2</span><span class="o">,</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;param3&quot;</span><span class="o">,</span> <span class="n">defaultValue</span><span class="o">=</span><span class="s">&quot;def3&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">param3</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">CommonParameters</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CommonParameters</span><span class="o">();</span>
    <span class="n">params</span><span class="o">.</span><span class="na">setParam1</span><span class="o">(</span><span class="n">param1</span><span class="o">);</span>
    <span class="n">params</span><span class="o">.</span><span class="na">setParam2</span><span class="o">(</span><span class="n">param2</span><span class="o">);</span>
    <span class="n">params</span><span class="o">.</span><span class="na">setParam3</span><span class="o">(</span><span class="n">param3</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">params</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>Controller</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;home&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">home</span><span class="o">(</span><span class="nd">@ModelAttribute</span> <span class="n">CommonParameters</span> <span class="n">commonParams</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (2)</span>
</span>    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;param1 : {}&quot;</span><span class="o">,</span><span class="n">commonParams</span><span class="o">.</span><span class="na">getParam1</span><span class="o">());</span>
    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;param2 : {}&quot;</span><span class="o">,</span><span class="n">commonParams</span><span class="o">.</span><span class="na">getParam2</span><span class="o">());</span>
    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;param3 : {}&quot;</span><span class="o">,</span><span class="n">commonParams</span><span class="o">.</span><span class="na">getParam3</span><span class="o">());</span>
    <span class="c1">// ...</span>
    <span class="k">return</span> <span class="s">&quot;sample/home&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Implement <code class="docutils literal"><span class="pre">&#64;ModelAttribute</span></code> method. <code class="docutils literal"><span class="pre">&#64;ModelAttribute</span></code> method is applied to all Controllers.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Object created by <code class="docutils literal"><span class="pre">&#64;ModelAttribute</span></code> method is passed.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="prevention-of-double-submission">
<h2><a class="toc-backref" href="#id91">4.4.5. Prevention of double submission</a><a class="headerlink" href="#prevention-of-double-submission" title="Permalink to this headline">¶</a></h2>
<p>Measures should be taken to prevent double submission as the same process gets executed multiple times by clicking Send button multiple times or
refreshing (refresh using F5 button) the Finish screen.</p>
<p>For the problems occurring when countermeasures are not taken and details of implementation method, refer to <a class="reference internal" href="../ArchitectureInDetail/DoubleSubmitProtection.html"><em>Double Submit Protection</em></a> .</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="usage-of-session">
<h2><a class="toc-backref" href="#id92">4.4.6. Usage of session</a><a class="headerlink" href="#usage-of-session" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">In the default operations of Spring MVC, model (form object, domain object etc.) is not stored in session.</div>
<div class="line">When it is to be stored in session, it is necessary to assign  <code class="docutils literal"><span class="pre">&#64;SessionAttributes</span></code> annotation to the controller class.</div>
<div class="line">When input forms are split on multiple screens, usage of <code class="docutils literal"><span class="pre">&#64;SessionAttributes</span></code> annotation should be studied since model (form object, domain object etc.)</div>
<div class="line">can be shared between multiple requests for executing a series of screen transitions.</div>
<div class="line">However, whether to use <code class="docutils literal"><span class="pre">&#64;SessionAttributes</span></code> annotation should be determined after confirming the warning signs of using the session.</div>
</div>
<p>For details of session usage policy and implementation at the time of session usage, refer to <a class="reference internal" href="../ArchitectureInDetail/SessionManagement.html"><em>Session Management</em></a> .</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../ArchitectureInDetail/index.html" title="5. Architecture in Detail - TERASOLUNA Server Framework for Java (5.x)"
             >next</a> |</li>
        <li class="right" >
          <a href="InfrastructureLayer.html" title="4.3. Implementation of Infrastructure Layer"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.0.2.RELEASE documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >4. Application Development using TERASOLUNA Server Framework for Java (5.x)</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013-2016, NTT DATA.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.4.Theme by <a href="http://github.com/vkvn">vkvn</a>
    </div>
    
    <script>
    
    $(function() {
    	var $sidebar	= $('.sphinxsidebar'),
    		$window		= $(window),
    		offset		= $sidebar.offset(),
    		topPadding	= 3,
    		$scroll		= $('#scroll');
    	
    	$window.scroll(function() {
    		if ($scroll.is(':checked')) {
				if ($window.scrollTop() > offset.top) {
					$sidebar.stop().animate({
						marginTop:$window.scrollTop() - offset.top + topPadding
					});
				} else {
					$sidebar.stop().animate({
						marginTop:0
					});
				}
			}
		});
    	
    	var $navList = $('ul:first', $sidebar);
    	$('li:first', $navList).addClass('open');
    	
    	$navList.treeview({
    		persist: "location",
    		collapsed: true,
    		unique: false
    	});
    	
	});
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-46550814-1', 'terasolunaorg.github.io');
    ga('send', 'pageview');
    </script>
  </body>
</html>