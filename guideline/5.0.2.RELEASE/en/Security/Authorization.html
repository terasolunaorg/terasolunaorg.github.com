<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6.5. Authorization &mdash; TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.0.2.RELEASE documentation</title>
    
    <link rel="stylesheet" href="../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.0.2.RELEASE',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.0.2.RELEASE documentation" href="../index.html" />
    <link rel="up" title="6. Security for TERASOLUNA Server Framework for Java (5.x)" href="index.html" />
    <link rel="next" title="6.6. XSS Countermeasures" href="XSS.html" />
    <link rel="prev" title="6.4. Password Hashing" href="PasswordHashing.html" /><script src="../_static/jquery.treeview.js" type="text/javascript"></script>
<!-- <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'> -->
<link href="../_static/solarized-dark.css" rel="stylesheet">
<link href="../_static/jquery.treeview.css" rel="stylesheet">
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="XSS.html" title="6.6. XSS Countermeasures"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="PasswordHashing.html" title="6.4. Password Hashing"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.0.2.RELEASE documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">6. Security for TERASOLUNA Server Framework for Java (5.x)</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><label><input id="scroll" type="checkbox" checked> scroll sidebar</label>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">6.5. Authorization</a><ul>
<li><a class="reference internal" href="#overview">6.5.1. Overview</a><ul>
<li><a class="reference internal" href="#access-authorization-request-url">6.5.1.1. Access authorization (Request URL)</a></li>
<li><a class="reference internal" href="#access-authorization-jsp">6.5.1.2. Access authorization (JSP)</a></li>
<li><a class="reference internal" href="#access-authorization-method">6.5.1.3. Access authorization (Method)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use">6.5.2. How to use</a><ul>
<li><a class="reference internal" href="#id1">6.5.2.1. Access authorization (Request URL)</a><ul>
<li><a class="reference internal" href="#setting-sec-intercept-url-element">6.5.2.1.1. Setting <code class="docutils literal"><span class="pre">&lt;sec:intercept-url&gt;</span></code> element</a></li>
<li><a class="reference internal" href="#setting-the-url-for-which-access-authorization-is-not-controlled">6.5.2.1.2. Setting the URL for which access authorization is not controlled</a></li>
<li><a class="reference internal" href="#exception-handling-in-url-pattern">6.5.2.1.3. Exception handling in URL pattern</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id2">6.5.2.2. Access authorization (JSP)</a></li>
<li><a class="reference internal" href="#id3">6.5.2.3. Access authorization (Method)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-extend">6.5.3. How to extend</a><ul>
<li><a class="reference internal" href="#role-hierarchy-functionality">6.5.3.1. Role hierarchy functionality</a><ul>
<li><a class="reference internal" href="#common-settings">6.5.3.1.1. Common settings</a></li>
<li><a class="reference internal" href="#how-to-use-it-in-access-authorization-request-url-and-access-authorization-jsp">6.5.3.1.2. How to use it in access authorization (request URL) and access authorization (JSP)</a></li>
<li><a class="reference internal" href="#how-to-use-it-in-access-authorization-method">6.5.3.1.3. How to use it in access authorization (Method)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="PasswordHashing.html"
                        title="previous chapter">6.4. Password Hashing</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="XSS.html"
                        title="next chapter">6.6. XSS Countermeasures</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/Security/Authorization.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="authorization">
<h1>6.5. Authorization<a class="headerlink" href="#authorization" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id8">Overview</a><ul>
<li><a class="reference internal" href="#access-authorization-request-url" id="id9">Access authorization (Request URL)</a></li>
<li><a class="reference internal" href="#access-authorization-jsp" id="id10">Access authorization (JSP)</a></li>
<li><a class="reference internal" href="#access-authorization-method" id="id11">Access authorization (Method)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use" id="id12">How to use</a><ul>
<li><a class="reference internal" href="#id1" id="id13">Access authorization (Request URL)</a><ul>
<li><a class="reference internal" href="#setting-sec-intercept-url-element" id="id14">Setting <code class="docutils literal"><span class="pre">&lt;sec:intercept-url&gt;</span></code> element</a></li>
<li><a class="reference internal" href="#setting-the-url-for-which-access-authorization-is-not-controlled" id="id15">Setting the URL for which access authorization is not controlled</a></li>
<li><a class="reference internal" href="#exception-handling-in-url-pattern" id="id16">Exception handling in URL pattern</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id2" id="id17">Access authorization (JSP)</a></li>
<li><a class="reference internal" href="#id3" id="id18">Access authorization (Method)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-extend" id="id19">How to extend</a><ul>
<li><a class="reference internal" href="#role-hierarchy-functionality" id="id20">Role hierarchy functionality</a><ul>
<li><a class="reference internal" href="#common-settings" id="id21">Common settings</a></li>
<li><a class="reference internal" href="#how-to-use-it-in-access-authorization-request-url-and-access-authorization-jsp" id="id22">How to use it in access authorization (request URL) and access authorization (JSP)</a></li>
<li><a class="reference internal" href="#how-to-use-it-in-access-authorization-method" id="id23">How to use it in access authorization (Method)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id8">6.5.1. Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">This chapter explains about Authorization functionality provided by Spring Security.</div>
</div>
<div class="line-block">
<div class="line">As authorization is implemented using access authorization functionality of Spring Security, it is a pre-requisite that authentication functionality of Spring Security is used.</div>
<div class="line">For details on authentication method using Spring Security, refer to <a class="reference internal" href="Authentication.html"><em>Authentication</em></a>.</div>
</div>
<div class="line-block">
<div class="line">Following 3 are the target resources of access authorization.</div>
</div>
<ol class="arabic simple">
<li>Web (Request URL)<ul>
<li>Authority required to access specific URLs can be set.</li>
</ul>
</li>
<li>Screen fields (JSP)<ul>
<li>Authority required to display specific elements in a screen can be set.</li>
</ul>
</li>
<li>Method<ul>
<li>Authority required to execute specific methods in a screen can be set.</li>
</ul>
</li>
</ol>
<div class="line-block">
<div class="line">In Spring Security, the functionality is implemented by describing access authorization information in configuration file or by using annotations.</div>
</div>
<div class="section" id="access-authorization-request-url">
<h3><a class="toc-backref" href="#id9">6.5.1.1. Access authorization (Request URL)</a><a class="headerlink" href="#access-authorization-request-url" title="Permalink to this headline">¶</a></h3>
<div class="figure" id="id4">
<a class="reference internal image-reference" href="../_images/Authorization_Filter_overview.png"><img alt="Authorization (Request URL)" src="../_images/Authorization_Filter_overview.png" style="width: 60%;" /></a>
<p class="caption"><span class="caption-text"><strong>Picture - Authorization (Request URL)</strong></span></p>
</div>
<ol class="arabic simple">
<li>Spring Security&#8217;s filter chain interrupts the process for user requests.</li>
<li>Target URL for authorization control and request are matched and a query is sent to access authorization manager regarding decision on access authorization.</li>
<li>Access authorization manager checks the user authority and access authorization information
and throws access denial exception when the required role is not assigned.</li>
<li>Process is continued if the required role is assigned.</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="access-authorization-jsp">
<h3><a class="toc-backref" href="#id10">6.5.1.2. Access authorization (JSP)</a><a class="headerlink" href="#access-authorization-jsp" title="Permalink to this headline">¶</a></h3>
<div class="figure" id="id5">
<a class="reference internal image-reference" href="../_images/Authorization_Jsp_overview.png"><img alt="Authorization(JSP)" src="../_images/Authorization_Jsp_overview.png" style="width: 60%;" /></a>
<p class="caption"><span class="caption-text"><strong>Picture - Authorization(JSP)</strong></span></p>
</div>
<ol class="arabic simple">
<li>The servlet generated from JSP inquires with access authorization manager.</li>
<li>Access authorization manager checks the user authority and access authorization information.
If the required role is not assigned, it does not evaluate the internal tag.</li>
<li>It evaluates internal tag if the required role is assigned.</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="access-authorization-method">
<h3><a class="toc-backref" href="#id11">6.5.1.3. Access authorization (Method)</a><a class="headerlink" href="#access-authorization-method" title="Permalink to this headline">¶</a></h3>
<div class="figure" id="id6">
<a class="reference internal image-reference" href="../_images/Authorization_Method_overview.png"><img alt="Authorization(Method)" src="../_images/Authorization_Method_overview.png" style="width: 60%;" /></a>
<p class="caption"><span class="caption-text"><strong>Picture - Authorization(Method)</strong></span></p>
</div>
<ol class="arabic simple">
<li>Spring container generates an interceptor for the target object on the basis of access authorization information and interrupts the process.</li>
<li>Interceptor inquires with access authorization manager on the basis of set roles.</li>
<li>Access authorization manager checks user authority and access authorization information
and throws access denial exception when the required role is not assigned.</li>
<li>The process is continued if the required role is assigned. (Authority can be checked after executing the process as per the settings).</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="how-to-use">
<h2><a class="toc-backref" href="#id12">6.5.2. How to use</a><a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">How to use access authorization (Request URL), access authorization (JSP) and access authorization (Method) is explained here.</div>
</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id13">6.5.2.1. Access authorization (Request URL)</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">The contents to be described in the Spring Security configuration file in order to use access authorization (Request URL) functionality, are shown below.</div>
<div class="line">For basic settings, refer to <a class="reference internal" href="SpringSecurity.html"><em>Spring Security Overview</em></a>.</div>
</div>
<div class="section" id="setting-sec-intercept-url-element">
<span id="authorization-intercept-url"></span><h4><a class="toc-backref" href="#id14">6.5.2.1.1. Setting <code class="docutils literal"><span class="pre">&lt;sec:intercept-url&gt;</span></code> element</a><a class="headerlink" href="#setting-sec-intercept-url-element" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">By describing the target URL to be controlled and the role to be authorized in the <code class="docutils literal"><span class="pre">&lt;sec:intercept-url&gt;</span></code> element which is a child element of <code class="docutils literal"><span class="pre">&lt;sec:http&gt;</span></code> element,</div>
<div class="line">authorization can be controlled for each URL path.</div>
</div>
<div class="line-block">
<div class="line">Setting example is described below.</div>
</div>
<ul>
<li><p class="first">spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;sec:http</span> <span class="na">auto-config=</span><span class="s">&quot;true&quot;</span> <span class="na">use-expressions=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/*&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ROLE_ADMIN&#39;)&quot;</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Attribute name</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">pattern</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Describes the target URL pattern for access authorization. Wild cards &#8220;*&#8221; and &#8220;**&#8221; can be used.</div>
<div class="line">&#8220;*&#8221; is used only for URL patterns of same level while &#8220;**&#8221; targets all URLs under specified level for authorization setting.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">access</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specifies the access control type and accessible role using Spring EL.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">method</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specifies the HTTP method (GET, POST etc.). Matches only the specified method with URL pattern.</div>
<div class="line">When not specified, any HTTP method is applied. It can be utilized in the Web services that mainly use REST.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">requires-channel</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specifies &#8220;http&#8221; or &#8220;https&#8221;. It enforces access to the specified protocol.</div>
<div class="line">When not specified, both protocols can be accessed.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">For attributes other than the above, refer to <a class="reference external" href="http://docs.spring.io/spring-security/site/docs/3.2.9.RELEASE/reference/htmlsingle/#nsa-intercept-url">&lt;intercept-url&gt;</a>.</div>
</div>
</li>
</ul>
<div class="line-block">
<div class="line">A setting example with roles namely &#8220;ROLE_USER&#8221; and &#8220;ROLE_ADMIN&#8221; assigned to login user, is shown below.</div>
</div>
<ul>
<li><p class="first">spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;sec:http</span> <span class="na">auto-config=</span><span class="s">&quot;true&quot;</span> <span class="na">use-expressions=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/reserve/*&quot;</span> <span class="na">access=</span><span class="s">&quot;hasAnyRole(&#39;ROLE_USER&#39;,&#39;ROLE_ADMIN&#39;)&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/*&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ROLE_ADMIN&#39;)&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/**&quot;</span> <span class="na">access=</span><span class="s">&quot;denyAll&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">To access &#8220;/reserve/*&#8221;, either the role &#8220;ROLE_USER&#8221; or &#8220;ROLE_ADMIN&#8221; is required.</div>
<div class="line"><code class="docutils literal"><span class="pre">hasAnyRole</span></code> will be described later.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">To access &#8220;/admin/*&#8221;, the role &#8220;ROLE_ADMIN&#8221; is required.</div>
<div class="line"><code class="docutils literal"><span class="pre">hasRole</span></code> will be described later.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">denyAll</span></code> is set for all patterns</div>
<div class="line">and it is set such that no user can access the URLs for which authority settings are not performed.</div>
<div class="line"><code class="docutils literal"><span class="pre">denyAll</span></code> will be described later.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Description order of URL pattern</strong></p>
<p class="last">Match the request received from client with the pattern in intercept-url, starting from the top.
Perform access authorization for the matched pattern. Therefore, pattern should be described from restricted patterns.</p>
</div>
</li>
</ul>
<div class="line-block">
<div class="line">Spring EL is enabled by setting <code class="docutils literal"><span class="pre">use-expressions=&quot;true&quot;</span></code> in <code class="docutils literal"><span class="pre">&lt;sec:http&gt;</span></code> attribute.</div>
<div class="line">Since Spring EL is evaluated by Boolean values, access is authorized when the expression is true.</div>
<div class="line">Example is shown below.</div>
</div>
<ul>
<li><p class="first">spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;sec:http</span> <span class="na">auto-config=</span><span class="s">&quot;true&quot;</span> <span class="na">use-expressions=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/*&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ROLE_ADMIN&#39;)&quot;</span><span class="nt">/&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr. No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">By specifying <code class="docutils literal"><span class="pre">hasRole('role</span> <span class="pre">name')</span></code>, &#8216;true&#8217; is returned if the login user has the specified role.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block" id="spring-el">
<div class="line"><strong>Example of available expressions list</strong></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">hasRole('Role</span> <span class="pre">name')</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Returns true if the user has the specified role.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">hasAnyRole('Role</span> <span class="pre">1','Role</span> <span class="pre">2')</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Returns true if the user has any of the specified roles.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">permitAll</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Always returns true. Note that it is accessible even if not authenticated.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">denyAll</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Always returns false.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">isAnonymous()</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Returns true in case of an anonymous user.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">isAuthenticated()</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Returns true in case of an authenticated user.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">isFullyAuthenticated()</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Returns false, in case of an anonymous user or authentication by RememberMe functionality.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">hasIpAddress('IP</span> <span class="pre">address')</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Enabled only by the access authorization to request URL and JSP tag.</div>
<div class="line">Returns true if there is a request from specified IP address.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">For other available Spring EL, refer to <a class="reference external" href="http://docs.spring.io/spring-security/site/docs/3.2.9.RELEASE/reference/htmlsingle/#el-common-built-in">Common built-in expressions</a>.</div>
</div>
<div class="line-block">
<div class="line">Determination can also be performed using operator.</div>
<div class="line">In the following example, it can be accessed when it matches with both the role and the requested IP address.</div>
</div>
</li>
<li><p class="first">spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;sec:http</span> <span class="na">auto-config=</span><span class="s">&quot;true&quot;</span> <span class="na">use-expressions=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/admin/*&quot;</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ROLE_ADMIN&#39;) and hasIpAddress(&#39;192.168.10.1&#39;)&quot;</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Available operators list</strong></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operator</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">[Expression1]</span> <span class="pre">and</span> <span class="pre">[Expression2]</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Returns true when both Expression1 and Expression2 are true.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">[Expression1]</span> <span class="pre">or</span> <span class="pre">[Expression2]</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Returns true when either of the expressions is true.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">![Expression]</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Returns false when expression is true and true when the expression is false.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
<div class="section" id="setting-the-url-for-which-access-authorization-is-not-controlled">
<h4><a class="toc-backref" href="#id15">6.5.2.1.2. Setting the URL for which access authorization is not controlled</a><a class="headerlink" href="#setting-the-url-for-which-access-authorization-is-not-controlled" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Use pattern attribute and security attribute of http element for</div>
<div class="line">URLs such as top page and login screen, css file path etc. where authentication is not required.</div>
</div>
<blockquote>
<div><ul class="simple">
<li>spring-security.xml</li>
</ul>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;sec:http</span> <span class="na">pattern=</span><span class="s">&quot;/css/*&quot;</span> <span class="na">security=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>  <span class="c">&lt;!-- Perform steps (1) and (2) in the specified attribute order --&gt;</span>
<span class="nt">&lt;sec:http</span> <span class="na">pattern=</span><span class="s">&quot;/login&quot;</span> <span class="na">security=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;sec:http</span> <span class="na">auto-config=</span><span class="s">&quot;true&quot;</span> <span class="na">use-expressions=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Describe the target URL pattern for which settings are to be performed in <code class="docutils literal"><span class="pre">pattern</span></code> attribute. When not specifying <code class="docutils literal"><span class="pre">pattern</span></code> attribute, match with all patterns.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">By specifying <code class="docutils literal"><span class="pre">none</span></code> in <code class="docutils literal"><span class="pre">security</span></code> attribute, Spring Security filter chain can be avoided for the path stated in <code class="docutils literal"><span class="pre">pattern</span></code> attribute.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="exception-handling-in-url-pattern">
<h4><a class="toc-backref" href="#id16">6.5.2.1.3. Exception handling in URL pattern</a><a class="headerlink" href="#exception-handling-in-url-pattern" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">org.springframework.security.access.AccessDeniedException</span></code> is thrown when an unauthorized URL is accessed.</div>
<div class="line">As per default setting, <code class="docutils literal"><span class="pre">org.springframework.security.web.access.AccessDeniedHandlerImpl</span></code> which is set in <code class="docutils literal"><span class="pre">org.springframework.security.web.access.ExceptionTranslationFilter</span></code>,</div>
<div class="line">returns error code 403.</div>
<div class="line">By setting the error page at the time of access denial in http element, it is possible to transit to the specified error page.</div>
</div>
<ul>
<li><p class="first">spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;sec:http</span> <span class="na">auto-config=</span><span class="s">&quot;true&quot;</span> <span class="na">use-expressions=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
    <span class="nt">&lt;sec:access-denied-handler</span> <span class="na">error-page=</span><span class="s">&quot;/accessDeneidPage&quot;</span> <span class="nt">/&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify destination path in <code class="docutils literal"><span class="pre">error-page</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:access-denied-handler&gt;</span></code> element.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id17">6.5.2.2. Access authorization (JSP)</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Use custom JSP tag <code class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></code> provided by Spring Security, to control screen display fields.</div>
<div class="line">Usage declaration settings of tag library``&lt;%&#64; taglib prefix=&#8221;sec&#8221; uri=&#8221;<a class="reference external" href="http://www.springframework.org/security/tags">http://www.springframework.org/security/tags</a>&#8221; %&gt;``</div>
<div class="line">is the precondition.</div>
</div>
<ul>
<li><p class="first">Attributes list of <code class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></code> tag</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Attribute name</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">access</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Describes the access control expression. If true, tag contents are evaluated.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">url</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Tag contents are evaluated when authority is granted to the set URL. It is used to control link display etc.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">method</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specifies the HTTP method (GET, POST etc.).It is used by combining with url attribute and only the specified method</div>
<div class="line">is matched with the specified URL pattern. When not specified, GET is applied.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">ifAllGranted</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Tag contents are evaluated when all the set roles are granted. Role hierarchy functionality is not effective.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">ifAnyGranted</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Tag contents are evaluated when any one of the set roles is granted. Role hierarchy functionality is not effective.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">ifNotGranted</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Tag contents are evaluated when the set role is not granted. Role hierarchy functionality is not effective.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">var</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Declares the variables of page scope that stores tag evaluation result. It is used when same authorization check is performed in a page.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<div class="line-block">
<div class="line">Example showing use of <code class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></code> tag is as follows:</div>
</div>
<ul>
<li><p class="first">spring-security.xml</p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span>
  <span class="nt">&lt;sec:authorize</span> <span class="na">access=</span><span class="s">&quot;hasRole(&#39;ROLE_USER&#39;)&quot;</span><span class="nt">&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
      <span class="nt">&lt;p&gt;</span>This screen is for ROLE_USER<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/sec:authorize&gt;</span>
  <span class="nt">&lt;sec:authorize</span> <span class="na">url=</span><span class="s">&quot;/admin/menu&quot;</span><span class="nt">&gt;</span>  <span class="c">&lt;!-- (2) --&gt;</span>
      <span class="nt">&lt;p&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/admin/menu&quot;</span><span class="nt">&gt;</span>Go to admin screen<span class="nt">&lt;/a&gt;</span>
      <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/sec:authorize&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Tag contents are displayed only when it contains  &#8220;ROLE_USER&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Tag contents are displayed when access is authorized for &#8220;/admin/menu&#8221;.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The authorization process using <code class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></code> tag <strong>can only be controlled by screen display</strong>. As a result, even if the link is not displayed by specific authority, the URL of the link can be directly accessed by guessing the URL.
Therefore, make sure to use it together with the &#8220;Access authorization (request URL)&#8221; described earlier or the &#8220;Access authorization (Method)&#8221; that will be described later and perform the essential access control.</p>
</div>
</li>
</ul>
</div>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id18">6.5.2.3. Access authorization (Method)</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Authorization control can be performed for method.</div>
<div class="line">The Bean stored in Spring&#8217;s DI container is the target of authorization.</div>
</div>
<div class="line-block">
<div class="line">The two authorization methods described earlier were authorization controls in application layer.</div>
<div class="line">However, method level authorization is controlled with respect to domain layer (Service class).</div>
<div class="line">It is advisable to set <code class="docutils literal"><span class="pre">org.springframework.security.access.prepost.PreAuthorize</span></code> annotation for the method to be controlled.</div>
</div>
<ul>
<li><p class="first">spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;sec:global-method-security</span> <span class="na">pre-post-annotations=</span><span class="s">&quot;enabled&quot;</span><span class="nt">/&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">pre-post-annotations</span></code> attribute of <code class="docutils literal"><span class="pre">&lt;sec:global-method-security&gt;</span></code> element in <code class="docutils literal"><span class="pre">enabled</span></code>.</div>
<div class="line">It is <code class="docutils literal"><span class="pre">disabled</span></code> by default.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Java code</p>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@Service</span>
<span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserServiceImpl</span> <span class="kd">implements</span> <span class="n">UserService</span> <span class="o">{</span>
    <span class="c1">// omitted</span>

    <span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">&quot;hasRole(&#39;ROLE_ADMIN&#39;)&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">User</span> <span class="nf">create</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
       <span class="c1">// omitted</span>
    <span class="o">}</span>


    <span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">&quot;isAuthenticated()&quot;</span><span class="o">)</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">User</span> <span class="nf">update</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
       <span class="c1">// omitted</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">State the access control expression. The expression is evaluated before executing the method and if it is true, the method is executed.</div>
<div class="line">If the expression is false, <code class="docutils literal"><span class="pre">org.springframework.security.access.AccessDeniedException</span></code> is thrown.</div>
<div class="line">Expression stated in <a class="reference internal" href="#authorization-intercept-url"><span>Setting &lt;sec:intercept-url&gt; element</span></a> and</div>
<div class="line">the expression stated in <a class="reference external" href="http://docs.spring.io/spring/docs/4.1.9.RELEASE/spring-framework-reference/html/expressions.html">Spring Expression Language (SpEL)</a> can be set as the value.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Following annotations can also be used in the above setting, other than <code class="docutils literal"><span class="pre">org.springframework.security.access.prepost.PreAuthorize</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">org.springframework.security.access.prepost.PostAuthorize</span></code></li>
<li><code class="docutils literal"><span class="pre">org.springframework.security.access.prepost.PreFilter</span></code></li>
<li><code class="docutils literal"><span class="pre">org.springframework.security.access.prepost.PostFilter</span></code></li>
</ul>
<p class="last">For their details, refer <a class="reference external" href="http://docs.spring.io/spring-security/site/docs/3.2.9.RELEASE/reference/htmlsingle/#el-pre-post-annotations">Spring Security manual</a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In Spring Security, authorization can also be controlled by using <code class="docutils literal"><span class="pre">javax.annotation.security.RolesAllowed</span></code> annotation of JSR-250 which is a standard Java specification.
However, SpEL expressions cannot be stated in <code class="docutils literal"><span class="pre">&#64;RolesAllowed</span></code>. By <code class="docutils literal"><span class="pre">&#64;PreAuthorize</span></code> annotation, using SpEL, authorization control can be performed in the same notations as spring-security.xml settings.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>It is recommended to perform authorization control for request path by carrying out settings in spring-security.xml, instead of assigning annotation to Controller method.</p>
<p class="last">If Service is executed only via Web and if authorization control is performed for all the request path patterns, authorization control for Service need not be performed.
It is advisable to use annotation when it is not known from where Service will be executed and thus authorization control is necessary.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="how-to-extend">
<h2><a class="toc-backref" href="#id19">6.5.3. How to extend</a><a class="headerlink" href="#how-to-extend" title="Permalink to this headline">¶</a></h2>
<div class="section" id="role-hierarchy-functionality">
<h3><a class="toc-backref" href="#id20">6.5.3.1. Role hierarchy functionality</a><a class="headerlink" href="#role-hierarchy-functionality" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Hierarchical relation can be set in roles.</div>
<div class="line">Roles that are set at higher level can have all the accesses authorized by the lower roles.</div>
<div class="line">Consider using hierarchy functionality if the role relation is complex.</div>
</div>
<div class="line-block">
<div class="line">It is explained by setting a hierarchical relation wherein ROLE_ADMIN is the higher role and ROLE_USER is set as the lower role.</div>
</div>
<div class="figure align-center" id="id7">
<a class="reference internal image-reference" href="../_images/Authorization_RoleHierarchy.png"><img alt="RoleHierarchy" src="../_images/Authorization_RoleHierarchy.png" style="width: 30%;" /></a>
<p class="caption"><span class="caption-text"><strong>Picture - RoleHierarchy</strong></span></p>
</div>
<div class="line-block">
<div class="line">Here, if access authorization is set as follows,</div>
<div class="line">the user with &#8220;ROLE_ADMIN&#8221; role can also access &#8220;/user/*&#8221; URL.</div>
</div>
<p><strong>Spring Security configuration file</strong></p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;sec:http</span> <span class="na">auto-config=</span><span class="s">&quot;true&quot;</span> <span class="na">use-expressions=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;sec:intercept-url</span> <span class="na">pattern=</span><span class="s">&quot;/user/*&quot;</span> <span class="na">access=</span><span class="s">&quot;hasAnyRole(&#39;ROLE_USER&#39;)&quot;</span> <span class="nt">/&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">The setting method differs for access authorization (request URL), access authorization (JSP) and access authorization (Method).</div>
<div class="line">How to use these methods is explained below.</div>
</div>
<div class="section" id="common-settings">
<h4><a class="toc-backref" href="#id21">6.5.3.1.1. Common settings</a><a class="headerlink" href="#common-settings" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Required common settings are described here.</div>
<div class="line">Perform Bean definition of <code class="docutils literal"><span class="pre">org.springframework.security.access.hierarchicalroles.RoleHierarchy</span></code> class that stores the hierarchical relation.</div>
</div>
<ul>
<li><p class="first">spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;roleHierarchy&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.springframework.security.access.hierarchicalroles.RoleHierarchyImpl&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;hierarchy&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;value&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
            ROLE_ADMIN &gt; ROLE_STAFF
            ROLE_STAFF &gt; ROLE_USER
        <span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the default class of <code class="docutils literal"><span class="pre">RoleHierarchy</span></code> namely, <code class="docutils literal"><span class="pre">org.springframework.security.access.hierarchicalroles.RoleHierarchyImpl</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define the hierarchical relation in <code class="docutils literal"><span class="pre">hierarchy</span></code> property.</div>
<div class="line">Format:</div>
<div class="line">[Higher role] &gt; [Lower role]</div>
<div class="line">In the example, STAFF can access all the USER authorized resources.</div>
<div class="line">ADMIN can access all the resources authorized by USER and STAFF.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
<div class="section" id="how-to-use-it-in-access-authorization-request-url-and-access-authorization-jsp">
<h4><a class="toc-backref" href="#id22">6.5.3.1.2. How to use it in access authorization (request URL) and access authorization (JSP)</a><a class="headerlink" href="#how-to-use-it-in-access-authorization-request-url-and-access-authorization-jsp" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">How to set role hierarchy for request URL and JSP is explained here.</div>
</div>
<ul>
<li><p class="first">spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;webExpressionHandler&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler&quot;</span><span class="nt">&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;roleHierarchy&quot;</span> <span class="na">ref=</span><span class="s">&quot;roleHierarchy&quot;</span><span class="nt">/&gt;</span>  <span class="c">&lt;!-- (2) --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;sec:http</span> <span class="na">auto-config=</span><span class="s">&quot;true&quot;</span> <span class="na">use-expression=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
    <span class="nt">&lt;sec:expression-handler</span> <span class="na">ref=</span><span class="s">&quot;webExpressionHandler&quot;</span> <span class="nt">/&gt;</span>  <span class="c">&lt;!-- (3) --&gt;</span>
<span class="nt">&lt;/sec:http&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Explanation</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler</span></code> in class.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set the Bean ID of <code class="docutils literal"><span class="pre">RoleHierarchy</span></code> in <code class="docutils literal"><span class="pre">roleHierarchy</span></code> property.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the Bean ID of handler class that implemented <code class="docutils literal"><span class="pre">org.springframework.security.access.expression.SecurityExpressionHandler</span></code> in <code class="docutils literal"><span class="pre">expression-handler</span></code> element.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
<div class="section" id="how-to-use-it-in-access-authorization-method">
<h4><a class="toc-backref" href="#id23">6.5.3.1.3. How to use it in access authorization (Method)</a><a class="headerlink" href="#how-to-use-it-in-access-authorization-method" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Role hierarchy settings when authorization control is performed by assigning annotation to Service method, are explained here.</div>
</div>
<ul>
<li><p class="first">spring-security.xml</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;methodExpressionHandler&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;roleHierarchy&quot;</span> <span class="na">ref=</span><span class="s">&quot;roleHierarchy&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;sec:global-method-security</span> <span class="na">pre-post-annotations=</span><span class="s">&quot;enabled&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;sec:expression-handler</span> <span class="na">ref=</span><span class="s">&quot;methodExpressionHandler&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
<span class="nt">&lt;/sec:global-method-security&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler</span></code> in class.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Set the Bean ID of <code class="docutils literal"><span class="pre">RoleHierarchy</span></code> in <code class="docutils literal"><span class="pre">roleHierarchy</span></code> property.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the Bean ID of handler class that implements <code class="docutils literal"><span class="pre">org.springframework.security.access.expression.SecurityExpressionHandler</span></code> in <code class="docutils literal"><span class="pre">expression-handler</span></code> element.</div>
</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="XSS.html" title="6.6. XSS Countermeasures"
             >next</a> |</li>
        <li class="right" >
          <a href="PasswordHashing.html" title="6.4. Password Hashing"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TERASOLUNA Server Framework for Java (5.x) Development Guideline 5.0.2.RELEASE documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >6. Security for TERASOLUNA Server Framework for Java (5.x)</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013-2016, NTT DATA.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.4.Theme by <a href="http://github.com/vkvn">vkvn</a>
    </div>
    
    <script>
    
    $(function() {
    	var $sidebar	= $('.sphinxsidebar'),
    		$window		= $(window),
    		offset		= $sidebar.offset(),
    		topPadding	= 3,
    		$scroll		= $('#scroll');
    	
    	$window.scroll(function() {
    		if ($scroll.is(':checked')) {
				if ($window.scrollTop() > offset.top) {
					$sidebar.stop().animate({
						marginTop:$window.scrollTop() - offset.top + topPadding
					});
				} else {
					$sidebar.stop().animate({
						marginTop:0
					});
				}
			}
		});
    	
    	var $navList = $('ul:first', $sidebar);
    	$('li:first', $navList).addClass('open');
    	
    	$navList.treeview({
    		persist: "location",
    		collapsed: true,
    		unique: false
    	});
    	
	});
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-46550814-1', 'terasolunaorg.github.io');
    ga('send', 'pageview');
    </script>
  </body>
</html>