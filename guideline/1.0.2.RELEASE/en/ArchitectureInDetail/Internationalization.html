<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>5.13. Internationalization &#8212; TERASOLUNA Global Framework Development Guideline 1.0.2.RELEASE documentation</title>
    <link rel="stylesheet" href="../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.2.RELEASE',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.14. Codelist" href="Codelist.html" />
    <link rel="prev" title="5.12. Double Submit Protection" href="DoubleSubmitProtection.html" /><script async src="https://www.googletagmanager.com/gtag/js?id=G-847V2Q99G8"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date()); gtag('config', 'G-847V2Q99G8');
</script>
<script src="../_static/jquery.treeview.js" type="text/javascript"></script>
<!-- <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'> -->
<link href="../_static/solarized-dark.css" rel="stylesheet">
<link href="../_static/jquery.treeview.css" rel="stylesheet">
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Codelist.html" title="5.14. Codelist"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="DoubleSubmitProtection.html" title="5.12. Double Submit Protection"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TERASOLUNA Global Framework Development Guideline 1.0.2.RELEASE documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">5. Architecture in Detail - TERASOLUNA Global Framework</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><label><input id="scroll" type="checkbox" checked> scroll sidebar</label>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5.13. Internationalization</a><ul>
<li><a class="reference internal" href="#overview">5.13.1. Overview</a></li>
<li><a class="reference internal" href="#how-to-use">5.13.2. How to use</a><ul>
<li><a class="reference internal" href="#configuration-to-define-messages">5.13.2.1. Configuration to define messages</a></li>
<li><a class="reference internal" href="#changing-locale-as-per-browser-settings">5.13.2.2. Changing locale as per browser settings</a><ul>
<li><a class="reference internal" href="#settings-of-acceptheaderlocaleresolver">5.13.2.2.1. Settings of AcceptHeaderLocaleResolver</a></li>
<li><a class="reference internal" href="#definition-of-messages">5.13.2.2.2. Definition of messages</a></li>
<li><a class="reference internal" href="#implementation-of-jsp">5.13.2.2.3. Implementation of JSP</a></li>
</ul>
</li>
<li><a class="reference internal" href="#changing-locale-depending-on-screen-operations-dynamically">5.13.2.3. Changing locale depending on screen operations dynamically</a><ul>
<li><a class="reference internal" href="#how-to-define-localechangeinterceptor">5.13.2.3.1. How to define LocaleChangeInterceptor</a></li>
<li><a class="reference internal" href="#how-to-define-sessionlocaleresolver">5.13.2.3.2. How to define SessionLocaleResolver</a></li>
<li><a class="reference internal" href="#how-to-define-cookielocaleresolver">5.13.2.3.3. How to define CookieLocaleResolver</a></li>
<li><a class="reference internal" href="#messages-settings">5.13.2.3.4. Messages settings</a></li>
<li><a class="reference internal" href="#i18n-set-locale-jsp">5.13.2.3.5. Implementation of JSP</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="DoubleSubmitProtection.html"
                        title="previous chapter">5.12. Double Submit Protection</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Codelist.html"
                        title="next chapter">5.14. Codelist</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/ArchitectureInDetail/Internationalization.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="internationalization">
<h1>5.13. Internationalization<a class="headerlink" href="#internationalization" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id3">Overview</a></li>
<li><a class="reference internal" href="#how-to-use" id="id4">How to use</a><ul>
<li><a class="reference internal" href="#configuration-to-define-messages" id="id5">Configuration to define messages</a></li>
<li><a class="reference internal" href="#changing-locale-as-per-browser-settings" id="id6">Changing locale as per browser settings</a><ul>
<li><a class="reference internal" href="#settings-of-acceptheaderlocaleresolver" id="id7">Settings of AcceptHeaderLocaleResolver</a></li>
<li><a class="reference internal" href="#definition-of-messages" id="id8">Definition of messages</a></li>
<li><a class="reference internal" href="#implementation-of-jsp" id="id9">Implementation of JSP</a></li>
</ul>
</li>
<li><a class="reference internal" href="#changing-locale-depending-on-screen-operations-dynamically" id="id10">Changing locale depending on screen operations dynamically</a><ul>
<li><a class="reference internal" href="#how-to-define-localechangeinterceptor" id="id11">How to define LocaleChangeInterceptor</a></li>
<li><a class="reference internal" href="#how-to-define-sessionlocaleresolver" id="id12">How to define SessionLocaleResolver</a></li>
<li><a class="reference internal" href="#how-to-define-cookielocaleresolver" id="id13">How to define CookieLocaleResolver</a></li>
<li><a class="reference internal" href="#messages-settings" id="id14">Messages settings</a></li>
<li><a class="reference internal" href="#i18n-set-locale-jsp" id="id15">Implementation of JSP</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id3">5.13.1. Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Internationalization is a process wherein the display of labels and messages in an application is not fixed to a specific language. It supports multiple languages. The language switching can be achieved by specifying a unit called “Locale” expressing language, country and region.</p>
<p>This section explains how to internationalize messages to display on the screen.</p>
<p>In order to internationalization, following requrements should be meeted.</p>
<ul class="simple">
<li>Text elements on the screen(code name, messages, labels of GUI components etc.) should be retrieve from external definitions such as properties file. (should not be hard-coding in the source code)</li>
<li>The mechanism to specify the locale of the clients should be provided.</li>
</ul>
<p>Methods to specify the locale are as follows:</p>
<ul class="simple">
<li>Using standard request header (specify the locale by language settings of browsers)</li>
<li>Saving the locale into the Cookie using request parameter</li>
<li>Saving the locale into the Session using request parameter</li>
</ul>
<p>The image of switching locale is as follows:</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/i18n_change_image.png"><img alt="locale change image" src="../_images/i18n_change_image.png" style="width: 90%;" /></a>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For internationalization of Codelist, refer to <a class="reference internal" href="Codelist.html"><span class="doc">Codelist</span></a>.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The most commonly known abbreviation of internationalization is i18n.
Internationalization is abbreviated as i18n because the number of letters between the first “i” and
the last “n” is 18 i.e. “nternationalizatio”.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="how-to-use">
<h2><a class="toc-backref" href="#id4">5.13.2. How to use</a><a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h2>
<div class="section" id="configuration-to-define-messages">
<h3><a class="toc-backref" href="#id5">5.13.2.1. Configuration to define messages</a><a class="headerlink" href="#configuration-to-define-messages" title="Permalink to this headline">¶</a></h3>
<p>To internationalize the messages on the screen, use the one of following <code class="docutils literal"><span class="pre">MessageSource</span></code>imelementations for managing messages.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">org.springframework.context.support.ResourceBundleMessageSource</span></code></li>
<li><code class="docutils literal"><span class="pre">org.springframework.context.support.ReloadableResourceBundleMessageSource</span></code></li>
</ul>
<p>The information here explains an example of using the <code class="docutils literal"><span class="pre">ResourceBundleMessageSource</span></code>.</p>
<p><strong>applicationContext.xml</strong></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;messageSource&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.springframework.context.support.ResourceBundleMessageSource&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;basenames&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;list&gt;</span>
            <span class="nt">&lt;value&gt;</span>i18n/application-messages<span class="nt">&lt;/value&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
        <span class="nt">&lt;/list&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">i18n/application-messages</span></code> as base name of properties file.</div>
<div class="line">It is recommended to store message properties file under i18n directory to support internationalization.</div>
<div class="line"><br /></div>
<div class="line">For MessageSource details and definition methods, refer to <a class="reference internal" href="MessageManagement.html"><span class="doc">Message Management</span></a>.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Example of storing properties files</strong></p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/i18n_properties_filepath.png"><img alt="properties filepath" src="../_images/i18n_properties_filepath.png" style="width: 50%;" /></a>
</div>
<p>Properties file should be created in accordance with the following rules.</p>
<ul class="simple">
<li>File name should be defined in <code class="file docutils literal"><span class="pre">application-messages_XX.properties</span></code> format. (Specify locale in XX portion)</li>
<li>The messages defined in <code class="file docutils literal"><span class="pre">application-messages.properties</span></code> should be created in default language.</li>
<li><strong>Make sure you create</strong> <code class="file docutils literal"><span class="pre">application-messages.properties</span></code>. If it does not exist, messages cannot be fetched from <code class="docutils literal"><span class="pre">MessageSource</span></code> and <code class="docutils literal"><span class="pre">JspTagException</span></code> occurs while setting the messages in JSP.</li>
</ul>
<p>When creating property files as above, it is determined which to use the file as follows:</p>
<ul class="simple">
<li>When the locale resolved by <code class="docutils literal"><span class="pre">LocaleResolver</span></code> is zh, <code class="file docutils literal"><span class="pre">application-messages_zh.properties</span></code> is used.</li>
<li>when the locale resolved by <code class="docutils literal"><span class="pre">LocaleResolver</span></code> is ja, <code class="file docutils literal"><span class="pre">application-messages_ja.properties</span></code> is used.</li>
<li>When properties file does not exist corresponding to the locale resolved by <code class="docutils literal"><span class="pre">LocaleResolver</span></code>, <code class="file docutils literal"><span class="pre">application-messages.properties</span></code> is used as default. (“_XX” portion does not exist in file name)</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The locate to use is determined in the following order until a properties file is found corresponding to the locale.</p>
<ol class="arabic simple">
<li>Locale sent from clients</li>
<li>Locale specified by JVM on which application server runs (it may not be set in some cases)</li>
<li>Locale specified by OS on which application server runs</li>
</ol>
<p class="last">It is frequently misunderstood that default properties file is used when properties file does not exist corresponding to the locale sent from clients .
In this case, then it is checked whether the file is available corresponding to the locale specified by the application server.
If not found, finally the default properties file is used.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">For description of message properties file, refer to <a class="reference internal" href="MessageManagement.html"><span class="doc">Message Management</span></a>.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="changing-locale-as-per-browser-settings">
<h3><a class="toc-backref" href="#id6">5.13.2.2. Changing locale as per browser settings</a><a class="headerlink" href="#changing-locale-as-per-browser-settings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="settings-of-acceptheaderlocaleresolver">
<h4><a class="toc-backref" href="#id7">5.13.2.2.1. Settings of AcceptHeaderLocaleResolver</a><a class="headerlink" href="#settings-of-acceptheaderlocaleresolver" title="Permalink to this headline">¶</a></h4>
<p>If switch the locale using browser settings, use the <code class="docutils literal"><span class="pre">AcceptHeaderLocaleResolver</span></code>.</p>
<p><strong>spring-mvc.xml</strong></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;localeResolver&quot;</span>
    <span class="na">class=</span><span class="s">&quot;org.springframework.web.servlet.i18n.AcceptHeaderLocaleResolver&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify <code class="docutils literal"><span class="pre">org.springframework.web.servlet.i18n.AcceptHeaderLocaleResolver</span></code> in id attribute “localeResolver” of bean tag.</div>
<div class="line">If this <code class="docutils literal"><span class="pre">LocaleResolver</span></code> is used, HTTP header “accept-language” is added for each request and locale gets specified.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When <code class="docutils literal"><span class="pre">LocaleResolver</span></code> is not set, <code class="docutils literal"><span class="pre">org.springframework.web.servlet.i18n.AcceptHeaderLocaleResolver</span></code> is used by default; hence <code class="docutils literal"><span class="pre">LocaleResolver</span></code> need not be set.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="definition-of-messages">
<h4><a class="toc-backref" href="#id8">5.13.2.2.2. Definition of messages</a><a class="headerlink" href="#definition-of-messages" title="Permalink to this headline">¶</a></h4>
<p>See the example of definition of messages below.</p>
<p><strong>application-messages.properties</strong></p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">title.admin.top</span> <span class="o">=</span> <span class="s">Admin Top</span>
</pre></div>
</div>
<p><strong>application-messages_ja.properties</strong></p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">title.admin.top</span> <span class="o">=</span> <span class="s">管理画面 Top</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementation-of-jsp">
<h4><a class="toc-backref" href="#id9">5.13.2.2.3. Implementation of JSP</a><a class="headerlink" href="#implementation-of-jsp" title="Permalink to this headline">¶</a></h4>
<p>See the example of implementaion of messages below.</p>
<p><strong>include.jsp(Common jsp file to be included)</strong></p>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="k">&lt;%@</span> <span class="n">page</span> <span class="n">session</span><span class="o">=</span><span class="s">&quot;false&quot;</span><span class="k">%&gt;</span>
<span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;c&quot;</span><span class="k">%&gt;</span>
<span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://java.sun.com/jsp/jstl/fmt&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;fmt&quot;</span><span class="k">%&gt;</span>
<span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://www.springframework.org/tags&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;spring&quot;</span><span class="k">%&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
<span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://www.springframework.org/tags/form&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;form&quot;</span><span class="k">%&gt;</span>
<span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://www.springframework.org/security/tags&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;sec&quot;</span><span class="k">%&gt;</span>
<span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://terasoluna.org/functions&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;f&quot;</span><span class="k">%&gt;</span>
<span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://terasoluna.org/tags&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;t&quot;</span><span class="k">%&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When message is to be output in JSP, it is output using Spring tag library; hence custom tag needs to be defined.</div>
<div class="line"><code class="docutils literal"><span class="pre">&lt;%&#64;taglib</span> <span class="pre">uri=&quot;http://www.springframework.org/tags&quot;</span> <span class="pre">prefix=&quot;spring&quot;%&gt;</span></code>  should be defined.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For details on common jsp files to be included, refer to <a class="reference internal" href="../ImplementationAtEachLayer/ApplicationLayer.html#view-jsp-include-label"><span class="std std-ref">Creating common JSP for include</span></a>.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>JSP file for screen display</strong></p>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="nt">&lt;spring:message</span> <span class="na">code=</span><span class="s">&quot;title.admin.top&quot;</span> <span class="nt">/&gt;</span>  <span class="c">&lt;!-- (2) --&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Output the message using <code class="docutils literal"><span class="pre">&lt;spring:message&gt;</span></code>  which is a Spring tag library of JSP.</div>
<div class="line">In code attribute, set the key specified in properties.</div>
<div class="line">In this example, if locale is ja, “管理画面 Top” is output and for other locales, “Admin Top” is output.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="changing-locale-depending-on-screen-operations-dynamically">
<h3><a class="toc-backref" href="#id10">5.13.2.3. Changing locale depending on screen operations dynamically</a><a class="headerlink" href="#changing-locale-depending-on-screen-operations-dynamically" title="Permalink to this headline">¶</a></h3>
<p>The method of dynamic changing the locale depending on screen operations etc. is effective in case of selecting a specific language irrespective of user terminal (browser) settings.</p>
<p>Following is an example of changing locale depending on screen operations.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/i18n_change_locale_on_screen.png"><img alt="i18n change locale on screen" src="../_images/i18n_change_locale_on_screen.png" style="width: 40%;" /></a>
</div>
<p>To use the language selected by a user, chooose <code class="docutils literal"><span class="pre">org.springframework.web.servlet.i18n.LocaleChangeInterceptor</span></code>.</p>
<p><code class="docutils literal"><span class="pre">LocaleChangeInterceptor</span></code>is an interceptor to save the locale value specified by the request parameter using <code class="docutils literal"><span class="pre">org.springframework.web.servlet.LocaleResolver</span></code>.</p>
<p>Select the implementation class of <code class="docutils literal"><span class="pre">LocaleResolver</span></code> from the following table.</p>
<table border="1" class="colwidths-given docutils" id="id2">
<caption><span class="caption-text"><strong>Types of LocaleResolver</strong></span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="5%" />
<col width="60%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">No</th>
<th class="head">Implementation class</th>
<th class="head">How to save locale</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td><code class="docutils literal"><span class="pre">org.springframework.web.servlet.i18n.SessionLocaleResolver</span></code></td>
<td><div class="first last line-block">
<div class="line">Save in server(using <code class="docutils literal"><span class="pre">HttpSession</span></code>)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td><code class="docutils literal"><span class="pre">org.springframework.web.servlet.i18n.CookieLocaleResolver</span></code></td>
<td><div class="first last line-block">
<div class="line">Save in client(using <code class="docutils literal"><span class="pre">Cookie</span></code>)</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When <code class="docutils literal"><span class="pre">org.springframework.web.servlet.i18n.AcceptHeaderLocaleResolver</span></code> is used in <code class="docutils literal"><span class="pre">LocaleResolver</span></code>,
locale cannot be changed dynamically using <code class="docutils literal"><span class="pre">org.springframework.web.servlet.i18n.LocaleChangeInterceptor</span></code>.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="how-to-define-localechangeinterceptor">
<h4><a class="toc-backref" href="#id11">5.13.2.3.1. How to define LocaleChangeInterceptor</a><a class="headerlink" href="#how-to-define-localechangeinterceptor" title="Permalink to this headline">¶</a></h4>
<p>If switching the locale using the request parameter, use the <code class="docutils literal"><span class="pre">LocaleChangeInterceptor</span></code>.</p>
<p><strong>spring-mvc.xml</strong></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;mvc:interceptors&gt;</span>
  <span class="nt">&lt;mvc:interceptor&gt;</span>
    <span class="nt">&lt;mvc:mapping</span> <span class="na">path=</span><span class="s">&quot;/**&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;mvc:exclude-mapping</span> <span class="na">path=</span><span class="s">&quot;/resources/**&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;mvc:exclude-mapping</span> <span class="na">path=</span><span class="s">&quot;/**/*.html&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;bean</span>
      <span class="na">class=</span><span class="s">&quot;org.springframework.web.servlet.i18n.LocaleChangeInterceptor&quot;</span><span class="nt">&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>
    <span class="c">&lt;!-- omitted --&gt;</span>
  <span class="nt">&lt;/mvc:interceptor&gt;</span>
<span class="nt">&lt;/mvc:interceptors&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">項番</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">説明</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define <code class="docutils literal"><span class="pre">org.springframework.web.servlet.i18n.LocaleChangeInterceptor</span></code> in interceptor of Spring MVC.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>How to change the name of request parameter to specify locale</strong></p>
<blockquote class="last">
<div><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;bean</span>
    <span class="na">class=</span><span class="s">&quot;org.springframework.web.servlet.i18n.LocaleChangeInterceptor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;paramName&quot;</span> <span class="na">value=</span><span class="s">&quot;lang&quot;</span><span class="nt">/&gt;</span>  <span class="c">&lt;!-- (2) --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In <code class="docutils literal"><span class="pre">paramName</span></code>property, specify the name of request parameter. In this example, it is “request URL?lang=xx”.</div>
<div class="line"><strong>When paramName property is omitted, “locale” gets set.</strong> With “request URL?locale=xx”, it becomes <a class="reference internal" href="#i18n-set-locale-jsp"><span class="std std-ref">enabled</span></a>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="how-to-define-sessionlocaleresolver">
<h4><a class="toc-backref" href="#id12">5.13.2.3.2. How to define SessionLocaleResolver</a><a class="headerlink" href="#how-to-define-sessionlocaleresolver" title="Permalink to this headline">¶</a></h4>
<p>If saving the locale in the server side, use the  <code class="docutils literal"><span class="pre">SessionLocaleResolver</span></code>.</p>
<p><strong>spring-mvc.xml</strong></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;localeResolver&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework.web.servlet.i18n.SessionLocaleResolver&quot;</span><span class="nt">&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;defaultLocale&quot;</span> <span class="na">value=</span><span class="s">&quot;en&quot;</span><span class="nt">/&gt;</span>  <span class="c">&lt;!-- (2) --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Define id attribute of bean tag in “localeResolver” and specify the class wherein <code class="docutils literal"><span class="pre">org.springframework.web.servlet.LocaleResolver</span></code> is implemented.</div>
<div class="line">In this example, <code class="docutils literal"><span class="pre">org.springframework.web.servlet.i18n.SessionLocaleResolver</span></code> that stores locale in session is specified.</div>
<div class="line">id attribute of bean tag should be set as “localeResolver”.</div>
<div class="line">By performing these settings, <code class="docutils literal"><span class="pre">SessionLocaleResolver</span></code> will be used at the <code class="docutils literal"><span class="pre">LocaleChangeInterceptor</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When locale is not specified in request parameter, locale specified in <code class="docutils literal"><span class="pre">defaultLocale</span></code> property is enabled. In this case, the value fetched in <code class="docutils literal"><span class="pre">HttpServletRequest#getLocale</span></code> is considered.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="how-to-define-cookielocaleresolver">
<h4><a class="toc-backref" href="#id13">5.13.2.3.3. How to define CookieLocaleResolver</a><a class="headerlink" href="#how-to-define-cookielocaleresolver" title="Permalink to this headline">¶</a></h4>
<p>If saving the locale in the client side, use the  <code class="docutils literal"><span class="pre">CookieLocaleResolver</span></code>.</p>
<p><strong>spring-mvc.xml</strong></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;localeResolver&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework.web.servlet.i18n.CookieLocaleResolver&quot;</span><span class="nt">&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;defaultLocale&quot;</span> <span class="na">value=</span><span class="s">&quot;en&quot;</span><span class="nt">/&gt;</span>  <span class="c">&lt;!-- (2) --&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;cookieName&quot;</span> <span class="na">value=</span><span class="s">&quot;localeCookie&quot;</span><span class="nt">/&gt;</span>  <span class="c">&lt;!-- (3) --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In id attribute “localeResolver” of bean tag, specify <code class="docutils literal"><span class="pre">org.springframework.web.servlet.i18n.CookieLocaleResolver</span></code>.</div>
<div class="line">id attribute of bean tag should be set as “localeResolver”.</div>
<div class="line">By performing these settings, <code class="docutils literal"><span class="pre">CookieLocaleResolver</span></code> will be used at the <code class="docutils literal"><span class="pre">LocaleChangeInterceptor</span></code>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When locale is not specified, locale specified in <code class="docutils literal"><span class="pre">defaultLocale</span></code> property is enabled. In this case, the value fetched in <code class="docutils literal"><span class="pre">HttpServletRequest#getLocale</span></code> is considered.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The value specified in <code class="docutils literal"><span class="pre">cookieName</span></code> property is used as cookie name. If not specified, the value of <code class="docutils literal"><span class="pre">org.springframework.web.servlet.i18n.CookieLocaleResolver.LOCALE</span></code>is used as default. <strong>It is recommended to change not to tell the user explicitly Spring Framework is used.</strong></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="messages-settings">
<h4><a class="toc-backref" href="#id14">5.13.2.3.4. Messages settings</a><a class="headerlink" href="#messages-settings" title="Permalink to this headline">¶</a></h4>
<p>See the example below for messages settings.</p>
<p><strong>application-messages.properties</strong></p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">i.xx.yy.0001</span> <span class="o">=</span> <span class="s">changed locale</span>
<span class="na">i.xx.yy.0002</span> <span class="o">=</span> <span class="s">Confirm change of locale at next screen</span>
</pre></div>
</div>
<p><strong>application-messages_ja.properties</strong></p>
<div class="highlight-properties"><div class="highlight"><pre><span></span><span class="na">i.xx.yy.0001</span> <span class="o">=</span> <span class="s">Localeを変更しました。</span>
<span class="na">i.xx.yy.0002</span> <span class="o">=</span> <span class="s">次の画面でのLocale変更を確認</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="i18n-set-locale-jsp">
<span id="id1"></span><h4><a class="toc-backref" href="#id15">5.13.2.3.5. Implementation of JSP</a><a class="headerlink" href="#i18n-set-locale-jsp" title="Permalink to this headline">¶</a></h4>
<p>See the example of implementation of JSP below.</p>
<p><strong>JSP file for screen display</strong></p>
<div class="highlight-jsp"><div class="highlight"><pre><span></span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&#39;${pageContext.request.contextPath}?locale=en&#39;</span><span class="nt">&gt;</span>English<span class="nt">&lt;/a&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&#39;${pageContext.request.contextPath}?locale=ja&#39;</span><span class="nt">&gt;</span>Japanese<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;spring:message</span> <span class="na">code=</span><span class="s">&quot;i.xx.yy.0001&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr. No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Submit the request parameter to switch the locale.</div>
<div class="line">Request parameter name is specified in <code class="docutils literal"><span class="pre">paramName</span></code> property of <code class="docutils literal"><span class="pre">LocaleChangeInterceptor</span></code>. (In the example above, the default parameter name is used)</div>
<div class="line">In the above example, it is changed to English locale in English link and to Japanese locale in Japanese link.</div>
<div class="line">Hereafter, the selected locale is enabled.</div>
<div class="line">As “en” properties file does not exist, English locale is read from properties file by default.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<ul class="last simple">
<li>Spring tag library should be defined in common jsp files to be included.</li>
<li>For details on common jsp files to be included, refer to <a class="reference internal" href="../ImplementationAtEachLayer/ApplicationLayer.html#view-jsp-include-label"><span class="std std-ref">Creating common JSP for include</span></a>.</li>
</ul>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Codelist.html" title="5.14. Codelist"
             >next</a> |</li>
        <li class="right" >
          <a href="DoubleSubmitProtection.html" title="5.12. Double Submit Protection"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">TERASOLUNA Global Framework Development Guideline 1.0.2.RELEASE documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >5. Architecture in Detail - TERASOLUNA Global Framework</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013-2015, NTT DATA.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.3.Theme by <a href="http://github.com/vkvn">vkvn</a>
    </div>
    
    <script>
    
    $(function() {
    	var $sidebar	= $('.sphinxsidebar'),
    		$window		= $(window),
    		offset		= $sidebar.offset(),
    		topPadding	= 3,
    		$scroll		= $('#scroll');
    	
    	$window.scroll(function() {
    		if ($scroll.is(':checked')) {
				if ($window.scrollTop() > offset.top) {
					$sidebar.stop().animate({
						marginTop:$window.scrollTop() - offset.top + topPadding
					});
				} else {
					$sidebar.stop().animate({
						marginTop:0
					});
				}
			}
		});
    	
    	var $navList = $('ul:first', $sidebar);
    	$('li:first', $navList).addClass('open');
    	
    	$navList.treeview({
    		persist: "location",
    		collapsed: true,
    		unique: false
    	});
    	
	});
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-46550814-1', 'terasolunaorg.github.io');
    ga('send', 'pageview');
    </script>
  </body>
</html>